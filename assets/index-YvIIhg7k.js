var zT=Object.create;var nv=Object.defineProperty;var BT=Object.getOwnPropertyDescriptor;var Rx=(ee,z)=>(z=Symbol[ee])?z:Symbol.for("Symbol."+ee),qp=ee=>{throw TypeError(ee)};var Lx=(ee,z,P)=>z in ee?nv(ee,z,{enumerable:!0,configurable:!0,writable:!0,value:P}):ee[z]=P;var Tx=(ee,z)=>nv(ee,"name",{value:z,configurable:!0});var ig=ee=>[,,,zT(ee?.[Rx("metadata")]??null)],Px=["class","method","getter","setter","accessor","field","value","get","set"],Xp=ee=>ee!==void 0&&typeof ee!="function"?qp("Function expected"):ee,HT=(ee,z,P,$,ve)=>({kind:Px[ee],name:z,metadata:$,addInitializer:ze=>P._?qp("Already initialized"):ve.push(Xp(ze||null))}),Yp=(ee,z)=>Lx(z,Rx("metadata"),ee[3]),ag=(ee,z,P,$)=>{for(var ve=0,ze=ee[z>>1],Ze=ze&&ze.length;ve<Ze;ve++)z&1?ze[ve].call(P):$=ze[ve].call(P,$);return $},ko=(ee,z,P,$,ve,ze)=>{var Ze,at,Ke,vt,Zt,$e=z&7,Rt=!!(z&8),Tt=!!(z&16),mn=$e>3?ee.length+1:$e?Rt?1:2:0,Ot=Px[$e+5],Lt=$e>3&&(ee[mn-1]=[]),rr=ee[mn]||(ee[mn]=[]),_n=$e&&(!Tt&&!Rt&&(ve=ve.prototype),$e<5&&($e>3||!Tt)&&BT($e<4?ve:{get[P](){return Ex(this,ze)},set[P](F){return Ax(this,ze,F)}},P));$e?Tt&&$e<4&&Tx(ze,($e>2?"set ":$e>1?"get ":"")+P):Tx(ve,P);for(var ir=$.length-1;ir>=0;ir--)vt=HT($e,P,Ke={},ee[3],rr),$e&&(vt.static=Rt,vt.private=Tt,Zt=vt.access={has:Tt?F=>jT(ve,F):F=>P in F},$e^3&&(Zt.get=Tt?F=>($e^1?Ex:GT)(F,ve,$e^4?ze:_n.get):F=>F[P]),$e>2&&(Zt.set=Tt?(F,he)=>Ax(F,ve,he,$e^4?ze:_n.set):(F,he)=>F[P]=he)),at=(0,$[ir])($e?$e<4?Tt?ze:_n[Ot]:$e>4?void 0:{get:_n.get,set:_n.set}:ve,vt),Ke._=1,$e^4||at===void 0?Xp(at)&&($e>4?Lt.unshift(at):$e?Tt?ze=at:_n[Ot]=at:ve=at):typeof at!="object"||at===null?qp("Object expected"):(Xp(Ze=at.get)&&(_n.get=Ze),Xp(Ze=at.set)&&(_n.set=Ze),Xp(Ze=at.init)&&Lt.unshift(Ze));return $e||Yp(ee,ve),_n&&nv(ve,P,_n),Tt?$e^4?ze:_n:ve},Cx=(ee,z,P)=>Lx(ee,typeof z!="symbol"?z+"":z,P),rv=(ee,z,P)=>z.has(ee)||qp("Cannot "+P),jT=(ee,z)=>Object(z)!==z?qp('Cannot use the "in" operator on this value'):ee.has(z),Ex=(ee,z,P)=>(rv(ee,z,"read from private field"),P?P.call(ee):z.get(ee));var Ax=(ee,z,P,$)=>(rv(ee,z,"write to private field"),$?$.call(ee,P):z.set(ee,P),P),GT=(ee,z,P)=>(rv(ee,z,"access private method"),P);(function(){const z=document.createElement("link").relList;if(z&&z.supports&&z.supports("modulepreload"))return;for(const ve of document.querySelectorAll('link[rel="modulepreload"]'))$(ve);new MutationObserver(ve=>{for(const ze of ve)if(ze.type==="childList")for(const Ze of ze.addedNodes)Ze.tagName==="LINK"&&Ze.rel==="modulepreload"&&$(Ze)}).observe(document,{childList:!0,subtree:!0});function P(ve){const ze={};return ve.integrity&&(ze.integrity=ve.integrity),ve.referrerPolicy&&(ze.referrerPolicy=ve.referrerPolicy),ve.crossOrigin==="use-credentials"?ze.credentials="include":ve.crossOrigin==="anonymous"?ze.credentials="omit":ze.credentials="same-origin",ze}function $(ve){if(ve.ep)return;ve.ep=!0;const ze=P(ve);fetch(ve.href,ze)}})();function lb(ee){return ee&&ee.__esModule&&Object.prototype.hasOwnProperty.call(ee,"default")?ee.default:ee}var iv={exports:{}},Qp={},av={exports:{}},zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dx;function VT(){if(Dx)return zt;Dx=1;var ee=Symbol.for("react.element"),z=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),ve=Symbol.for("react.profiler"),ze=Symbol.for("react.provider"),Ze=Symbol.for("react.context"),at=Symbol.for("react.forward_ref"),Ke=Symbol.for("react.suspense"),vt=Symbol.for("react.memo"),Zt=Symbol.for("react.lazy"),$e=Symbol.iterator;function Rt(se){return se===null||typeof se!="object"?null:(se=$e&&se[$e]||se["@@iterator"],typeof se=="function"?se:null)}var Tt={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mn=Object.assign,Ot={};function Lt(se,Re,Et){this.props=se,this.context=Re,this.refs=Ot,this.updater=Et||Tt}Lt.prototype.isReactComponent={},Lt.prototype.setState=function(se,Re){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,Re,"setState")},Lt.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function rr(){}rr.prototype=Lt.prototype;function _n(se,Re,Et){this.props=se,this.context=Re,this.refs=Ot,this.updater=Et||Tt}var ir=_n.prototype=new rr;ir.constructor=_n,mn(ir,Lt.prototype),ir.isPureReactComponent=!0;var F=Array.isArray,he=Object.prototype.hasOwnProperty,Se={current:null},Be={key:!0,ref:!0,__self:!0,__source:!0};function We(se,Re,Et){var Pt,Gt={},Vt=null,dn=null;if(Re!=null)for(Pt in Re.ref!==void 0&&(dn=Re.ref),Re.key!==void 0&&(Vt=""+Re.key),Re)he.call(Re,Pt)&&!Be.hasOwnProperty(Pt)&&(Gt[Pt]=Re[Pt]);var rn=arguments.length-2;if(rn===1)Gt.children=Et;else if(1<rn){for(var wn=Array(rn),Jr=0;Jr<rn;Jr++)wn[Jr]=arguments[Jr+2];Gt.children=wn}if(se&&se.defaultProps)for(Pt in rn=se.defaultProps,rn)Gt[Pt]===void 0&&(Gt[Pt]=rn[Pt]);return{$$typeof:ee,type:se,key:Vt,ref:dn,props:Gt,_owner:Se.current}}function ct(se,Re){return{$$typeof:ee,type:se.type,key:Re,ref:se.ref,props:se.props,_owner:se._owner}}function it(se){return typeof se=="object"&&se!==null&&se.$$typeof===ee}function Nt(se){var Re={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(Et){return Re[Et]})}var Un=/\/+/g;function jn(se,Re){return typeof se=="object"&&se!==null&&se.key!=null?Nt(""+se.key):Re.toString(36)}function pr(se,Re,Et,Pt,Gt){var Vt=typeof se;(Vt==="undefined"||Vt==="boolean")&&(se=null);var dn=!1;if(se===null)dn=!0;else switch(Vt){case"string":case"number":dn=!0;break;case"object":switch(se.$$typeof){case ee:case z:dn=!0}}if(dn)return dn=se,Gt=Gt(dn),se=Pt===""?"."+jn(dn,0):Pt,F(Gt)?(Et="",se!=null&&(Et=se.replace(Un,"$&/")+"/"),pr(Gt,Re,Et,"",function(Jr){return Jr})):Gt!=null&&(it(Gt)&&(Gt=ct(Gt,Et+(!Gt.key||dn&&dn.key===Gt.key?"":(""+Gt.key).replace(Un,"$&/")+"/")+se)),Re.push(Gt)),1;if(dn=0,Pt=Pt===""?".":Pt+":",F(se))for(var rn=0;rn<se.length;rn++){Vt=se[rn];var wn=Pt+jn(Vt,rn);dn+=pr(Vt,Re,Et,wn,Gt)}else if(wn=Rt(se),typeof wn=="function")for(se=wn.call(se),rn=0;!(Vt=se.next()).done;)Vt=Vt.value,wn=Pt+jn(Vt,rn++),dn+=pr(Vt,Re,Et,wn,Gt);else if(Vt==="object")throw Re=String(se),Error("Objects are not valid as a React child (found: "+(Re==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":Re)+"). If you meant to render a collection of children, use an array instead.");return dn}function Kr(se,Re,Et){if(se==null)return se;var Pt=[],Gt=0;return pr(se,Pt,"","",function(Vt){return Re.call(Et,Vt,Gt++)}),Pt}function Zn(se){if(se._status===-1){var Re=se._result;Re=Re(),Re.then(function(Et){(se._status===0||se._status===-1)&&(se._status=1,se._result=Et)},function(Et){(se._status===0||se._status===-1)&&(se._status=2,se._result=Et)}),se._status===-1&&(se._status=0,se._result=Re)}if(se._status===1)return se._result.default;throw se._result}var Dn={current:null},Ye={transition:null},mt={ReactCurrentDispatcher:Dn,ReactCurrentBatchConfig:Ye,ReactCurrentOwner:Se};function et(){throw Error("act(...) is not supported in production builds of React.")}return zt.Children={map:Kr,forEach:function(se,Re,Et){Kr(se,function(){Re.apply(this,arguments)},Et)},count:function(se){var Re=0;return Kr(se,function(){Re++}),Re},toArray:function(se){return Kr(se,function(Re){return Re})||[]},only:function(se){if(!it(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},zt.Component=Lt,zt.Fragment=P,zt.Profiler=ve,zt.PureComponent=_n,zt.StrictMode=$,zt.Suspense=Ke,zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mt,zt.act=et,zt.cloneElement=function(se,Re,Et){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var Pt=mn({},se.props),Gt=se.key,Vt=se.ref,dn=se._owner;if(Re!=null){if(Re.ref!==void 0&&(Vt=Re.ref,dn=Se.current),Re.key!==void 0&&(Gt=""+Re.key),se.type&&se.type.defaultProps)var rn=se.type.defaultProps;for(wn in Re)he.call(Re,wn)&&!Be.hasOwnProperty(wn)&&(Pt[wn]=Re[wn]===void 0&&rn!==void 0?rn[wn]:Re[wn])}var wn=arguments.length-2;if(wn===1)Pt.children=Et;else if(1<wn){rn=Array(wn);for(var Jr=0;Jr<wn;Jr++)rn[Jr]=arguments[Jr+2];Pt.children=rn}return{$$typeof:ee,type:se.type,key:Gt,ref:Vt,props:Pt,_owner:dn}},zt.createContext=function(se){return se={$$typeof:Ze,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:ze,_context:se},se.Consumer=se},zt.createElement=We,zt.createFactory=function(se){var Re=We.bind(null,se);return Re.type=se,Re},zt.createRef=function(){return{current:null}},zt.forwardRef=function(se){return{$$typeof:at,render:se}},zt.isValidElement=it,zt.lazy=function(se){return{$$typeof:Zt,_payload:{_status:-1,_result:se},_init:Zn}},zt.memo=function(se,Re){return{$$typeof:vt,type:se,compare:Re===void 0?null:Re}},zt.startTransition=function(se){var Re=Ye.transition;Ye.transition={};try{se()}finally{Ye.transition=Re}},zt.unstable_act=et,zt.useCallback=function(se,Re){return Dn.current.useCallback(se,Re)},zt.useContext=function(se){return Dn.current.useContext(se)},zt.useDebugValue=function(){},zt.useDeferredValue=function(se){return Dn.current.useDeferredValue(se)},zt.useEffect=function(se,Re){return Dn.current.useEffect(se,Re)},zt.useId=function(){return Dn.current.useId()},zt.useImperativeHandle=function(se,Re,Et){return Dn.current.useImperativeHandle(se,Re,Et)},zt.useInsertionEffect=function(se,Re){return Dn.current.useInsertionEffect(se,Re)},zt.useLayoutEffect=function(se,Re){return Dn.current.useLayoutEffect(se,Re)},zt.useMemo=function(se,Re){return Dn.current.useMemo(se,Re)},zt.useReducer=function(se,Re,Et){return Dn.current.useReducer(se,Re,Et)},zt.useRef=function(se){return Dn.current.useRef(se)},zt.useState=function(se){return Dn.current.useState(se)},zt.useSyncExternalStore=function(se,Re,Et){return Dn.current.useSyncExternalStore(se,Re,Et)},zt.useTransition=function(){return Dn.current.useTransition()},zt.version="18.3.1",zt}var Ox;function fv(){return Ox||(Ox=1,av.exports=VT()),av.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ix;function WT(){if(Ix)return Qp;Ix=1;var ee=fv(),z=Symbol.for("react.element"),P=Symbol.for("react.fragment"),$=Object.prototype.hasOwnProperty,ve=ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ze={key:!0,ref:!0,__self:!0,__source:!0};function Ze(at,Ke,vt){var Zt,$e={},Rt=null,Tt=null;vt!==void 0&&(Rt=""+vt),Ke.key!==void 0&&(Rt=""+Ke.key),Ke.ref!==void 0&&(Tt=Ke.ref);for(Zt in Ke)$.call(Ke,Zt)&&!ze.hasOwnProperty(Zt)&&($e[Zt]=Ke[Zt]);if(at&&at.defaultProps)for(Zt in Ke=at.defaultProps,Ke)$e[Zt]===void 0&&($e[Zt]=Ke[Zt]);return{$$typeof:z,type:at,key:Rt,ref:Tt,props:$e,_owner:ve.current}}return Qp.Fragment=P,Qp.jsx=Ze,Qp.jsxs=Ze,Qp}var Nx;function XT(){return Nx||(Nx=1,iv.exports=WT()),iv.exports}var nn=XT(),Zr=fv();const qT=lb(Zr);var sg={},sv={exports:{}},ta={},ov={exports:{}},lv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kx;function YT(){return kx||(kx=1,(function(ee){function z(Ye,mt){var et=Ye.length;Ye.push(mt);e:for(;0<et;){var se=et-1>>>1,Re=Ye[se];if(0<ve(Re,mt))Ye[se]=mt,Ye[et]=Re,et=se;else break e}}function P(Ye){return Ye.length===0?null:Ye[0]}function $(Ye){if(Ye.length===0)return null;var mt=Ye[0],et=Ye.pop();if(et!==mt){Ye[0]=et;e:for(var se=0,Re=Ye.length,Et=Re>>>1;se<Et;){var Pt=2*(se+1)-1,Gt=Ye[Pt],Vt=Pt+1,dn=Ye[Vt];if(0>ve(Gt,et))Vt<Re&&0>ve(dn,Gt)?(Ye[se]=dn,Ye[Vt]=et,se=Vt):(Ye[se]=Gt,Ye[Pt]=et,se=Pt);else if(Vt<Re&&0>ve(dn,et))Ye[se]=dn,Ye[Vt]=et,se=Vt;else break e}}return mt}function ve(Ye,mt){var et=Ye.sortIndex-mt.sortIndex;return et!==0?et:Ye.id-mt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var ze=performance;ee.unstable_now=function(){return ze.now()}}else{var Ze=Date,at=Ze.now();ee.unstable_now=function(){return Ze.now()-at}}var Ke=[],vt=[],Zt=1,$e=null,Rt=3,Tt=!1,mn=!1,Ot=!1,Lt=typeof setTimeout=="function"?setTimeout:null,rr=typeof clearTimeout=="function"?clearTimeout:null,_n=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ir(Ye){for(var mt=P(vt);mt!==null;){if(mt.callback===null)$(vt);else if(mt.startTime<=Ye)$(vt),mt.sortIndex=mt.expirationTime,z(Ke,mt);else break;mt=P(vt)}}function F(Ye){if(Ot=!1,ir(Ye),!mn)if(P(Ke)!==null)mn=!0,Zn(he);else{var mt=P(vt);mt!==null&&Dn(F,mt.startTime-Ye)}}function he(Ye,mt){mn=!1,Ot&&(Ot=!1,rr(We),We=-1),Tt=!0;var et=Rt;try{for(ir(mt),$e=P(Ke);$e!==null&&(!($e.expirationTime>mt)||Ye&&!Nt());){var se=$e.callback;if(typeof se=="function"){$e.callback=null,Rt=$e.priorityLevel;var Re=se($e.expirationTime<=mt);mt=ee.unstable_now(),typeof Re=="function"?$e.callback=Re:$e===P(Ke)&&$(Ke),ir(mt)}else $(Ke);$e=P(Ke)}if($e!==null)var Et=!0;else{var Pt=P(vt);Pt!==null&&Dn(F,Pt.startTime-mt),Et=!1}return Et}finally{$e=null,Rt=et,Tt=!1}}var Se=!1,Be=null,We=-1,ct=5,it=-1;function Nt(){return!(ee.unstable_now()-it<ct)}function Un(){if(Be!==null){var Ye=ee.unstable_now();it=Ye;var mt=!0;try{mt=Be(!0,Ye)}finally{mt?jn():(Se=!1,Be=null)}}else Se=!1}var jn;if(typeof _n=="function")jn=function(){_n(Un)};else if(typeof MessageChannel<"u"){var pr=new MessageChannel,Kr=pr.port2;pr.port1.onmessage=Un,jn=function(){Kr.postMessage(null)}}else jn=function(){Lt(Un,0)};function Zn(Ye){Be=Ye,Se||(Se=!0,jn())}function Dn(Ye,mt){We=Lt(function(){Ye(ee.unstable_now())},mt)}ee.unstable_IdlePriority=5,ee.unstable_ImmediatePriority=1,ee.unstable_LowPriority=4,ee.unstable_NormalPriority=3,ee.unstable_Profiling=null,ee.unstable_UserBlockingPriority=2,ee.unstable_cancelCallback=function(Ye){Ye.callback=null},ee.unstable_continueExecution=function(){mn||Tt||(mn=!0,Zn(he))},ee.unstable_forceFrameRate=function(Ye){0>Ye||125<Ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ct=0<Ye?Math.floor(1e3/Ye):5},ee.unstable_getCurrentPriorityLevel=function(){return Rt},ee.unstable_getFirstCallbackNode=function(){return P(Ke)},ee.unstable_next=function(Ye){switch(Rt){case 1:case 2:case 3:var mt=3;break;default:mt=Rt}var et=Rt;Rt=mt;try{return Ye()}finally{Rt=et}},ee.unstable_pauseExecution=function(){},ee.unstable_requestPaint=function(){},ee.unstable_runWithPriority=function(Ye,mt){switch(Ye){case 1:case 2:case 3:case 4:case 5:break;default:Ye=3}var et=Rt;Rt=Ye;try{return mt()}finally{Rt=et}},ee.unstable_scheduleCallback=function(Ye,mt,et){var se=ee.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?se+et:se):et=se,Ye){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=et+Re,Ye={id:Zt++,callback:mt,priorityLevel:Ye,startTime:et,expirationTime:Re,sortIndex:-1},et>se?(Ye.sortIndex=et,z(vt,Ye),P(Ke)===null&&Ye===P(vt)&&(Ot?(rr(We),We=-1):Ot=!0,Dn(F,et-se))):(Ye.sortIndex=Re,z(Ke,Ye),mn||Tt||(mn=!0,Zn(he))),Ye},ee.unstable_shouldYield=Nt,ee.unstable_wrapCallback=function(Ye){var mt=Rt;return function(){var et=Rt;Rt=mt;try{return Ye.apply(this,arguments)}finally{Rt=et}}}})(lv)),lv}var Fx;function QT(){return Fx||(Fx=1,ov.exports=YT()),ov.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux;function ZT(){if(Ux)return ta;Ux=1;var ee=fv(),z=QT();function P(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $=new Set,ve={};function ze(o,c){Ze(o,c),Ze(o+"Capture",c)}function Ze(o,c){for(ve[o]=c,o=0;o<c.length;o++)$.add(c[o])}var at=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ke=Object.prototype.hasOwnProperty,vt=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zt={},$e={};function Rt(o){return Ke.call($e,o)?!0:Ke.call(Zt,o)?!1:vt.test(o)?$e[o]=!0:(Zt[o]=!0,!1)}function Tt(o,c,d,v){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:d!==null?!d.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function mn(o,c,d,v){if(c===null||typeof c>"u"||Tt(o,c,d,v))return!0;if(v)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function Ot(o,c,d,v,S,M,L){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=S,this.mustUseProperty=d,this.propertyName=o,this.type=c,this.sanitizeURL=M,this.removeEmptyString=L}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){Lt[o]=new Ot(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];Lt[c]=new Ot(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){Lt[o]=new Ot(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){Lt[o]=new Ot(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){Lt[o]=new Ot(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){Lt[o]=new Ot(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){Lt[o]=new Ot(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){Lt[o]=new Ot(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){Lt[o]=new Ot(o,5,!1,o.toLowerCase(),null,!1,!1)});var rr=/[\-:]([a-z])/g;function _n(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(rr,_n);Lt[c]=new Ot(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(rr,_n);Lt[c]=new Ot(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(rr,_n);Lt[c]=new Ot(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){Lt[o]=new Ot(o,1,!1,o.toLowerCase(),null,!1,!1)}),Lt.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){Lt[o]=new Ot(o,1,!1,o.toLowerCase(),null,!0,!0)});function ir(o,c,d,v){var S=Lt.hasOwnProperty(c)?Lt[c]:null;(S!==null?S.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(mn(c,d,S,v)&&(d=null),v||S===null?Rt(c)&&(d===null?o.removeAttribute(c):o.setAttribute(c,""+d)):S.mustUseProperty?o[S.propertyName]=d===null?S.type===3?!1:"":d:(c=S.attributeName,v=S.attributeNamespace,d===null?o.removeAttribute(c):(S=S.type,d=S===3||S===4&&d===!0?"":""+d,v?o.setAttributeNS(v,c,d):o.setAttribute(c,d))))}var F=ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,he=Symbol.for("react.element"),Se=Symbol.for("react.portal"),Be=Symbol.for("react.fragment"),We=Symbol.for("react.strict_mode"),ct=Symbol.for("react.profiler"),it=Symbol.for("react.provider"),Nt=Symbol.for("react.context"),Un=Symbol.for("react.forward_ref"),jn=Symbol.for("react.suspense"),pr=Symbol.for("react.suspense_list"),Kr=Symbol.for("react.memo"),Zn=Symbol.for("react.lazy"),Dn=Symbol.for("react.offscreen"),Ye=Symbol.iterator;function mt(o){return o===null||typeof o!="object"?null:(o=Ye&&o[Ye]||o["@@iterator"],typeof o=="function"?o:null)}var et=Object.assign,se;function Re(o){if(se===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);se=c&&c[1]||""}return`
`+se+o}var Et=!1;function Pt(o,c){if(!o||Et)return"";Et=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(fe){var v=fe}Reflect.construct(o,[],c)}else{try{c.call()}catch(fe){v=fe}o.call(c.prototype)}else{try{throw Error()}catch(fe){v=fe}o()}}catch(fe){if(fe&&v&&typeof fe.stack=="string"){for(var S=fe.stack.split(`
`),M=v.stack.split(`
`),L=S.length-1,V=M.length-1;1<=L&&0<=V&&S[L]!==M[V];)V--;for(;1<=L&&0<=V;L--,V--)if(S[L]!==M[V]){if(L!==1||V!==1)do if(L--,V--,0>V||S[L]!==M[V]){var Q=`
`+S[L].replace(" at new "," at ");return o.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",o.displayName)),Q}while(1<=L&&0<=V);break}}}finally{Et=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?Re(o):""}function Gt(o){switch(o.tag){case 5:return Re(o.type);case 16:return Re("Lazy");case 13:return Re("Suspense");case 19:return Re("SuspenseList");case 0:case 2:case 15:return o=Pt(o.type,!1),o;case 11:return o=Pt(o.type.render,!1),o;case 1:return o=Pt(o.type,!0),o;default:return""}}function Vt(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case Be:return"Fragment";case Se:return"Portal";case ct:return"Profiler";case We:return"StrictMode";case jn:return"Suspense";case pr:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case Nt:return(o.displayName||"Context")+".Consumer";case it:return(o._context.displayName||"Context")+".Provider";case Un:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Kr:return c=o.displayName||null,c!==null?c:Vt(o.type)||"Memo";case Zn:c=o._payload,o=o._init;try{return Vt(o(c))}catch{}}return null}function dn(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vt(c);case 8:return c===We?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function rn(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function wn(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Jr(o){var c=wn(o)?"checked":"value",d=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),v=""+o[c];if(!o.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var S=d.get,M=d.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return S.call(this)},set:function(L){v=""+L,M.call(this,L)}}),Object.defineProperty(o,c,{enumerable:d.enumerable}),{getValue:function(){return v},setValue:function(L){v=""+L},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function sc(o){o._valueTracker||(o._valueTracker=Jr(o))}function Au(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var d=c.getValue(),v="";return o&&(v=wn(o)?o.checked?"true":"false":o.value),o=v,o!==d?(c.setValue(o),!0):!1}function zo(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Bo(o,c){var d=c.checked;return et({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??o._wrapperState.initialChecked})}function Ho(o,c){var d=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;d=rn(c.value!=null?c.value:d),o._wrapperState={initialChecked:v,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function jo(o,c){c=c.checked,c!=null&&ir(o,"checked",c,!1)}function oc(o,c){jo(o,c);var d=rn(c.value),v=c.type;if(d!=null)v==="number"?(d===0&&o.value===""||o.value!=d)&&(o.value=""+d):o.value!==""+d&&(o.value=""+d);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?Go(o,c.type,d):c.hasOwnProperty("defaultValue")&&Go(o,c.type,rn(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function id(o,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,d||c===o.value||(o.value=c),o.defaultValue=c}d=o.name,d!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,d!==""&&(o.name=d)}function Go(o,c,d){(c!=="number"||zo(o.ownerDocument)!==o)&&(d==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+d&&(o.defaultValue=""+d))}var Ga=Array.isArray;function Vs(o,c,d,v){if(o=o.options,c){c={};for(var S=0;S<d.length;S++)c["$"+d[S]]=!0;for(d=0;d<o.length;d++)S=c.hasOwnProperty("$"+o[d].value),o[d].selected!==S&&(o[d].selected=S),S&&v&&(o[d].defaultSelected=!0)}else{for(d=""+rn(d),c=null,S=0;S<o.length;S++){if(o[S].value===d){o[S].selected=!0,v&&(o[S].defaultSelected=!0);return}c!==null||o[S].disabled||(c=o[S])}c!==null&&(c.selected=!0)}}function Ru(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(P(91));return et({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function ra(o,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(P(92));if(Ga(d)){if(1<d.length)throw Error(P(93));d=d[0]}c=d}c==null&&(c=""),d=c}o._wrapperState={initialValue:rn(d)}}function ad(o,c){var d=rn(c.value),v=rn(c.defaultValue);d!=null&&(d=""+d,d!==o.value&&(o.value=d),c.defaultValue==null&&o.defaultValue!==d&&(o.defaultValue=d)),v!=null&&(o.defaultValue=""+v)}function sd(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function od(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lc(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?od(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var cc,uc=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,v,S){MSApp.execUnsafeLocalFunction(function(){return o(c,d,v,S)})}:o})(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(cc=cc||document.createElement("div"),cc.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=cc.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function Ci(o,c){if(c){var d=o.firstChild;if(d&&d===o.lastChild&&d.nodeType===3){d.nodeValue=c;return}}o.textContent=c}var Di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ys=["Webkit","ms","Moz","O"];Object.keys(Di).forEach(function(o){ys.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),Di[c]=Di[o]})});function Vo(o,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Di.hasOwnProperty(o)&&Di[o]?(""+c).trim():c+"px"}function Ws(o,c){o=o.style;for(var d in c)if(c.hasOwnProperty(d)){var v=d.indexOf("--")===0,S=Vo(d,c[d],v);d==="float"&&(d="cssFloat"),v?o.setProperty(d,S):o[d]=S}}var $r=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gn(o,c){if(c){if($r[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(P(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(P(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(P(61))}if(c.style!=null&&typeof c.style!="object")throw Error(P(62))}}function xs(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wt=null;function Xs(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var ld=null,ia=null,Wo=null;function _t(o){if(o=mr(o)){if(typeof ld!="function")throw Error(P(280));var c=o.stateNode;c&&(c=ho(c),ld(o.stateNode,o.type,c))}}function hc(o){ia?Wo?Wo.push(o):Wo=[o]:ia=o}function nf(){if(ia){var o=ia,c=Wo;if(Wo=ia=null,_t(o),c)for(o=0;o<c.length;o++)_t(c[o])}}function Oi(o,c){return o(c)}function rf(){}var Vn=!1;function cd(o,c,d){if(Vn)return o(c,d);Vn=!0;try{return Oi(o,c,d)}finally{Vn=!1,(ia!==null||Wo!==null)&&(rf(),nf())}}function Xo(o,c){var d=o.stateNode;if(d===null)return null;var v=ho(d);if(v===null)return null;d=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(d&&typeof d!="function")throw Error(P(231,c,typeof d));return d}var qo=!1;if(at)try{var Yo={};Object.defineProperty(Yo,"passive",{get:function(){qo=!0}}),window.addEventListener("test",Yo,Yo),window.removeEventListener("test",Yo,Yo)}catch{qo=!1}function Va(o,c,d,v,S,M,L,V,Q){var fe=Array.prototype.slice.call(arguments,3);try{c.apply(d,fe)}catch(Le){this.onError(Le)}}var xr=!1,br=null,dc=!1,Lu=null,Wa={onError:function(o){xr=!0,br=o}};function af(o,c,d,v,S,M,L,V,Q){xr=!1,br=null,Va.apply(Wa,arguments)}function Hr(o,c,d,v,S,M,L,V,Q){if(af.apply(this,arguments),xr){if(xr){var fe=br;xr=!1,br=null}else throw Error(P(198));dc||(dc=!0,Lu=fe)}}function bs(o){var c=o,d=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(d=c.return),o=c.return;while(o)}return c.tag===3?d:null}function ud(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function xa(o){if(bs(o)!==o)throw Error(P(188))}function Ss(o){var c=o.alternate;if(!c){if(c=bs(o),c===null)throw Error(P(188));return c!==o?null:o}for(var d=o,v=c;;){var S=d.return;if(S===null)break;var M=S.alternate;if(M===null){if(v=S.return,v!==null){d=v;continue}break}if(S.child===M.child){for(M=S.child;M;){if(M===d)return xa(S),o;if(M===v)return xa(S),c;M=M.sibling}throw Error(P(188))}if(d.return!==v.return)d=S,v=M;else{for(var L=!1,V=S.child;V;){if(V===d){L=!0,d=S,v=M;break}if(V===v){L=!0,v=S,d=M;break}V=V.sibling}if(!L){for(V=M.child;V;){if(V===d){L=!0,d=M,v=S;break}if(V===v){L=!0,v=M,d=S;break}V=V.sibling}if(!L)throw Error(P(189))}}if(d.alternate!==v)throw Error(P(190))}if(d.tag!==3)throw Error(P(188));return d.stateNode.current===d?o:c}function Pu(o){return o=Ss(o),o!==null?hd(o):null}function hd(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=hd(o);if(c!==null)return c;o=o.sibling}return null}var dd=z.unstable_scheduleCallback,pd=z.unstable_cancelCallback,sf=z.unstable_shouldYield,Cu=z.unstable_requestPaint,Ln=z.unstable_now,Du=z.unstable_getCurrentPriorityLevel,Qo=z.unstable_ImmediatePriority,Ou=z.unstable_UserBlockingPriority,Zo=z.unstable_NormalPriority,fd=z.unstable_LowPriority,Iu=z.unstable_IdlePriority,pc=null,Ii=null;function md(o){if(Ii&&typeof Ii.onCommitFiberRoot=="function")try{Ii.onCommitFiberRoot(pc,o,void 0,(o.current.flags&128)===128)}catch{}}var pi=Math.clz32?Math.clz32:yd,gd=Math.log,vd=Math.LN2;function yd(o){return o>>>=0,o===0?32:31-(gd(o)/vd|0)|0}var Ko=64,Jo=4194304;function qs(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function $o(o,c){var d=o.pendingLanes;if(d===0)return 0;var v=0,S=o.suspendedLanes,M=o.pingedLanes,L=d&268435455;if(L!==0){var V=L&~S;V!==0?v=qs(V):(M&=L,M!==0&&(v=qs(M)))}else L=d&~S,L!==0?v=qs(L):M!==0&&(v=qs(M));if(v===0)return 0;if(c!==0&&c!==v&&(c&S)===0&&(S=v&-v,M=c&-c,S>=M||S===16&&(M&4194240)!==0))return c;if((v&4)!==0&&(v|=d&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=v;0<c;)d=31-pi(c),S=1<<d,v|=o[d],c&=~S;return v}function xd(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bd(o,c){for(var d=o.suspendedLanes,v=o.pingedLanes,S=o.expirationTimes,M=o.pendingLanes;0<M;){var L=31-pi(M),V=1<<L,Q=S[L];Q===-1?((V&d)===0||(V&v)!==0)&&(S[L]=xd(V,c)):Q<=c&&(o.expiredLanes|=V),M&=~V}}function fc(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Nu(){var o=Ko;return Ko<<=1,(Ko&4194240)===0&&(Ko=64),o}function mc(o){for(var c=[],d=0;31>d;d++)c.push(o);return c}function Ys(o,c,d){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-pi(c),o[c]=d}function ku(o,c){var d=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<d;){var S=31-pi(d),M=1<<S;c[S]=0,v[S]=-1,o[S]=-1,d&=~M}}function Fu(o,c){var d=o.entangledLanes|=c;for(o=o.entanglements;d;){var v=31-pi(d),S=1<<v;S&c|o[v]&c&&(o[v]|=c),d&=~S}}var Kt=0;function Uu(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var zu,Bu,Sd,_d,Qs,Xa=!1,Zs=[],ei=null,ti=null,Ni=null,Ks=new Map,Js=new Map,qa=[],wd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gc(o,c){switch(o){case"focusin":case"focusout":ei=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":Ks.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Js.delete(c.pointerId)}}function jr(o,c,d,v,S,M){return o===null||o.nativeEvent!==M?(o={blockedOn:c,domEventName:d,eventSystemFlags:v,nativeEvent:M,targetContainers:[S]},c!==null&&(c=mr(c),c!==null&&Bu(c)),o):(o.eventSystemFlags|=v,c=o.targetContainers,S!==null&&c.indexOf(S)===-1&&c.push(S),o)}function Ct(o,c,d,v,S){switch(c){case"focusin":return ei=jr(ei,o,c,d,v,S),!0;case"dragenter":return ti=jr(ti,o,c,d,v,S),!0;case"mouseover":return Ni=jr(Ni,o,c,d,v,S),!0;case"pointerover":var M=S.pointerId;return Ks.set(M,jr(Ks.get(M)||null,o,c,d,v,S)),!0;case"gotpointercapture":return M=S.pointerId,Js.set(M,jr(Js.get(M)||null,o,c,d,v,S)),!0}return!1}function ki(o){var c=Bn(o.target);if(c!==null){var d=bs(c);if(d!==null){if(c=d.tag,c===13){if(c=ud(d),c!==null){o.blockedOn=c,Qs(o.priority,function(){Sd(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){o.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}o.blockedOn=null}function $s(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var d=Td(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(d===null){d=o.nativeEvent;var v=new d.constructor(d.type,d);Wt=v,d.target.dispatchEvent(v),Wt=null}else return c=mr(d),c!==null&&Bu(c),o.blockedOn=d,!1;c.shift()}return!0}function Ya(o,c,d){$s(o)&&d.delete(c)}function of(){Xa=!1,ei!==null&&$s(ei)&&(ei=null),ti!==null&&$s(ti)&&(ti=null),Ni!==null&&$s(Ni)&&(Ni=null),Ks.forEach(Ya),Js.forEach(Ya)}function el(o,c){o.blockedOn===c&&(o.blockedOn=null,Xa||(Xa=!0,z.unstable_scheduleCallback(z.unstable_NormalPriority,of)))}function Sr(o){function c(S){return el(S,o)}if(0<Zs.length){el(Zs[0],o);for(var d=1;d<Zs.length;d++){var v=Zs[d];v.blockedOn===o&&(v.blockedOn=null)}}for(ei!==null&&el(ei,o),ti!==null&&el(ti,o),Ni!==null&&el(Ni,o),Ks.forEach(c),Js.forEach(c),d=0;d<qa.length;d++)v=qa[d],v.blockedOn===o&&(v.blockedOn=null);for(;0<qa.length&&(d=qa[0],d.blockedOn===null);)ki(d),d.blockedOn===null&&qa.shift()}var aa=F.ReactCurrentBatchConfig,tl=!0;function vg(o,c,d,v){var S=Kt,M=aa.transition;aa.transition=null;try{Kt=1,Md(o,c,d,v)}finally{Kt=S,aa.transition=M}}function Hu(o,c,d,v){var S=Kt,M=aa.transition;aa.transition=null;try{Kt=4,Md(o,c,d,v)}finally{Kt=S,aa.transition=M}}function Md(o,c,d,v){if(tl){var S=Td(o,c,d,v);if(S===null)ll(o,c,v,ju,d),gc(o,v);else if(Ct(S,o,c,d,v))v.stopPropagation();else if(gc(o,v),c&4&&-1<wd.indexOf(o)){for(;S!==null;){var M=mr(S);if(M!==null&&zu(M),M=Td(o,c,d,v),M===null&&ll(o,c,v,ju,d),M===S)break;S=M}S!==null&&v.stopPropagation()}else ll(o,c,v,null,d)}}var ju=null;function Td(o,c,d,v){if(ju=null,o=Xs(v),o=Bn(o),o!==null)if(c=bs(o),c===null)o=null;else if(d=c.tag,d===13){if(o=ud(c),o!==null)return o;o=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return ju=o,null}function lf(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Du()){case Qo:return 1;case Ou:return 4;case Zo:case fd:return 16;case Iu:return 536870912;default:return 16}default:return 16}}var _s=null,Ed=null,Gu=null;function cf(){if(Gu)return Gu;var o,c=Ed,d=c.length,v,S="value"in _s?_s.value:_s.textContent,M=S.length;for(o=0;o<d&&c[o]===S[o];o++);var L=d-o;for(v=1;v<=L&&c[d-v]===S[M-v];v++);return Gu=S.slice(o,1<v?1-v:void 0)}function Vu(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Wu(){return!0}function uf(){return!1}function fi(o){function c(d,v,S,M,L){this._reactName=d,this._targetInst=S,this.type=v,this.nativeEvent=M,this.target=L,this.currentTarget=null;for(var V in o)o.hasOwnProperty(V)&&(d=o[V],this[V]=d?d(M):M[V]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Wu:uf,this.isPropagationStopped=uf,this}return et(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Wu)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Wu)},persist:function(){},isPersistent:Wu}),c}var nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xu=fi(nl),Qa=et({},nl,{view:0,detail:0}),hf=fi(Qa),Ad,Rd,vc,qu=et({},Qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bc,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==vc&&(vc&&o.type==="mousemove"?(Ad=o.screenX-vc.screenX,Rd=o.screenY-vc.screenY):Rd=Ad=0,vc=o),Ad)},movementY:function(o){return"movementY"in o?o.movementY:Rd}}),df=fi(qu),yg=et({},qu,{dataTransfer:0}),xg=fi(yg),bg=et({},Qa,{relatedTarget:0}),yc=fi(bg),Yu=et({},nl,{animationName:0,elapsedTime:0,pseudoElement:0}),Fi=fi(Yu),Er=et({},nl,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),pf=fi(Er),eo=et({},nl,{data:0}),rl=fi(eo),mi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ld={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xc(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=Ld[o])?!!c[o]:!1}function bc(){return xc}var ff=et({},Qa,{key:function(o){if(o.key){var c=mi[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=Vu(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?zn[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bc,charCode:function(o){return o.type==="keypress"?Vu(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Vu(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),mf=fi(ff),Za=et({},qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ln=fi(Za),Kn=et({},Qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bc}),ce=fi(Kn),Jn=et({},nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pd=fi(Jn),gf=et({},qu,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Sg=fi(gf),il=[9,13,27,32],to=at&&"CompositionEvent"in window,Jt=null;at&&"documentMode"in document&&(Jt=document.documentMode);var D=at&&"TextEvent"in window&&!Jt,Qu=at&&(!to||Jt&&8<Jt&&11>=Jt),Cd=" ",no=!1;function Zu(o,c){switch(o){case"keyup":return il.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vf(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var al=!1;function ws(o,c){switch(o){case"compositionend":return vf(c);case"keypress":return c.which!==32?null:(no=!0,Cd);case"textInput":return o=c.data,o===Cd&&no?null:o;default:return null}}function _g(o,c){if(al)return o==="compositionend"||!to&&Zu(o,c)?(o=cf(),Gu=Ed=_s=null,al=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Qu&&c.locale!=="ko"?null:c.data;default:return null}}var wg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ar(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!wg[o.type]:c==="textarea"}function ro(o,c,d,v){hc(v),c=ah(c,"onChange"),0<c.length&&(d=new Xu("onChange","change",null,d,v),o.push({event:d,listeners:c}))}var io=null,sa=null;function Dd(o){wr(o,0)}function Ku(o){var c=Mn(o);if(Au(c))return o}function pn(o,c){if(o==="change")return c}var ot=!1;if(at){var Xt;if(at){var sl="oninput"in document;if(!sl){var yf=document.createElement("div");yf.setAttribute("oninput","return;"),sl=typeof yf.oninput=="function"}Xt=sl}else Xt=!1;ot=Xt&&(!document.documentMode||9<document.documentMode)}function Ju(){io&&(io.detachEvent("onpropertychange",xf),sa=io=null)}function xf(o){if(o.propertyName==="value"&&Ku(sa)){var c=[];ro(c,sa,o,Xs(o)),cd(Dd,c)}}function bf(o,c,d){o==="focusin"?(Ju(),io=c,sa=d,io.attachEvent("onpropertychange",xf)):o==="focusout"&&Ju()}function ba(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Ku(sa)}function Ka(o,c){if(o==="click")return Ku(c)}function ao(o,c){if(o==="input"||o==="change")return Ku(c)}function Od(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Ar=typeof Object.is=="function"?Object.is:Od;function Sa(o,c){if(Ar(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var d=Object.keys(o),v=Object.keys(c);if(d.length!==v.length)return!1;for(v=0;v<d.length;v++){var S=d[v];if(!Ke.call(c,S)||!Ar(o[S],c[S]))return!1}return!0}function so(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Ja(o,c){var d=so(o);o=0;for(var v;d;){if(d.nodeType===3){if(v=o+d.textContent.length,o<=c&&v>=c)return{node:d,offset:c-o};o=v}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=so(d)}}function $a(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?$a(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Ms(){for(var o=window,c=zo();c instanceof o.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)o=c.contentWindow;else break;c=zo(o.document)}return c}function oo(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function $u(o){var c=Ms(),d=o.focusedElem,v=o.selectionRange;if(c!==d&&d&&d.ownerDocument&&$a(d.ownerDocument.documentElement,d)){if(v!==null&&oo(d)){if(c=v.start,o=v.end,o===void 0&&(o=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(o,d.value.length);else if(o=(c=d.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var S=d.textContent.length,M=Math.min(v.start,S);v=v.end===void 0?M:Math.min(v.end,S),!o.extend&&M>v&&(S=v,v=M,M=S),S=Ja(d,M);var L=Ja(d,v);S&&L&&(o.rangeCount!==1||o.anchorNode!==S.node||o.anchorOffset!==S.offset||o.focusNode!==L.node||o.focusOffset!==L.offset)&&(c=c.createRange(),c.setStart(S.node,S.offset),o.removeAllRanges(),M>v?(o.addRange(c),o.extend(L.node,L.offset)):(c.setEnd(L.node,L.offset),o.addRange(c)))}}for(c=[],o=d;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)o=c[d],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var eh=at&&"documentMode"in document&&11>=document.documentMode,Ui=null,Sc=null,_c=null,lo=!1;function th(o,c,d){var v=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;lo||Ui==null||Ui!==zo(v)||(v=Ui,"selectionStart"in v&&oo(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),_c&&Sa(_c,v)||(_c=v,v=ah(Sc,"onSelect"),0<v.length&&(c=new Xu("onSelect","select",null,c,d),o.push({event:c,listeners:v}),c.target=Ui)))}function zi(o,c){var d={};return d[o.toLowerCase()]=c.toLowerCase(),d["Webkit"+o]="webkit"+c,d["Moz"+o]="moz"+c,d}var ni={animationend:zi("Animation","AnimationEnd"),animationiteration:zi("Animation","AnimationIteration"),animationstart:zi("Animation","AnimationStart"),transitionend:zi("Transition","TransitionEnd")},wc={},Mc={};at&&(Mc=document.createElement("div").style,"AnimationEvent"in window||(delete ni.animationend.animation,delete ni.animationiteration.animation,delete ni.animationstart.animation),"TransitionEvent"in window||delete ni.transitionend.transition);function oa(o){if(wc[o])return wc[o];if(!ni[o])return o;var c=ni[o],d;for(d in c)if(c.hasOwnProperty(d)&&d in Mc)return wc[o]=c[d];return o}var nh=oa("animationend"),Tc=oa("animationiteration"),rh=oa("animationstart"),ol=oa("transitionend"),Ie=new Map,co="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fr(o,c){Ie.set(o,c),ze(c,[o])}for(var Id=0;Id<co.length;Id++){var Nd=co[Id],Ts=Nd.toLowerCase(),ih=Nd[0].toUpperCase()+Nd.slice(1);fr(Ts,"on"+ih)}fr(nh,"onAnimationEnd"),fr(Tc,"onAnimationIteration"),fr(rh,"onAnimationStart"),fr("dblclick","onDoubleClick"),fr("focusin","onFocus"),fr("focusout","onBlur"),fr(ol,"onTransitionEnd"),Ze("onMouseEnter",["mouseout","mouseover"]),Ze("onMouseLeave",["mouseout","mouseover"]),Ze("onPointerEnter",["pointerout","pointerover"]),Ze("onPointerLeave",["pointerout","pointerover"]),ze("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ze("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ze("onBeforeInput",["compositionend","keypress","textInput","paste"]),ze("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ze("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ze("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _r="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sf=new Set("cancel close invalid load scroll toggle".split(" ").concat(_r));function kd(o,c,d){var v=o.type||"unknown-event";o.currentTarget=d,Hr(v,c,void 0,o),o.currentTarget=null}function wr(o,c){c=(c&4)!==0;for(var d=0;d<o.length;d++){var v=o[d],S=v.event;v=v.listeners;e:{var M=void 0;if(c)for(var L=v.length-1;0<=L;L--){var V=v[L],Q=V.instance,fe=V.currentTarget;if(V=V.listener,Q!==M&&S.isPropagationStopped())break e;kd(S,V,fe),M=Q}else for(L=0;L<v.length;L++){if(V=v[L],Q=V.instance,fe=V.currentTarget,V=V.listener,Q!==M&&S.isPropagationStopped())break e;kd(S,V,fe),M=Q}}}if(dc)throw o=Lu,dc=!1,Lu=null,o}function cn(o,c){var d=c[pl];d===void 0&&(d=c[pl]=new Set);var v=o+"__bubble";d.has(v)||(wa(c,o,2,!1),d.add(v))}function Fd(o,c,d){var v=0;c&&(v|=4),wa(d,o,v,c)}var Ec="_reactListening"+Math.random().toString(36).slice(2);function _a(o){if(!o[Ec]){o[Ec]=!0,$.forEach(function(d){d!=="selectionchange"&&(Sf.has(d)||Fd(d,!1,o),Fd(d,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Ec]||(c[Ec]=!0,Fd("selectionchange",!1,c))}}function wa(o,c,d,v){switch(lf(c)){case 1:var S=vg;break;case 4:S=Hu;break;default:S=Md}d=S.bind(null,c,d,o),S=void 0,!qo||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(S=!0),v?S!==void 0?o.addEventListener(c,d,{capture:!0,passive:S}):o.addEventListener(c,d,!0):S!==void 0?o.addEventListener(c,d,{passive:S}):o.addEventListener(c,d,!1)}function ll(o,c,d,v,S){var M=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var L=v.tag;if(L===3||L===4){var V=v.stateNode.containerInfo;if(V===S||V.nodeType===8&&V.parentNode===S)break;if(L===4)for(L=v.return;L!==null;){var Q=L.tag;if((Q===3||Q===4)&&(Q=L.stateNode.containerInfo,Q===S||Q.nodeType===8&&Q.parentNode===S))return;L=L.return}for(;V!==null;){if(L=Bn(V),L===null)return;if(Q=L.tag,Q===5||Q===6){v=M=L;continue e}V=V.parentNode}}v=v.return}cd(function(){var fe=M,Le=Xs(d),Pe=[];e:{var Ee=Ie.get(o);if(Ee!==void 0){var Xe=Xu,Qe=o;switch(o){case"keypress":if(Vu(d)===0)break e;case"keydown":case"keyup":Xe=mf;break;case"focusin":Qe="focus",Xe=yc;break;case"focusout":Qe="blur",Xe=yc;break;case"beforeblur":case"afterblur":Xe=yc;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=df;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=xg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=ce;break;case nh:case Tc:case rh:Xe=Fi;break;case ol:Xe=Pd;break;case"scroll":Xe=hf;break;case"wheel":Xe=Sg;break;case"copy":case"cut":case"paste":Xe=pf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=ln}var tt=(c&4)!==0,xn=!tt&&o==="scroll",ae=tt?Ee!==null?Ee+"Capture":null:Ee;tt=[];for(var Z=fe,ue;Z!==null;){ue=Z;var ke=ue.stateNode;if(ue.tag===5&&ke!==null&&(ue=ke,ae!==null&&(ke=Xo(Z,ae),ke!=null&&tt.push(es(Z,ke,ue)))),xn)break;Z=Z.return}0<tt.length&&(Ee=new Xe(Ee,Qe,null,d,Le),Pe.push({event:Ee,listeners:tt}))}}if((c&7)===0){e:{if(Ee=o==="mouseover"||o==="pointerover",Xe=o==="mouseout"||o==="pointerout",Ee&&d!==Wt&&(Qe=d.relatedTarget||d.fromElement)&&(Bn(Qe)||Qe[sr]))break e;if((Xe||Ee)&&(Ee=Le.window===Le?Le:(Ee=Le.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,Xe?(Qe=d.relatedTarget||d.toElement,Xe=fe,Qe=Qe?Bn(Qe):null,Qe!==null&&(xn=bs(Qe),Qe!==xn||Qe.tag!==5&&Qe.tag!==6)&&(Qe=null)):(Xe=null,Qe=fe),Xe!==Qe)){if(tt=df,ke="onMouseLeave",ae="onMouseEnter",Z="mouse",(o==="pointerout"||o==="pointerover")&&(tt=ln,ke="onPointerLeave",ae="onPointerEnter",Z="pointer"),xn=Xe==null?Ee:Mn(Xe),ue=Qe==null?Ee:Mn(Qe),Ee=new tt(ke,Z+"leave",Xe,d,Le),Ee.target=xn,Ee.relatedTarget=ue,ke=null,Bn(Le)===fe&&(tt=new tt(ae,Z+"enter",Qe,d,Le),tt.target=ue,tt.relatedTarget=xn,ke=tt),xn=ke,Xe&&Qe)t:{for(tt=Xe,ae=Qe,Z=0,ue=tt;ue;ue=cl(ue))Z++;for(ue=0,ke=ae;ke;ke=cl(ke))ue++;for(;0<Z-ue;)tt=cl(tt),Z--;for(;0<ue-Z;)ae=cl(ae),ue--;for(;Z--;){if(tt===ae||ae!==null&&tt===ae.alternate)break t;tt=cl(tt),ae=cl(ae)}tt=null}else tt=null;Xe!==null&&Ud(Pe,Ee,Xe,tt,!1),Qe!==null&&xn!==null&&Ud(Pe,xn,Qe,tt,!0)}}e:{if(Ee=fe?Mn(fe):window,Xe=Ee.nodeName&&Ee.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&Ee.type==="file")var rt=pn;else if(ar(Ee))if(ot)rt=ao;else{rt=ba;var lt=bf}else(Xe=Ee.nodeName)&&Xe.toLowerCase()==="input"&&(Ee.type==="checkbox"||Ee.type==="radio")&&(rt=Ka);if(rt&&(rt=rt(o,fe))){ro(Pe,rt,d,Le);break e}lt&&lt(o,Ee,fe),o==="focusout"&&(lt=Ee._wrapperState)&&lt.controlled&&Ee.type==="number"&&Go(Ee,"number",Ee.value)}switch(lt=fe?Mn(fe):window,o){case"focusin":(ar(lt)||lt.contentEditable==="true")&&(Ui=lt,Sc=fe,_c=null);break;case"focusout":_c=Sc=Ui=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,th(Pe,d,Le);break;case"selectionchange":if(eh)break;case"keydown":case"keyup":th(Pe,d,Le)}var dt;if(to)e:{switch(o){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else al?Zu(o,d)&&(yt="onCompositionEnd"):o==="keydown"&&d.keyCode===229&&(yt="onCompositionStart");yt&&(Qu&&d.locale!=="ko"&&(al||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&al&&(dt=cf()):(_s=Le,Ed="value"in _s?_s.value:_s.textContent,al=!0)),lt=ah(fe,yt),0<lt.length&&(yt=new rl(yt,o,null,d,Le),Pe.push({event:yt,listeners:lt}),dt?yt.data=dt:(dt=vf(d),dt!==null&&(yt.data=dt)))),(dt=D?ws(o,d):_g(o,d))&&(fe=ah(fe,"onBeforeInput"),0<fe.length&&(Le=new rl("onBeforeInput","beforeinput",null,d,Le),Pe.push({event:Le,listeners:fe}),Le.data=dt))}wr(Pe,c)})}function es(o,c,d){return{instance:o,listener:c,currentTarget:d}}function ah(o,c){for(var d=c+"Capture",v=[];o!==null;){var S=o,M=S.stateNode;S.tag===5&&M!==null&&(S=M,M=Xo(o,d),M!=null&&v.unshift(es(o,M,S)),M=Xo(o,c),M!=null&&v.push(es(o,M,S))),o=o.return}return v}function cl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Ud(o,c,d,v,S){for(var M=c._reactName,L=[];d!==null&&d!==v;){var V=d,Q=V.alternate,fe=V.stateNode;if(Q!==null&&Q===v)break;V.tag===5&&fe!==null&&(V=fe,S?(Q=Xo(d,M),Q!=null&&L.unshift(es(d,Q,V))):S||(Q=Xo(d,M),Q!=null&&L.push(es(d,Q,V)))),d=d.return}L.length!==0&&o.push({event:c,listeners:L})}var _f=/\r\n?/g,wf=/\u0000|\uFFFD/g;function Mf(o){return(typeof o=="string"?o:""+o).replace(_f,`
`).replace(wf,"")}function Ac(o,c,d){if(c=Mf(c),Mf(o)!==c&&d)throw Error(P(425))}function St(){}var gi=null,la=null;function Rc(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ca=typeof setTimeout=="function"?setTimeout:void 0,ul=typeof clearTimeout=="function"?clearTimeout:void 0,uo=typeof Promise=="function"?Promise:void 0,Tf=typeof queueMicrotask=="function"?queueMicrotask:typeof uo<"u"?function(o){return uo.resolve(null).then(o).catch(zd)}:ca;function zd(o){setTimeout(function(){throw o})}function Lc(o,c){var d=c,v=0;do{var S=d.nextSibling;if(o.removeChild(d),S&&S.nodeType===8)if(d=S.data,d==="/$"){if(v===0){o.removeChild(S),Sr(c);return}v--}else d!=="$"&&d!=="$?"&&d!=="$!"||v++;d=S}while(d);Sr(c)}function Ma(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function vi(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var d=o.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return o;c--}else d==="/$"&&c++}o=o.previousSibling}return null}var hl=Math.random().toString(36).slice(2),an="__reactFiber$"+hl,dl="__reactProps$"+hl,sr="__reactContainer$"+hl,pl="__reactEvents$"+hl,Bd="__reactListeners$"+hl,Ne="__reactHandles$"+hl;function Bn(o){var c=o[an];if(c)return c;for(var d=o.parentNode;d;){if(c=d[sr]||d[an]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(o=vi(o);o!==null;){if(d=o[an])return d;o=vi(o)}return c}o=d,d=o.parentNode}return null}function mr(o){return o=o[an]||o[sr],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Mn(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(P(33))}function ho(o){return o[dl]||null}var pt=[],fl=-1;function Es(o){return{current:o}}function Tn(o){0>fl||(o.current=pt[fl],pt[fl]=null,fl--)}function gn(o,c){fl++,pt[fl]=o.current,o.current=c}var ua={},Rr=Es(ua),Lr=Es(!1),po=ua;function He(o,c){var d=o.type.contextTypes;if(!d)return ua;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var S={},M;for(M in d)S[M]=c[M];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=S),S}function ri(o){return o=o.childContextTypes,o!=null}function sh(){Tn(Lr),Tn(Rr)}function yi(o,c,d){if(Rr.current!==ua)throw Error(P(168));gn(Rr,c),gn(Lr,d)}function oh(o,c,d){var v=o.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return d;v=v.getChildContext();for(var S in v)if(!(S in c))throw Error(P(108,dn(o)||"Unknown",S));return et({},d,v)}function ts(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ua,po=Rr.current,gn(Rr,o),gn(Lr,Lr.current),!0}function ii(o,c,d){var v=o.stateNode;if(!v)throw Error(P(169));d?(o=oh(o,c,po),v.__reactInternalMemoizedMergedChildContext=o,Tn(Lr),Tn(Rr),gn(Rr,o)):Tn(Lr),gn(Lr,d)}var xi=null,Wn=!1,ut=!1;function Hd(o){xi===null?xi=[o]:xi.push(o)}function Ta(o){Wn=!0,Hd(o)}function ha(){if(!ut&&xi!==null){ut=!0;var o=0,c=Kt;try{var d=xi;for(Kt=1;o<d.length;o++){var v=d[o];do v=v(!0);while(v!==null)}xi=null,Wn=!1}catch(S){throw xi!==null&&(xi=xi.slice(o+1)),dd(Qo,ha),S}finally{Kt=c,ut=!1}}return null}var fo=[],Ea=0,As=null,Rs=0,ai=[],Gr=0,Aa=null,Bi=1,Hi="";function ns(o,c){fo[Ea++]=Rs,fo[Ea++]=As,As=o,Rs=c}function Pc(o,c,d){ai[Gr++]=Bi,ai[Gr++]=Hi,ai[Gr++]=Aa,Aa=o;var v=Bi;o=Hi;var S=32-pi(v)-1;v&=~(1<<S),d+=1;var M=32-pi(c)+S;if(30<M){var L=S-S%5;M=(v&(1<<L)-1).toString(32),v>>=L,S-=L,Bi=1<<32-pi(c)+S|d<<S|v,Hi=M+o}else Bi=1<<M|d<<S|v,Hi=o}function ht(o){o.return!==null&&(ns(o,1),Pc(o,1,0))}function ml(o){for(;o===As;)As=fo[--Ea],fo[Ea]=null,Rs=fo[--Ea],fo[Ea]=null;for(;o===Aa;)Aa=ai[--Gr],ai[Gr]=null,Hi=ai[--Gr],ai[Gr]=null,Bi=ai[--Gr],ai[Gr]=null}var Xn=null,gr=null,Dt=!1,ji=null;function lh(o,c){var d=kr(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=o,c=o.deletions,c===null?(o.deletions=[d],o.flags|=16):c.push(d)}function Bt(o,c){switch(o.tag){case 5:var d=o.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,Xn=o,gr=Ma(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,Xn=o,gr=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Aa!==null?{id:Bi,overflow:Hi}:null,o.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=kr(18,null,null,0),d.stateNode=c,d.return=o,o.child=d,Xn=o,gr=null,!0):!1;default:return!1}}function Ls(o){return(o.mode&1)!==0&&(o.flags&128)===0}function vn(o){if(Dt){var c=gr;if(c){var d=c;if(!Bt(o,c)){if(Ls(o))throw Error(P(418));c=Ma(d.nextSibling);var v=Xn;c&&Bt(o,c)?lh(v,d):(o.flags=o.flags&-4097|2,Dt=!1,Xn=o)}}else{if(Ls(o))throw Error(P(418));o.flags=o.flags&-4097|2,Dt=!1,Xn=o}}}function mo(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Xn=o}function Cc(o){if(o!==Xn)return!1;if(!Dt)return mo(o),Dt=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!Rc(o.type,o.memoizedProps)),c&&(c=gr)){if(Ls(o))throw gl(),Error(P(418));for(;c;)lh(o,c),c=Ma(c.nextSibling)}if(mo(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(P(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var d=o.data;if(d==="/$"){if(c===0){gr=Ma(o.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}o=o.nextSibling}gr=null}}else gr=Xn?Ma(o.stateNode.nextSibling):null;return!0}function gl(){for(var o=gr;o;)o=Ma(o.nextSibling)}function go(){gr=Xn=null,Dt=!1}function Dc(o){ji===null?ji=[o]:ji.push(o)}var Mg=F.ReactCurrentBatchConfig;function Oc(o,c,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(P(309));var v=d.stateNode}if(!v)throw Error(P(147,o));var S=v,M=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===M?c.ref:(c=function(L){var V=S.refs;L===null?delete V[M]:V[M]=L},c._stringRef=M,c)}if(typeof o!="string")throw Error(P(284));if(!d._owner)throw Error(P(290,o))}return o}function Gi(o,c){throw o=Object.prototype.toString.call(c),Error(P(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function vo(o){var c=o._init;return c(o._payload)}function Ic(o){function c(ae,Z){if(o){var ue=ae.deletions;ue===null?(ae.deletions=[Z],ae.flags|=16):ue.push(Z)}}function d(ae,Z){if(!o)return null;for(;Z!==null;)c(ae,Z),Z=Z.sibling;return null}function v(ae,Z){for(ae=new Map;Z!==null;)Z.key!==null?ae.set(Z.key,Z):ae.set(Z.index,Z),Z=Z.sibling;return ae}function S(ae,Z){return ae=Ai(ae,Z),ae.index=0,ae.sibling=null,ae}function M(ae,Z,ue){return ae.index=ue,o?(ue=ae.alternate,ue!==null?(ue=ue.index,ue<Z?(ae.flags|=2,Z):ue):(ae.flags|=2,Z)):(ae.flags|=1048576,Z)}function L(ae){return o&&ae.alternate===null&&(ae.flags|=2),ae}function V(ae,Z,ue,ke){return Z===null||Z.tag!==6?(Z=ks(ue,ae.mode,ke),Z.return=ae,Z):(Z=S(Z,ue),Z.return=ae,Z)}function Q(ae,Z,ue,ke){var rt=ue.type;return rt===Be?Le(ae,Z,ue.props.children,ke,ue.key):Z!==null&&(Z.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===Zn&&vo(rt)===Z.type)?(ke=S(Z,ue.props),ke.ref=Oc(ae,Z,ue),ke.return=ae,ke):(ke=ma(ue.type,ue.key,ue.props,null,ae.mode,ke),ke.ref=Oc(ae,Z,ue),ke.return=ae,ke)}function fe(ae,Z,ue,ke){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==ue.containerInfo||Z.stateNode.implementation!==ue.implementation?(Z=Vl(ue,ae.mode,ke),Z.return=ae,Z):(Z=S(Z,ue.children||[]),Z.return=ae,Z)}function Le(ae,Z,ue,ke,rt){return Z===null||Z.tag!==7?(Z=Yi(ue,ae.mode,ke,rt),Z.return=ae,Z):(Z=S(Z,ue),Z.return=ae,Z)}function Pe(ae,Z,ue){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=ks(""+Z,ae.mode,ue),Z.return=ae,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case he:return ue=ma(Z.type,Z.key,Z.props,null,ae.mode,ue),ue.ref=Oc(ae,null,Z),ue.return=ae,ue;case Se:return Z=Vl(Z,ae.mode,ue),Z.return=ae,Z;case Zn:var ke=Z._init;return Pe(ae,ke(Z._payload),ue)}if(Ga(Z)||mt(Z))return Z=Yi(Z,ae.mode,ue,null),Z.return=ae,Z;Gi(ae,Z)}return null}function Ee(ae,Z,ue,ke){var rt=Z!==null?Z.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return rt!==null?null:V(ae,Z,""+ue,ke);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case he:return ue.key===rt?Q(ae,Z,ue,ke):null;case Se:return ue.key===rt?fe(ae,Z,ue,ke):null;case Zn:return rt=ue._init,Ee(ae,Z,rt(ue._payload),ke)}if(Ga(ue)||mt(ue))return rt!==null?null:Le(ae,Z,ue,ke,null);Gi(ae,ue)}return null}function Xe(ae,Z,ue,ke,rt){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ae=ae.get(ue)||null,V(Z,ae,""+ke,rt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case he:return ae=ae.get(ke.key===null?ue:ke.key)||null,Q(Z,ae,ke,rt);case Se:return ae=ae.get(ke.key===null?ue:ke.key)||null,fe(Z,ae,ke,rt);case Zn:var lt=ke._init;return Xe(ae,Z,ue,lt(ke._payload),rt)}if(Ga(ke)||mt(ke))return ae=ae.get(ue)||null,Le(Z,ae,ke,rt,null);Gi(Z,ke)}return null}function Qe(ae,Z,ue,ke){for(var rt=null,lt=null,dt=Z,yt=Z=0,ur=null;dt!==null&&yt<ue.length;yt++){dt.index>yt?(ur=dt,dt=null):ur=dt.sibling;var st=Ee(ae,dt,ue[yt],ke);if(st===null){dt===null&&(dt=ur);break}o&&dt&&st.alternate===null&&c(ae,dt),Z=M(st,Z,yt),lt===null?rt=st:lt.sibling=st,lt=st,dt=ur}if(yt===ue.length)return d(ae,dt),Dt&&ns(ae,yt),rt;if(dt===null){for(;yt<ue.length;yt++)dt=Pe(ae,ue[yt],ke),dt!==null&&(Z=M(dt,Z,yt),lt===null?rt=dt:lt.sibling=dt,lt=dt);return Dt&&ns(ae,yt),rt}for(dt=v(ae,dt);yt<ue.length;yt++)ur=Xe(dt,ae,yt,ue[yt],ke),ur!==null&&(o&&ur.alternate!==null&&dt.delete(ur.key===null?yt:ur.key),Z=M(ur,Z,yt),lt===null?rt=ur:lt.sibling=ur,lt=ur);return o&&dt.forEach(function(Fr){return c(ae,Fr)}),Dt&&ns(ae,yt),rt}function tt(ae,Z,ue,ke){var rt=mt(ue);if(typeof rt!="function")throw Error(P(150));if(ue=rt.call(ue),ue==null)throw Error(P(151));for(var lt=rt=null,dt=Z,yt=Z=0,ur=null,st=ue.next();dt!==null&&!st.done;yt++,st=ue.next()){dt.index>yt?(ur=dt,dt=null):ur=dt.sibling;var Fr=Ee(ae,dt,st.value,ke);if(Fr===null){dt===null&&(dt=ur);break}o&&dt&&Fr.alternate===null&&c(ae,dt),Z=M(Fr,Z,yt),lt===null?rt=Fr:lt.sibling=Fr,lt=Fr,dt=ur}if(st.done)return d(ae,dt),Dt&&ns(ae,yt),rt;if(dt===null){for(;!st.done;yt++,st=ue.next())st=Pe(ae,st.value,ke),st!==null&&(Z=M(st,Z,yt),lt===null?rt=st:lt.sibling=st,lt=st);return Dt&&ns(ae,yt),rt}for(dt=v(ae,dt);!st.done;yt++,st=ue.next())st=Xe(dt,ae,yt,st.value,ke),st!==null&&(o&&st.alternate!==null&&dt.delete(st.key===null?yt:st.key),Z=M(st,Z,yt),lt===null?rt=st:lt.sibling=st,lt=st);return o&&dt.forEach(function(Zc){return c(ae,Zc)}),Dt&&ns(ae,yt),rt}function xn(ae,Z,ue,ke){if(typeof ue=="object"&&ue!==null&&ue.type===Be&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case he:e:{for(var rt=ue.key,lt=Z;lt!==null;){if(lt.key===rt){if(rt=ue.type,rt===Be){if(lt.tag===7){d(ae,lt.sibling),Z=S(lt,ue.props.children),Z.return=ae,ae=Z;break e}}else if(lt.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===Zn&&vo(rt)===lt.type){d(ae,lt.sibling),Z=S(lt,ue.props),Z.ref=Oc(ae,lt,ue),Z.return=ae,ae=Z;break e}d(ae,lt);break}else c(ae,lt);lt=lt.sibling}ue.type===Be?(Z=Yi(ue.props.children,ae.mode,ke,ue.key),Z.return=ae,ae=Z):(ke=ma(ue.type,ue.key,ue.props,null,ae.mode,ke),ke.ref=Oc(ae,Z,ue),ke.return=ae,ae=ke)}return L(ae);case Se:e:{for(lt=ue.key;Z!==null;){if(Z.key===lt)if(Z.tag===4&&Z.stateNode.containerInfo===ue.containerInfo&&Z.stateNode.implementation===ue.implementation){d(ae,Z.sibling),Z=S(Z,ue.children||[]),Z.return=ae,ae=Z;break e}else{d(ae,Z);break}else c(ae,Z);Z=Z.sibling}Z=Vl(ue,ae.mode,ke),Z.return=ae,ae=Z}return L(ae);case Zn:return lt=ue._init,xn(ae,Z,lt(ue._payload),ke)}if(Ga(ue))return Qe(ae,Z,ue,ke);if(mt(ue))return tt(ae,Z,ue,ke);Gi(ae,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,Z!==null&&Z.tag===6?(d(ae,Z.sibling),Z=S(Z,ue),Z.return=ae,ae=Z):(d(ae,Z),Z=ks(ue,ae.mode,ke),Z.return=ae,ae=Z),L(ae)):d(ae,Z)}return xn}var Ra=Ic(!0),jd=Ic(!1),ch=Es(null),Vi=null,bt=null,je=null;function bi(){je=bt=Vi=null}function vl(o){var c=ch.current;Tn(ch),o._currentValue=c}function Gd(o,c,d){for(;o!==null;){var v=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),o===d)break;o=o.return}}function yl(o,c){Vi=o,je=bt=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&c)!==0&&(si=!0),o.firstContext=null)}function Wi(o){var c=o._currentValue;if(je!==o)if(o={context:o,memoizedValue:c,next:null},bt===null){if(Vi===null)throw Error(P(308));bt=o,Vi.dependencies={lanes:0,firstContext:o}}else bt=bt.next=o;return c}var yo=null;function Vd(o){yo===null?yo=[o]:yo.push(o)}function Ef(o,c,d,v){var S=c.interleaved;return S===null?(d.next=d,Vd(c)):(d.next=S.next,S.next=d),c.interleaved=d,Pr(o,v)}function Pr(o,c){o.lanes|=c;var d=o.alternate;for(d!==null&&(d.lanes|=c),d=o,o=o.return;o!==null;)o.childLanes|=c,d=o.alternate,d!==null&&(d.childLanes|=c),d=o,o=o.return;return d.tag===3?d.stateNode:null}var rs=!1;function xo(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uh(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function La(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Pa(o,c,d){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(qt&2)!==0){var S=v.pending;return S===null?c.next=c:(c.next=S.next,S.next=c),v.pending=c,Pr(o,d)}return S=v.interleaved,S===null?(c.next=c,Vd(v)):(c.next=S.next,S.next=c),v.interleaved=c,Pr(o,d)}function Ca(o,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var v=c.lanes;v&=o.pendingLanes,d|=v,c.lanes=d,Fu(o,d)}}function bo(o,c){var d=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,d===v)){var S=null,M=null;if(d=d.firstBaseUpdate,d!==null){do{var L={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};M===null?S=M=L:M=M.next=L,d=d.next}while(d!==null);M===null?S=M=c:M=M.next=c}else S=M=c;d={baseState:v.baseState,firstBaseUpdate:S,lastBaseUpdate:M,shared:v.shared,effects:v.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=c}function Nc(o,c,d,v){var S=o.updateQueue;rs=!1;var M=S.firstBaseUpdate,L=S.lastBaseUpdate,V=S.shared.pending;if(V!==null){S.shared.pending=null;var Q=V,fe=Q.next;Q.next=null,L===null?M=fe:L.next=fe,L=Q;var Le=o.alternate;Le!==null&&(Le=Le.updateQueue,V=Le.lastBaseUpdate,V!==L&&(V===null?Le.firstBaseUpdate=fe:V.next=fe,Le.lastBaseUpdate=Q))}if(M!==null){var Pe=S.baseState;L=0,Le=fe=Q=null,V=M;do{var Ee=V.lane,Xe=V.eventTime;if((v&Ee)===Ee){Le!==null&&(Le=Le.next={eventTime:Xe,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var Qe=o,tt=V;switch(Ee=c,Xe=d,tt.tag){case 1:if(Qe=tt.payload,typeof Qe=="function"){Pe=Qe.call(Xe,Pe,Ee);break e}Pe=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=tt.payload,Ee=typeof Qe=="function"?Qe.call(Xe,Pe,Ee):Qe,Ee==null)break e;Pe=et({},Pe,Ee);break e;case 2:rs=!0}}V.callback!==null&&V.lane!==0&&(o.flags|=64,Ee=S.effects,Ee===null?S.effects=[V]:Ee.push(V))}else Xe={eventTime:Xe,lane:Ee,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Le===null?(fe=Le=Xe,Q=Pe):Le=Le.next=Xe,L|=Ee;if(V=V.next,V===null){if(V=S.shared.pending,V===null)break;Ee=V,V=Ee.next,Ee.next=null,S.lastBaseUpdate=Ee,S.shared.pending=null}}while(!0);if(Le===null&&(Q=Pe),S.baseState=Q,S.firstBaseUpdate=fe,S.lastBaseUpdate=Le,c=S.shared.interleaved,c!==null){S=c;do L|=S.lane,S=S.next;while(S!==c)}else M===null&&(S.shared.lanes=0);Mo|=L,o.lanes=L,o.memoizedState=Pe}}function hh(o,c,d){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var v=o[c],S=v.callback;if(S!==null){if(v.callback=null,v=d,typeof S!="function")throw Error(P(191,S));S.call(v)}}}var xl={},Si=Es(xl),bl=Es(xl),Sl=Es(xl);function is(o){if(o===xl)throw Error(P(174));return o}function Wd(o,c){switch(gn(Sl,c),gn(bl,o),gn(Si,xl),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:lc(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=lc(c,o)}Tn(Si),gn(Si,c)}function _l(){Tn(Si),Tn(bl),Tn(Sl)}function Af(o){is(Sl.current);var c=is(Si.current),d=lc(c,o.type);c!==d&&(gn(bl,o),gn(Si,d))}function Xd(o){bl.current===o&&(Tn(Si),Tn(bl))}var On=Es(0);function dh(o){for(var c=o;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var qd=[];function Yd(){for(var o=0;o<qd.length;o++)qd[o]._workInProgressVersionPrimary=null;qd.length=0}var ph=F.ReactCurrentDispatcher,fh=F.ReactCurrentBatchConfig,Ps=0,Pn=null,$n=null,or=null,kc=!1,wl=!1,Ml=0,Rf=0;function qn(){throw Error(P(321))}function Yn(o,c){if(c===null)return!1;for(var d=0;d<c.length&&d<o.length;d++)if(!Ar(o[d],c[d]))return!1;return!0}function Qn(o,c,d,v,S,M){if(Ps=M,Pn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ph.current=o===null||o.memoizedState===null?Rg:Lg,o=d(v,S),wl){M=0;do{if(wl=!1,Ml=0,25<=M)throw Error(P(301));M+=1,or=$n=null,c.updateQueue=null,ph.current=Pg,o=d(v,S)}while(wl)}if(ph.current=vh,c=$n!==null&&$n.next!==null,Ps=0,or=$n=Pn=null,kc=!1,c)throw Error(P(300));return o}function Tl(){var o=Ml!==0;return Ml=0,o}function Da(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?Pn.memoizedState=or=o:or=or.next=o,or}function Xi(){if($n===null){var o=Pn.alternate;o=o!==null?o.memoizedState:null}else o=$n.next;var c=or===null?Pn.memoizedState:or.next;if(c!==null)or=c,$n=o;else{if(o===null)throw Error(P(310));$n=o,o={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},or===null?Pn.memoizedState=or=o:or=or.next=o}return or}function Fc(o,c){return typeof c=="function"?c(o):c}function Qd(o){var c=Xi(),d=c.queue;if(d===null)throw Error(P(311));d.lastRenderedReducer=o;var v=$n,S=v.baseQueue,M=d.pending;if(M!==null){if(S!==null){var L=S.next;S.next=M.next,M.next=L}v.baseQueue=S=M,d.pending=null}if(S!==null){M=S.next,v=v.baseState;var V=L=null,Q=null,fe=M;do{var Le=fe.lane;if((Ps&Le)===Le)Q!==null&&(Q=Q.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),v=fe.hasEagerState?fe.eagerState:o(v,fe.action);else{var Pe={lane:Le,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};Q===null?(V=Q=Pe,L=v):Q=Q.next=Pe,Pn.lanes|=Le,Mo|=Le}fe=fe.next}while(fe!==null&&fe!==M);Q===null?L=v:Q.next=V,Ar(v,c.memoizedState)||(si=!0),c.memoizedState=v,c.baseState=L,c.baseQueue=Q,d.lastRenderedState=v}if(o=d.interleaved,o!==null){S=o;do M=S.lane,Pn.lanes|=M,Mo|=M,S=S.next;while(S!==o)}else S===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function Zd(o){var c=Xi(),d=c.queue;if(d===null)throw Error(P(311));d.lastRenderedReducer=o;var v=d.dispatch,S=d.pending,M=c.memoizedState;if(S!==null){d.pending=null;var L=S=S.next;do M=o(M,L.action),L=L.next;while(L!==S);Ar(M,c.memoizedState)||(si=!0),c.memoizedState=M,c.baseQueue===null&&(c.baseState=M),d.lastRenderedState=M}return[M,v]}function Lf(){}function Pf(o,c){var d=Pn,v=Xi(),S=c(),M=!Ar(v.memoizedState,S);if(M&&(v.memoizedState=S,si=!0),v=v.queue,Kd(Of.bind(null,d,v,o),[o]),v.getSnapshot!==c||M||or!==null&&or.memoizedState.tag&1){if(d.flags|=2048,Uc(9,Df.bind(null,d,v,S,c),void 0,null),lr===null)throw Error(P(349));(Ps&30)!==0||Cf(d,c,S)}return S}function Cf(o,c,d){o.flags|=16384,o={getSnapshot:c,value:d},c=Pn.updateQueue,c===null?(c={lastEffect:null,stores:null},Pn.updateQueue=c,c.stores=[o]):(d=c.stores,d===null?c.stores=[o]:d.push(o))}function Df(o,c,d,v){c.value=d,c.getSnapshot=v,If(c)&&Nf(o)}function Of(o,c,d){return d(function(){If(c)&&Nf(o)})}function If(o){var c=o.getSnapshot;o=o.value;try{var d=c();return!Ar(o,d)}catch{return!0}}function Nf(o){var c=Pr(o,1);c!==null&&li(c,o,1,-1)}function kf(o){var c=Da();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fc,lastRenderedState:o},c.queue=o,o=o.dispatch=Ag.bind(null,Pn,o),[c.memoizedState,o]}function Uc(o,c,d,v){return o={tag:o,create:c,destroy:d,deps:v,next:null},c=Pn.updateQueue,c===null?(c={lastEffect:null,stores:null},Pn.updateQueue=c,c.lastEffect=o.next=o):(d=c.lastEffect,d===null?c.lastEffect=o.next=o:(v=d.next,d.next=o,o.next=v,c.lastEffect=o)),o}function Ff(){return Xi().memoizedState}function mh(o,c,d,v){var S=Da();Pn.flags|=o,S.memoizedState=Uc(1|c,d,void 0,v===void 0?null:v)}function gh(o,c,d,v){var S=Xi();v=v===void 0?null:v;var M=void 0;if($n!==null){var L=$n.memoizedState;if(M=L.destroy,v!==null&&Yn(v,L.deps)){S.memoizedState=Uc(c,d,M,v);return}}Pn.flags|=o,S.memoizedState=Uc(1|c,d,M,v)}function Uf(o,c){return mh(8390656,8,o,c)}function Kd(o,c){return gh(2048,8,o,c)}function zf(o,c){return gh(4,2,o,c)}function Bf(o,c){return gh(4,4,o,c)}function Hf(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function jf(o,c,d){return d=d!=null?d.concat([o]):null,gh(4,4,Hf.bind(null,c,o),d)}function Jd(){}function Gf(o,c){var d=Xi();c=c===void 0?null:c;var v=d.memoizedState;return v!==null&&c!==null&&Yn(c,v[1])?v[0]:(d.memoizedState=[o,c],o)}function Vf(o,c){var d=Xi();c=c===void 0?null:c;var v=d.memoizedState;return v!==null&&c!==null&&Yn(c,v[1])?v[0]:(o=o(),d.memoizedState=[o,c],o)}function Wf(o,c,d){return(Ps&21)===0?(o.baseState&&(o.baseState=!1,si=!0),o.memoizedState=d):(Ar(d,c)||(d=Nu(),Pn.lanes|=d,Mo|=d,o.baseState=!0),c)}function Tg(o,c){var d=Kt;Kt=d!==0&&4>d?d:4,o(!0);var v=fh.transition;fh.transition={};try{o(!1),c()}finally{Kt=d,fh.transition=v}}function Xf(){return Xi().memoizedState}function Eg(o,c,d){var v=Na(o);if(d={lane:v,action:d,hasEagerState:!1,eagerState:null,next:null},qf(o))Yf(c,d);else if(d=Ef(o,c,d,v),d!==null){var S=En();li(d,o,v,S),Qf(d,c,v)}}function Ag(o,c,d){var v=Na(o),S={lane:v,action:d,hasEagerState:!1,eagerState:null,next:null};if(qf(o))Yf(c,S);else{var M=o.alternate;if(o.lanes===0&&(M===null||M.lanes===0)&&(M=c.lastRenderedReducer,M!==null))try{var L=c.lastRenderedState,V=M(L,d);if(S.hasEagerState=!0,S.eagerState=V,Ar(V,L)){var Q=c.interleaved;Q===null?(S.next=S,Vd(c)):(S.next=Q.next,Q.next=S),c.interleaved=S;return}}catch{}finally{}d=Ef(o,c,S,v),d!==null&&(S=En(),li(d,o,v,S),Qf(d,c,v))}}function qf(o){var c=o.alternate;return o===Pn||c!==null&&c===Pn}function Yf(o,c){wl=kc=!0;var d=o.pending;d===null?c.next=c:(c.next=d.next,d.next=c),o.pending=c}function Qf(o,c,d){if((d&4194240)!==0){var v=c.lanes;v&=o.pendingLanes,d|=v,c.lanes=d,Fu(o,d)}}var vh={readContext:Wi,useCallback:qn,useContext:qn,useEffect:qn,useImperativeHandle:qn,useInsertionEffect:qn,useLayoutEffect:qn,useMemo:qn,useReducer:qn,useRef:qn,useState:qn,useDebugValue:qn,useDeferredValue:qn,useTransition:qn,useMutableSource:qn,useSyncExternalStore:qn,useId:qn,unstable_isNewReconciler:!1},Rg={readContext:Wi,useCallback:function(o,c){return Da().memoizedState=[o,c===void 0?null:c],o},useContext:Wi,useEffect:Uf,useImperativeHandle:function(o,c,d){return d=d!=null?d.concat([o]):null,mh(4194308,4,Hf.bind(null,c,o),d)},useLayoutEffect:function(o,c){return mh(4194308,4,o,c)},useInsertionEffect:function(o,c){return mh(4,2,o,c)},useMemo:function(o,c){var d=Da();return c=c===void 0?null:c,o=o(),d.memoizedState=[o,c],o},useReducer:function(o,c,d){var v=Da();return c=d!==void 0?d(c):c,v.memoizedState=v.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},v.queue=o,o=o.dispatch=Eg.bind(null,Pn,o),[v.memoizedState,o]},useRef:function(o){var c=Da();return o={current:o},c.memoizedState=o},useState:kf,useDebugValue:Jd,useDeferredValue:function(o){return Da().memoizedState=o},useTransition:function(){var o=kf(!1),c=o[0];return o=Tg.bind(null,o[1]),Da().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,d){var v=Pn,S=Da();if(Dt){if(d===void 0)throw Error(P(407));d=d()}else{if(d=c(),lr===null)throw Error(P(349));(Ps&30)!==0||Cf(v,c,d)}S.memoizedState=d;var M={value:d,getSnapshot:c};return S.queue=M,Uf(Of.bind(null,v,M,o),[o]),v.flags|=2048,Uc(9,Df.bind(null,v,M,d,c),void 0,null),d},useId:function(){var o=Da(),c=lr.identifierPrefix;if(Dt){var d=Hi,v=Bi;d=(v&~(1<<32-pi(v)-1)).toString(32)+d,c=":"+c+"R"+d,d=Ml++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=Rf++,c=":"+c+"r"+d.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},Lg={readContext:Wi,useCallback:Gf,useContext:Wi,useEffect:Kd,useImperativeHandle:jf,useInsertionEffect:zf,useLayoutEffect:Bf,useMemo:Vf,useReducer:Qd,useRef:Ff,useState:function(){return Qd(Fc)},useDebugValue:Jd,useDeferredValue:function(o){var c=Xi();return Wf(c,$n.memoizedState,o)},useTransition:function(){var o=Qd(Fc)[0],c=Xi().memoizedState;return[o,c]},useMutableSource:Lf,useSyncExternalStore:Pf,useId:Xf,unstable_isNewReconciler:!1},Pg={readContext:Wi,useCallback:Gf,useContext:Wi,useEffect:Kd,useImperativeHandle:jf,useInsertionEffect:zf,useLayoutEffect:Bf,useMemo:Vf,useReducer:Zd,useRef:Ff,useState:function(){return Zd(Fc)},useDebugValue:Jd,useDeferredValue:function(o){var c=Xi();return $n===null?c.memoizedState=o:Wf(c,$n.memoizedState,o)},useTransition:function(){var o=Zd(Fc)[0],c=Xi().memoizedState;return[o,c]},useMutableSource:Lf,useSyncExternalStore:Pf,useId:Xf,unstable_isNewReconciler:!1};function da(o,c){if(o&&o.defaultProps){c=et({},c),o=o.defaultProps;for(var d in o)c[d]===void 0&&(c[d]=o[d]);return c}return c}function $d(o,c,d,v){c=o.memoizedState,d=d(v,c),d=d==null?c:et({},c,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var yh={isMounted:function(o){return(o=o._reactInternals)?bs(o)===o:!1},enqueueSetState:function(o,c,d){o=o._reactInternals;var v=En(),S=Na(o),M=La(v,S);M.payload=c,d!=null&&(M.callback=d),c=Pa(o,M,S),c!==null&&(li(c,o,S,v),Ca(c,o,S))},enqueueReplaceState:function(o,c,d){o=o._reactInternals;var v=En(),S=Na(o),M=La(v,S);M.tag=1,M.payload=c,d!=null&&(M.callback=d),c=Pa(o,M,S),c!==null&&(li(c,o,S,v),Ca(c,o,S))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var d=En(),v=Na(o),S=La(d,v);S.tag=2,c!=null&&(S.callback=c),c=Pa(o,S,v),c!==null&&(li(c,o,v,d),Ca(c,o,v))}};function xh(o,c,d,v,S,M,L){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,M,L):c.prototype&&c.prototype.isPureReactComponent?!Sa(d,v)||!Sa(S,M):!0}function ep(o,c,d){var v=!1,S=ua,M=c.contextType;return typeof M=="object"&&M!==null?M=Wi(M):(S=ri(c)?po:Rr.current,v=c.contextTypes,M=(v=v!=null)?He(o,S):ua),c=new c(d,M),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=yh,o.stateNode=c,c._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=S,o.__reactInternalMemoizedMaskedChildContext=M),c}function Zf(o,c,d,v){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,v),c.state!==o&&yh.enqueueReplaceState(c,c.state,null)}function El(o,c,d,v){var S=o.stateNode;S.props=d,S.state=o.memoizedState,S.refs={},xo(o);var M=c.contextType;typeof M=="object"&&M!==null?S.context=Wi(M):(M=ri(c)?po:Rr.current,S.context=He(o,M)),S.state=o.memoizedState,M=c.getDerivedStateFromProps,typeof M=="function"&&($d(o,c,M,d),S.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(c=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),c!==S.state&&yh.enqueueReplaceState(S,S.state,null),Nc(o,d,S,v),S.state=o.memoizedState),typeof S.componentDidMount=="function"&&(o.flags|=4194308)}function So(o,c){try{var d="",v=c;do d+=Gt(v),v=v.return;while(v);var S=d}catch(M){S=`
Error generating stack: `+M.message+`
`+M.stack}return{value:o,source:c,stack:S,digest:null}}function tp(o,c,d){return{value:o,source:null,stack:d??null,digest:c??null}}function bh(o,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var Cg=typeof WeakMap=="function"?WeakMap:Map;function Kf(o,c,d){d=La(-1,d),d.tag=3,d.payload={element:null};var v=c.value;return d.callback=function(){To||(To=!0,cr=v),bh(o,c)},d}function Al(o,c,d){d=La(-1,d),d.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var S=c.value;d.payload=function(){return v(S)},d.callback=function(){bh(o,c)}}var M=o.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(d.callback=function(){bh(o,c),typeof v!="function"&&(ss===null?ss=new Set([this]):ss.add(this));var L=c.stack;this.componentDidCatch(c.value,{componentStack:L!==null?L:""})}),d}function np(o,c,d){var v=o.pingCache;if(v===null){v=o.pingCache=new Cg;var S=new Set;v.set(c,S)}else S=v.get(c),S===void 0&&(S=new Set,v.set(c,S));S.has(d)||(S.add(d),o=fm.bind(null,o,c,d),c.then(o,o))}function rp(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function Jf(o,c,d,v,S){return(o.mode&1)===0?(o===c?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=La(-1,1),c.tag=2,Pa(d,c,1))),d.lanes|=1),o):(o.flags|=65536,o.lanes=S,o)}var ip=F.ReactCurrentOwner,si=!1;function Vr(o,c,d,v){c.child=o===null?jd(c,null,d,v):Ra(c,o.child,d,v)}function ap(o,c,d,v,S){d=d.render;var M=c.ref;return yl(c,S),v=Qn(o,c,d,v,M,S),d=Tl(),o!==null&&!si?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~S,pa(o,c,S)):(Dt&&d&&ht(c),c.flags|=1,Vr(o,c,v,S),c.child)}function $f(o,c,d,v,S){if(o===null){var M=d.type;return typeof M=="function"&&!us(M)&&M.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=M,sp(o,c,M,v,S)):(o=ma(d.type,null,v,c,c.mode,S),o.ref=c.ref,o.return=c,c.child=o)}if(M=o.child,(o.lanes&S)===0){var L=M.memoizedProps;if(d=d.compare,d=d!==null?d:Sa,d(L,v)&&o.ref===c.ref)return pa(o,c,S)}return c.flags|=1,o=Ai(M,v),o.ref=c.ref,o.return=c,c.child=o}function sp(o,c,d,v,S){if(o!==null){var M=o.memoizedProps;if(Sa(M,v)&&o.ref===c.ref)if(si=!1,c.pendingProps=v=M,(o.lanes&S)!==0)(o.flags&131072)!==0&&(si=!0);else return c.lanes=o.lanes,pa(o,c,S)}return op(o,c,d,v,S)}function em(o,c,d){var v=c.pendingProps,S=v.children,M=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(fa,Nr),Nr|=d;else{if((d&1073741824)===0)return o=M!==null?M.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,gn(fa,Nr),Nr|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=M!==null?M.baseLanes:d,gn(fa,Nr),Nr|=v}else M!==null?(v=M.baseLanes|d,c.memoizedState=null):v=d,gn(fa,Nr),Nr|=v;return Vr(o,c,S,d),c.child}function tm(o,c){var d=c.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function op(o,c,d,v,S){var M=ri(d)?po:Rr.current;return M=He(c,M),yl(c,S),d=Qn(o,c,d,v,M,S),v=Tl(),o!==null&&!si?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~S,pa(o,c,S)):(Dt&&v&&ht(c),c.flags|=1,Vr(o,c,d,S),c.child)}function nm(o,c,d,v,S){if(ri(d)){var M=!0;ts(c)}else M=!1;if(yl(c,S),c.stateNode===null)_o(o,c),ep(c,d,v),El(c,d,v,S),v=!0;else if(o===null){var L=c.stateNode,V=c.memoizedProps;L.props=V;var Q=L.context,fe=d.contextType;typeof fe=="object"&&fe!==null?fe=Wi(fe):(fe=ri(d)?po:Rr.current,fe=He(c,fe));var Le=d.getDerivedStateFromProps,Pe=typeof Le=="function"||typeof L.getSnapshotBeforeUpdate=="function";Pe||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(V!==v||Q!==fe)&&Zf(c,L,v,fe),rs=!1;var Ee=c.memoizedState;L.state=Ee,Nc(c,v,L,S),Q=c.memoizedState,V!==v||Ee!==Q||Lr.current||rs?(typeof Le=="function"&&($d(c,d,Le,v),Q=c.memoizedState),(V=rs||xh(c,d,V,v,Ee,Q,fe))?(Pe||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(c.flags|=4194308)):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=Q),L.props=v,L.state=Q,L.context=fe,v=V):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{L=c.stateNode,uh(o,c),V=c.memoizedProps,fe=c.type===c.elementType?V:da(c.type,V),L.props=fe,Pe=c.pendingProps,Ee=L.context,Q=d.contextType,typeof Q=="object"&&Q!==null?Q=Wi(Q):(Q=ri(d)?po:Rr.current,Q=He(c,Q));var Xe=d.getDerivedStateFromProps;(Le=typeof Xe=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(V!==Pe||Ee!==Q)&&Zf(c,L,v,Q),rs=!1,Ee=c.memoizedState,L.state=Ee,Nc(c,v,L,S);var Qe=c.memoizedState;V!==Pe||Ee!==Qe||Lr.current||rs?(typeof Xe=="function"&&($d(c,d,Xe,v),Qe=c.memoizedState),(fe=rs||xh(c,d,fe,v,Ee,Qe,Q)||!1)?(Le||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(v,Qe,Q),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(v,Qe,Q)),typeof L.componentDidUpdate=="function"&&(c.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof L.componentDidUpdate!="function"||V===o.memoizedProps&&Ee===o.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||V===o.memoizedProps&&Ee===o.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=Qe),L.props=v,L.state=Qe,L.context=Q,v=fe):(typeof L.componentDidUpdate!="function"||V===o.memoizedProps&&Ee===o.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||V===o.memoizedProps&&Ee===o.memoizedState||(c.flags|=1024),v=!1)}return lp(o,c,d,v,M,S)}function lp(o,c,d,v,S,M){tm(o,c);var L=(c.flags&128)!==0;if(!v&&!L)return S&&ii(c,d,!1),pa(o,c,M);v=c.stateNode,ip.current=c;var V=L&&typeof d.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,o!==null&&L?(c.child=Ra(c,o.child,null,M),c.child=Ra(c,null,V,M)):Vr(o,c,V,M),c.memoizedState=v.state,S&&ii(c,d,!0),c.child}function rm(o){var c=o.stateNode;c.pendingContext?yi(o,c.pendingContext,c.pendingContext!==c.context):c.context&&yi(o,c.context,!1),Wd(o,c.containerInfo)}function im(o,c,d,v,S){return go(),Dc(S),c.flags|=256,Vr(o,c,d,v),c.child}var Sh={dehydrated:null,treeContext:null,retryLane:0};function _h(o){return{baseLanes:o,cachePool:null,transitions:null}}function am(o,c,d){var v=c.pendingProps,S=On.current,M=!1,L=(c.flags&128)!==0,V;if((V=L)||(V=o!==null&&o.memoizedState===null?!1:(S&2)!==0),V?(M=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&(S|=1),gn(On,S&1),o===null)return vn(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((c.mode&1)===0?c.lanes=1:o.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(L=v.children,o=v.fallback,M?(v=c.mode,M=c.child,L={mode:"hidden",children:L},(v&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=L):M=Ri(L,v,0,null),o=Yi(o,v,d,null),M.return=c,o.return=c,M.sibling=o,c.child=M,c.child.memoizedState=_h(d),c.memoizedState=Sh,o):cp(c,L));if(S=o.memoizedState,S!==null&&(V=S.dehydrated,V!==null))return Dg(o,c,L,v,V,S,d);if(M){M=v.fallback,L=c.mode,S=o.child,V=S.sibling;var Q={mode:"hidden",children:v.children};return(L&1)===0&&c.child!==S?(v=c.child,v.childLanes=0,v.pendingProps=Q,c.deletions=null):(v=Ai(S,Q),v.subtreeFlags=S.subtreeFlags&14680064),V!==null?M=Ai(V,M):(M=Yi(M,L,d,null),M.flags|=2),M.return=c,v.return=c,v.sibling=M,c.child=v,v=M,M=c.child,L=o.child.memoizedState,L=L===null?_h(d):{baseLanes:L.baseLanes|d,cachePool:null,transitions:L.transitions},M.memoizedState=L,M.childLanes=o.childLanes&~d,c.memoizedState=Sh,v}return M=o.child,o=M.sibling,v=Ai(M,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=d),v.return=c,v.sibling=null,o!==null&&(d=c.deletions,d===null?(c.deletions=[o],c.flags|=16):d.push(o)),c.child=v,c.memoizedState=null,v}function cp(o,c){return c=Ri({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function wh(o,c,d,v){return v!==null&&Dc(v),Ra(c,o.child,null,d),o=cp(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function Dg(o,c,d,v,S,M,L){if(d)return c.flags&256?(c.flags&=-257,v=tp(Error(P(422))),wh(o,c,L,v)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(M=v.fallback,S=c.mode,v=Ri({mode:"visible",children:v.children},S,0,null),M=Yi(M,S,L,null),M.flags|=2,v.return=c,M.return=c,v.sibling=M,c.child=v,(c.mode&1)!==0&&Ra(c,o.child,null,L),c.child.memoizedState=_h(L),c.memoizedState=Sh,M);if((c.mode&1)===0)return wh(o,c,L,null);if(S.data==="$!"){if(v=S.nextSibling&&S.nextSibling.dataset,v)var V=v.dgst;return v=V,M=Error(P(419)),v=tp(M,v,void 0),wh(o,c,L,v)}if(V=(L&o.childLanes)!==0,si||V){if(v=lr,v!==null){switch(L&-L){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(v.suspendedLanes|L))!==0?0:S,S!==0&&S!==M.retryLane&&(M.retryLane=S,Pr(o,S),li(v,o,S,-1))}return Ch(),v=tp(Error(P(421))),wh(o,c,L,v)}return S.data==="$?"?(c.flags|=128,c.child=o.child,c=mm.bind(null,o),S._reactRetry=c,null):(o=M.treeContext,gr=Ma(S.nextSibling),Xn=c,Dt=!0,ji=null,o!==null&&(ai[Gr++]=Bi,ai[Gr++]=Hi,ai[Gr++]=Aa,Bi=o.id,Hi=o.overflow,Aa=c),c=cp(c,v.children),c.flags|=4096,c)}function sm(o,c,d){o.lanes|=c;var v=o.alternate;v!==null&&(v.lanes|=c),Gd(o.return,c,d)}function Mh(o,c,d,v,S){var M=o.memoizedState;M===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:d,tailMode:S}:(M.isBackwards=c,M.rendering=null,M.renderingStartTime=0,M.last=v,M.tail=d,M.tailMode=S)}function om(o,c,d){var v=c.pendingProps,S=v.revealOrder,M=v.tail;if(Vr(o,c,v.children,d),v=On.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&sm(o,d,c);else if(o.tag===19)sm(o,d,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(gn(On,v),(c.mode&1)===0)c.memoizedState=null;else switch(S){case"forwards":for(d=c.child,S=null;d!==null;)o=d.alternate,o!==null&&dh(o)===null&&(S=d),d=d.sibling;d=S,d===null?(S=c.child,c.child=null):(S=d.sibling,d.sibling=null),Mh(c,!1,S,d,M);break;case"backwards":for(d=null,S=c.child,c.child=null;S!==null;){if(o=S.alternate,o!==null&&dh(o)===null){c.child=S;break}o=S.sibling,S.sibling=d,d=S,S=o}Mh(c,!0,d,null,M);break;case"together":Mh(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function _o(o,c){(c.mode&1)===0&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function pa(o,c,d){if(o!==null&&(c.dependencies=o.dependencies),Mo|=c.lanes,(d&c.childLanes)===0)return null;if(o!==null&&c.child!==o.child)throw Error(P(153));if(c.child!==null){for(o=c.child,d=Ai(o,o.pendingProps),c.child=d,d.return=c;o.sibling!==null;)o=o.sibling,d=d.sibling=Ai(o,o.pendingProps),d.return=c;d.sibling=null}return c.child}function Og(o,c,d){switch(c.tag){case 3:rm(c),go();break;case 5:Af(c);break;case 1:ri(c.type)&&ts(c);break;case 4:Wd(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,S=c.memoizedProps.value;gn(ch,v._currentValue),v._currentValue=S;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(gn(On,On.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?am(o,c,d):(gn(On,On.current&1),o=pa(o,c,d),o!==null?o.sibling:null);gn(On,On.current&1);break;case 19:if(v=(d&c.childLanes)!==0,(o.flags&128)!==0){if(v)return om(o,c,d);c.flags|=128}if(S=c.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),gn(On,On.current),v)break;return null;case 22:case 23:return c.lanes=0,em(o,c,d)}return pa(o,c,d)}var lm,up,cm,um;lm=function(o,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)o.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},up=function(){},cm=function(o,c,d,v){var S=o.memoizedProps;if(S!==v){o=c.stateNode,is(Si.current);var M=null;switch(d){case"input":S=Bo(o,S),v=Bo(o,v),M=[];break;case"select":S=et({},S,{value:void 0}),v=et({},v,{value:void 0}),M=[];break;case"textarea":S=Ru(o,S),v=Ru(o,v),M=[];break;default:typeof S.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=St)}Gn(d,v);var L;d=null;for(fe in S)if(!v.hasOwnProperty(fe)&&S.hasOwnProperty(fe)&&S[fe]!=null)if(fe==="style"){var V=S[fe];for(L in V)V.hasOwnProperty(L)&&(d||(d={}),d[L]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(ve.hasOwnProperty(fe)?M||(M=[]):(M=M||[]).push(fe,null));for(fe in v){var Q=v[fe];if(V=S?.[fe],v.hasOwnProperty(fe)&&Q!==V&&(Q!=null||V!=null))if(fe==="style")if(V){for(L in V)!V.hasOwnProperty(L)||Q&&Q.hasOwnProperty(L)||(d||(d={}),d[L]="");for(L in Q)Q.hasOwnProperty(L)&&V[L]!==Q[L]&&(d||(d={}),d[L]=Q[L])}else d||(M||(M=[]),M.push(fe,d)),d=Q;else fe==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,V=V?V.__html:void 0,Q!=null&&V!==Q&&(M=M||[]).push(fe,Q)):fe==="children"?typeof Q!="string"&&typeof Q!="number"||(M=M||[]).push(fe,""+Q):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(ve.hasOwnProperty(fe)?(Q!=null&&fe==="onScroll"&&cn("scroll",o),M||V===Q||(M=[])):(M=M||[]).push(fe,Q))}d&&(M=M||[]).push("style",d);var fe=M;(c.updateQueue=fe)&&(c.flags|=4)}},um=function(o,c,d,v){d!==v&&(c.flags|=4)};function Rl(o,c){if(!Dt)switch(o.tailMode){case"hidden":c=o.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var v=null;d!==null;)d.alternate!==null&&(v=d),d=d.sibling;v===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Mr(o){var c=o.alternate!==null&&o.alternate.child===o.child,d=0,v=0;if(c)for(var S=o.child;S!==null;)d|=S.lanes|S.childLanes,v|=S.subtreeFlags&14680064,v|=S.flags&14680064,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)d|=S.lanes|S.childLanes,v|=S.subtreeFlags,v|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=v,o.childLanes=d,c}function Cr(o,c,d){var v=c.pendingProps;switch(ml(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mr(c),null;case 1:return ri(c.type)&&sh(),Mr(c),null;case 3:return v=c.stateNode,_l(),Tn(Lr),Tn(Rr),Yd(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(Cc(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,ji!==null&&(Bl(ji),ji=null))),up(o,c),Mr(c),null;case 5:Xd(c);var S=is(Sl.current);if(d=c.type,o!==null&&c.stateNode!=null)cm(o,c,d,v,S),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(P(166));return Mr(c),null}if(o=is(Si.current),Cc(c)){v=c.stateNode,d=c.type;var M=c.memoizedProps;switch(v[an]=c,v[dl]=M,o=(c.mode&1)!==0,d){case"dialog":cn("cancel",v),cn("close",v);break;case"iframe":case"object":case"embed":cn("load",v);break;case"video":case"audio":for(S=0;S<_r.length;S++)cn(_r[S],v);break;case"source":cn("error",v);break;case"img":case"image":case"link":cn("error",v),cn("load",v);break;case"details":cn("toggle",v);break;case"input":Ho(v,M),cn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!M.multiple},cn("invalid",v);break;case"textarea":ra(v,M),cn("invalid",v)}Gn(d,M),S=null;for(var L in M)if(M.hasOwnProperty(L)){var V=M[L];L==="children"?typeof V=="string"?v.textContent!==V&&(M.suppressHydrationWarning!==!0&&Ac(v.textContent,V,o),S=["children",V]):typeof V=="number"&&v.textContent!==""+V&&(M.suppressHydrationWarning!==!0&&Ac(v.textContent,V,o),S=["children",""+V]):ve.hasOwnProperty(L)&&V!=null&&L==="onScroll"&&cn("scroll",v)}switch(d){case"input":sc(v),id(v,M,!0);break;case"textarea":sc(v),sd(v);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(v.onclick=St)}v=S,c.updateQueue=v,v!==null&&(c.flags|=4)}else{L=S.nodeType===9?S:S.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=od(d)),o==="http://www.w3.org/1999/xhtml"?d==="script"?(o=L.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=L.createElement(d,{is:v.is}):(o=L.createElement(d),d==="select"&&(L=o,v.multiple?L.multiple=!0:v.size&&(L.size=v.size))):o=L.createElementNS(o,d),o[an]=c,o[dl]=v,lm(o,c,!1,!1),c.stateNode=o;e:{switch(L=xs(d,v),d){case"dialog":cn("cancel",o),cn("close",o),S=v;break;case"iframe":case"object":case"embed":cn("load",o),S=v;break;case"video":case"audio":for(S=0;S<_r.length;S++)cn(_r[S],o);S=v;break;case"source":cn("error",o),S=v;break;case"img":case"image":case"link":cn("error",o),cn("load",o),S=v;break;case"details":cn("toggle",o),S=v;break;case"input":Ho(o,v),S=Bo(o,v),cn("invalid",o);break;case"option":S=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},S=et({},v,{value:void 0}),cn("invalid",o);break;case"textarea":ra(o,v),S=Ru(o,v),cn("invalid",o);break;default:S=v}Gn(d,S),V=S;for(M in V)if(V.hasOwnProperty(M)){var Q=V[M];M==="style"?Ws(o,Q):M==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&uc(o,Q)):M==="children"?typeof Q=="string"?(d!=="textarea"||Q!=="")&&Ci(o,Q):typeof Q=="number"&&Ci(o,""+Q):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(ve.hasOwnProperty(M)?Q!=null&&M==="onScroll"&&cn("scroll",o):Q!=null&&ir(o,M,Q,L))}switch(d){case"input":sc(o),id(o,v,!1);break;case"textarea":sc(o),sd(o);break;case"option":v.value!=null&&o.setAttribute("value",""+rn(v.value));break;case"select":o.multiple=!!v.multiple,M=v.value,M!=null?Vs(o,!!v.multiple,M,!1):v.defaultValue!=null&&Vs(o,!!v.multiple,v.defaultValue,!0);break;default:typeof S.onClick=="function"&&(o.onclick=St)}switch(d){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Mr(c),null;case 6:if(o&&c.stateNode!=null)um(o,c,o.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(P(166));if(d=is(Sl.current),is(Si.current),Cc(c)){if(v=c.stateNode,d=c.memoizedProps,v[an]=c,(M=v.nodeValue!==d)&&(o=Xn,o!==null))switch(o.tag){case 3:Ac(v.nodeValue,d,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Ac(v.nodeValue,d,(o.mode&1)!==0)}M&&(c.flags|=4)}else v=(d.nodeType===9?d:d.ownerDocument).createTextNode(v),v[an]=c,c.stateNode=v}return Mr(c),null;case 13:if(Tn(On),v=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Dt&&gr!==null&&(c.mode&1)!==0&&(c.flags&128)===0)gl(),go(),c.flags|=98560,M=!1;else if(M=Cc(c),v!==null&&v.dehydrated!==null){if(o===null){if(!M)throw Error(P(318));if(M=c.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(P(317));M[an]=c}else go(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Mr(c),M=!1}else ji!==null&&(Bl(ji),ji=null),M=!0;if(!M)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(o===null||(On.current&1)!==0?yn===0&&(yn=3):Ch())),c.updateQueue!==null&&(c.flags|=4),Mr(c),null);case 4:return _l(),up(o,c),o===null&&_a(c.stateNode.containerInfo),Mr(c),null;case 10:return vl(c.type._context),Mr(c),null;case 17:return ri(c.type)&&sh(),Mr(c),null;case 19:if(Tn(On),M=c.memoizedState,M===null)return Mr(c),null;if(v=(c.flags&128)!==0,L=M.rendering,L===null)if(v)Rl(M,!1);else{if(yn!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(L=dh(o),L!==null){for(c.flags|=128,Rl(M,!1),v=L.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=d,d=c.child;d!==null;)M=d,o=v,M.flags&=14680066,L=M.alternate,L===null?(M.childLanes=0,M.lanes=o,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=L.childLanes,M.lanes=L.lanes,M.child=L.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=L.memoizedProps,M.memoizedState=L.memoizedState,M.updateQueue=L.updateQueue,M.type=L.type,o=L.dependencies,M.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),d=d.sibling;return gn(On,On.current&1|2),c.child}o=o.sibling}M.tail!==null&&Ln()>Fl&&(c.flags|=128,v=!0,Rl(M,!1),c.lanes=4194304)}else{if(!v)if(o=dh(L),o!==null){if(c.flags|=128,v=!0,d=o.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),Rl(M,!0),M.tail===null&&M.tailMode==="hidden"&&!L.alternate&&!Dt)return Mr(c),null}else 2*Ln()-M.renderingStartTime>Fl&&d!==1073741824&&(c.flags|=128,v=!0,Rl(M,!1),c.lanes=4194304);M.isBackwards?(L.sibling=c.child,c.child=L):(d=M.last,d!==null?d.sibling=L:c.child=L,M.last=L)}return M.tail!==null?(c=M.tail,M.rendering=c,M.tail=c.sibling,M.renderingStartTime=Ln(),c.sibling=null,d=On.current,gn(On,v?d&1|2:d&1),c):(Mr(c),null);case 22:case 23:return vp(),v=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(Nr&1073741824)!==0&&(Mr(c),c.subtreeFlags&6&&(c.flags|=8192)):Mr(c),null;case 24:return null;case 25:return null}throw Error(P(156,c.tag))}function Ig(o,c){switch(ml(c),c.tag){case 1:return ri(c.type)&&sh(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return _l(),Tn(Lr),Tn(Rr),Yd(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 5:return Xd(c),null;case 13:if(Tn(On),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(P(340));go()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return Tn(On),null;case 4:return _l(),null;case 10:return vl(c.type._context),null;case 22:case 23:return vp(),null;case 24:return null;default:return null}}var Ll=!1,er=!1,Ng=typeof WeakSet=="function"?WeakSet:Set,nt=null;function Pl(o,c){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(v){Cn(o,c,v)}else d.current=null}function Cl(o,c,d){try{d()}catch(v){Cn(o,c,v)}}var hp=!1;function Th(o,c){if(gi=tl,o=Ms(),oo(o)){if("selectionStart"in o)var d={start:o.selectionStart,end:o.selectionEnd};else e:{d=(d=o.ownerDocument)&&d.defaultView||window;var v=d.getSelection&&d.getSelection();if(v&&v.rangeCount!==0){d=v.anchorNode;var S=v.anchorOffset,M=v.focusNode;v=v.focusOffset;try{d.nodeType,M.nodeType}catch{d=null;break e}var L=0,V=-1,Q=-1,fe=0,Le=0,Pe=o,Ee=null;t:for(;;){for(var Xe;Pe!==d||S!==0&&Pe.nodeType!==3||(V=L+S),Pe!==M||v!==0&&Pe.nodeType!==3||(Q=L+v),Pe.nodeType===3&&(L+=Pe.nodeValue.length),(Xe=Pe.firstChild)!==null;)Ee=Pe,Pe=Xe;for(;;){if(Pe===o)break t;if(Ee===d&&++fe===S&&(V=L),Ee===M&&++Le===v&&(Q=L),(Xe=Pe.nextSibling)!==null)break;Pe=Ee,Ee=Pe.parentNode}Pe=Xe}d=V===-1||Q===-1?null:{start:V,end:Q}}else d=null}d=d||{start:0,end:0}}else d=null;for(la={focusedElem:o,selectionRange:d},tl=!1,nt=c;nt!==null;)if(c=nt,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,nt=o;else for(;nt!==null;){c=nt;try{var Qe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Qe!==null){var tt=Qe.memoizedProps,xn=Qe.memoizedState,ae=c.stateNode,Z=ae.getSnapshotBeforeUpdate(c.elementType===c.type?tt:da(c.type,tt),xn);ae.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var ue=c.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(P(163))}}catch(ke){Cn(c,c.return,ke)}if(o=c.sibling,o!==null){o.return=c.return,nt=o;break}nt=c.return}return Qe=hp,hp=!1,Qe}function Cs(o,c,d){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var S=v=v.next;do{if((S.tag&o)===o){var M=S.destroy;S.destroy=void 0,M!==void 0&&Cl(c,d,M)}S=S.next}while(S!==v)}}function Oa(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&o)===o){var v=d.create;d.destroy=v()}d=d.next}while(d!==c)}}function Ds(o){var c=o.ref;if(c!==null){var d=o.stateNode;switch(o.tag){case 5:o=d;break;default:o=d}typeof c=="function"?c(o):c.current=o}}function Dr(o){var c=o.alternate;c!==null&&(o.alternate=null,Dr(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[an],delete c[dl],delete c[pl],delete c[Bd],delete c[Ne])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Or(o){return o.tag===5||o.tag===3||o.tag===4}function Eh(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Or(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Os(o,c,d){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(o,c):d.insertBefore(o,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(o,d)):(c=d,c.appendChild(o)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=St));else if(v!==4&&(o=o.child,o!==null))for(Os(o,c,d),o=o.sibling;o!==null;)Os(o,c,d),o=o.sibling}function wo(o,c,d){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?d.insertBefore(o,c):d.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(wo(o,c,d),o=o.sibling;o!==null;)wo(o,c,d),o=o.sibling}var Hn=null,Ir=!1;function _i(o,c,d){for(d=d.child;d!==null;)Dl(o,c,d),d=d.sibling}function Dl(o,c,d){if(Ii&&typeof Ii.onCommitFiberUnmount=="function")try{Ii.onCommitFiberUnmount(pc,d)}catch{}switch(d.tag){case 5:er||Pl(d,c);case 6:var v=Hn,S=Ir;Hn=null,_i(o,c,d),Hn=v,Ir=S,Hn!==null&&(Ir?(o=Hn,d=d.stateNode,o.nodeType===8?o.parentNode.removeChild(d):o.removeChild(d)):Hn.removeChild(d.stateNode));break;case 18:Hn!==null&&(Ir?(o=Hn,d=d.stateNode,o.nodeType===8?Lc(o.parentNode,d):o.nodeType===1&&Lc(o,d),Sr(o)):Lc(Hn,d.stateNode));break;case 4:v=Hn,S=Ir,Hn=d.stateNode.containerInfo,Ir=!0,_i(o,c,d),Hn=v,Ir=S;break;case 0:case 11:case 14:case 15:if(!er&&(v=d.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){S=v=v.next;do{var M=S,L=M.destroy;M=M.tag,L!==void 0&&((M&2)!==0||(M&4)!==0)&&Cl(d,c,L),S=S.next}while(S!==v)}_i(o,c,d);break;case 1:if(!er&&(Pl(d,c),v=d.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=d.memoizedProps,v.state=d.memoizedState,v.componentWillUnmount()}catch(V){Cn(d,c,V)}_i(o,c,d);break;case 21:_i(o,c,d);break;case 22:d.mode&1?(er=(v=er)||d.memoizedState!==null,_i(o,c,d),er=v):_i(o,c,d);break;default:_i(o,c,d)}}function dp(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new Ng),c.forEach(function(v){var S=xp.bind(null,o,v);d.has(v)||(d.add(v),v.then(S,S))})}}function oi(o,c){var d=c.deletions;if(d!==null)for(var v=0;v<d.length;v++){var S=d[v];try{var M=o,L=c,V=L;e:for(;V!==null;){switch(V.tag){case 5:Hn=V.stateNode,Ir=!1;break e;case 3:Hn=V.stateNode.containerInfo,Ir=!0;break e;case 4:Hn=V.stateNode.containerInfo,Ir=!0;break e}V=V.return}if(Hn===null)throw Error(P(160));Dl(M,L,S),Hn=null,Ir=!1;var Q=S.alternate;Q!==null&&(Q.return=null),S.return=null}catch(fe){Cn(S,c,fe)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Ol(c,o),c=c.sibling}function Ol(o,c){var d=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(oi(c,o),wi(o),v&4){try{Cs(3,o,o.return),Oa(3,o)}catch(tt){Cn(o,o.return,tt)}try{Cs(5,o,o.return)}catch(tt){Cn(o,o.return,tt)}}break;case 1:oi(c,o),wi(o),v&512&&d!==null&&Pl(d,d.return);break;case 5:if(oi(c,o),wi(o),v&512&&d!==null&&Pl(d,d.return),o.flags&32){var S=o.stateNode;try{Ci(S,"")}catch(tt){Cn(o,o.return,tt)}}if(v&4&&(S=o.stateNode,S!=null)){var M=o.memoizedProps,L=d!==null?d.memoizedProps:M,V=o.type,Q=o.updateQueue;if(o.updateQueue=null,Q!==null)try{V==="input"&&M.type==="radio"&&M.name!=null&&jo(S,M),xs(V,L);var fe=xs(V,M);for(L=0;L<Q.length;L+=2){var Le=Q[L],Pe=Q[L+1];Le==="style"?Ws(S,Pe):Le==="dangerouslySetInnerHTML"?uc(S,Pe):Le==="children"?Ci(S,Pe):ir(S,Le,Pe,fe)}switch(V){case"input":oc(S,M);break;case"textarea":ad(S,M);break;case"select":var Ee=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!M.multiple;var Xe=M.value;Xe!=null?Vs(S,!!M.multiple,Xe,!1):Ee!==!!M.multiple&&(M.defaultValue!=null?Vs(S,!!M.multiple,M.defaultValue,!0):Vs(S,!!M.multiple,M.multiple?[]:"",!1))}S[dl]=M}catch(tt){Cn(o,o.return,tt)}}break;case 6:if(oi(c,o),wi(o),v&4){if(o.stateNode===null)throw Error(P(162));S=o.stateNode,M=o.memoizedProps;try{S.nodeValue=M}catch(tt){Cn(o,o.return,tt)}}break;case 3:if(oi(c,o),wi(o),v&4&&d!==null&&d.memoizedState.isDehydrated)try{Sr(c.containerInfo)}catch(tt){Cn(o,o.return,tt)}break;case 4:oi(c,o),wi(o);break;case 13:oi(c,o),wi(o),S=o.child,S.flags&8192&&(M=S.memoizedState!==null,S.stateNode.isHidden=M,!M||S.alternate!==null&&S.alternate.memoizedState!==null||(kl=Ln())),v&4&&dp(o);break;case 22:if(Le=d!==null&&d.memoizedState!==null,o.mode&1?(er=(fe=er)||Le,oi(c,o),er=fe):oi(c,o),wi(o),v&8192){if(fe=o.memoizedState!==null,(o.stateNode.isHidden=fe)&&!Le&&(o.mode&1)!==0)for(nt=o,Le=o.child;Le!==null;){for(Pe=nt=Le;nt!==null;){switch(Ee=nt,Xe=Ee.child,Ee.tag){case 0:case 11:case 14:case 15:Cs(4,Ee,Ee.return);break;case 1:Pl(Ee,Ee.return);var Qe=Ee.stateNode;if(typeof Qe.componentWillUnmount=="function"){v=Ee,d=Ee.return;try{c=v,Qe.props=c.memoizedProps,Qe.state=c.memoizedState,Qe.componentWillUnmount()}catch(tt){Cn(v,d,tt)}}break;case 5:Pl(Ee,Ee.return);break;case 22:if(Ee.memoizedState!==null){fp(Pe);continue}}Xe!==null?(Xe.return=Ee,nt=Xe):fp(Pe)}Le=Le.sibling}e:for(Le=null,Pe=o;;){if(Pe.tag===5){if(Le===null){Le=Pe;try{S=Pe.stateNode,fe?(M=S.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(V=Pe.stateNode,Q=Pe.memoizedProps.style,L=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,V.style.display=Vo("display",L))}catch(tt){Cn(o,o.return,tt)}}}else if(Pe.tag===6){if(Le===null)try{Pe.stateNode.nodeValue=fe?"":Pe.memoizedProps}catch(tt){Cn(o,o.return,tt)}}else if((Pe.tag!==22&&Pe.tag!==23||Pe.memoizedState===null||Pe===o)&&Pe.child!==null){Pe.child.return=Pe,Pe=Pe.child;continue}if(Pe===o)break e;for(;Pe.sibling===null;){if(Pe.return===null||Pe.return===o)break e;Le===Pe&&(Le=null),Pe=Pe.return}Le===Pe&&(Le=null),Pe.sibling.return=Pe.return,Pe=Pe.sibling}}break;case 19:oi(c,o),wi(o),v&4&&dp(o);break;case 21:break;default:oi(c,o),wi(o)}}function wi(o){var c=o.flags;if(c&2){try{e:{for(var d=o.return;d!==null;){if(Or(d)){var v=d;break e}d=d.return}throw Error(P(160))}switch(v.tag){case 5:var S=v.stateNode;v.flags&32&&(Ci(S,""),v.flags&=-33);var M=Eh(o);wo(o,M,S);break;case 3:case 4:var L=v.stateNode.containerInfo,V=Eh(o);Os(o,V,L);break;default:throw Error(P(161))}}catch(Q){Cn(o,o.return,Q)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function hm(o,c,d){nt=o,Ah(o)}function Ah(o,c,d){for(var v=(o.mode&1)!==0;nt!==null;){var S=nt,M=S.child;if(S.tag===22&&v){var L=S.memoizedState!==null||Ll;if(!L){var V=S.alternate,Q=V!==null&&V.memoizedState!==null||er;V=Ll;var fe=er;if(Ll=L,(er=Q)&&!fe)for(nt=S;nt!==null;)L=nt,Q=L.child,L.tag===22&&L.memoizedState!==null?zc(S):Q!==null?(Q.return=L,nt=Q):zc(S);for(;M!==null;)nt=M,Ah(M),M=M.sibling;nt=S,Ll=V,er=fe}pp(o)}else(S.subtreeFlags&8772)!==0&&M!==null?(M.return=S,nt=M):pp(o)}}function pp(o){for(;nt!==null;){var c=nt;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:er||Oa(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!er)if(d===null)v.componentDidMount();else{var S=c.elementType===c.type?d.memoizedProps:da(c.type,d.memoizedProps);v.componentDidUpdate(S,d.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var M=c.updateQueue;M!==null&&hh(c,M,v);break;case 3:var L=c.updateQueue;if(L!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}hh(c,L,d)}break;case 5:var V=c.stateNode;if(d===null&&c.flags&4){d=V;var Q=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&d.focus();break;case"img":Q.src&&(d.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var fe=c.alternate;if(fe!==null){var Le=fe.memoizedState;if(Le!==null){var Pe=Le.dehydrated;Pe!==null&&Sr(Pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(P(163))}er||c.flags&512&&Ds(c)}catch(Ee){Cn(c,c.return,Ee)}}if(c===o){nt=null;break}if(d=c.sibling,d!==null){d.return=c.return,nt=d;break}nt=c.return}}function fp(o){for(;nt!==null;){var c=nt;if(c===o){nt=null;break}var d=c.sibling;if(d!==null){d.return=c.return,nt=d;break}nt=c.return}}function zc(o){for(;nt!==null;){var c=nt;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{Oa(4,c)}catch(Q){Cn(c,d,Q)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var S=c.return;try{v.componentDidMount()}catch(Q){Cn(c,S,Q)}}var M=c.return;try{Ds(c)}catch(Q){Cn(c,M,Q)}break;case 5:var L=c.return;try{Ds(c)}catch(Q){Cn(c,L,Q)}}}catch(Q){Cn(c,c.return,Q)}if(c===o){nt=null;break}var V=c.sibling;if(V!==null){V.return=c.return,nt=V;break}nt=c.return}}var Rh=Math.ceil,Bc=F.ReactCurrentDispatcher,Lh=F.ReactCurrentOwner,Mi=F.ReactCurrentBatchConfig,qt=0,lr=null,tr=null,vr=0,Nr=0,fa=Es(0),yn=0,Il=null,Mo=0,as=0,Ia=0,Nl=null,Wr=null,kl=0,Fl=1/0,Ti=null,To=!1,cr=null,ss=null,Hc=!1,os=null,Ul=0,Is=0,qi=null,jc=-1,Gc=0;function En(){return(qt&6)!==0?Ln():jc!==-1?jc:jc=Ln()}function Na(o){return(o.mode&1)===0?1:(qt&2)!==0&&vr!==0?vr&-vr:Mg.transition!==null?(Gc===0&&(Gc=Nu()),Gc):(o=Kt,o!==0||(o=window.event,o=o===void 0?16:lf(o.type)),o)}function li(o,c,d,v){if(50<Is)throw Is=0,qi=null,Error(P(185));Ys(o,d,v),((qt&2)===0||o!==lr)&&(o===lr&&((qt&2)===0&&(as|=d),yn===4&&ls(o,vr)),Xr(o,v),d===1&&qt===0&&(c.mode&1)===0&&(Fl=Ln()+500,Wn&&ha()))}function Xr(o,c){var d=o.callbackNode;bd(o,c);var v=$o(o,o===lr?vr:0);if(v===0)d!==null&&pd(d),o.callbackNode=null,o.callbackPriority=0;else if(c=v&-v,o.callbackPriority!==c){if(d!=null&&pd(d),c===1)o.tag===0?Ta(dm.bind(null,o)):Hd(dm.bind(null,o)),Tf(function(){(qt&6)===0&&ha()}),d=null;else{switch(Uu(v)){case 1:d=Qo;break;case 4:d=Ou;break;case 16:d=Zo;break;case 536870912:d=Iu;break;default:d=Zo}d=Nh(d,Ph.bind(null,o))}o.callbackPriority=c,o.callbackNode=d}}function Ph(o,c){if(jc=-1,Gc=0,(qt&6)!==0)throw Error(P(327));var d=o.callbackNode;if(ka()&&o.callbackNode!==d)return null;var v=$o(o,o===lr?vr:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||c)c=Hl(o,v);else{c=v;var S=qt;qt|=2;var M=Vc();(lr!==o||vr!==c)&&(Ti=null,Fl=Ln()+500,Eo(o,c));do try{yp();break}catch(V){Ei(o,V)}while(!0);bi(),Bc.current=M,qt=S,tr!==null?c=0:(lr=null,vr=0,c=yn)}if(c!==0){if(c===2&&(S=fc(o),S!==0&&(v=S,c=zl(o,S))),c===1)throw d=Il,Eo(o,0),ls(o,v),Xr(o,Ln()),d;if(c===6)ls(o,v);else{if(S=o.current.alternate,(v&30)===0&&!mp(S)&&(c=Hl(o,v),c===2&&(M=fc(o),M!==0&&(v=M,c=zl(o,M))),c===1))throw d=Il,Eo(o,0),ls(o,v),Xr(o,Ln()),d;switch(o.finishedWork=S,o.finishedLanes=v,c){case 0:case 1:throw Error(P(345));case 2:Ns(o,Wr,Ti);break;case 3:if(ls(o,v),(v&130023424)===v&&(c=kl+500-Ln(),10<c)){if($o(o,0)!==0)break;if(S=o.suspendedLanes,(S&v)!==v){En(),o.pingedLanes|=o.suspendedLanes&S;break}o.timeoutHandle=ca(Ns.bind(null,o,Wr,Ti),c);break}Ns(o,Wr,Ti);break;case 4:if(ls(o,v),(v&4194240)===v)break;for(c=o.eventTimes,S=-1;0<v;){var L=31-pi(v);M=1<<L,L=c[L],L>S&&(S=L),v&=~M}if(v=S,v=Ln()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*Rh(v/1960))-v,10<v){o.timeoutHandle=ca(Ns.bind(null,o,Wr,Ti),v);break}Ns(o,Wr,Ti);break;case 5:Ns(o,Wr,Ti);break;default:throw Error(P(329))}}}return Xr(o,Ln()),o.callbackNode===d?Ph.bind(null,o):null}function zl(o,c){var d=Nl;return o.current.memoizedState.isDehydrated&&(Eo(o,c).flags|=256),o=Hl(o,c),o!==2&&(c=Wr,Wr=d,c!==null&&Bl(c)),o}function Bl(o){Wr===null?Wr=o:Wr.push.apply(Wr,o)}function mp(o){for(var c=o;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var v=0;v<d.length;v++){var S=d[v],M=S.getSnapshot;S=S.value;try{if(!Ar(M(),S))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ls(o,c){for(c&=~Ia,c&=~as,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var d=31-pi(c),v=1<<d;o[d]=-1,c&=~v}}function dm(o){if((qt&6)!==0)throw Error(P(327));ka();var c=$o(o,0);if((c&1)===0)return Xr(o,Ln()),null;var d=Hl(o,c);if(o.tag!==0&&d===2){var v=fc(o);v!==0&&(c=v,d=zl(o,v))}if(d===1)throw d=Il,Eo(o,0),ls(o,c),Xr(o,Ln()),d;if(d===6)throw Error(P(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,Ns(o,Wr,Ti),Xr(o,Ln()),null}function gp(o,c){var d=qt;qt|=1;try{return o(c)}finally{qt=d,qt===0&&(Fl=Ln()+500,Wn&&ha())}}function cs(o){os!==null&&os.tag===0&&(qt&6)===0&&ka();var c=qt;qt|=1;var d=Mi.transition,v=Kt;try{if(Mi.transition=null,Kt=1,o)return o()}finally{Kt=v,Mi.transition=d,qt=c,(qt&6)===0&&ha()}}function vp(){Nr=fa.current,Tn(fa)}function Eo(o,c){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==-1&&(o.timeoutHandle=-1,ul(d)),tr!==null)for(d=tr.return;d!==null;){var v=d;switch(ml(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&sh();break;case 3:_l(),Tn(Lr),Tn(Rr),Yd();break;case 5:Xd(v);break;case 4:_l();break;case 13:Tn(On);break;case 19:Tn(On);break;case 10:vl(v.type._context);break;case 22:case 23:vp()}d=d.return}if(lr=o,tr=o=Ai(o.current,null),vr=Nr=c,yn=0,Il=null,Ia=as=Mo=0,Wr=Nl=null,yo!==null){for(c=0;c<yo.length;c++)if(d=yo[c],v=d.interleaved,v!==null){d.interleaved=null;var S=v.next,M=d.pending;if(M!==null){var L=M.next;M.next=S,v.next=L}d.pending=v}yo=null}return o}function Ei(o,c){do{var d=tr;try{if(bi(),ph.current=vh,kc){for(var v=Pn.memoizedState;v!==null;){var S=v.queue;S!==null&&(S.pending=null),v=v.next}kc=!1}if(Ps=0,or=$n=Pn=null,wl=!1,Ml=0,Lh.current=null,d===null||d.return===null){yn=1,Il=c,tr=null;break}e:{var M=o,L=d.return,V=d,Q=c;if(c=vr,V.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var fe=Q,Le=V,Pe=Le.tag;if((Le.mode&1)===0&&(Pe===0||Pe===11||Pe===15)){var Ee=Le.alternate;Ee?(Le.updateQueue=Ee.updateQueue,Le.memoizedState=Ee.memoizedState,Le.lanes=Ee.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var Xe=rp(L);if(Xe!==null){Xe.flags&=-257,Jf(Xe,L,V,M,c),Xe.mode&1&&np(M,fe,c),c=Xe,Q=fe;var Qe=c.updateQueue;if(Qe===null){var tt=new Set;tt.add(Q),c.updateQueue=tt}else Qe.add(Q);break e}else{if((c&1)===0){np(M,fe,c),Ch();break e}Q=Error(P(426))}}else if(Dt&&V.mode&1){var xn=rp(L);if(xn!==null){(xn.flags&65536)===0&&(xn.flags|=256),Jf(xn,L,V,M,c),Dc(So(Q,V));break e}}M=Q=So(Q,V),yn!==4&&(yn=2),Nl===null?Nl=[M]:Nl.push(M),M=L;do{switch(M.tag){case 3:M.flags|=65536,c&=-c,M.lanes|=c;var ae=Kf(M,Q,c);bo(M,ae);break e;case 1:V=Q;var Z=M.type,ue=M.stateNode;if((M.flags&128)===0&&(typeof Z.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(ss===null||!ss.has(ue)))){M.flags|=65536,c&=-c,M.lanes|=c;var ke=Al(M,V,c);bo(M,ke);break e}}M=M.return}while(M!==null)}Ih(d)}catch(rt){c=rt,tr===d&&d!==null&&(tr=d=d.return);continue}break}while(!0)}function Vc(){var o=Bc.current;return Bc.current=vh,o===null?vh:o}function Ch(){(yn===0||yn===3||yn===2)&&(yn=4),lr===null||(Mo&268435455)===0&&(as&268435455)===0||ls(lr,vr)}function Hl(o,c){var d=qt;qt|=2;var v=Vc();(lr!==o||vr!==c)&&(Ti=null,Eo(o,c));do try{Dh();break}catch(S){Ei(o,S)}while(!0);if(bi(),qt=d,Bc.current=v,tr!==null)throw Error(P(261));return lr=null,vr=0,yn}function Dh(){for(;tr!==null;)Oh(tr)}function yp(){for(;tr!==null&&!sf();)Oh(tr)}function Oh(o){var c=Xc(o.alternate,o,Nr);o.memoizedProps=o.pendingProps,c===null?Ih(o):tr=c,Lh.current=null}function Ih(o){var c=o;do{var d=c.alternate;if(o=c.return,(c.flags&32768)===0){if(d=Cr(d,c,Nr),d!==null){tr=d;return}}else{if(d=Ig(d,c),d!==null){d.flags&=32767,tr=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{yn=6,tr=null;return}}if(c=c.sibling,c!==null){tr=c;return}tr=c=o}while(c!==null);yn===0&&(yn=5)}function Ns(o,c,d){var v=Kt,S=Mi.transition;try{Mi.transition=null,Kt=1,pm(o,c,d,v)}finally{Mi.transition=S,Kt=v}return null}function pm(o,c,d,v){do ka();while(os!==null);if((qt&6)!==0)throw Error(P(327));d=o.finishedWork;var S=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(P(177));o.callbackNode=null,o.callbackPriority=0;var M=d.lanes|d.childLanes;if(ku(o,M),o===lr&&(tr=lr=null,vr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Hc||(Hc=!0,Nh(Zo,function(){return ka(),null})),M=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||M){M=Mi.transition,Mi.transition=null;var L=Kt;Kt=1;var V=qt;qt|=4,Lh.current=null,Th(o,d),Ol(d,o),$u(la),tl=!!gi,la=gi=null,o.current=d,hm(d),Cu(),qt=V,Kt=L,Mi.transition=M}else o.current=d;if(Hc&&(Hc=!1,os=o,Ul=S),M=o.pendingLanes,M===0&&(ss=null),md(d.stateNode),Xr(o,Ln()),c!==null)for(v=o.onRecoverableError,d=0;d<c.length;d++)S=c[d],v(S.value,{componentStack:S.stack,digest:S.digest});if(To)throw To=!1,o=cr,cr=null,o;return(Ul&1)!==0&&o.tag!==0&&ka(),M=o.pendingLanes,(M&1)!==0?o===qi?Is++:(Is=0,qi=o):Is=0,ha(),null}function ka(){if(os!==null){var o=Uu(Ul),c=Mi.transition,d=Kt;try{if(Mi.transition=null,Kt=16>o?16:o,os===null)var v=!1;else{if(o=os,os=null,Ul=0,(qt&6)!==0)throw Error(P(331));var S=qt;for(qt|=4,nt=o.current;nt!==null;){var M=nt,L=M.child;if((nt.flags&16)!==0){var V=M.deletions;if(V!==null){for(var Q=0;Q<V.length;Q++){var fe=V[Q];for(nt=fe;nt!==null;){var Le=nt;switch(Le.tag){case 0:case 11:case 15:Cs(8,Le,M)}var Pe=Le.child;if(Pe!==null)Pe.return=Le,nt=Pe;else for(;nt!==null;){Le=nt;var Ee=Le.sibling,Xe=Le.return;if(Dr(Le),Le===fe){nt=null;break}if(Ee!==null){Ee.return=Xe,nt=Ee;break}nt=Xe}}}var Qe=M.alternate;if(Qe!==null){var tt=Qe.child;if(tt!==null){Qe.child=null;do{var xn=tt.sibling;tt.sibling=null,tt=xn}while(tt!==null)}}nt=M}}if((M.subtreeFlags&2064)!==0&&L!==null)L.return=M,nt=L;else e:for(;nt!==null;){if(M=nt,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:Cs(9,M,M.return)}var ae=M.sibling;if(ae!==null){ae.return=M.return,nt=ae;break e}nt=M.return}}var Z=o.current;for(nt=Z;nt!==null;){L=nt;var ue=L.child;if((L.subtreeFlags&2064)!==0&&ue!==null)ue.return=L,nt=ue;else e:for(L=Z;nt!==null;){if(V=nt,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:Oa(9,V)}}catch(rt){Cn(V,V.return,rt)}if(V===L){nt=null;break e}var ke=V.sibling;if(ke!==null){ke.return=V.return,nt=ke;break e}nt=V.return}}if(qt=S,ha(),Ii&&typeof Ii.onPostCommitFiberRoot=="function")try{Ii.onPostCommitFiberRoot(pc,o)}catch{}v=!0}return v}finally{Kt=d,Mi.transition=c}}return!1}function jl(o,c,d){c=So(d,c),c=Kf(o,c,1),o=Pa(o,c,1),c=En(),o!==null&&(Ys(o,1,c),Xr(o,c))}function Cn(o,c,d){if(o.tag===3)jl(o,o,d);else for(;c!==null;){if(c.tag===3){jl(c,o,d);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(ss===null||!ss.has(v))){o=So(d,o),o=Al(c,o,1),c=Pa(c,o,1),o=En(),c!==null&&(Ys(c,1,o),Xr(c,o));break}}c=c.return}}function fm(o,c,d){var v=o.pingCache;v!==null&&v.delete(c),c=En(),o.pingedLanes|=o.suspendedLanes&d,lr===o&&(vr&d)===d&&(yn===4||yn===3&&(vr&130023424)===vr&&500>Ln()-kl?Eo(o,0):Ia|=d),Xr(o,c)}function Wc(o,c){c===0&&((o.mode&1)===0?c=1:(c=Jo,Jo<<=1,(Jo&130023424)===0&&(Jo=4194304)));var d=En();o=Pr(o,c),o!==null&&(Ys(o,c,d),Xr(o,d))}function mm(o){var c=o.memoizedState,d=0;c!==null&&(d=c.retryLane),Wc(o,d)}function xp(o,c){var d=0;switch(o.tag){case 13:var v=o.stateNode,S=o.memoizedState;S!==null&&(d=S.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(P(314))}v!==null&&v.delete(c),Wc(o,d)}var Xc;Xc=function(o,c,d){if(o!==null)if(o.memoizedProps!==c.pendingProps||Lr.current)si=!0;else{if((o.lanes&d)===0&&(c.flags&128)===0)return si=!1,Og(o,c,d);si=(o.flags&131072)!==0}else si=!1,Dt&&(c.flags&1048576)!==0&&Pc(c,Rs,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;_o(o,c),o=c.pendingProps;var S=He(c,Rr.current);yl(c,d),S=Qn(null,c,v,o,S,d);var M=Tl();return c.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ri(v)?(M=!0,ts(c)):M=!1,c.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,xo(c),S.updater=yh,c.stateNode=S,S._reactInternals=c,El(c,v,o,d),c=lp(null,c,v,!0,M,d)):(c.tag=0,Dt&&M&&ht(c),Vr(null,c,S,d),c=c.child),c;case 16:v=c.elementType;e:{switch(_o(o,c),o=c.pendingProps,S=v._init,v=S(v._payload),c.type=v,S=c.tag=Gl(v),o=da(v,o),S){case 0:c=op(null,c,v,o,d);break e;case 1:c=nm(null,c,v,o,d);break e;case 11:c=ap(null,c,v,o,d);break e;case 14:c=$f(null,c,v,da(v.type,o),d);break e}throw Error(P(306,v,""))}return c;case 0:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:da(v,S),op(o,c,v,S,d);case 1:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:da(v,S),nm(o,c,v,S,d);case 3:e:{if(rm(c),o===null)throw Error(P(387));v=c.pendingProps,M=c.memoizedState,S=M.element,uh(o,c),Nc(c,v,null,d);var L=c.memoizedState;if(v=L.element,M.isDehydrated)if(M={element:v,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},c.updateQueue.baseState=M,c.memoizedState=M,c.flags&256){S=So(Error(P(423)),c),c=im(o,c,v,d,S);break e}else if(v!==S){S=So(Error(P(424)),c),c=im(o,c,v,d,S);break e}else for(gr=Ma(c.stateNode.containerInfo.firstChild),Xn=c,Dt=!0,ji=null,d=jd(c,null,v,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(go(),v===S){c=pa(o,c,d);break e}Vr(o,c,v,d)}c=c.child}return c;case 5:return Af(c),o===null&&vn(c),v=c.type,S=c.pendingProps,M=o!==null?o.memoizedProps:null,L=S.children,Rc(v,S)?L=null:M!==null&&Rc(v,M)&&(c.flags|=32),tm(o,c),Vr(o,c,L,d),c.child;case 6:return o===null&&vn(c),null;case 13:return am(o,c,d);case 4:return Wd(c,c.stateNode.containerInfo),v=c.pendingProps,o===null?c.child=Ra(c,null,v,d):Vr(o,c,v,d),c.child;case 11:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:da(v,S),ap(o,c,v,S,d);case 7:return Vr(o,c,c.pendingProps,d),c.child;case 8:return Vr(o,c,c.pendingProps.children,d),c.child;case 12:return Vr(o,c,c.pendingProps.children,d),c.child;case 10:e:{if(v=c.type._context,S=c.pendingProps,M=c.memoizedProps,L=S.value,gn(ch,v._currentValue),v._currentValue=L,M!==null)if(Ar(M.value,L)){if(M.children===S.children&&!Lr.current){c=pa(o,c,d);break e}}else for(M=c.child,M!==null&&(M.return=c);M!==null;){var V=M.dependencies;if(V!==null){L=M.child;for(var Q=V.firstContext;Q!==null;){if(Q.context===v){if(M.tag===1){Q=La(-1,d&-d),Q.tag=2;var fe=M.updateQueue;if(fe!==null){fe=fe.shared;var Le=fe.pending;Le===null?Q.next=Q:(Q.next=Le.next,Le.next=Q),fe.pending=Q}}M.lanes|=d,Q=M.alternate,Q!==null&&(Q.lanes|=d),Gd(M.return,d,c),V.lanes|=d;break}Q=Q.next}}else if(M.tag===10)L=M.type===c.type?null:M.child;else if(M.tag===18){if(L=M.return,L===null)throw Error(P(341));L.lanes|=d,V=L.alternate,V!==null&&(V.lanes|=d),Gd(L,d,c),L=M.sibling}else L=M.child;if(L!==null)L.return=M;else for(L=M;L!==null;){if(L===c){L=null;break}if(M=L.sibling,M!==null){M.return=L.return,L=M;break}L=L.return}M=L}Vr(o,c,S.children,d),c=c.child}return c;case 9:return S=c.type,v=c.pendingProps.children,yl(c,d),S=Wi(S),v=v(S),c.flags|=1,Vr(o,c,v,d),c.child;case 14:return v=c.type,S=da(v,c.pendingProps),S=da(v.type,S),$f(o,c,v,S,d);case 15:return sp(o,c,c.type,c.pendingProps,d);case 17:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:da(v,S),_o(o,c),c.tag=1,ri(v)?(o=!0,ts(c)):o=!1,yl(c,d),ep(c,v,S),El(c,v,S,d),lp(null,c,v,!0,o,d);case 19:return om(o,c,d);case 22:return em(o,c,d)}throw Error(P(156,c.tag))};function Nh(o,c){return dd(o,c)}function gm(o,c,d,v){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(o,c,d,v){return new gm(o,c,d,v)}function us(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Gl(o){if(typeof o=="function")return us(o)?1:0;if(o!=null){if(o=o.$$typeof,o===Un)return 11;if(o===Kr)return 14}return 2}function Ai(o,c){var d=o.alternate;return d===null?(d=kr(o.tag,c,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=c,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,c=o.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function ma(o,c,d,v,S,M){var L=2;if(v=o,typeof o=="function")us(o)&&(L=1);else if(typeof o=="string")L=5;else e:switch(o){case Be:return Yi(d.children,S,M,c);case We:L=8,S|=8;break;case ct:return o=kr(12,d,c,S|2),o.elementType=ct,o.lanes=M,o;case jn:return o=kr(13,d,c,S),o.elementType=jn,o.lanes=M,o;case pr:return o=kr(19,d,c,S),o.elementType=pr,o.lanes=M,o;case Dn:return Ri(d,S,M,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case it:L=10;break e;case Nt:L=9;break e;case Un:L=11;break e;case Kr:L=14;break e;case Zn:L=16,v=null;break e}throw Error(P(130,o==null?o:typeof o,""))}return c=kr(L,d,c,S),c.elementType=o,c.type=v,c.lanes=M,c}function Yi(o,c,d,v){return o=kr(7,o,v,c),o.lanes=d,o}function Ri(o,c,d,v){return o=kr(22,o,v,c),o.elementType=Dn,o.lanes=d,o.stateNode={isHidden:!1},o}function ks(o,c,d){return o=kr(6,o,null,c),o.lanes=d,o}function Vl(o,c,d){return c=kr(4,o.children!==null?o.children:[],o.key,c),c.lanes=d,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function kh(o,c,d,v,S){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mc(0),this.expirationTimes=mc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mc(0),this.identifierPrefix=v,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function qc(o,c,d,v,S,M,L,V,Q){return o=new kh(o,c,d,V,Q),c===1?(c=1,M===!0&&(c|=8)):c=0,M=kr(3,null,null,c),o.current=M,M.stateNode=o,M.memoizedState={element:v,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},xo(M),o}function Fh(o,c,d){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Se,key:v==null?null:""+v,children:o,containerInfo:c,implementation:d}}function Uh(o){if(!o)return ua;o=o._reactInternals;e:{if(bs(o)!==o||o.tag!==1)throw Error(P(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(ri(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(P(171))}if(o.tag===1){var d=o.type;if(ri(d))return oh(o,d,c)}return c}function Fa(o,c,d,v,S,M,L,V,Q){return o=qc(d,v,!0,o,S,M,L,V,Q),o.context=Uh(null),d=o.current,v=En(),S=Na(d),M=La(v,S),M.callback=c??null,Pa(d,M,S),o.current.lanes=S,Ys(o,S,v),Xr(o,v),o}function zh(o,c,d,v){var S=c.current,M=En(),L=Na(S);return d=Uh(d),c.context===null?c.context=d:c.pendingContext=d,c=La(M,L),c.payload={element:o},v=v===void 0?null:v,v!==null&&(c.callback=v),o=Pa(S,c,L),o!==null&&(li(o,S,L,M),Ca(o,S,L)),L}function Yc(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Fs(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<c?d:c}}function Ao(o,c){Fs(o,c),(o=o.alternate)&&Fs(o,c)}function kg(){return null}var vm=typeof reportError=="function"?reportError:function(o){console.error(o)};function bp(o){this._internalRoot=o}Bh.prototype.render=bp.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(P(409));zh(o,c,null,null)},Bh.prototype.unmount=bp.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;cs(function(){zh(null,o,null,null)}),c[sr]=null}};function Bh(o){this._internalRoot=o}Bh.prototype.unstable_scheduleHydration=function(o){if(o){var c=_d();o={blockedOn:null,target:o,priority:c};for(var d=0;d<qa.length&&c!==0&&c<qa[d].priority;d++);qa.splice(d,0,o),d===0&&ki(o)}};function Sp(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Hh(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function ym(){}function _p(o,c,d,v,S){if(S){if(typeof v=="function"){var M=v;v=function(){var fe=Yc(L);M.call(fe)}}var L=Fa(c,v,o,0,null,!1,!1,"",ym);return o._reactRootContainer=L,o[sr]=L.current,_a(o.nodeType===8?o.parentNode:o),cs(),L}for(;S=o.lastChild;)o.removeChild(S);if(typeof v=="function"){var V=v;v=function(){var fe=Yc(Q);V.call(fe)}}var Q=qc(o,0,!1,null,null,!1,!1,"",ym);return o._reactRootContainer=Q,o[sr]=Q.current,_a(o.nodeType===8?o.parentNode:o),cs(function(){zh(c,Q,d,v)}),Q}function jh(o,c,d,v,S){var M=d._reactRootContainer;if(M){var L=M;if(typeof S=="function"){var V=S;S=function(){var Q=Yc(L);V.call(Q)}}zh(c,L,o,S)}else L=_p(d,c,o,S,v);return Yc(L)}zu=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var d=qs(c.pendingLanes);d!==0&&(Fu(c,d|1),Xr(c,Ln()),(qt&6)===0&&(Fl=Ln()+500,ha()))}break;case 13:cs(function(){var v=Pr(o,1);if(v!==null){var S=En();li(v,o,1,S)}}),Ao(o,1)}},Bu=function(o){if(o.tag===13){var c=Pr(o,134217728);if(c!==null){var d=En();li(c,o,134217728,d)}Ao(o,134217728)}},Sd=function(o){if(o.tag===13){var c=Na(o),d=Pr(o,c);if(d!==null){var v=En();li(d,o,c,v)}Ao(o,c)}},_d=function(){return Kt},Qs=function(o,c){var d=Kt;try{return Kt=o,c()}finally{Kt=d}},ld=function(o,c,d){switch(c){case"input":if(oc(o,d),c=d.name,d.type==="radio"&&c!=null){for(d=o;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var v=d[c];if(v!==o&&v.form===o.form){var S=ho(v);if(!S)throw Error(P(90));Au(v),oc(v,S)}}}break;case"textarea":ad(o,d);break;case"select":c=d.value,c!=null&&Vs(o,!!d.multiple,c,!1)}},Oi=gp,rf=cs;var Wl={usingClientEntryPoint:!1,Events:[mr,Mn,ho,hc,nf,gp]},Qc={findFiberByHostInstance:Bn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},In={bundleType:Qc.bundleType,version:Qc.version,rendererPackageName:Qc.rendererPackageName,rendererConfig:Qc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Pu(o),o===null?null:o.stateNode},findFiberByHostInstance:Qc.findFiberByHostInstance||kg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ro=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ro.isDisabled&&Ro.supportsFiber)try{pc=Ro.inject(In),Ii=Ro}catch{}}return ta.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wl,ta.createPortal=function(o,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sp(c))throw Error(P(200));return Fh(o,c,null,d)},ta.createRoot=function(o,c){if(!Sp(o))throw Error(P(299));var d=!1,v="",S=vm;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),c=qc(o,1,!1,null,null,d,!1,v,S),o[sr]=c.current,_a(o.nodeType===8?o.parentNode:o),new bp(c)},ta.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(P(188)):(o=Object.keys(o).join(","),Error(P(268,o)));return o=Pu(c),o=o===null?null:o.stateNode,o},ta.flushSync=function(o){return cs(o)},ta.hydrate=function(o,c,d){if(!Hh(c))throw Error(P(200));return jh(null,o,c,!0,d)},ta.hydrateRoot=function(o,c,d){if(!Sp(o))throw Error(P(405));var v=d!=null&&d.hydratedSources||null,S=!1,M="",L=vm;if(d!=null&&(d.unstable_strictMode===!0&&(S=!0),d.identifierPrefix!==void 0&&(M=d.identifierPrefix),d.onRecoverableError!==void 0&&(L=d.onRecoverableError)),c=Fa(c,null,o,1,d??null,S,!1,M,L),o[sr]=c.current,_a(o),v)for(o=0;o<v.length;o++)d=v[o],S=d._getVersion,S=S(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,S]:c.mutableSourceEagerHydrationData.push(d,S);return new Bh(c)},ta.render=function(o,c,d){if(!Hh(c))throw Error(P(200));return jh(null,o,c,!1,d)},ta.unmountComponentAtNode=function(o){if(!Hh(o))throw Error(P(40));return o._reactRootContainer?(cs(function(){jh(null,null,o,!1,function(){o._reactRootContainer=null,o[sr]=null})}),!0):!1},ta.unstable_batchedUpdates=gp,ta.unstable_renderSubtreeIntoContainer=function(o,c,d,v){if(!Hh(d))throw Error(P(200));if(o==null||o._reactInternals===void 0)throw Error(P(38));return jh(o,c,d,!1,v)},ta.version="18.3.1-next-f1338f8080-20240426",ta}var zx;function KT(){if(zx)return sv.exports;zx=1;function ee(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ee)}catch(z){console.error(z)}}return ee(),sv.exports=ZT(),sv.exports}var Bx;function JT(){if(Bx)return sg;Bx=1;var ee=KT();return sg.createRoot=ee.createRoot,sg.hydrateRoot=ee.hydrateRoot,sg}var $T=JT();const e3=lb($T);/*! For license information please see xviewer.module.min.js.LICENSE.txt */var t3={631:(ee,z,P)=>{P.r(z),P.d(z,{TweenChain:()=>ve});const $=P(622);class ve{constructor(Ze){this._object=Ze,this._tween=new $.Tween(Ze)}start(){return this._tween.start(),this}stop(){return this._tween.stop(),this}repeat(Ze){return this._chainedTween.repeat(Ze),this}union(){return this._chainedTween=this._tween=new $.Tween(this._object).union(this._tween,this._chainedTween),this}call(Ze){return this._chainTween().call(Ze),this}delay(Ze){return this._chainTween().delay(Ze),this}to(Ze,at,Ke){let vt=this._chainTween().to(Ze,at);return Ke&&(Ke.from&&vt.from(Ke.from),Ke.easing&&vt.easing(Ke.easing),Ke.onStart&&vt.onStart(Ke.onStart),Ke.onStop&&vt.onStop(Ke.onStop),Ke.onComplete&&vt.onComplete(Ke.onComplete),Ke.onUpdate&&vt.onUpdate(Ke.onUpdate),Ke.onRepeat&&vt.onRepeat(Ke.onRepeat)),this}_chainTween(){let Ze=this._tween;return this._chainedTween&&(Ze=new $.Tween(this._object),this._chainedTween.chain(Ze)),this._chainedTween=Ze,Ze}}},622:(ee,z)=>{Object.defineProperty(z,"__esModule",{value:!0});var P,$={Linear:{None:function(F){return F}},Quadratic:{In:function(F){return F*F},Out:function(F){return F*(2-F)},InOut:function(F){return(F*=2)<1?.5*F*F:-.5*(--F*(F-2)-1)}},Cubic:{In:function(F){return F*F*F},Out:function(F){return--F*F*F+1},InOut:function(F){return(F*=2)<1?.5*F*F*F:.5*((F-=2)*F*F+2)}},Quartic:{In:function(F){return F*F*F*F},Out:function(F){return 1- --F*F*F*F},InOut:function(F){return(F*=2)<1?.5*F*F*F*F:-.5*((F-=2)*F*F*F-2)}},Quintic:{In:function(F){return F*F*F*F*F},Out:function(F){return--F*F*F*F*F+1},InOut:function(F){return(F*=2)<1?.5*F*F*F*F*F:.5*((F-=2)*F*F*F*F+2)}},Sinusoidal:{In:function(F){return 1-Math.cos(F*Math.PI/2)},Out:function(F){return Math.sin(F*Math.PI/2)},InOut:function(F){return .5*(1-Math.cos(Math.PI*F))}},Exponential:{In:function(F){return F===0?0:Math.pow(1024,F-1)},Out:function(F){return F===1?1:1-Math.pow(2,-10*F)},InOut:function(F){return F===0?0:F===1?1:(F*=2)<1?.5*Math.pow(1024,F-1):.5*(2-Math.pow(2,-10*(F-1)))}},Circular:{In:function(F){return 1-Math.sqrt(1-F*F)},Out:function(F){return Math.sqrt(1- --F*F)},InOut:function(F){return(F*=2)<1?-.5*(Math.sqrt(1-F*F)-1):.5*(Math.sqrt(1-(F-=2)*F)+1)}},Elastic:{In:function(F){return F===0?0:F===1?1:-Math.pow(2,10*(F-1))*Math.sin(5*(F-1.1)*Math.PI)},Out:function(F){return F===0?0:F===1?1:Math.pow(2,-10*F)*Math.sin(5*(F-.1)*Math.PI)+1},InOut:function(F){return F===0?0:F===1?1:(F*=2)<1?-.5*Math.pow(2,10*(F-1))*Math.sin(5*(F-1.1)*Math.PI):.5*Math.pow(2,-10*(F-1))*Math.sin(5*(F-1.1)*Math.PI)+1}},Back:{In:function(F){var he=1.70158;return F*F*((he+1)*F-he)},Out:function(F){var he=1.70158;return--F*F*((he+1)*F+he)+1},InOut:function(F){var he=2.5949095;return(F*=2)<1?F*F*((he+1)*F-he)*.5:.5*((F-=2)*F*((he+1)*F+he)+2)}},Bounce:{In:function(F){return 1-$.Bounce.Out(1-F)},Out:function(F){return F<1/2.75?7.5625*F*F:F<2/2.75?7.5625*(F-=1.5/2.75)*F+.75:F<2.5/2.75?7.5625*(F-=2.25/2.75)*F+.9375:7.5625*(F-=2.625/2.75)*F+.984375},InOut:function(F){return F<.5?.5*$.Bounce.In(2*F):.5*$.Bounce.Out(2*F-1)+.5}}};function ve(){return .001*P()}P=typeof self>"u"&&typeof process<"u"&&process.hrtime?function(){var F=process.hrtime();return 1e3*F[0]+F[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?self.performance.now.bind(self.performance):Date.now!==void 0?Date.now:function(){return new Date().getTime()};var ze,Ze=(function(){function F(){this._tweens={},this._tweensAddedDuringUpdate={}}return F.prototype.getAll=function(){var he=this;return Object.keys(this._tweens).map((function(Se){return he._tweens[Se]}))},F.prototype.removeAll=function(){this._tweens={}},F.prototype.add=function(he){this._tweens[he.getId()]=he,this._tweensAddedDuringUpdate[he.getId()]=he},F.prototype.remove=function(he){delete this._tweens[he.getId()],delete this._tweensAddedDuringUpdate[he.getId()]},F.prototype.update=function(he,Se){he===void 0&&(he=ve()),Se===void 0&&(Se=!1);var Be=Object.keys(this._tweens);if(Be.length===0)return!1;for(;Be.length>0;){this._tweensAddedDuringUpdate={};for(var We=0;We<Be.length;We++){var ct=this._tweens[Be[We]],it=!Se;ct&&ct.update(he,it)===!1&&!Se&&delete this._tweens[Be[We]]}Be=Object.keys(this._tweensAddedDuringUpdate)}return!0},F})(),at={Linear:function(F,he){var Se=F.length-1,Be=Se*he,We=Math.floor(Be),ct=at.Utils.Linear;return he<0?ct(F[0],F[1],Be):he>1?ct(F[Se],F[Se-1],Se-Be):ct(F[We],F[We+1>Se?Se:We+1],Be-We)},Bezier:function(F,he){for(var Se=0,Be=F.length-1,We=Math.pow,ct=at.Utils.Bernstein,it=0;it<=Be;it++)Se+=We(1-he,Be-it)*We(he,it)*F[it]*ct(Be,it);return Se},CatmullRom:function(F,he){var Se=F.length-1,Be=Se*he,We=Math.floor(Be),ct=at.Utils.CatmullRom;return F[0]===F[Se]?(he<0&&(We=Math.floor(Be=Se*(1+he))),ct(F[(We-1+Se)%Se],F[We],F[(We+1)%Se],F[(We+2)%Se],Be-We)):he<0?F[0]-(ct(F[0],F[0],F[1],F[1],-Be)-F[0]):he>1?F[Se]-(ct(F[Se],F[Se],F[Se-1],F[Se-1],Be-Se)-F[Se]):ct(F[We?We-1:0],F[We],F[Se<We+1?Se:We+1],F[Se<We+2?Se:We+2],Be-We)},Utils:{Linear:function(F,he,Se){return(he-F)*Se+F},Bernstein:function(F,he){var Se=at.Utils.Factorial;return Se(F)/Se(he)/Se(F-he)},Factorial:(ze=[1],function(F){var he=1;if(ze[F])return ze[F];for(var Se=F;Se>1;Se--)he*=Se;return ze[F]=he,he}),CatmullRom:function(F,he,Se,Be,We){var ct=.5*(Se-F),it=.5*(Be-he),Nt=We*We;return(2*he-2*Se+ct+it)*(We*Nt)+(-3*he+3*Se-2*ct-it)*Nt+ct*We+he}}},Ke=(function(){function F(){}return F.nextId=function(){return F._nextId++},F._nextId=0,F})(),vt=new Ze,Zt=(function(){function F(he,Se){Se===void 0&&(Se=vt),this._object=he,this._group=Se,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=0,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=$.Linear.None,this._interpolationFunction=at.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Ke.nextId(),this._isChainStopped=!1,this._goToEnd=!1,this._headTween=null,this._tailTween=null,this._headStart=!1}return F.prototype.getId=function(){return this._id},F.prototype.isPlaying=function(){return this._isPlaying},F.prototype.isPaused=function(){return this._isPaused},F.prototype.duration=function(he){return this._duration=he,this},F.prototype.start=function(he){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var Se in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(Se),this._valuesStart[Se]=this._valuesStartRepeat[Se];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=he!==void 0?typeof he=="string"?ve()+parseFloat(he):he:ve(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},F.prototype._setupProperties=function(he,Se,Be,We){for(var ct in Be){var it=he[ct],Nt=Array.isArray(it),Un=Nt?"array":typeof it,jn=!Nt&&Array.isArray(Be[ct]);if(Un!=="undefined"&&Un!=="function"){if(jn){var pr=Be[ct];if(pr.length===0)continue;pr=pr.map(this._handleRelativeValue.bind(this,it)),Be[ct]=[it].concat(pr)}if(Un!=="object"&&!Nt||!it||jn)Se[ct]===void 0&&(Se[ct]=it),Nt||(Se[ct]*=1),We[ct]=jn?Be[ct].slice().reverse():Se[ct]||0;else{for(var Kr in Se[ct]=Nt?[]:{},it)Se[ct][Kr]=it[Kr];We[ct]=Nt?[]:{},this._setupProperties(it,Se[ct],Be[ct],We[ct])}}}},F.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},F.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},F.prototype.pause=function(he){return he===void 0&&(he=ve()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=he,this._group&&this._group.remove(this)),this},F.prototype.resume=function(he){return he===void 0&&(he=ve()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=he-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},F.prototype.stopChainedTweens=function(){for(var he=0,Se=this._chainedTweens.length;he<Se;he++)this._chainedTweens[he].stop();return this._chainedTweens=[],this},F.prototype.group=function(he){return this._group=he,this},F.prototype.call=function(he){return this._onFinishCallback=he,this},F.prototype.from=function(he){return this._valuesStart=Object.create(he),this},F.prototype.to=function(he,Se){return this._valuesEnd=Object.create(he),Se!==void 0&&(this._duration=Se),this._chainedTween=this,this},F.prototype.delay=function(he){return this._delayTime=he,this},F.prototype.union=function(he,Se){return this._headTween=he,this._tailTween=Se.chain(this),this._headStart=!0,this},F.prototype.repeat=function(he){return this._initialRepeat=he,this._repeat=he,this},F.prototype.repeatDelay=function(he){return this._repeatDelayTime=he,this},F.prototype.yoyo=function(he){return this._yoyo=he,this},F.prototype.easing=function(he){return this._easingFunction=he,this},F.prototype.interpolation=function(he){return this._interpolationFunction=he,this},F.prototype.chain=function(){for(var he=[],Se=0;Se<arguments.length;Se++)he[Se]=arguments[Se];return this._chainedTweens=he,this},F.prototype.unchain=function(){for(var he=0;he<arguments.length;he++){let Se=this._chainedTweens.findIndex((Be=>Be==arguments[he]));Se>-1&&this._chainedTweens.splice(Se,1)}return this},F.prototype.onStart=function(he){return this._onStartCallback=he,this},F.prototype.onUpdate=function(he){return this._onUpdateCallback=he,this},F.prototype.onRepeat=function(he){return this._onRepeatCallback=he,this},F.prototype.onComplete=function(he){return this._onCompleteCallback=he,this},F.prototype.onStop=function(he){return this._onStopCallback=he,this},F.prototype.update=function(he,Se){if(he===void 0&&(he=ve()),Se===void 0&&(Se=!0),this._isPaused)return!0;var Be,We,ct=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(he>ct)return!1;Se&&this.start(he)}if(this._goToEnd=!1,he<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),We=(he-this._startTime)/this._duration,We=this._duration===0||We>1?1:We;var it=this._easingFunction(We);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,it),this._onUpdateCallback&&this._onUpdateCallback(this._object,We),We===1){if(this._onFinishCallback&&this._onFinishCallback(this._object),this._headTween&&this._headStart)return this._headTween.start(this._startTime+this._duration),this._headStart=!1,this._isPlaying=!1,!1;if(this._repeat>0){for(Be in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||typeof this._valuesEnd[Be]!="string"||(this._valuesStartRepeat[Be]=this._valuesStartRepeat[Be]+parseFloat(this._valuesEnd[Be])),this._yoyo&&this._swapEndStartRepeatValues(Be),this._valuesStart[Be]=this._valuesStartRepeat[Be];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=he+this._repeatDelayTime:this._startTime=he+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._headTween&&(this._headStart=!0,this._initialRepeat=this._repeat),!0}this._tailTween&&this._tailTween.unchain(this),this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var Nt=0,Un=this._chainedTweens.length;Nt<Un;Nt++)this._chainedTweens[Nt].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},F.prototype._updateProperties=function(he,Se,Be,We){for(var ct in Be)if(Se[ct]!==void 0){var it=Se[ct]||0,Nt=Be[ct],Un=Array.isArray(he[ct]),jn=Array.isArray(Nt);!Un&&jn?he[ct]=this._interpolationFunction(Nt,We):typeof Nt=="object"&&Nt?this._updateProperties(he[ct],it,Nt,We):typeof(Nt=this._handleRelativeValue(it,Nt))=="number"&&(he[ct]=it+(Nt-it)*We)}},F.prototype._handleRelativeValue=function(he,Se){return typeof Se!="string"?Se:Se.charAt(0)==="+"||Se.charAt(0)==="-"?he+parseFloat(Se):parseFloat(Se)},F.prototype._swapEndStartRepeatValues=function(he){var Se=this._valuesStartRepeat[he],Be=this._valuesEnd[he];this._valuesStartRepeat[he]=typeof Be=="string"?this._valuesStartRepeat[he]+parseFloat(Be):this._valuesEnd[he],this._valuesEnd[he]=Se},F})(),$e="18.6.4",Rt=Ke.nextId,Tt=vt,mn=Tt.getAll.bind(Tt),Ot=Tt.removeAll.bind(Tt),Lt=Tt.add.bind(Tt),rr=Tt.remove.bind(Tt),_n=Tt.update.bind(Tt),ir={Easing:$,Group:Ze,Interpolation:at,now:ve,Sequence:Ke,nextId:Rt,Tween:Zt,VERSION:$e,getAll:mn,removeAll:Ot,add:Lt,remove:rr,update:_n};z.Easing=$,z.Group=Ze,z.Interpolation=at,z.Sequence=Ke,z.Tween=Zt,z.VERSION=$e,z.add=Lt,z.default=ir,z.getAll=mn,z.nextId=Rt,z.now=ve,z.remove=rr,z.removeAll=Ot,z.update=_n}},Hx={};function Fn(ee){var z=Hx[ee];if(z!==void 0)return z.exports;var P=Hx[ee]={exports:{}};return t3[ee](P,P.exports,Fn),P.exports}Fn.d=(ee,z)=>{for(var P in z)Fn.o(z,P)&&!Fn.o(ee,P)&&Object.defineProperty(ee,P,{enumerable:!0,get:z[P]})},Fn.o=(ee,z)=>Object.prototype.hasOwnProperty.call(ee,z),Fn.r=ee=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ee,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ee,"__esModule",{value:!0})};var E={};(()=>{Fn.d(E,{J12:()=>i0,$c:()=>QS,I_b:()=>A1,oGK:()=>Nm,$p:()=>$t,$q:()=>JS,$r:()=>E1,i5S:()=>ZS,nXV:()=>T1,bd1:()=>KS,LY2:()=>lc,bGH:()=>Zn,NDo:()=>Ru,gSk:()=>Js,WMw:()=>Un,OTo:()=>af,Se2:()=>zo,cum:()=>Xu,Mig:()=>Yg,i_9:()=>Lb,m7l:()=>nu,sYA:()=>bb,Xcj:()=>Hb,mzJ:()=>Ub,ZZA:()=>vb,T__:()=>Ch,HkE:()=>Mr,tGC:()=>iS,gOo:()=>Ql,meI:()=>Zi,BbS:()=>Zg,kqm:()=>Ob,Wat:()=>Ly,Hmr:()=>Qg,SJI:()=>Em,rMl:()=>LM,mTL:()=>Hv,y8_:()=>aS,_Li:()=>Be,z81:()=>ki,_MY:()=>_n,dFZ:()=>j0,IIx:()=>Ay,N$j:()=>fa,XO3:()=>Py,_YM:()=>Jc,TUj:()=>qb,ZzF:()=>ba,GQ:()=>nS,nvb:()=>lS,DvJ:()=>Xn,fQA:()=>tS,TlE:()=>pt,u9r:()=>ut,s4_:()=>Fv,T95:()=>cd,CtF:()=>Xl,V1s:()=>Ls,Rki:()=>eS,ROQ:()=>Eo,YN5:()=>cS,BVQ:()=>Gl,YT8:()=>Ns,_DE:()=>sx,YGz:()=>od,WXy:()=>y0,max:()=>ve,trn:()=>uS,zf8:()=>Ai,uWy:()=>Gn,SUY:()=>Vv,Ilk:()=>Ne,xRS:()=>Cy,R2R:()=>Gg,epp:()=>ar,wA2:()=>en,Z_g:()=>vp,EB7:()=>cs,DqL:()=>Sb,_3:()=>hS,b_z:()=>Yi,Qrh:()=>ga,unp:()=>Ey,_am:()=>Cc,fY$:()=>Ci,vxC:()=>Di,BtG:()=>gl,cBK:()=>_b,g8_:()=>Ws,AXT:()=>Cn,yj7:()=>fm,dYG:()=>Tv,tm_:()=>Ot,S2y:()=>Lt,B02:()=>rr,PeU:()=>mn,Hyl:()=>Ei,Wqd:()=>gm,Xaj:()=>Kr,dZ3:()=>cc,m_w:()=>dS,fHI:()=>ma,LBq:()=>Xb,JUT:()=>Ju,p3g:()=>sl,IEO:()=>yn,yxD:()=>Pv,A5E:()=>Ep,jfJ:()=>Td,T_J:()=>_s,tEQ:()=>Rv,qkB:()=>xa,HWo:()=>Km,brP:()=>Ss,$YQ:()=>er,iRp:()=>bn,Ox3:()=>Sm,cBI:()=>c1,cU9:()=>Ev,ntt:()=>tl,DT1:()=>pS,Kgo:()=>ks,ehD:()=>We,fSK:()=>dn,Vdb:()=>wn,l8J:()=>yg,dj0:()=>hf,QM0:()=>vc,TOt:()=>Uh,Qmf:()=>ed,JIf:()=>js,Ny0:()=>Vc,eD:()=>jo,jwo:()=>Vu,dSO:()=>ys,Bf4:()=>Vo,USm:()=>wr,pBf:()=>Fi,vpe:()=>at,$Vf:()=>fS,O7d:()=>Pe,JE9:()=>jp,hH6:()=>Li,e62:()=>po,a$l:()=>He,OM3:()=>ri,VzW:()=>xr,ybr:()=>Cs,yo9:()=>Th,Wzm:()=>gp,zUS:()=>my,Wl3:()=>Se,iWj:()=>Ra,CoK:()=>Wm,ylh:()=>Vb,v9Y:()=>bg,LSk:()=>yc,XSA:()=>qm,w$m:()=>id,ksN:()=>oc,j4z:()=>nl,OAl:()=>uf,VLJ:()=>Jb,ZAu:()=>Cr,cLu:()=>br,vmT:()=>Cv,Qpg:()=>Kb,So8:()=>Rb,Wjw:()=>mS,cJO:()=>Xe,QRU:()=>Bv,uSM:()=>ky,S3k:()=>wp,fnl:()=>AM,PpQ:()=>io,ZRs:()=>ju,oqc:()=>lf,UT1:()=>Q0,KQe:()=>K0,s28:()=>Z0,uEm:()=>q0,b08:()=>X0,yPR:()=>_u,ph9:()=>Gs,llF:()=>W0,EIF:()=>Y0,lb7:()=>Ia,L5s:()=>Mm,$TI:()=>Zv,SPe:()=>To,aVm:()=>gn,j87:()=>Rr,RNb:()=>fl,Kz5:()=>Yo,vpT:()=>Ds,kB5:()=>Or,_C8:()=>Gh,Syv:()=>Qs,NMF:()=>Xa,pIN:()=>Zs,eMJ:()=>Ed,x5V:()=>Hu,tUh:()=>hs,z8B:()=>Lh,GZb:()=>gS,p7y:()=>us,S9g:()=>cn,Zr5:()=>Bo,vCF:()=>Ho,yt0:()=>Wu,uXU:()=>cf,_kC:()=>ql,lk7:()=>_m,x12:()=>qi,Zzh:()=>Yb,nls:()=>cr,g_z:()=>Wc,U7:()=>mm,FT0:()=>wv,blk:()=>Na,ejS:()=>En,rnI:()=>jr,wem:()=>_t,lfu:()=>jg,FDw:()=>rf,lRj:()=>nf,D1R:()=>Oi,qyh:()=>hc,GUF:()=>aa,EoG:()=>ad,aNw:()=>ci,Zp0:()=>ru,lLk:()=>Vg,jAl:()=>Bu,uEv:()=>_d,YKA:()=>Sd,cRx:()=>ud,Y8D:()=>bs,RsA:()=>Rt,F5T:()=>an,u7G:()=>wm,M8C:()=>Kn,Vkp:()=>Jn,yGw:()=>Ie,Sm8:()=>et,Kj0:()=>ht,vBJ:()=>mr,lRF:()=>_o,Lun:()=>pa,YBo:()=>Ug,kaV:()=>_v,RSm:()=>Fg,xoR:()=>Zc,EJi:()=>Fr,Qme:()=>Ry,Wid:()=>st,IKL:()=>Sv,r_:()=>mt,OoA:()=>xs,qhX:()=>Vs,M5h:()=>pr,Ns1:()=>Ga,Ue:()=>Su,RR3:()=>pT,TyD:()=>Wt,vZf:()=>Wo,HTd:()=>ld,aH4:()=>ia,YLQ:()=>Xs,BVF:()=>Au,MyG:()=>Gu,jFi:()=>it,aCh:()=>el,uL9:()=>ra,IFH:()=>Ks,bdR:()=>Nt,M6v:()=>Go,RvT:()=>fi,ymC:()=>Dy,dUE:()=>$c,Tme:()=>St,Gql:()=>Eb,PA7:()=>of,REq:()=>vS,pQR:()=>Qe,ghN:()=>Re,Hy8:()=>rn,Wpd:()=>Jr,LgZ:()=>Vt,iWC:()=>Pt,lkL:()=>Oy,iKG:()=>Pr,_iA:()=>ir,ntZ:()=>F,anP:()=>hh,HRQ:()=>E0,hpZ:()=>ze,w2v:()=>Ur,WI2:()=>bu,y$t:()=>kr,cPb:()=>vn,JOQ:()=>Gi,BKK:()=>yS,_12:()=>Vi,tJx:()=>rS,OdJ:()=>TM,SyM:()=>ui,cek:()=>Tp,xG9:()=>i1,woe:()=>mp,UY4:()=>li,aq0:()=>$b,ujx:()=>xS,Uol:()=>Ri,VYz:()=>Yv,tSf:()=>PM,M20:()=>xu,iUV:()=>kt,tf:()=>Qv,ZQ6:()=>xp,mXe:()=>Xc,_fP:()=>Jt,iLg:()=>Lo,zbs:()=>Av,ZTh:()=>Uu,HdW:()=>Fu,UZH:()=>$e,mSO:()=>$s,wk1:()=>Hr,E2K:()=>sf,FUD:()=>Nu,pKu:()=>xd,GG6:()=>bd,Gih:()=>fc,iiP:()=>mc,SvJ:()=>Ys,ptH:()=>pi,jZA:()=>gd,y2t:()=>vd,gi4:()=>yd,Djp:()=>Ko,BG$:()=>Jo,NYV:()=>qs,xJs:()=>$o,bsb:()=>ku,ekQ:()=>md,CaW:()=>Iu,eaV:()=>fd,BFQ:()=>Ln,v3W:()=>Du,ILR:()=>Qo,fto:()=>pc,l0P:()=>Ii,vCx:()=>Zo,_AM:()=>Ou,wuA:()=>Cu,av9:()=>dd,CtA:()=>pd,FIo:()=>ur,zHn:()=>ol,iMs:()=>Wb,T_f:()=>Nv,hEm:()=>Pu,D9w:()=>hd,CdI:()=>sd,wo6:()=>Fm,TIb:()=>EM,rpg:()=>$r,ce8:()=>Md,rOj:()=>Ye,V4E:()=>bS,o8S:()=>tt,lGU:()=>zu,vuL:()=>Kt,KI_:()=>Sr,iLN:()=>H0,xsS:()=>Oa,b26:()=>Zt,w5d:()=>Jm,WdD:()=>bt,Vj0:()=>bi,jyz:()=>Bt,Tn7:()=>yt,bnF:()=>Fa,HW6:()=>SS,oa8:()=>xn,T_1:()=>sS,iDF:()=>Q,iAb:()=>Xo,OdW:()=>as,_YX:()=>Qb,TUv:()=>Nr,Hw6:()=>sa,aLr:()=>zi,Aip:()=>_S,xo$:()=>ae,$V:()=>Jv,lDi:()=>kv,gti:()=>Nh,PMe:()=>bm,FvO:()=>n1,jyi:()=>fp,xeV:()=>Eh,k74:()=>Gt,RlZ:()=>sc,KhW:()=>Et,HgB:()=>df,W2J:()=>Qa,JWc:()=>Rd,kP0:()=>DM,u37:()=>Pb,Z6B:()=>xg,QZ1:()=>Ad,Ir4:()=>qu,nE5:()=>Iy,NwF:()=>eu,Wbm:()=>Dn,N4l:()=>jn,QmN:()=>Tt,wes:()=>$,IOt:()=>Ya,L5g:()=>wS,H$k:()=>Z,xEZ:()=>pn,Yin:()=>L1,dpR:()=>xm,hmx:()=>fs,Lb$:()=>ox,Cne:()=>MS,XvJ:()=>ue,XZw:()=>TS,FE5:()=>ke,CJI:()=>vi,z$h:()=>gc,UlW:()=>wd,WwZ:()=>qa,Lcc:()=>ES,WXh:()=>rt,VNk:()=>ny,ub3:()=>ct,xfE:()=>uc,qlB:()=>ua,lCJ:()=>Lr,WTc:()=>Es,rAo:()=>Tn,xWb:()=>qe,gH0:()=>Gb,rBU:()=>je,rDY:()=>lh,ywz:()=>Vn,wJv:()=>Wa,JQ4:()=>Va,k0A:()=>dc,irR:()=>Lu,LsT:()=>qo,Oih:()=>cy,p9U:()=>ly,MiG:()=>Bs,JSe:()=>uy,dwk:()=>he,FM8:()=>ce,Pa4:()=>D,Ltg:()=>ot,yC1:()=>tu,Lpp:()=>RM,fO1:()=>dm,AEx:()=>_w,_9o:()=>hy,k5T:()=>OM,b5g:()=>hp,Ywn:()=>xf,GVz:()=>yf,oAp:()=>go,kFz:()=>bf,dd2:()=>Xt,CP7:()=>Cl,fQK:()=>Rl,Uk6:()=>lt,_sL:()=>Ni,Pnf:()=>ei,c8b:()=>se,_lf:()=>ti,ad5:()=>vg,L_r:()=>Yu,HOT:()=>zs,$R8:()=>P,lDs:()=>e_,Oe_:()=>$S,S6$:()=>Ze,CbL:()=>fn,knz:()=>Ct});var ee={};Fn.r(ee),Fn.d(ee,{ArcCurve:()=>Ch,CatmullRomCurve3:()=>Ns,CubicBezierCurve:()=>Cn,CubicBezierCurve3:()=>fm,EllipseCurve:()=>Vc,LineCurve:()=>Wc,LineCurve3:()=>mm,QuadraticBezierCurve:()=>xp,QuadraticBezierCurve3:()=>Xc,SplineCurve:()=>Nh});var z={};Fn.r(z),Fn.d(z,{BoxGeometry:()=>Xn,CapsuleGeometry:()=>Gl,CircleGeometry:()=>Ai,ConeGeometry:()=>Yi,CylinderGeometry:()=>ma,DodecahedronGeometry:()=>ks,EdgesGeometry:()=>Uh,ExtrudeGeometry:()=>Pe,IcosahedronGeometry:()=>Xe,LatheGeometry:()=>us,OctahedronGeometry:()=>Qe,PlaneGeometry:()=>Vi,PolyhedronGeometry:()=>Ri,RingGeometry:()=>tt,ShapeGeometry:()=>xn,SphereGeometry:()=>ae,TetrahedronGeometry:()=>Z,TorusGeometry:()=>ue,TorusKnotGeometry:()=>ke,TubeGeometry:()=>rt,WireframeGeometry:()=>lt});var P={};Fn.r(P),Fn.d(P,{CSS2DObject:()=>RS,CSS2DRenderer:()=>LS,CSS3DObject:()=>v1,CSS3DRenderer:()=>OS,CSS3DSprite:()=>CS,Projector:()=>IS,RenderableFace:()=>x1,RenderableLine:()=>b1,RenderableObject:()=>y1,RenderableSprite:()=>S1,RenderableVertex:()=>cu,SimplexNoise:()=>AS,computeMikkTSpaceTangents:()=>kS,computeMorphedAttributes:()=>jS,computeTangents:()=>NS,createMeshesFromInstancedMesh:()=>VS,createMeshesFromMultiMaterialMesh:()=>WS,createMultiMaterialObject:()=>XS,deepCloneAttribute:()=>Om,deinterleaveAttribute:()=>Im,deinterleaveGeometry:()=>zS,estimateBytesUsed:()=>BS,interleaveAttributes:()=>US,mergeBufferAttributes:()=>n0,mergeBufferGeometries:()=>FS,mergeGroups:()=>_1,mergeVertices:()=>HS,reduceVertices:()=>qS,sortInstancedMesh:()=>YS,toCreasedNormals:()=>GS,toTrianglesDrawMode:()=>r0});var $={};Fn.r($),Fn.d($,{Easing:()=>Ki.Easing,Group:()=>Ki.Group,Interpolation:()=>Ki.Interpolation,Sequence:()=>Ki.Sequence,Tween:()=>Ki.Tween,TweenChain:()=>pw.TweenChain,TweenManager:()=>ty,VERSION:()=>Ki.VERSION,__esModule:()=>Ki.__esModule,add:()=>Ki.add,getAll:()=>Ki.getAll,nextId:()=>Ki.nextId,now:()=>Ki.now,remove:()=>Ki.remove,removeAll:()=>Ki.removeAll,update:()=>Ki.update});var ve={};Fn.r(ve),Fn.d(ve,{FInterpConstantTo:()=>Uw,FInterpTo:()=>Fw,QInterpConstantTo:()=>kw,QInterpTo:()=>Nw,Quat_exponentialDamp:()=>Lw,Quat_quarticDamp:()=>Pw,Quat_smoothDamp:()=>Cw,VInterpConstantTo:()=>Iw,VInterpTo:()=>Ow,Vec3_smoothDamp:()=>Dw,exponentialDamp:()=>ay,quarticDamp:()=>Qh,smoothDamp:()=>x0});var ze={};Fn.r(ze),Fn.d(ze,{Alpha:()=>$w,BaseRenderer:()=>My,Behaviour:()=>Ip,Color:()=>eM,Controller:()=>by,Emitter:()=>Kw,Force:()=>wy,GPURenderer:()=>rM,Gravity:()=>tM,Particle:()=>_0,Scale:()=>nM,System:()=>w0,copyProperties:()=>qw,ease:()=>Zh,setPrototypeByObj:()=>jm});var Ze={};Fn.r(Ze),Fn.d(Ze,{Box:()=>iM,Capsule:()=>aM,Circle:()=>sM,Cone:()=>oM,Cylinder:()=>lM,Dodecahedron:()=>cM,Edges:()=>uM,Extrude:()=>hM,Icosahedron:()=>dM,Lathe:()=>pM,Octahedron:()=>fM,Plane:()=>mM,Polyhedron:()=>gM,Ring:()=>vM,Shape:()=>yM,Sphere:()=>xM,Tetrahedron:()=>bM,Torus:()=>SM,TorusKnot:()=>_M,Tube:()=>wM,Wireframe:()=>MM});for(let s=0;s<256;s++)(s<16?"0":"")+s.toString(16);Array.prototype.remove=function(s){let e=this.indexOf(s);e>-1&&this.splice(e,1)};class at{_events={};clear(){return this._events={},this}on(e,t,n,r=!1){let i=this._events[e];if(i==null&&(i=this._events[e]=[]),!(i.findIndex((l=>l.callback===t&&(!n||l.target===n)))>-1))return i.push({name:e,callback:t,target:n,once:r}),this;console.warn(`event: ${e} duplicate registered`)}off(e,t,n){let r=this._events[e];if(r){let i=r.findIndex((a=>a.callback===t&&(!n||a.target===n)));this._removeEvent(r,i,e)}return this}onof(e,t,n){return n._listeners===void 0&&(n._listeners=[]),n._listeners.push({name:e,callback:t}),this.on(e,t),this}offof(e){for(let t of e._listeners)this.off(t.name,t.callback);return this}_removeEvent(e,t,n){return t>-1&&(e.splice(t,1),e.length===0&&delete this._events[n]),this}targetOff(e){for(let t in this._events){let n=this._events[t];for(let r=n.length;r--;)n[r].target===e&&this._removeEvent(n,r,t)}}emit(e,...t){let n=this._events[e];if(n)for(let r=n.length;r--;){let i=n[r];i.once&&this._removeEvent(n,r,e),i.target?i.callback.apply(i.target,t):i.callback(...t)}return this}}class Ke{_target=null;_callback=null;_interval=0;_repeat=0;_elapsed=0;_lastTime=0;_repeatForever=!1;_pause=!1;get pause(){return this._pause}set pause(e){this._pause=e}get target(){return this._target}get callback(){return this._callback}constructor(e,t,n,r){this._target=e,this._callback=t,this._interval=n,this._repeat=r,this._repeatForever=r===-1}get lived(){return this._repeat>0||this._repeatForever}update(e){this._pause||(this._repeat>0||this._repeatForever)&&(this._elapsed+=e,this._elapsed-this._lastTime>=this._interval&&(this._lastTime+=this._interval,this._repeat--,this.trigger(e)))}trigger(e){this._target&&this._callback&&this._callback.call(this._target,e,this._elapsed)}}class vt{_target;_callers;get target(){return this._target}get callers(){return this._callers}constructor(e,t){this._target=e,this._callers=t}}class Zt{_callers={};_callersArray=[];pause(e){let t=this._callers[e.uuid];t&&t.forEach((n=>n.pause=!0))}resume(e){let t=this._callers[e.uuid];t&&t.forEach((n=>n.pause=!1))}schedule(e,t,n,r){let i=this._callers[e.uuid];i===void 0&&(i=this._callers[e.uuid]=[],this._callersArray.push(new vt(e,i))),i.push(new Ke(e,t,n,r))}unshedule(e,t){let n=this._callers[e.uuid];if(n){let r=n.findIndex((i=>i.callback===t));r!==-1&&n.splice(r,1)}}unscheduleAll(e){delete this._callers[e.uuid];let t=this._callersArray.findIndex((n=>n.target===e));t!==-1&&this._callersArray.splice(t,1)}update(e){let t,n=this._callersArray;for(let r=n.length;r--;){t=n[r].callers;for(let i=t.length;i--;)t[i].lived?t[i].update(e):t.splice(i,1)}}}const $e="150",Rt={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Tt={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},mn=0,Ot=1,Lt=2,rr=3,_n=0,ir=1,F=2,he=3,Se=0,Be=1,We=2,ct=2,it=0,Nt=1,Un=2,jn=3,pr=4,Kr=5,Zn=100,Dn=101,Ye=102,mt=103,et=104,se=200,Re=201,Et=202,Pt=203,Gt=204,Vt=205,dn=206,rn=207,wn=208,Jr=209,sc=210,Au=0,zo=1,Bo=2,Ho=3,jo=4,oc=5,id=6,Go=7,Ga=0,Vs=1,Ru=2,ra=0,ad=1,sd=2,od=3,lc=4,cc=5,uc=300,Ci=301,Di=302,ys=303,Vo=304,Ws=306,$r=1e3,Gn=1001,xs=1002,Wt=1003,Xs=1004,ld=1004,ia=1005,Wo=1005,_t=1006,hc=1007,nf=1007,Oi=1008,rf=1008,Vn=1009,cd=1010,Xo=1011,qo=1012,Yo=1013,Va=1014,xr=1015,br=1016,dc=1017,Lu=1018,Wa=1020,af=1021,Hr=1023,bs=1024,ud=1025,xa=1026,Ss=1027,Pu=1028,hd=1029,dd=1030,pd=1031,sf=1033,Cu=33776,Ln=33777,Du=33778,Qo=33779,Ou=35840,Zo=35841,fd=35842,Iu=35843,pc=36196,Ii=37492,md=37496,pi=37808,gd=37809,vd=37810,yd=37811,Ko=37812,Jo=37813,qs=37814,$o=37815,xd=37816,bd=37817,fc=37818,Nu=37819,mc=37820,Ys=37821,ku=36492,Fu=36283,Kt=36284,Uu=36285,zu=36286,Bu=2200,Sd=2201,_d=2202,Qs=2300,Xa=2301,Zs=2302,ei=2400,ti=2401,Ni=2402,Ks=2500,Js=2501,qa=0,wd=1,gc=2,jr=3e3,Ct=3001,ki=3200,$s=3201,Ya=0,of=1,el="",Sr="srgb",aa="srgb-linear",tl="display-p3",vg=0,Hu=7680,Md=7681,ju=7682,Td=7683,lf=34055,_s=34056,Ed=5386,Gu=512,cf=513,Vu=514,Wu=515,uf=516,fi=517,nl=518,Xu=519,Qa=35044,hf=35048,Ad=35040,Rd=35045,vc=35049,qu=35041,df=35046,yg=35050,xg=35042,bg="100",yc="300 es",Yu=1035;class Fi{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const n=t.slice(0);for(let r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}const Er=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let pf=1234567;const eo=Math.PI/180,rl=180/Math.PI;function mi(){const s=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Er[255&s]+Er[s>>8&255]+Er[s>>16&255]+Er[s>>24&255]+"-"+Er[255&e]+Er[e>>8&255]+"-"+Er[e>>16&15|64]+Er[e>>24&255]+"-"+Er[63&t|128]+Er[t>>8&255]+"-"+Er[t>>16&255]+Er[t>>24&255]+Er[255&n]+Er[n>>8&255]+Er[n>>16&255]+Er[n>>24&255]).toLowerCase()}function zn(s,e,t){return Math.max(e,Math.min(t,s))}function Ld(s,e){return(s%e+e)%e}function xc(s,e,t){return(1-t)*s+t*e}function bc(s){return(s&s-1)==0&&s!==0}function ff(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function mf(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function Za(s,e){switch(e.constructor){case Float32Array:return s;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function ln(s,e){switch(e.constructor){case Float32Array:return s;case Uint16Array:return Math.round(65535*s);case Uint8Array:return Math.round(255*s);case Int16Array:return Math.round(32767*s);case Int8Array:return Math.round(127*s);default:throw new Error("Invalid component type.")}}const Kn={DEG2RAD:eo,RAD2DEG:rl,generateUUID:mi,clamp:zn,clamp01:function(s){return zn(s,0,1)},euclideanModulo:Ld,mapLinear:function(s,e,t,n,r){return n+(s-e)*(r-n)/(t-e)},inverseLerp:function(s,e,t){return s!==e?(t-s)/(e-s):0},lerp:xc,damp:function(s,e,t,n){return xc(s,e,1-Math.exp(-t*n))},pingpong:function(s,e=1){return e-Math.abs(Ld(s,2*e)-e)},smoothstep:function(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e))*s*(3-2*s)},smootherstep:function(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e))*s*s*(s*(6*s-15)+10)},randInt:function(s,e){return s+Math.random()*(e-s+1)>>0},randFloat:function(s,e){return s+Math.random()*(e-s)},randFloatSpread:function(s){return s*(.5-Math.random())},seededRandom:function(s){s!==void 0&&(pf=s);let e=pf+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(s){return s*eo},radToDeg:function(s){return s*rl},isPowerOfTwo:bc,ceilPowerOfTwo:ff,floorPowerOfTwo:mf,setQuaternionFromProperEuler:function(s,e,t,n,r){const i=Math.cos,a=Math.sin,l=i(t/2),u=a(t/2),h=i((e+n)/2),p=a((e+n)/2),f=i((e-n)/2),m=a((e-n)/2),g=i((n-e)/2),x=a((n-e)/2);switch(r){case"XYX":s.set(l*p,u*f,u*m,l*h);break;case"YZY":s.set(u*m,l*p,u*f,l*h);break;case"ZXZ":s.set(u*f,u*m,l*p,l*h);break;case"XZX":s.set(l*p,u*x,u*g,l*h);break;case"YXY":s.set(u*g,l*p,u*x,l*h);break;case"ZYZ":s.set(u*x,u*g,l*p,l*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:ln,denormalize:Za};class ce{constructor(e=0,t=0){ce.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Jn{constructor(){Jn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,i,a,l,u,h){const p=this.elements;return p[0]=e,p[1]=r,p[2]=l,p[3]=t,p[4]=i,p[5]=u,p[6]=n,p[7]=a,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],l=n[3],u=n[6],h=n[1],p=n[4],f=n[7],m=n[2],g=n[5],x=n[8],y=r[0],b=r[3],w=r[6],_=r[1],T=r[4],A=r[7],R=r[2],C=r[5],I=r[8];return i[0]=a*y+l*_+u*R,i[3]=a*b+l*T+u*C,i[6]=a*w+l*A+u*I,i[1]=h*y+p*_+f*R,i[4]=h*b+p*T+f*C,i[7]=h*w+p*A+f*I,i[2]=m*y+g*_+x*R,i[5]=m*b+g*T+x*C,i[8]=m*w+g*A+x*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8];return t*a*p-t*l*h-n*i*p+n*l*u+r*i*h-r*a*u}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8],f=p*a-l*h,m=l*u-p*i,g=h*i-a*u,x=t*f+n*m+r*g;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/x;return e[0]=f*y,e[1]=(r*h-p*n)*y,e[2]=(l*n-r*a)*y,e[3]=m*y,e[4]=(p*t-r*u)*y,e[5]=(r*i-l*t)*y,e[6]=g*y,e[7]=(n*u-h*t)*y,e[8]=(a*t-n*i)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,l){const u=Math.cos(i),h=Math.sin(i);return this.set(n*u,n*h,-n*(u*a+h*l)+a+e,-r*h,r*u,-r*(-h*a+u*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(Pd.makeScale(e,t)),this}rotate(e){return this.premultiply(Pd.makeRotation(-e)),this}translate(e,t){return this.premultiply(Pd.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,1,0,-n,0,t,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Pd=new Jn;function gf(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const Sg={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function il(s,e){return new Sg[s](e)}function to(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}class Jt{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,l){let u=n[r+0],h=n[r+1],p=n[r+2],f=n[r+3];const m=i[a+0],g=i[a+1],x=i[a+2],y=i[a+3];if(l===0)return e[t+0]=u,e[t+1]=h,e[t+2]=p,void(e[t+3]=f);if(l===1)return e[t+0]=m,e[t+1]=g,e[t+2]=x,void(e[t+3]=y);if(f!==y||u!==m||h!==g||p!==x){let b=1-l;const w=u*m+h*g+p*x+f*y,_=w>=0?1:-1,T=1-w*w;if(T>Number.EPSILON){const R=Math.sqrt(T),C=Math.atan2(R,w*_);b=Math.sin(b*C)/R,l=Math.sin(l*C)/R}const A=l*_;if(u=u*b+m*A,h=h*b+g*A,p=p*b+x*A,f=f*b+y*A,b===1-l){const R=1/Math.sqrt(u*u+h*h+p*p+f*f);u*=R,h*=R,p*=R,f*=R}}e[t]=u,e[t+1]=h,e[t+2]=p,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,i,a){const l=n[r],u=n[r+1],h=n[r+2],p=n[r+3],f=i[a],m=i[a+1],g=i[a+2],x=i[a+3];return e[t]=l*x+p*f+u*g-h*m,e[t+1]=u*x+p*m+h*f-l*g,e[t+2]=h*x+p*g+l*m-u*f,e[t+3]=p*x-l*f-u*m-h*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,i=e._z,a=e._order,l=Math.cos,u=Math.sin,h=l(n/2),p=l(r/2),f=l(i/2),m=u(n/2),g=u(r/2),x=u(i/2);switch(a){case"XYZ":this._x=m*p*f+h*g*x,this._y=h*g*f-m*p*x,this._z=h*p*x+m*g*f,this._w=h*p*f-m*g*x;break;case"YXZ":this._x=m*p*f+h*g*x,this._y=h*g*f-m*p*x,this._z=h*p*x-m*g*f,this._w=h*p*f+m*g*x;break;case"ZXY":this._x=m*p*f-h*g*x,this._y=h*g*f+m*p*x,this._z=h*p*x+m*g*f,this._w=h*p*f-m*g*x;break;case"ZYX":this._x=m*p*f-h*g*x,this._y=h*g*f+m*p*x,this._z=h*p*x-m*g*f,this._w=h*p*f+m*g*x;break;case"YZX":this._x=m*p*f+h*g*x,this._y=h*g*f+m*p*x,this._z=h*p*x-m*g*f,this._w=h*p*f-m*g*x;break;case"XZY":this._x=m*p*f-h*g*x,this._y=h*g*f-m*p*x,this._z=h*p*x+m*g*f,this._w=h*p*f+m*g*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],l=t[5],u=t[9],h=t[2],p=t[6],f=t[10],m=n+l+f;if(m>0){const g=.5/Math.sqrt(m+1);this._w=.25/g,this._x=(p-u)*g,this._y=(i-h)*g,this._z=(a-r)*g}else if(n>l&&n>f){const g=2*Math.sqrt(1+n-l-f);this._w=(p-u)/g,this._x=.25*g,this._y=(r+a)/g,this._z=(i+h)/g}else if(l>f){const g=2*Math.sqrt(1+l-n-f);this._w=(i-h)/g,this._x=(r+a)/g,this._y=.25*g,this._z=(u+p)/g}else{const g=2*Math.sqrt(1+f-n-l);this._w=(a-r)/g,this._x=(i+h)/g,this._y=(u+p)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(zn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,l=t._x,u=t._y,h=t._z,p=t._w;return this._x=n*p+a*l+r*h-i*u,this._y=r*p+a*u+i*l-n*h,this._z=i*p+a*h+n*u-r*l,this._w=a*p-n*l-r*u-i*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let l=a*e._w+n*e._x+r*e._y+i*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const u=1-l*l;if(u<=Number.EPSILON){const g=1-t;return this._w=g*a+t*this._w,this._x=g*n+t*this._x,this._y=g*r+t*this._y,this._z=g*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(u),p=Math.atan2(h,l),f=Math.sin((1-t)*p)/h,m=Math.sin(t*p)/h;return this._w=a*f+this._w*m,this._x=n*f+this._x*m,this._y=r*f+this._y*m,this._z=i*f+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{static UNIT_X=Object.freeze(new D(1,0,0));static UNIT_Y=Object.freeze(new D(0,1,0));static UNIT_Z=Object.freeze(new D(0,0,1));static RIGHT=Object.freeze(new D(1,0,0));static UP=Object.freeze(new D(0,1,0));static ZERO=Object.freeze(new D(0,0,0));static ONE=Object.freeze(new D(1,1,1));static NEG_ONE=Object.freeze(new D(-1,-1,-1));constructor(e=0,t=0,n=0){D.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Cd.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Cd.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,l=e.z,u=e.w,h=u*t+a*r-l*n,p=u*n+l*t-i*r,f=u*r+i*n-a*t,m=-i*t-a*n-l*r;return this.x=h*u+m*-i+p*-l-f*-a,this.y=p*u+m*-a+f*-i-h*-l,this.z=f*u+m*-l+h*-a-p*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,l=t.y,u=t.z;return this.x=r*u-i*l,this.y=i*a-n*u,this.z=n*l-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Qu.copy(this).projectOnVector(e),this.sub(Qu)}reflect(e){return this.sub(Qu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qu=new D,Cd=new Jt;function no(s){return s<.04045?.0773993808*s:Math.pow(.9478672986*s+.0521327014,2.4)}function Zu(s){return s<.0031308?12.92*s:1.055*Math.pow(s,.41666)-.055}const vf=new Jn().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),al=new Jn().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),ws=new D,_g={[aa]:s=>s,[Sr]:s=>s.convertSRGBToLinear(),[tl]:function(s){return s.convertSRGBToLinear(),ws.set(s.r,s.g,s.b).applyMatrix3(al),s.setRGB(ws.x,ws.y,ws.z)}},wg={[aa]:s=>s,[Sr]:s=>s.convertLinearToSRGB(),[tl]:function(s){return ws.set(s.r,s.g,s.b).applyMatrix3(vf),s.setRGB(ws.x,ws.y,ws.z).convertLinearToSRGB()}},ar={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(s){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!s},get workingColorSpace(){return aa},set workingColorSpace(s){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(s,e,t){if(this.enabled===!1||e===t||!e||!t)return s;const n=_g[e],r=wg[t];if(n===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(n(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this.workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this.workingColorSpace)}};let ro;class io{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ro===void 0&&(ro=to("canvas")),ro.width=e.width,ro.height=e.height;const n=ro.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ro}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=to("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let a=0;a<i.length;a++)i[a]=255*no(i[a]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(255*no(t[n]/255)):t[n]=no(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class sa{constructor(e=null){this.isSource=!0,this.uuid=mi(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let a=0,l=r.length;a<l;a++)r[a].isDataTexture?i.push(Dd(r[a].image)):i.push(Dd(r[a]))}else i=Dd(r);n.url=i}return t||(e.images[this.uuid]=n),n}}function Dd(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?io.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Ku=0;class pn extends Fi{constructor(e=pn.DEFAULT_IMAGE,t=pn.DEFAULT_MAPPING,n=Gn,r=Gn,i=_t,a=Oi,l=Hr,u=Vn,h=pn.DEFAULT_ANISOTROPY,p=jr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Ku++}),this.uuid=mi(),this.name="",this.source=new sa(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=h,this.format=l,this.internalFormat=null,this.type=u,this.offset=new ce(0,0),this.repeat=new ce(1,1),this.center=new ce(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=p,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==uc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case $r:e.x=e.x-Math.floor(e.x);break;case Gn:e.x=e.x<0?0:1;break;case xs:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case $r:e.y=e.y-Math.floor(e.y);break;case Gn:e.y=e.y<0?0:1;break;case xs:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}pn.DEFAULT_IMAGE=null,pn.DEFAULT_MAPPING=uc,pn.DEFAULT_ANISOTROPY=1;class ot{constructor(e=0,t=0,n=0,r=1){ot.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const u=e.elements,h=u[0],p=u[4],f=u[8],m=u[1],g=u[5],x=u[9],y=u[2],b=u[6],w=u[10];if(Math.abs(p-m)<.01&&Math.abs(f-y)<.01&&Math.abs(x-b)<.01){if(Math.abs(p+m)<.1&&Math.abs(f+y)<.1&&Math.abs(x+b)<.1&&Math.abs(h+g+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(h+1)/2,A=(g+1)/2,R=(w+1)/2,C=(p+m)/4,I=(f+y)/4,G=(x+b)/4;return T>A&&T>R?T<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(T),r=C/n,i=I/n):A>R?A<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(A),n=C/r,i=G/r):R<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(R),n=I/i,r=G/i),this.set(n,r,i,t),this}let _=Math.sqrt((b-x)*(b-x)+(f-y)*(f-y)+(m-p)*(m-p));return Math.abs(_)<.001&&(_=1),this.x=(b-x)/_,this.y=(f-y)/_,this.z=(m-p)/_,this.w=Math.acos((h+g+w-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Xt extends Fi{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ot(0,0,e,t),this.scissorTest=!1,this.viewport=new ot(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new pn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:_t,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new sa(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class sl extends pn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Wt,this.minFilter=Wt,this.wrapR=Gn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class yf extends Xt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new sl(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Ju extends pn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Wt,this.minFilter=Wt,this.wrapR=Gn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class xf extends Xt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Ju(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class bf extends Xt{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const i=this.texture;this.texture=[];for(let a=0;a<n;a++)this.texture[a]=i.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class ba{constructor(e=new D(1/0,1/0,1/0),t=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,l=-1/0;for(let u=0,h=e.length;u<h;u+=3){const p=e[u],f=e[u+1],m=e[u+2];p<t&&(t=p),f<n&&(n=f),m<r&&(r=m),p>i&&(i=p),f>a&&(a=f),m>l&&(l=m)}return this.min.set(t,n,r),this.max.set(i,a,l),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,l=-1/0;for(let u=0,h=e.count;u<h;u++){const p=e.getX(u),f=e.getY(u),m=e.getZ(u);p<t&&(t=p),f<n&&(n=f),m<r&&(r=m),p>i&&(i=p),f>a&&(a=f),m>l&&(l=m)}return this.min.set(t,n,r),this.max.set(i,a,l),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=ao.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0)if(t&&n.attributes!=null&&n.attributes.position!==void 0){const i=n.attributes.position;for(let a=0,l=i.count;a<l;a++)ao.fromBufferAttribute(i,a).applyMatrix4(e.matrixWorld),this.expandByPoint(ao)}else n.boundingBox===null&&n.computeBoundingBox(),Od.copy(n.boundingBox),Od.applyMatrix4(e.matrixWorld),this.union(Od);const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ao),ao.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(oo),$u.subVectors(this.max,oo),Ar.subVectors(e.a,oo),Sa.subVectors(e.b,oo),so.subVectors(e.c,oo),Ja.subVectors(Sa,Ar),$a.subVectors(so,Sa),Ms.subVectors(Ar,so);let t=[0,-Ja.z,Ja.y,0,-$a.z,$a.y,0,-Ms.z,Ms.y,Ja.z,0,-Ja.x,$a.z,0,-$a.x,Ms.z,0,-Ms.x,-Ja.y,Ja.x,0,-$a.y,$a.x,0,-Ms.y,Ms.x,0];return!!Sc(t,Ar,Sa,so,$u)&&(t=[1,0,0,0,1,0,0,0,1],!!Sc(t,Ar,Sa,so,$u)&&(eh.crossVectors(Ja,$a),t=[eh.x,eh.y,eh.z],Sc(t,Ar,Sa,so,$u)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ao).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(ao).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ka[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ka[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ka[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ka[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ka[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ka[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ka[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ka[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ka)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ka=[new D,new D,new D,new D,new D,new D,new D,new D],ao=new D,Od=new ba,Ar=new D,Sa=new D,so=new D,Ja=new D,$a=new D,Ms=new D,oo=new D,$u=new D,eh=new D,Ui=new D;function Sc(s,e,t,n,r){for(let i=0,a=s.length-3;i<=a;i+=3){Ui.fromArray(s,i);const l=r.x*Math.abs(Ui.x)+r.y*Math.abs(Ui.y)+r.z*Math.abs(Ui.z),u=e.dot(Ui),h=t.dot(Ui),p=n.dot(Ui);if(Math.max(-Math.max(u,h,p),Math.min(u,h,p))>l)return!1}return!0}const _c=new ba,lo=new D,th=new D;class zi{constructor(e=new D,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):_c.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;lo.subVectors(e,this.center);const t=lo.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(lo,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(th.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(lo.copy(e.center).add(th)),this.expandByPoint(lo.copy(e.center).sub(th))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ni=new D,wc=new D,Mc=new D,oa=new D,nh=new D,Tc=new D,rh=new D;class ol{constructor(e=new D,t=new D(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ni)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ni.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ni.copy(this.origin).addScaledVector(this.direction,t),ni.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){wc.copy(e).add(t).multiplyScalar(.5),Mc.copy(t).sub(e).normalize(),oa.copy(this.origin).sub(wc);const i=.5*e.distanceTo(t),a=-this.direction.dot(Mc),l=oa.dot(this.direction),u=-oa.dot(Mc),h=oa.lengthSq(),p=Math.abs(1-a*a);let f,m,g,x;if(p>0)if(f=a*u-l,m=a*l-u,x=i*p,f>=0)if(m>=-x)if(m<=x){const y=1/p;f*=y,m*=y,g=f*(f+a*m+2*l)+m*(a*f+m+2*u)+h}else m=i,f=Math.max(0,-(a*m+l)),g=-f*f+m*(m+2*u)+h;else m=-i,f=Math.max(0,-(a*m+l)),g=-f*f+m*(m+2*u)+h;else m<=-x?(f=Math.max(0,-(-a*i+l)),m=f>0?-i:Math.min(Math.max(-i,-u),i),g=-f*f+m*(m+2*u)+h):m<=x?(f=0,m=Math.min(Math.max(-i,-u),i),g=m*(m+2*u)+h):(f=Math.max(0,-(a*i+l)),m=f>0?i:Math.min(Math.max(-i,-u),i),g=-f*f+m*(m+2*u)+h);else m=a>0?-i:i,f=Math.max(0,-(a*m+l)),g=-f*f+m*(m+2*u)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(wc).addScaledVector(Mc,m),g}intersectSphere(e,t){ni.subVectors(e.center,this.origin);const n=ni.dot(this.direction),r=ni.dot(ni)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),l=n-a,u=n+a;return u<0?null:l<0?this.at(u,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0?!0:e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,l,u;const h=1/this.direction.x,p=1/this.direction.y,f=1/this.direction.z,m=this.origin;return h>=0?(n=(e.min.x-m.x)*h,r=(e.max.x-m.x)*h):(n=(e.max.x-m.x)*h,r=(e.min.x-m.x)*h),p>=0?(i=(e.min.y-m.y)*p,a=(e.max.y-m.y)*p):(i=(e.max.y-m.y)*p,a=(e.min.y-m.y)*p),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),f>=0?(l=(e.min.z-m.z)*f,u=(e.max.z-m.z)*f):(l=(e.max.z-m.z)*f,u=(e.min.z-m.z)*f),n>u||l>r?null:((l>n||n!=n)&&(n=l),(u<r||r!=r)&&(r=u),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return this.intersectBox(e,ni)!==null}intersectTriangle(e,t,n,r,i){nh.subVectors(t,e),Tc.subVectors(n,e),rh.crossVectors(nh,Tc);let a,l=this.direction.dot(rh);if(l>0){if(r)return null;a=1}else{if(!(l<0))return null;a=-1,l=-l}oa.subVectors(this.origin,e);const u=a*this.direction.dot(Tc.crossVectors(oa,Tc));if(u<0)return null;const h=a*this.direction.dot(nh.cross(oa));if(h<0||u+h>l)return null;const p=-a*oa.dot(rh);return p<0?null:this.at(p/l,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ie{constructor(){Ie.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,i,a,l,u,h,p,f,m,g,x,y,b){const w=this.elements;return w[0]=e,w[4]=t,w[8]=n,w[12]=r,w[1]=i,w[5]=a,w[9]=l,w[13]=u,w[2]=h,w[6]=p,w[10]=f,w[14]=m,w[3]=g,w[7]=x,w[11]=y,w[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ie().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/co.setFromMatrixColumn(e,0).length(),i=1/co.setFromMatrixColumn(e,1).length(),a=1/co.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),l=Math.sin(n),u=Math.cos(r),h=Math.sin(r),p=Math.cos(i),f=Math.sin(i);if(e.order==="XYZ"){const m=a*p,g=a*f,x=l*p,y=l*f;t[0]=u*p,t[4]=-u*f,t[8]=h,t[1]=g+x*h,t[5]=m-y*h,t[9]=-l*u,t[2]=y-m*h,t[6]=x+g*h,t[10]=a*u}else if(e.order==="YXZ"){const m=u*p,g=u*f,x=h*p,y=h*f;t[0]=m+y*l,t[4]=x*l-g,t[8]=a*h,t[1]=a*f,t[5]=a*p,t[9]=-l,t[2]=g*l-x,t[6]=y+m*l,t[10]=a*u}else if(e.order==="ZXY"){const m=u*p,g=u*f,x=h*p,y=h*f;t[0]=m-y*l,t[4]=-a*f,t[8]=x+g*l,t[1]=g+x*l,t[5]=a*p,t[9]=y-m*l,t[2]=-a*h,t[6]=l,t[10]=a*u}else if(e.order==="ZYX"){const m=a*p,g=a*f,x=l*p,y=l*f;t[0]=u*p,t[4]=x*h-g,t[8]=m*h+y,t[1]=u*f,t[5]=y*h+m,t[9]=g*h-x,t[2]=-h,t[6]=l*u,t[10]=a*u}else if(e.order==="YZX"){const m=a*u,g=a*h,x=l*u,y=l*h;t[0]=u*p,t[4]=y-m*f,t[8]=x*f+g,t[1]=f,t[5]=a*p,t[9]=-l*p,t[2]=-h*p,t[6]=g*f+x,t[10]=m-y*f}else if(e.order==="XZY"){const m=a*u,g=a*h,x=l*u,y=l*h;t[0]=u*p,t[4]=-f,t[8]=h*p,t[1]=m*f+y,t[5]=a*p,t[9]=g*f-x,t[2]=x*f-g,t[6]=l*p,t[10]=y*f+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Id,e,Nd)}lookAt(e,t,n){const r=this.elements;return _r.subVectors(e,t),_r.lengthSq()===0&&(_r.z=1),_r.normalize(),Ts.crossVectors(n,_r),Ts.lengthSq()===0&&(Math.abs(n.z)===1?_r.x+=1e-4:_r.z+=1e-4,_r.normalize(),Ts.crossVectors(n,_r)),Ts.normalize(),ih.crossVectors(_r,Ts),r[0]=Ts.x,r[4]=ih.x,r[8]=_r.x,r[1]=Ts.y,r[5]=ih.y,r[9]=_r.y,r[2]=Ts.z,r[6]=ih.z,r[10]=_r.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],l=n[4],u=n[8],h=n[12],p=n[1],f=n[5],m=n[9],g=n[13],x=n[2],y=n[6],b=n[10],w=n[14],_=n[3],T=n[7],A=n[11],R=n[15],C=r[0],I=r[4],G=r[8],U=r[12],j=r[1],N=r[5],J=r[9],le=r[13],oe=r[2],xe=r[6],ge=r[10],Me=r[14],Ae=r[3],De=r[7],pe=r[11],re=r[15];return i[0]=a*C+l*j+u*oe+h*Ae,i[4]=a*I+l*N+u*xe+h*De,i[8]=a*G+l*J+u*ge+h*pe,i[12]=a*U+l*le+u*Me+h*re,i[1]=p*C+f*j+m*oe+g*Ae,i[5]=p*I+f*N+m*xe+g*De,i[9]=p*G+f*J+m*ge+g*pe,i[13]=p*U+f*le+m*Me+g*re,i[2]=x*C+y*j+b*oe+w*Ae,i[6]=x*I+y*N+b*xe+w*De,i[10]=x*G+y*J+b*ge+w*pe,i[14]=x*U+y*le+b*Me+w*re,i[3]=_*C+T*j+A*oe+R*Ae,i[7]=_*I+T*N+A*xe+R*De,i[11]=_*G+T*J+A*ge+R*pe,i[15]=_*U+T*le+A*Me+R*re,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],l=e[5],u=e[9],h=e[13],p=e[2],f=e[6],m=e[10],g=e[14];return e[3]*(+i*u*f-r*h*f-i*l*m+n*h*m+r*l*g-n*u*g)+e[7]*(+t*u*g-t*h*m+i*a*m-r*a*g+r*h*p-i*u*p)+e[11]*(+t*h*f-t*l*g-i*a*f+n*a*g+i*l*p-n*h*p)+e[15]*(-r*l*p-t*u*f+t*l*m+r*a*f-n*a*m+n*u*p)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=e[8],f=e[9],m=e[10],g=e[11],x=e[12],y=e[13],b=e[14],w=e[15],_=f*b*h-y*m*h+y*u*g-l*b*g-f*u*w+l*m*w,T=x*m*h-p*b*h-x*u*g+a*b*g+p*u*w-a*m*w,A=p*y*h-x*f*h+x*l*g-a*y*g-p*l*w+a*f*w,R=x*f*u-p*y*u-x*l*m+a*y*m+p*l*b-a*f*b,C=t*_+n*T+r*A+i*R;if(C===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/C;return e[0]=_*I,e[1]=(y*m*i-f*b*i-y*r*g+n*b*g+f*r*w-n*m*w)*I,e[2]=(l*b*i-y*u*i+y*r*h-n*b*h-l*r*w+n*u*w)*I,e[3]=(f*u*i-l*m*i-f*r*h+n*m*h+l*r*g-n*u*g)*I,e[4]=T*I,e[5]=(p*b*i-x*m*i+x*r*g-t*b*g-p*r*w+t*m*w)*I,e[6]=(x*u*i-a*b*i-x*r*h+t*b*h+a*r*w-t*u*w)*I,e[7]=(a*m*i-p*u*i+p*r*h-t*m*h-a*r*g+t*u*g)*I,e[8]=A*I,e[9]=(x*f*i-p*y*i-x*n*g+t*y*g+p*n*w-t*f*w)*I,e[10]=(a*y*i-x*l*i+x*n*h-t*y*h-a*n*w+t*l*w)*I,e[11]=(p*l*i-a*f*i-p*n*h+t*f*h+a*n*g-t*l*g)*I,e[12]=R*I,e[13]=(p*y*r-x*f*r+x*n*m-t*y*m-p*n*b+t*f*b)*I,e[14]=(x*l*r-a*y*r-x*n*u+t*y*u+a*n*b-t*l*b)*I,e[15]=(a*f*r-p*l*r+p*n*u-t*f*u-a*n*m+t*l*m)*I,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,l=e.y,u=e.z,h=i*a,p=i*l;return this.set(h*a+n,h*l-r*u,h*u+r*l,0,h*l+r*u,p*l+n,p*u-r*a,0,h*u-r*l,p*u+r*a,i*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,l=t._z,u=t._w,h=i+i,p=a+a,f=l+l,m=i*h,g=i*p,x=i*f,y=a*p,b=a*f,w=l*f,_=u*h,T=u*p,A=u*f,R=n.x,C=n.y,I=n.z;return r[0]=(1-(y+w))*R,r[1]=(g+A)*R,r[2]=(x-T)*R,r[3]=0,r[4]=(g-A)*C,r[5]=(1-(m+w))*C,r[6]=(b+_)*C,r[7]=0,r[8]=(x+T)*I,r[9]=(b-_)*I,r[10]=(1-(m+y))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=co.set(r[0],r[1],r[2]).length();const a=co.set(r[4],r[5],r[6]).length(),l=co.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],fr.copy(this);const u=1/i,h=1/a,p=1/l;return fr.elements[0]*=u,fr.elements[1]*=u,fr.elements[2]*=u,fr.elements[4]*=h,fr.elements[5]*=h,fr.elements[6]*=h,fr.elements[8]*=p,fr.elements[9]*=p,fr.elements[10]*=p,t.setFromRotationMatrix(fr),n.x=i,n.y=a,n.z=l,this}makePerspective(e,t,n,r,i,a){const l=this.elements,u=2*i/(t-e),h=2*i/(n-r),p=(t+e)/(t-e),f=(n+r)/(n-r),m=-(a+i)/(a-i),g=-2*a*i/(a-i);return l[0]=u,l[4]=0,l[8]=p,l[12]=0,l[1]=0,l[5]=h,l[9]=f,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,i,a){const l=this.elements,u=1/(t-e),h=1/(n-r),p=1/(a-i),f=(t+e)*u,m=(n+r)*h,g=(a+i)*p;return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-f,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=-2*p,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const co=new D,fr=new Ie,Id=new D(0,0,0),Nd=new D(1,1,1),Ts=new D,ih=new D,_r=new D,Sf=new Ie,kd=new Jt;class wr{constructor(e=0,t=0,n=0,r=wr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],l=r[8],u=r[1],h=r[5],p=r[9],f=r[2],m=r[6],g=r[10];switch(t){case"XYZ":this._y=Math.asin(zn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-p,g),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-zn(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(l,g),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-f,i),this._z=0);break;case"ZXY":this._x=Math.asin(zn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(u,i));break;case"ZYX":this._y=Math.asin(-zn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(zn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,h),this._y=Math.atan2(-f,i)):(this._x=0,this._y=Math.atan2(l,g));break;case"XZY":this._z=Math.asin(-zn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(l,i)):(this._x=Math.atan2(-p,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Sf.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Sf,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return kd.setFromEuler(this),this.setFromQuaternion(kd,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}wr.DEFAULT_ORDER="XYZ";class cn{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let Fd=0;const Ec=new D,_a=new Jt,wa=new Ie,ll=new D,es=new D,ah=new D,cl=new Jt,Ud=new D(1,0,0),_f=new D(0,1,0),wf=new D(0,0,1),Mf={type:"added"},Ac={type:"removed"};class St extends Fi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Fd++}),this.uuid=mi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=St.DEFAULT_UP.clone();const e=new D,t=new wr,n=new Jt,r=new D(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ie},normalMatrix:{value:new Jn}}),this.matrix=new Ie,this.matrixWorld=new Ie,this.matrixAutoUpdate=St.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=St.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new cn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={},this.uniforms={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return _a.setFromAxisAngle(e,t),this.quaternion.multiply(_a),this}rotateOnWorldAxis(e,t){return _a.setFromAxisAngle(e,t),this.quaternion.premultiply(_a),this}rotateX(e){return this.rotateOnAxis(Ud,e)}rotateY(e){return this.rotateOnAxis(_f,e)}rotateZ(e){return this.rotateOnAxis(wf,e)}translateOnAxis(e,t){return Ec.copy(e).applyQuaternion(this.quaternion),this.position.add(Ec.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ud,e)}translateY(e){return this.translateOnAxis(_f,e)}translateZ(e){return this.translateOnAxis(wf,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(wa.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ll.copy(e):ll.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),es.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wa.lookAt(es,ll,this.up):wa.lookAt(ll,es,this.up),this.quaternion.setFromRotationMatrix(wa),r&&(wa.extractRotation(r.matrixWorld),_a.setFromRotationMatrix(wa),this.quaternion.premultiply(_a.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Mf)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}addObject(e){return this.add(e),e}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ac)),this}removeObject(e){return this.remove(e),e}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ac)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),wa.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),wa.multiply(e.parent.matrixWorld)),e.applyMatrix4(wa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const i=this.children[n].getObjectByProperty(e,t);if(i!==void 0)return i}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectsByProperty(e,t);a.length>0&&(n=n.concat(a))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(es,e,ah),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(es,cl,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const i=t[n];i.matrixWorldAutoUpdate!==!0&&e!==!0||i.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let i=0,a=r.length;i<a;i++){const l=r[i];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(e)),u.uuid}if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const u=l.shapes;if(Array.isArray(u))for(let h=0,p=u.length;h<p;h++){const f=u[h];i(e.shapes,f)}else i(e.shapes,u)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let u=0,h=this.material.length;u<h;u++)l.push(i(e.materials,this.material[u]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++){const u=this.animations[l];r.animations.push(i(e.animations,u))}}if(t){const l=a(e.geometries),u=a(e.materials),h=a(e.textures),p=a(e.images),f=a(e.shapes),m=a(e.skeletons),g=a(e.animations),x=a(e.nodes);l.length>0&&(n.geometries=l),u.length>0&&(n.materials=u),h.length>0&&(n.textures=h),p.length>0&&(n.images=p),f.length>0&&(n.shapes=f),m.length>0&&(n.skeletons=m),g.length>0&&(n.animations=g),x.length>0&&(n.nodes=x)}return n.object=r,n;function a(l){const u=[];for(const h in l){const p=l[h];delete p.metadata,u.push(p)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}St.DEFAULT_UP=new D(0,1,0),St.DEFAULT_MATRIX_AUTO_UPDATE=!0,St.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const gi=new D,la=new D,Rc=new D,ca=new D,ul=new D,uo=new D,Tf=new D,zd=new D,Lc=new D,Ma=new D;class vi{constructor(e=new D,t=new D,n=new D){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),gi.subVectors(e,t),r.cross(gi);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){gi.subVectors(r,t),la.subVectors(n,t),Rc.subVectors(e,t);const a=gi.dot(gi),l=gi.dot(la),u=gi.dot(Rc),h=la.dot(la),p=la.dot(Rc),f=a*h-l*l;if(f===0)return i.set(-2,-1,-1);const m=1/f,g=(h*u-l*p)*m,x=(a*p-l*u)*m;return i.set(1-g-x,x,g)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,ca),ca.x>=0&&ca.y>=0&&ca.x+ca.y<=1}static getUV(e,t,n,r,i,a,l,u){return this.getBarycoord(e,t,n,r,ca),u.set(0,0),u.addScaledVector(i,ca.x),u.addScaledVector(a,ca.y),u.addScaledVector(l,ca.z),u}static isFrontFacing(e,t,n,r){return gi.subVectors(n,t),la.subVectors(e,t),gi.cross(la).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return gi.subVectors(this.c,this.b),la.subVectors(this.a,this.b),.5*gi.cross(la).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return vi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return vi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,i){return vi.getUV(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return vi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return vi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,l;ul.subVectors(r,n),uo.subVectors(i,n),zd.subVectors(e,n);const u=ul.dot(zd),h=uo.dot(zd);if(u<=0&&h<=0)return t.copy(n);Lc.subVectors(e,r);const p=ul.dot(Lc),f=uo.dot(Lc);if(p>=0&&f<=p)return t.copy(r);const m=u*f-p*h;if(m<=0&&u>=0&&p<=0)return a=u/(u-p),t.copy(n).addScaledVector(ul,a);Ma.subVectors(e,i);const g=ul.dot(Ma),x=uo.dot(Ma);if(x>=0&&g<=x)return t.copy(i);const y=g*h-u*x;if(y<=0&&h>=0&&x<=0)return l=h/(h-x),t.copy(n).addScaledVector(uo,l);const b=p*x-g*f;if(b<=0&&f-p>=0&&g-x>=0)return Tf.subVectors(i,r),l=(f-p)/(f-p+(g-x)),t.copy(r).addScaledVector(Tf,l);const w=1/(b+y+m);return a=y*w,l=m*w,t.copy(n).addScaledVector(ul,a).addScaledVector(uo,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let hl=0;class an extends Fi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:hl++}),this.uuid=mi(),this.name="",this.type="Material",this.blending=Nt,this.side=Se,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Gt,this.blendDst=Vt,this.blendEquation=Zn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ho,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Xu,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Hu,this.stencilZFail=Hu,this.stencilZPass=Hu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];r!==void 0?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(i){const a=[];for(const l in i){const u=i[l];delete u.metadata,a.push(u)}return a}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Nt&&(n.blending=this.blending),this.side!==Se&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const dl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},sr={h:0,s:0,l:0},pl={h:0,s:0,l:0};function Bd(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+6*(e-s)*t:t<.5?e:t<2/3?s+6*(e-s)*(2/3-t):s}class Ne{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Sr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,ar.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=ar.workingColorSpace){return this.r=e,this.g=t,this.b=n,ar.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=ar.workingColorSpace){if(e=Ld(e,1),t=zn(t,0,1),n=zn(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=Bd(a,i,e+1/3),this.g=Bd(a,i,e),this.b=Bd(a,i,e-1/3)}return ar.toWorkingColorSpace(this,r),this}setStyle(e,t=Sr){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],l=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,ar.toWorkingColorSpace(this,t),n(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,ar.toWorkingColorSpace(this,t),n(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const u=parseFloat(i[1])/360,h=parseFloat(i[2])/100,p=parseFloat(i[3])/100;return n(i[4]),this.setHSL(u,h,p,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],a=i.length;if(a===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,ar.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,ar.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Sr){const n=dl[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=no(e.r),this.g=no(e.g),this.b=no(e.b),this}copyLinearToSRGB(e){return this.r=Zu(e.r),this.g=Zu(e.g),this.b=Zu(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Sr){return ar.fromWorkingColorSpace(Bn.copy(this),e),zn(255*Bn.r,0,255)<<16^zn(255*Bn.g,0,255)<<8^zn(255*Bn.b,0,255)<<0}getHexString(e=Sr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ar.workingColorSpace){ar.fromWorkingColorSpace(Bn.copy(this),t);const n=Bn.r,r=Bn.g,i=Bn.b,a=Math.max(n,r,i),l=Math.min(n,r,i);let u,h;const p=(l+a)/2;if(l===a)u=0,h=0;else{const f=a-l;switch(h=p<=.5?f/(a+l):f/(2-a-l),a){case n:u=(r-i)/f+(r<i?6:0);break;case r:u=(i-n)/f+2;break;case i:u=(n-r)/f+4}u/=6}return e.h=u,e.s=h,e.l=p,e}getRGB(e,t=ar.workingColorSpace){return ar.fromWorkingColorSpace(Bn.copy(this),t),e.r=Bn.r,e.g=Bn.g,e.b=Bn.b,e}getStyle(e=Sr){ar.fromWorkingColorSpace(Bn.copy(this),e);const t=Bn.r,n=Bn.g,r=Bn.b;return e!==Sr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*t|0},${255*n|0},${255*r|0})`}offsetHSL(e,t,n){return this.getHSL(sr),sr.h+=e,sr.s+=t,sr.l+=n,this.setHSL(sr.h,sr.s,sr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(sr),e.getHSL(pl);const n=xc(sr.h,pl.h,t),r=xc(sr.s,pl.s,t),i=xc(sr.l,pl.l,t);return this.setHSL(n,r,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Bn=new Ne;Ne.NAMES=dl;class mr extends an{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ne(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ga,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Mn=new D,ho=new ce;class pt{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Qa,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)ho.fromBufferAttribute(this,t),ho.applyMatrix3(e),this.setXY(t,ho.x,ho.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.applyMatrix3(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.applyMatrix4(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.applyNormalMatrix(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.transformDirection(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Za(t,this.array)),t}setX(e,t){return this.normalized&&(t=ln(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Za(t,this.array)),t}setY(e,t){return this.normalized&&(t=ln(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Za(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ln(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Za(t,this.array)),t}setW(e,t){return this.normalized&&(t=ln(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ln(t,this.array),n=ln(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ln(t,this.array),n=ln(n,this.array),r=ln(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=ln(t,this.array),n=ln(n,this.array),r=ln(r,this.array),i=ln(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Qa&&(e.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class fl extends pt{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Es extends pt{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Tn extends pt{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class gn extends pt{constructor(e,t,n){super(new Int16Array(e),t,n)}}class ua extends pt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Rr extends pt{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Lr extends pt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class po extends pt{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class He extends pt{constructor(e,t,n){super(new Float32Array(e),t,n)}}class ri extends pt{constructor(e,t,n){super(new Float64Array(e),t,n)}}let sh=0;const yi=new Ie,oh=new St,ts=new D,ii=new ba,xi=new ba,Wn=new D;class ut extends Fi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:sh++}),this.uuid=mi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(gf(e)?Lr:ua)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new Jn().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return yi.makeRotationFromQuaternion(e),this.applyMatrix4(yi),this}rotateX(e){return yi.makeRotationX(e),this.applyMatrix4(yi),this}rotateY(e){return yi.makeRotationY(e),this.applyMatrix4(yi),this}rotateZ(e){return yi.makeRotationZ(e),this.applyMatrix4(yi),this}translate(e,t,n){return yi.makeTranslation(e,t,n),this.applyMatrix4(yi),this}scale(e,t,n){return yi.makeScale(e,t,n),this.applyMatrix4(yi),this}lookAt(e){return oh.lookAt(e),oh.updateMatrix(),this.applyMatrix4(oh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ts).negate(),this.translate(ts.x,ts.y,ts.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new He(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ba);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(1/0,1/0,1/0));if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];ii.setFromBufferAttribute(i),this.morphTargetsRelative?(Wn.addVectors(this.boundingBox.min,ii.min),this.boundingBox.expandByPoint(Wn),Wn.addVectors(this.boundingBox.max,ii.max),this.boundingBox.expandByPoint(Wn)):(this.boundingBox.expandByPoint(ii.min),this.boundingBox.expandByPoint(ii.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new D,1/0);if(e){const n=this.boundingSphere.center;if(ii.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const l=t[i];xi.setFromBufferAttribute(l),this.morphTargetsRelative?(Wn.addVectors(ii.min,xi.min),ii.expandByPoint(Wn),Wn.addVectors(ii.max,xi.max),ii.expandByPoint(Wn)):(ii.expandByPoint(xi.min),ii.expandByPoint(xi.max))}ii.getCenter(n);let r=0;for(let i=0,a=e.count;i<a;i++)Wn.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Wn));if(t)for(let i=0,a=t.length;i<a;i++){const l=t[i],u=this.morphTargetsRelative;for(let h=0,p=l.count;h<p;h++)Wn.fromBufferAttribute(l,h),u&&(ts.fromBufferAttribute(e,h),Wn.add(ts)),r=Math.max(r,n.distanceToSquared(Wn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,l=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new pt(new Float32Array(4*l),4));const u=this.getAttribute("tangent").array,h=[],p=[];for(let j=0;j<l;j++)h[j]=new D,p[j]=new D;const f=new D,m=new D,g=new D,x=new ce,y=new ce,b=new ce,w=new D,_=new D;function T(j,N,J){f.fromArray(r,3*j),m.fromArray(r,3*N),g.fromArray(r,3*J),x.fromArray(a,2*j),y.fromArray(a,2*N),b.fromArray(a,2*J),m.sub(f),g.sub(f),y.sub(x),b.sub(x);const le=1/(y.x*b.y-b.x*y.y);isFinite(le)&&(w.copy(m).multiplyScalar(b.y).addScaledVector(g,-y.y).multiplyScalar(le),_.copy(g).multiplyScalar(y.x).addScaledVector(m,-b.x).multiplyScalar(le),h[j].add(w),h[N].add(w),h[J].add(w),p[j].add(_),p[N].add(_),p[J].add(_))}let A=this.groups;A.length===0&&(A=[{start:0,count:n.length}]);for(let j=0,N=A.length;j<N;++j){const J=A[j],le=J.start;for(let oe=le,xe=le+J.count;oe<xe;oe+=3)T(n[oe+0],n[oe+1],n[oe+2])}const R=new D,C=new D,I=new D,G=new D;function U(j){I.fromArray(i,3*j),G.copy(I);const N=h[j];R.copy(N),R.sub(I.multiplyScalar(I.dot(N))).normalize(),C.crossVectors(G,N);const J=C.dot(p[j])<0?-1:1;u[4*j]=R.x,u[4*j+1]=R.y,u[4*j+2]=R.z,u[4*j+3]=J}for(let j=0,N=A.length;j<N;++j){const J=A[j],le=J.start;for(let oe=le,xe=le+J.count;oe<xe;oe+=3)U(n[oe+0]),U(n[oe+1]),U(n[oe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new pt(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let m=0,g=n.count;m<g;m++)n.setXYZ(m,0,0,0);const r=new D,i=new D,a=new D,l=new D,u=new D,h=new D,p=new D,f=new D;if(e)for(let m=0,g=e.count;m<g;m+=3){const x=e.getX(m+0),y=e.getX(m+1),b=e.getX(m+2);r.fromBufferAttribute(t,x),i.fromBufferAttribute(t,y),a.fromBufferAttribute(t,b),p.subVectors(a,i),f.subVectors(r,i),p.cross(f),l.fromBufferAttribute(n,x),u.fromBufferAttribute(n,y),h.fromBufferAttribute(n,b),l.add(p),u.add(p),h.add(p),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(y,u.x,u.y,u.z),n.setXYZ(b,h.x,h.y,h.z)}else for(let m=0,g=t.count;m<g;m+=3)r.fromBufferAttribute(t,m+0),i.fromBufferAttribute(t,m+1),a.fromBufferAttribute(t,m+2),p.subVectors(a,i),f.subVectors(r,i),p.cross(f),n.setXYZ(m+0,p.x,p.y,p.z),n.setXYZ(m+1,p.x,p.y,p.z),n.setXYZ(m+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Wn.fromBufferAttribute(e,t),Wn.normalize(),e.setXYZ(t,Wn.x,Wn.y,Wn.z)}toNonIndexed(){function e(l,u){const h=l.array,p=l.itemSize,f=l.normalized,m=new h.constructor(u.length*p);let g=0,x=0;for(let y=0,b=u.length;y<b;y++){g=l.isInterleavedBufferAttribute?u[y]*l.data.stride+l.offset:u[y]*p;for(let w=0;w<p;w++)m[x++]=h[g++]}return new pt(m,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ut,n=this.index.array,r=this.attributes;for(const l in r){const u=e(r[l],n);t.setAttribute(l,u)}const i=this.morphAttributes;for(const l in i){const u=[],h=i[l];for(let p=0,f=h.length;p<f;p++){const m=e(h[p],n);u.push(m)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,u=a.length;l<u;l++){const h=a[l];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const h=n[u];e.data.attributes[u]=h.toJSON(e.data)}const r={};let i=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],p=[];for(let f=0,m=h.length;f<m;f++){const g=h[f];p.push(g.toJSON(e.data))}p.length>0&&(r[u]=p,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const h in r){const p=r[h];this.setAttribute(h,p.clone(t))}const i=e.morphAttributes;for(const h in i){const p=[],f=i[h];for(let m=0,g=f.length;m<g;m++)p.push(f[m].clone(t));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let h=0,p=a.length;h<p;h++){const f=a[h];this.addGroup(f.start,f.count,f.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Hd=new Ie,Ta=new ol,ha=new zi,fo=new D,Ea=new D,As=new D,Rs=new D,ai=new D,Gr=new D,Aa=new ce,Bi=new ce,Hi=new ce,ns=new D,Pc=new D;class ht extends St{constructor(e=new ut,t=new mr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,i=n.length;r<i;r++){const a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const l=this.morphTargetInfluences;if(i&&l){Gr.set(0,0,0);for(let u=0,h=i.length;u<h;u++){const p=l[u],f=i[u];p!==0&&(ai.fromBufferAttribute(f,e),a?Gr.addScaledVector(ai,p):Gr.addScaledVector(ai.sub(t),p))}t.add(Gr)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),ha.copy(n.boundingSphere),ha.applyMatrix4(i),Ta.copy(e.ray).recast(e.near),ha.containsPoint(Ta.origin)===!1&&(Ta.intersectSphere(ha,fo)===null||Ta.origin.distanceToSquared(fo)>(e.far-e.near)**2))||(Hd.copy(i).invert(),Ta.copy(e.ray).applyMatrix4(Hd),n.boundingBox!==null&&Ta.intersectsBox(n.boundingBox)===!1))return;let a;const l=n.index,u=n.attributes.position,h=n.attributes.uv,p=n.attributes.uv2,f=n.groups,m=n.drawRange;if(l!==null)if(Array.isArray(r))for(let g=0,x=f.length;g<x;g++){const y=f[g],b=r[y.materialIndex];for(let w=Math.max(y.start,m.start),_=Math.min(l.count,Math.min(y.start+y.count,m.start+m.count));w<_;w+=3){const T=l.getX(w),A=l.getX(w+1),R=l.getX(w+2);a=ml(this,b,e,Ta,h,p,T,A,R),a&&(a.faceIndex=Math.floor(w/3),a.face.materialIndex=y.materialIndex,t.push(a))}}else for(let g=Math.max(0,m.start),x=Math.min(l.count,m.start+m.count);g<x;g+=3){const y=l.getX(g),b=l.getX(g+1),w=l.getX(g+2);a=ml(this,r,e,Ta,h,p,y,b,w),a&&(a.faceIndex=Math.floor(g/3),t.push(a))}else if(u!==void 0)if(Array.isArray(r))for(let g=0,x=f.length;g<x;g++){const y=f[g],b=r[y.materialIndex];for(let w=Math.max(y.start,m.start),_=Math.min(u.count,Math.min(y.start+y.count,m.start+m.count));w<_;w+=3)a=ml(this,b,e,Ta,h,p,w,w+1,w+2),a&&(a.faceIndex=Math.floor(w/3),a.face.materialIndex=y.materialIndex,t.push(a))}else for(let g=Math.max(0,m.start),x=Math.min(u.count,m.start+m.count);g<x;g+=3)a=ml(this,r,e,Ta,h,p,g,g+1,g+2),a&&(a.faceIndex=Math.floor(g/3),t.push(a))}}function ml(s,e,t,n,r,i,a,l,u){s.getVertexPosition(a,Ea),s.getVertexPosition(l,As),s.getVertexPosition(u,Rs);const h=(function(p,f,m,g,x,y,b,w){let _;if(_=f.side===Be?g.intersectTriangle(b,y,x,!0,w):g.intersectTriangle(x,y,b,f.side===Se,w),_===null)return null;Pc.copy(w),Pc.applyMatrix4(p.matrixWorld);const T=m.ray.origin.distanceTo(Pc);return T<m.near||T>m.far?null:{distance:T,point:Pc.clone(),object:p}})(s,e,t,n,Ea,As,Rs,ns);if(h){r&&(Aa.fromBufferAttribute(r,a),Bi.fromBufferAttribute(r,l),Hi.fromBufferAttribute(r,u),h.uv=vi.getUV(ns,Ea,As,Rs,Aa,Bi,Hi,new ce)),i&&(Aa.fromBufferAttribute(i,a),Bi.fromBufferAttribute(i,l),Hi.fromBufferAttribute(i,u),h.uv2=vi.getUV(ns,Ea,As,Rs,Aa,Bi,Hi,new ce));const p={a,b:l,c:u,normal:new D,materialIndex:0};vi.getNormal(Ea,As,Rs,p.normal),h.face=p}return h}class Xn extends ut{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const l=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const u=[],h=[],p=[],f=[];let m=0,g=0;function x(y,b,w,_,T,A,R,C,I,G,U){const j=A/I,N=R/G,J=A/2,le=R/2,oe=C/2,xe=I+1,ge=G+1;let Me=0,Ae=0;const De=new D;for(let pe=0;pe<ge;pe++){const re=pe*N-le;for(let ye=0;ye<xe;ye++){const Ce=ye*j-J;De[y]=Ce*_,De[b]=re*T,De[w]=oe,h.push(De.x,De.y,De.z),De[y]=0,De[b]=0,De[w]=C>0?1:-1,p.push(De.x,De.y,De.z),f.push(ye/I),f.push(1-pe/G),Me+=1}}for(let pe=0;pe<G;pe++)for(let re=0;re<I;re++){const ye=m+re+xe*pe,Ce=m+re+xe*(pe+1),_e=m+(re+1)+xe*(pe+1),Ue=m+(re+1)+xe*pe;u.push(ye,Ce,Ue),u.push(Ce,_e,Ue),Ae+=6}l.addGroup(g,Ae,U),g+=Ae,m+=Me}x("z","y","x",-1,-1,n,t,e,a,i,0),x("z","y","x",1,-1,n,t,-e,a,i,1),x("x","z","y",1,1,e,n,t,r,a,2),x("x","z","y",1,-1,e,n,-t,r,a,3),x("x","y","z",1,-1,e,t,n,r,i,4),x("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(u),this.setAttribute("position",new He(h,3)),this.setAttribute("normal",new He(p,3)),this.setAttribute("uv",new He(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function gr(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const r=s[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Dt(s){const e={};for(let t=0;t<s.length;t++){const n=gr(s[t]);for(const r in n)e[r]=n[r]}return e}function ji(s){return s.getRenderTarget()===null&&s.outputEncoding===Ct?Sr:aa}const lh={clone:gr,merge:Dt};class Bt extends an{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,this.fragmentShader=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=gr(e.uniforms),this.uniformsGroups=(function(t){const n=[];for(let r=0;r<t.length;r++)n.push(t[r].clone());return n})(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Ls extends St{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ie,this.projectionMatrix=new Ie,this.projectionMatrixInverse=new Ie}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class vn extends Ls{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*rl*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*eo*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*rl*Math.atan(Math.tan(.5*eo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*eo*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const u=a.fullWidth,h=a.fullHeight;i+=a.offsetX*r/u,t-=a.offsetY*n/h,r*=a.width/u,n*=a.height/h}const l=this.filmOffset;l!==0&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const mo=-90;class Cc extends St{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new vn(mo,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const i=new vn(mo,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(-1,0,0),this.add(i);const a=new vn(mo,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);const l=new vn(mo,1,e,t);l.layers=this.layers,l.up.set(0,0,1),l.lookAt(0,-1,0),this.add(l);const u=new vn(mo,1,e,t);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,1),this.add(u);const h=new vn(mo,1,e,t);h.layers=this.layers,h.up.set(0,1,0),h.lookAt(0,0,-1),this.add(h)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,a,l,u,h]=this.children,p=e.getRenderTarget(),f=e.toneMapping,m=e.xr.enabled;e.toneMapping=ra,e.xr.enabled=!1;const g=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,l),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=g,e.setRenderTarget(n,5),e.render(t,h),e.setRenderTarget(p),e.toneMapping=f,e.xr.enabled=m,n.texture.needsPMREMUpdate=!0}}class gl extends pn{constructor(e,t,n,r,i,a,l,u,h,p){super(e=e!==void 0?e:[],t=t!==void 0?t:Ci,n,r,i,a,l,u,h,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class go extends Xt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new gl(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0&&t.generateMipmaps,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:_t}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Xn(5,5,5),i=new Bt({name:"CubemapFromEquirect",uniforms:gr(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Be,blending:it});i.uniforms.tEquirect.value=t;const a=new ht(r,i),l=t.minFilter;return t.minFilter===Oi&&(t.minFilter=_t),new Cc(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}const Dc=new D,Mg=new D,Oc=new Jn;class Gi{constructor(e=new D(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Dc.subVectors(n,t).cross(Mg.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Dc),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Oc.getNormalMatrix(e),r=this.coplanarPoint(Dc).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const vo=new zi,Ic=new D;class Ra{constructor(e=new Gi,t=new Gi,n=new Gi,r=new Gi,i=new Gi,a=new Gi){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(n),l[3].copy(r),l[4].copy(i),l[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],l=n[3],u=n[4],h=n[5],p=n[6],f=n[7],m=n[8],g=n[9],x=n[10],y=n[11],b=n[12],w=n[13],_=n[14],T=n[15];return t[0].setComponents(l-r,f-u,y-m,T-b).normalize(),t[1].setComponents(l+r,f+u,y+m,T+b).normalize(),t[2].setComponents(l+i,f+h,y+g,T+w).normalize(),t[3].setComponents(l-i,f-h,y-g,T-w).normalize(),t[4].setComponents(l-a,f-p,y-x,T-_).normalize(),t[5].setComponents(l+a,f+p,y+x,T+_).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),vo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(vo)}intersectsSprite(e){return vo.center.set(0,0,0),vo.radius=.7071067811865476,vo.applyMatrix4(e.matrixWorld),this.intersectsSphere(vo)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Ic.x=r.normal.x>0?e.max.x:e.min.x,Ic.y=r.normal.y>0?e.max.y:e.min.y,Ic.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Ic)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function jd(){let s=null,e=!1,t=null,n=null;function r(i,a){t(i,a),n=s.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(r),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){s=i}}}function ch(s,e){const t=e.isWebGL2,n=new WeakMap;return{get:function(r){return r.isInterleavedBufferAttribute&&(r=r.data),n.get(r)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);const i=n.get(r);i&&(s.deleteBuffer(i.buffer),n.delete(r))},update:function(r,i){if(r.isGLBufferAttribute){const l=n.get(r);return void((!l||l.version<r.version)&&n.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version}))}r.isInterleavedBufferAttribute&&(r=r.data);const a=n.get(r);a===void 0?n.set(r,(function(l,u){const h=l.array,p=l.usage,f=s.createBuffer();let m;if(s.bindBuffer(u,f),s.bufferData(u,h,p),l.onUploadCallback(),h instanceof Float32Array)m=s.FLOAT;else if(h instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=s.HALF_FLOAT}else m=s.UNSIGNED_SHORT;else if(h instanceof Int16Array)m=s.SHORT;else if(h instanceof Uint32Array)m=s.UNSIGNED_INT;else if(h instanceof Int32Array)m=s.INT;else if(h instanceof Int8Array)m=s.BYTE;else if(h instanceof Uint8Array)m=s.UNSIGNED_BYTE;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);m=s.UNSIGNED_BYTE}return{buffer:f,type:m,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version}})(r,i)):a.version<r.version&&((function(l,u,h){const p=u.array,f=u.updateRange;s.bindBuffer(h,l),f.count===-1?s.bufferSubData(h,0,p):(t?s.bufferSubData(h,f.offset*p.BYTES_PER_ELEMENT,p,f.offset,f.count):s.bufferSubData(h,f.offset*p.BYTES_PER_ELEMENT,p.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()})(a.buffer,r,i),a.version=r.version)}}}class Vi extends ut{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,l=Math.floor(n),u=Math.floor(r),h=l+1,p=u+1,f=e/l,m=t/u,g=[],x=[],y=[],b=[];for(let w=0;w<p;w++){const _=w*m-a;for(let T=0;T<h;T++){const A=T*f-i;x.push(A,-_,0),y.push(0,0,1),b.push(T/l),b.push(1-w/u)}}for(let w=0;w<u;w++)for(let _=0;_<l;_++){const T=_+h*w,A=_+h*(w+1),R=_+1+h*(w+1),C=_+1+h*w;g.push(T,A,C),g.push(A,R,C)}this.setIndex(g),this.setAttribute("position",new He(x,3)),this.setAttribute("normal",new He(y,3)),this.setAttribute("uv",new He(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vi(e.width,e.height,e.widthSegments,e.heightSegments)}}const bt={alphamap_fragment:`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`,alphamap_pars_fragment:`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,alphatest_fragment:`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`,alphatest_pars_fragment:`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`,aomap_fragment:`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`,aomap_pars_fragment:`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`,begin_vertex:`
vec3 transformed = vec3( position );
`,beginnormal_vertex:`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`,bsdfs:`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );

    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disney’s reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

#ifdef USE_IRIDESCENCE

	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {

		float alpha = pow2( roughness ); // UE4's roughness

		vec3 halfDir = normalize( lightDir + viewDir );

		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );

		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );

		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

		float D = D_GGX( alpha, dotNH );

		return F * ( V * D );

	}

#endif

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif
`,iridescence_fragment:`

#ifdef USE_IRIDESCENCE

	// XYZ to linear-sRGB color space
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);

	// Assume air interface for top
	// Note: We don't handle the case fresnel0 == 1
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {

		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );

	}

	// Conversion FO/IOR
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );

	}

	// ior is a value between 1.0 and 3.0. 1.0 is air interface
	float IorToFresnel0( float transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));

	}

	// Fresnel equations for dielectric/dielectric interfaces.
	// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html
	// Evaluation XYZ sensitivity curves in Fourier space
	vec3 evalSensitivity( float OPD, vec3 shift ) {

		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );

		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;

		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;

	}

	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {

		vec3 I;

		// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		// Evaluate the cosTheta on the base layer (Snell law)
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );

		// Handle TIR:
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {

			 return vec3( 1.0 );

		}

		float cosTheta2 = sqrt( cosTheta2Sq );

		// First interface
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;

		// Second interface
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) ); // guard against 1.0
		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;

		// Phase shift
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;

		// Compound terms
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );

		// Reflectance term for m = 0 (DC term amplitude)
		vec3 C0 = R12 + Rs;
		I = C0;

		// Reflectance term for m > 0 (pairs of diracs)
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {

			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;

		}

		// Since out of gamut colors might be produced, negative color values are clamped to 0.
		return max( I, vec3( 0.0 ) );

	}

#endif

`,bumpmap_pars_fragment:`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm; // normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`,clipping_planes_fragment:`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`,clipping_planes_pars_fragment:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`,clipping_planes_pars_vertex:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`,clipping_planes_vertex:`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`,color_fragment:`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`,color_pars_fragment:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`,color_pars_vertex:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`,color_vertex:`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`,common:`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

float luminance( const in vec3 rgb ) {

	// assumes rgb is in linear color space with sRGB primaries and D65 white point

	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );

	return dot( weights, rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}

// Mipped Bicubic Texture Filtering by N8
// https://www.shadertoy.com/view/Dl2SDW

float w0( float a ) {

	return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );

}

float w1( float a ) {

	return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );

}

float w2( float a ){

    return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );

}

float w3( float a ) {

	return ( 1.0 / 6.0 ) * ( a * a * a );

}

// g0 and g1 are the two amplitude functions
float g0( float a ) {

	return w0( a ) + w1( a );

}

float g1( float a ) {

	return w2( a ) + w3( a );

}

// h0 and h1 are the two offset functions
float h0( float a ) {

	return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );

}

float h1( float a ) {

    return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );

}

vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {

	uv = uv * texelSize.zw + 0.5;

	vec2 iuv = floor( uv );
    vec2 fuv = fract( uv );

    float g0x = g0( fuv.x );
    float g1x = g1( fuv.x );
    float h0x = h0( fuv.x );
    float h1x = h1( fuv.x );
    float h0y = h0( fuv.y );
    float h1y = h1( fuv.y );

    vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
    vec2 lodFudge = pow( 1.95, lod ) / fullSize;
#if __VERSION__ > 130
	return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
		   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
#else
	return texture2D(tex, uv); //TODO: remove
#endif
}

vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {

#if __VERSION__ > 130
	vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
	vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
	vec2 fLodSizeInv = 1.0 / fLodSize;
	vec2 cLodSizeInv = 1.0 / cLodSize;
	vec2 fullSize = vec2( textureSize( sampler, 0 ) );
	vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
	vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
	return mix( fSample, cSample, fract( lod ) );
#else
	return texture2D(sampler, uv); //TODO: remove
#endif

}
`,cube_uv_reflection_fragment:`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0; // #25071

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		uv.x += filterInt * 3.0 * cubeUV_minTileSize;

		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );

		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;

		#ifdef texture2DGradEXT

			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb; // disable anisotropic filtering

		#else

			return texture2D( envMap, uv ).rgb;

		#endif

	}

	// These defines must match with PMREMGenerator

	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= cubeUV_r1 ) {

			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;

		} else if ( roughness >= cubeUV_r4 ) {

			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;

		} else if ( roughness >= cubeUV_r5 ) {

			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;

		} else if ( roughness >= cubeUV_r6 ) {

			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`,defaultnormal_vertex:`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`,displacementmap_pars_vertex:`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`,displacementmap_vertex:`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`,emissivemap_fragment:`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`,emissivemap_pars_fragment:`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`,encodings_fragment:`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`,encodings_pars_fragment:`

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`,envmap_fragment:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`,envmap_common_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3  envRotationMatrix;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`,envmap_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`,envmap_pars_vertex:`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`,envmap_physical_pars_fragment:`
#if defined( USE_ENVMAP )

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envRotationMatrix*worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec = reflect( - viewDir, normal );

			// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envRotationMatrix*reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`,envmap_vertex:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`,fog_vertex:`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`,fog_pars_vertex:`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`,fog_fragment:`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`,fog_pars_fragment:`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`,gradientmap_pars_fragment:`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );

	#endif

}
`,lightmap_fragment:`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`,lightmap_pars_fragment:`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`,lights_lambert_fragment:`
LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;
`,lights_lambert_pars_fragment:`
varying vec3 vViewPosition;

struct LambertMaterial {

	vec3 diffuseColor;
	float specularStrength;

};

void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
`,lights_pars_begin:`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( LEGACY_LIGHTS )

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#else

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`,lights_toon_fragment:`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`,lights_toon_pars_fragment:`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
`,lights_phong_fragment:`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,lights_phong_pars_fragment:`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,lights_physical_fragment:`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	material.ior = ior;

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARCOLORMAP

			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_IRIDESCENCE

	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;

	#ifdef USE_IRIDESCENCEMAP

		material.iridescence *= texture2D( iridescenceMap, vUv ).r;

	#endif

	#ifdef USE_IRIDESCENCE_THICKNESSMAP

		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;

	#else

		material.iridescenceThickness = iridescenceThicknessMaximum;

	#endif

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEENCOLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEENROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;

	#endif

#endif
`,lights_physical_pars_fragment:`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

	#ifdef IOR
		float ior;
	#endif

	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from 
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Agüera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	#ifdef USE_IRIDESCENCE

		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );

	#else

		vec3 Fr = specularColor;

	#endif

	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );

	#endif

	#ifdef USE_IRIDESCENCE

		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );

	#else

		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );

	#endif

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	#ifdef USE_IRIDESCENCE

		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );

	#else

		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	#endif

	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`,lights_fragment_begin:`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

#ifdef USE_IRIDESCENCE

	float dotNVi = saturate( dot( normal, geometry.viewDir ) );

	if ( material.iridescenceThickness == 0.0 ) {

		material.iridescence = 0.0;

	} else {

		material.iridescence = saturate( material.iridescence );

	}

	if ( material.iridescence > 0.0 ) {

		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );

		// Iridescence F0 approximation
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );

	}

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;

	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif

		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif

		#undef SPOT_LIGHT_MAP_INDEX

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,lights_fragment_maps:`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`,lights_fragment_end:`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`,logdepthbuf_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`,logdepthbuf_pars_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`,logdepthbuf_pars_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`,logdepthbuf_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`,map_fragment:`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`,map_pars_fragment:`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`,map_particle_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`,map_particle_pars_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,metalnessmap_fragment:`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`,metalnessmap_pars_fragment:`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`,morphcolor_vertex:`
#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	vColor *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		#if defined( USE_COLOR_ALPHA )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];

		#elif defined( USE_COLOR )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];

		#endif

	}

#endif
`,morphnormal_vertex:`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`,morphtarget_pars_vertex:`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;

		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {

			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;

			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`,morphtarget_vertex:`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`,normal_fragment_begin:`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`,normal_fragment_maps:`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`,normal_pars_fragment:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_pars_vertex:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_vertex:`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`,normalmap_pars_fragment:`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`,clearcoat_normal_fragment_begin:`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`,clearcoat_normal_fragment_maps:`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`,clearcoat_pars_fragment:`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`,iridescence_pars_fragment:`

#ifdef USE_IRIDESCENCEMAP

	uniform sampler2D iridescenceMap;

#endif

#ifdef USE_IRIDESCENCE_THICKNESSMAP

	uniform sampler2D iridescenceThicknessMap;

#endif
`,output_fragment:`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`,packing:`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}

float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,premultiplied_alpha_fragment:`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`,project_vertex:`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`,dithering_fragment:`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`,dithering_pars_fragment:`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift according to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`,roughnessmap_fragment:`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`,roughnessmap_pars_fragment:`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`,shadowmap_pars_fragment:`
#if NUM_SPOT_LIGHT_COORDS > 0

	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#if NUM_SPOT_LIGHT_MAPS > 0

	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`,shadowmap_pars_vertex:`

#if NUM_SPOT_LIGHT_COORDS > 0

	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`,shadowmap_vertex:`

#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )

	// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;

#endif

#if defined( USE_SHADOWMAP )

	#if NUM_DIR_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif

// spot lights can be evaluated without active shadow mapping (when SpotLight.map is used)

#if NUM_SPOT_LIGHT_COORDS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {

		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

#endif


`,shadowmask_pars_fragment:`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`,skinbase_vertex:`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`,skinning_pars_vertex:`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;

	mat4 getBoneMatrix( const in float i ) {

		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );

		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );

		y = dy * ( y + 0.5 );

		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

		mat4 bone = mat4( v1, v2, v3, v4 );

		return bone;

	}

#endif
`,skinning_vertex:`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`,skinnormal_vertex:`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`,specularmap_fragment:`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`,specularmap_pars_fragment:`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`,tonemapping_fragment:`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`,tonemapping_pars_fragment:`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );
}

vec3 CustomToneMapping( vec3 color ) { return color; }
`,transmission_fragment:`
#ifdef USE_TRANSMISSION

	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		material.transmission *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		material.thickness *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );

	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );

#endif
`,transmission_pars_fragment:`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );

	}

	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( isinf( attenuationDistance ) ) {

			// Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`,uv_pars_fragment:`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`,uv_pars_vertex:`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`,uv_vertex:`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`,uv2_pars_fragment:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`,uv2_pars_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`,uv2_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`,worldpos_vertex:`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`,background_vert:`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,background_frag:`
uniform sampler2D t2D;
uniform float backgroundIntensity;

varying vec2 vUv;

void main() {

	vec4 texColor = texture2D( t2D, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,backgroundCube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,backgroundCube_frag:`

#ifdef ENVMAP_TYPE_CUBE

	uniform samplerCube envMap;

#elif defined( ENVMAP_TYPE_CUBE_UV )

	uniform sampler2D envMap;

#endif

uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3  envRotationMatrix;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 dir = envRotationMatrix * vWorldDirection;

	#ifdef ENVMAP_TYPE_CUBE

		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * dir.x, dir.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 texColor = textureCubeUV( envMap, dir, backgroundBlurriness );

	#else

		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,cube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,cube_frag:`
uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;

varying vec3 vWorldDirection;

void main() {

	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );

	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,depth_vert:`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,depth_frag:`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`,distanceRGBA_vert:`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,distanceRGBA_frag:`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`,equirect_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,equirect_frag:`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,linedashed_vert:`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,linedashed_frag:`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,meshbasic_vert:`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,meshbasic_frag:`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshlambert_vert:`
#define LAMBERT

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshlambert_frag:`
#define LAMBERT

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshmatcap_vert:`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,meshmatcap_frag:`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshnormal_vert:`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,meshnormal_frag:`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`,meshphong_vert:`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshphong_frag:`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshphysical_vert:`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,meshphysical_frag:`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

#if defined(DEBUG_OCCLUSION) && defined(USE_AOMAP)
	gl_FragColor.rgb = vec3(ambientOcclusion);
#endif

#if defined(DEBUG_NORMAL)
	gl_FragColor.rgb = geometry.normal * 0.5 + 0.5;
#endif

#if defined(DEBUG_ROUGHNESS)
	gl_FragColor.rgb = vec3(material.roughness);
#endif

#if defined(DEBUG_METALNESS)
	gl_FragColor.rgb = vec3(metalnessFactor);
#endif

}
`,meshtoon_vert:`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshtoon_frag:`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,points_vert:`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,points_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,shadow_vert:`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,shadow_frag:`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	#include <logdepthbuf_fragment>

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`,sprite_vert:`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,sprite_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`},je={common:{diffuse:{value:new Ne(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Jn},uv2Transform:{value:new Jn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ce(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ne(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ne(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Jn}},sprite:{diffuse:{value:new Ne(16777215)},opacity:{value:1},center:{value:new ce(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Jn}}},bi={basic:{uniforms:Dt([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.fog]),vertexShader:bt.meshbasic_vert,fragmentShader:bt.meshbasic_frag},lambert:{uniforms:Dt([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.fog,je.lights,{emissive:{value:new Ne(0)}}]),vertexShader:bt.meshlambert_vert,fragmentShader:bt.meshlambert_frag},phong:{uniforms:Dt([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.fog,je.lights,{emissive:{value:new Ne(0)},specular:{value:new Ne(1118481)},shininess:{value:30}}]),vertexShader:bt.meshphong_vert,fragmentShader:bt.meshphong_frag},standard:{uniforms:Dt([je.common,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.roughnessmap,je.metalnessmap,je.fog,je.lights,{emissive:{value:new Ne(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:bt.meshphysical_vert,fragmentShader:bt.meshphysical_frag},toon:{uniforms:Dt([je.common,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.gradientmap,je.fog,je.lights,{emissive:{value:new Ne(0)}}]),vertexShader:bt.meshtoon_vert,fragmentShader:bt.meshtoon_frag},matcap:{uniforms:Dt([je.common,je.bumpmap,je.normalmap,je.displacementmap,je.fog,{matcap:{value:null}}]),vertexShader:bt.meshmatcap_vert,fragmentShader:bt.meshmatcap_frag},points:{uniforms:Dt([je.points,je.fog]),vertexShader:bt.points_vert,fragmentShader:bt.points_frag},dashed:{uniforms:Dt([je.common,je.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bt.linedashed_vert,fragmentShader:bt.linedashed_frag},depth:{uniforms:Dt([je.common,je.displacementmap]),vertexShader:bt.depth_vert,fragmentShader:bt.depth_frag},normal:{uniforms:Dt([je.common,je.bumpmap,je.normalmap,je.displacementmap,{opacity:{value:1}}]),vertexShader:bt.meshnormal_vert,fragmentShader:bt.meshnormal_frag},sprite:{uniforms:Dt([je.sprite,je.fog]),vertexShader:bt.sprite_vert,fragmentShader:bt.sprite_frag},background:{uniforms:{uvTransform:{value:new Jn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:bt.background_vert,fragmentShader:bt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:bt.backgroundCube_vert,fragmentShader:bt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:bt.cube_vert,fragmentShader:bt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bt.equirect_vert,fragmentShader:bt.equirect_frag},distanceRGBA:{uniforms:Dt([je.common,je.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bt.distanceRGBA_vert,fragmentShader:bt.distanceRGBA_frag},shadow:{uniforms:Dt([je.lights,je.fog,{color:{value:new Ne(0)},opacity:{value:1}}]),vertexShader:bt.shadow_vert,fragmentShader:bt.shadow_frag}};bi.physical={uniforms:Dt([bi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ce(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ne(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ce},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ne(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ne(1,1,1)},specularColorMap:{value:null}}]),vertexShader:bt.meshphysical_vert,fragmentShader:bt.meshphysical_frag};const vl={r:0,b:0,g:0};function Gd(s,e,t,n,r,i,a){const l=new Ne(0);let u,h,p=i===!0?0:1,f=null,m=0,g=null;function x(y,b){y.getRGB(vl,ji(s)),n.buffers.color.setClear(vl.r,vl.g,vl.b,b,a)}return{getClearColor:function(){return l},setClearColor:function(y,b=1){l.set(y),p=b,x(l,p)},getClearAlpha:function(){return p},setClearAlpha:function(y){p=y,x(l,p)},render:function(y,b){let w=!1,_=b.isScene===!0?b.background:null;_&&_.isTexture&&(_=(b.backgroundBlurriness>0?t:e).get(_));const T=s.xr,A=T.getSession&&T.getSession();A&&A.environmentBlendMode==="additive"&&(_=null),_===null?x(l,p):_&&_.isColor&&(x(_,1),w=!0),(s.autoClear||w)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Ws)?(h===void 0&&(h=new ht(new Xn(1,1,1),new Bt({name:"BackgroundCubeMaterial",uniforms:gr(bi.backgroundCube.uniforms),vertexShader:bi.backgroundCube.vertexShader,fragmentShader:bi.backgroundCube.fragmentShader,side:Be,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(R,C,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=_,h.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=b.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,h.material.toneMapped=_.encoding!==Ct,f===_&&m===_.version&&g===s.toneMapping||(h.material.needsUpdate=!0,f=_,m=_.version,g=s.toneMapping),h.layers.enableAll(),y.unshift(h,h.geometry,h.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new ht(new Vi(2,2),new Bt({name:"BackgroundMaterial",uniforms:gr(bi.background.uniforms),vertexShader:bi.background.vertexShader,fragmentShader:bi.background.fragmentShader,side:Se,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=_,u.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,u.material.toneMapped=_.encoding!==Ct,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),f===_&&m===_.version&&g===s.toneMapping||(u.material.needsUpdate=!0,f=_,m=_.version,g=s.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}}}function yl(s,e,t,n){const r=s.getParameter(s.MAX_VERTEX_ATTRIBS),i=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||i!==null,l={},u=g(null);let h=u,p=!1;function f(R){return n.isWebGL2?s.bindVertexArray(R):i.bindVertexArrayOES(R)}function m(R){return n.isWebGL2?s.deleteVertexArray(R):i.deleteVertexArrayOES(R)}function g(R){const C=[],I=[],G=[];for(let U=0;U<r;U++)C[U]=0,I[U]=0,G[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:C,enabledAttributes:I,attributeDivisors:G,object:R,attributes:{},index:null}}function x(){const R=h.newAttributes;for(let C=0,I=R.length;C<I;C++)R[C]=0}function y(R){b(R,0)}function b(R,C){const I=h.newAttributes,G=h.enabledAttributes,U=h.attributeDivisors;I[R]=1,G[R]===0&&(s.enableVertexAttribArray(R),G[R]=1),U[R]!==C&&((n.isWebGL2?s:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,C),U[R]=C)}function w(){const R=h.newAttributes,C=h.enabledAttributes;for(let I=0,G=C.length;I<G;I++)C[I]!==R[I]&&(s.disableVertexAttribArray(I),C[I]=0)}function _(R,C,I,G,U,j){n.isWebGL2!==!0||I!==s.INT&&I!==s.UNSIGNED_INT?s.vertexAttribPointer(R,C,I,G,U,j):s.vertexAttribIPointer(R,C,I,U,j)}function T(){A(),p=!0,h!==u&&(h=u,f(h.object))}function A(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(R,C,I,G,U){let j=!1;if(a){const N=(function(J,le,oe){const xe=oe.wireframe===!0;let ge=l[J.id];ge===void 0&&(ge={},l[J.id]=ge);let Me=ge[le.id];Me===void 0&&(Me={},ge[le.id]=Me);let Ae=Me[xe];return Ae===void 0&&(Ae=g(n.isWebGL2?s.createVertexArray():i.createVertexArrayOES()),Me[xe]=Ae),Ae})(G,I,C);h!==N&&(h=N,f(h.object)),j=(function(J,le,oe,xe){const ge=h.attributes,Me=le.attributes;let Ae=0;const De=oe.getAttributes();for(const pe in De)if(De[pe].location>=0){const re=ge[pe];let ye=Me[pe];if(ye===void 0&&(pe==="instanceMatrix"&&J.instanceMatrix&&(ye=J.instanceMatrix),pe==="instanceColor"&&J.instanceColor&&(ye=J.instanceColor)),re===void 0||re.attribute!==ye||ye&&re.data!==ye.data)return!0;Ae++}return h.attributesNum!==Ae||h.index!==xe})(R,G,I,U),j&&(function(J,le,oe,xe){const ge={},Me=le.attributes;let Ae=0;const De=oe.getAttributes();for(const pe in De)if(De[pe].location>=0){let re=Me[pe];re===void 0&&(pe==="instanceMatrix"&&J.instanceMatrix&&(re=J.instanceMatrix),pe==="instanceColor"&&J.instanceColor&&(re=J.instanceColor));const ye={};ye.attribute=re,re&&re.data&&(ye.data=re.data),ge[pe]=ye,Ae++}h.attributes=ge,h.attributesNum=Ae,h.index=xe})(R,G,I,U)}else{const N=C.wireframe===!0;h.geometry===G.id&&h.program===I.id&&h.wireframe===N||(h.geometry=G.id,h.program=I.id,h.wireframe=N,j=!0)}U!==null&&t.update(U,s.ELEMENT_ARRAY_BUFFER),(j||p)&&(p=!1,(function(N,J,le,oe){if(n.isWebGL2===!1&&(N.isInstancedMesh||oe.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();const xe=oe.attributes,ge=le.getAttributes(),Me=J.defaultAttributeValues;for(const Ae in ge){const De=ge[Ae];if(De.location>=0){let pe=xe[Ae];if(pe===void 0&&(Ae==="instanceMatrix"&&N.instanceMatrix&&(pe=N.instanceMatrix),Ae==="instanceColor"&&N.instanceColor&&(pe=N.instanceColor)),pe!==void 0){const re=pe.normalized,ye=pe.itemSize,Ce=t.get(pe);if(Ce===void 0)continue;const _e=Ce.buffer,Ue=Ce.type,H=Ce.bytesPerElement;if(pe.isInterleavedBufferAttribute){const k=pe.data,ie=k.stride,q=pe.offset;if(k.isInstancedInterleavedBuffer){for(let B=0;B<De.locationSize;B++)b(De.location+B,k.meshPerAttribute);N.isInstancedMesh!==!0&&oe._maxInstanceCount===void 0&&(oe._maxInstanceCount=k.meshPerAttribute*k.count)}else for(let B=0;B<De.locationSize;B++)y(De.location+B);s.bindBuffer(s.ARRAY_BUFFER,_e);for(let B=0;B<De.locationSize;B++)_(De.location+B,ye/De.locationSize,Ue,re,ie*H,(q+ye/De.locationSize*B)*H)}else{if(pe.isInstancedBufferAttribute){for(let k=0;k<De.locationSize;k++)b(De.location+k,pe.meshPerAttribute);N.isInstancedMesh!==!0&&oe._maxInstanceCount===void 0&&(oe._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let k=0;k<De.locationSize;k++)y(De.location+k);s.bindBuffer(s.ARRAY_BUFFER,_e);for(let k=0;k<De.locationSize;k++)_(De.location+k,ye/De.locationSize,Ue,re,ye*H,ye/De.locationSize*k*H)}}else if(Me!==void 0){const re=Me[Ae];if(re!==void 0)switch(re.length){case 2:s.vertexAttrib2fv(De.location,re);break;case 3:s.vertexAttrib3fv(De.location,re);break;case 4:s.vertexAttrib4fv(De.location,re);break;default:s.vertexAttrib1fv(De.location,re)}}}}w()})(R,C,I,G),U!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t.get(U).buffer))},reset:T,resetDefaultState:A,dispose:function(){T();for(const R in l){const C=l[R];for(const I in C){const G=C[I];for(const U in G)m(G[U].object),delete G[U];delete C[I]}delete l[R]}},releaseStatesOfGeometry:function(R){if(l[R.id]===void 0)return;const C=l[R.id];for(const I in C){const G=C[I];for(const U in G)m(G[U].object),delete G[U];delete C[I]}delete l[R.id]},releaseStatesOfProgram:function(R){for(const C in l){const I=l[C];if(I[R.id]===void 0)continue;const G=I[R.id];for(const U in G)m(G[U].object),delete G[U];delete I[R.id]}},initAttributes:x,enableAttribute:y,disableUnusedAttributes:w}}function Wi(s,e,t,n){const r=n.isWebGL2;let i;this.setMode=function(a){i=a},this.render=function(a,l){s.drawArrays(i,a,l),t.update(l,i,1)},this.renderInstances=function(a,l,u){if(u===0)return;let h,p;if(r)h=s,p="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",h===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[p](i,a,l,u),t.update(l,i,u)}}function yo(s,e,t){let n;function r(A){if(A==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return A==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const i=typeof WebGL2RenderingContext<"u"&&s instanceof WebGL2RenderingContext;let a=t.precision!==void 0?t.precision:"highp";const l=r(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=i||e.has("WEBGL_draw_buffers"),h=t.logarithmicDepthBuffer===!0,p=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),f=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=s.getParameter(s.MAX_TEXTURE_SIZE),g=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),x=s.getParameter(s.MAX_VERTEX_ATTRIBS),y=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),b=s.getParameter(s.MAX_VARYING_VECTORS),w=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),_=f>0,T=i||e.has("OES_texture_float");return{isWebGL2:i,drawBuffers:u,getMaxAnisotropy:function(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");n=s.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:h,maxTextures:p,maxVertexTextures:f,maxTextureSize:m,maxCubemapSize:g,maxAttributes:x,maxVertexUniforms:y,maxVaryings:b,maxFragmentUniforms:w,vertexTextures:_,floatFragmentTextures:T,floatVertexTextures:_&&T,maxSamples:i?s.getParameter(s.MAX_SAMPLES):0}}function Vd(s){const e=this;let t=null,n=0,r=!1,i=!1;const a=new Gi,l=new Jn,u={value:null,needsUpdate:!1};function h(p,f,m,g){const x=p!==null?p.length:0;let y=null;if(x!==0){if(y=u.value,g!==!0||y===null){const b=m+4*x,w=f.matrixWorldInverse;l.getNormalMatrix(w),(y===null||y.length<b)&&(y=new Float32Array(b));for(let _=0,T=m;_!==x;++_,T+=4)a.copy(p[_]).applyMatrix4(w,l),a.normal.toArray(y,T),y[T+3]=a.constant}u.value=y,u.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,y}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(p,f){const m=p.length!==0||f||n!==0||r;return r=f,n=p.length,m},this.beginShadows=function(){i=!0,h(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(p,f){t=h(p,f,0)},this.setState=function(p,f,m){const g=p.clippingPlanes,x=p.clipIntersection,y=p.clipShadows,b=s.get(p);if(!r||g===null||g.length===0||i&&!y)i?h(null):(function(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0})();else{const w=i?0:n,_=4*w;let T=b.clippingState||null;u.value=T,T=h(g,f,_,m);for(let A=0;A!==_;++A)T[A]=t[A];b.clippingState=T,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=w}}}function Ef(s){let e=new WeakMap;function t(r,i){return i===ys?r.mapping=Ci:i===Vo&&(r.mapping=Di),r}function n(r){const i=r.target;i.removeEventListener("dispose",n);const a=e.get(i);a!==void 0&&(e.delete(i),a.dispose())}return{get:function(r){if(r&&r.isTexture&&r.isRenderTargetTexture===!1){const i=r.mapping;if(i===ys||i===Vo){if(e.has(r))return t(e.get(r).texture,r.mapping);{const a=r.image;if(a&&a.height>0){const l=new go(a.height/2);return l.fromEquirectangularTexture(s,r),e.set(r,l),r.addEventListener("dispose",n),t(l.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}class Pr extends Ls{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,l=r+t,u=r-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=h*this.view.offsetX,a=i+h*this.view.width,l-=p*this.view.offsetY,u=l-p*this.view.height}this.projectionMatrix.makeOrthographic(i,a,l,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const rs=[.125,.215,.35,.446,.526,.582],xo=20,uh=new Pr,La=new Ne;let Pa=null;const Ca=(1+Math.sqrt(5))/2,bo=1/Ca,Nc=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,Ca,bo),new D(0,Ca,-bo),new D(bo,0,Ca),new D(-bo,0,Ca),new D(Ca,bo,0),new D(-Ca,bo,0)];class hh{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Pa=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Sl(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=bl(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Pa),e.scissorTest=!1,Si(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ci||e.mapping===Di?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Pa=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:_t,minFilter:_t,generateMipmaps:!1,type:br,format:Hr,encoding:jr,depthBuffer:!1},r=xl(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=xl(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=(function(a){const l=[],u=[],h=[];let p=a;const f=a-4+1+rs.length;for(let m=0;m<f;m++){const g=Math.pow(2,p);u.push(g);let x=1/g;m>a-4?x=rs[m-a+4-1]:m===0&&(x=0),h.push(x);const y=1/(g-2),b=-y,w=1+y,_=[b,b,w,b,w,w,b,b,w,w,b,w],T=6,A=6,R=3,C=2,I=1,G=new Float32Array(R*A*T),U=new Float32Array(C*A*T),j=new Float32Array(I*A*T);for(let J=0;J<T;J++){const le=J%3*2/3-1,oe=J>2?0:-1,xe=[le,oe,0,le+2/3,oe,0,le+2/3,oe+1,0,le,oe,0,le+2/3,oe+1,0,le,oe+1,0];G.set(xe,R*A*J),U.set(_,C*A*J);const ge=[J,J,J,J,J,J];j.set(ge,I*A*J)}const N=new ut;N.setAttribute("position",new pt(G,R)),N.setAttribute("uv",new pt(U,C)),N.setAttribute("faceIndex",new pt(j,I)),l.push(N),p>4&&p--}return{lodPlanes:l,sizeLods:u,sigmas:h}})(i)),this._blurMaterial=(function(a,l,u){const h=new Float32Array(xo),p=new D(0,1,0);return new Bt({name:"SphericalGaussianBlur",defines:{n:xo,CUBEUV_TEXEL_WIDTH:1/l,CUBEUV_TEXEL_HEIGHT:1/u,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:h},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p}},vertexShader:is(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:it,depthTest:!1,depthWrite:!1})})(i,e,t)}return r}_compileMaterial(e){const t=new ht(this._lodPlanes[0],e);this._renderer.compile(t,uh)}_sceneToCubeUV(e,t,n,r){const i=new vn(90,1,t,n),a=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,p=u.toneMapping;u.getClearColor(La),u.toneMapping=ra,u.autoClear=!1;const f=new mr({name:"PMREM.Background",side:Be,depthWrite:!1,depthTest:!1}),m=new ht(new Xn,f);let g=!1;const x=e.background;x?x.isColor&&(f.color.copy(x),e.background=null,g=!0):(f.color.copy(La),g=!0);for(let y=0;y<6;y++){const b=y%3;b===0?(i.up.set(0,a[y],0),i.lookAt(l[y],0,0)):b===1?(i.up.set(0,0,a[y]),i.lookAt(0,l[y],0)):(i.up.set(0,a[y],0),i.lookAt(0,0,l[y]));const w=this._cubeSize;Si(r,b*w,y>2?w:0,w,w),u.setRenderTarget(r),g&&u.render(m,i),u.render(e,i)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=p,u.autoClear=h,e.background=x}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Ci||e.mapping===Di;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=Sl()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=bl());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new ht(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const l=this._cubeSize;Si(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(a,uh)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const i=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=Nc[(r-1)%Nc.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,l){const u=this._renderer,h=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const p=new ht(this._lodPlanes[r],h),f=h.uniforms,m=this._sizeLods[n]-1,g=isFinite(i)?Math.PI/(2*m):2*Math.PI/39,x=i/g,y=isFinite(i)?1+Math.floor(3*x):xo;y>xo&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${y} samples when the maximum is set to 20`);const b=[];let w=0;for(let A=0;A<xo;++A){const R=A/x,C=Math.exp(-R*R/2);b.push(C),A===0?w+=C:A<y&&(w+=2*C)}for(let A=0;A<b.length;A++)b[A]=b[A]/w;f.envMap.value=e.texture,f.samples.value=y,f.weights.value=b,f.latitudinal.value=a==="latitudinal",l&&(f.poleAxis.value=l);const{_lodMax:_}=this;f.dTheta.value=g,f.mipInt.value=_-n;const T=this._sizeLods[r];Si(t,3*T*(r>_-4?r-_+4:0),4*(this._cubeSize-T),3*T,2*T),u.setRenderTarget(t),u.render(p,uh)}}function xl(s,e,t){const n=new Xt(s,e,t);return n.texture.mapping=Ws,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Si(s,e,t,n,r){s.viewport.set(e,t,n,r),s.scissor.set(e,t,n,r)}function bl(){return new Bt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:is(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:it,depthTest:!1,depthWrite:!1})}function Sl(){return new Bt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:is(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:it,depthTest:!1,depthWrite:!1})}function is(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Wd(s){let e=new WeakMap,t=null;function n(r){const i=r.target;i.removeEventListener("dispose",n);const a=e.get(i);a!==void 0&&(e.delete(i),a.dispose())}return{get:function(r){if(r&&r.isTexture){const i=r.mapping,a=i===ys||i===Vo,l=i===Ci||i===Di;if(a||l){if(r.isRenderTargetTexture&&r.needsPMREMUpdate===!0){r.needsPMREMUpdate=!1;let u=e.get(r);return t===null&&(t=new hh(s)),u=a?t.fromEquirectangular(r,u):t.fromCubemap(r,u),e.set(r,u),u.texture}if(e.has(r))return e.get(r).texture;{const u=r.image;if(a&&u&&u.height>0||l&&u&&(function(h){let p=0;const f=6;for(let m=0;m<f;m++)h[m]!==void 0&&p++;return p===f})(u)){t===null&&(t=new hh(s));const h=a?t.fromEquirectangular(r):t.fromCubemap(r);return e.set(r,h),r.addEventListener("dispose",n),h.texture}return null}}}return r},dispose:function(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}}}function _l(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=s.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function Af(s,e,t,n){const r={},i=new WeakMap;function a(u){const h=u.target;h.index!==null&&e.remove(h.index);for(const f in h.attributes)e.remove(h.attributes[f]);h.removeEventListener("dispose",a),delete r[h.id];const p=i.get(h);p&&(e.remove(p),i.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function l(u){const h=[],p=u.index,f=u.attributes.position;let m=0;if(p!==null){const y=p.array;m=p.version;for(let b=0,w=y.length;b<w;b+=3){const _=y[b+0],T=y[b+1],A=y[b+2];h.push(_,T,T,A,A,_)}}else{const y=f.array;m=f.version;for(let b=0,w=y.length/3-1;b<w;b+=3){const _=b+0,T=b+1,A=b+2;h.push(_,T,T,A,A,_)}}const g=new(gf(h)?Lr:ua)(h,1);g.version=m;const x=i.get(u);x&&e.remove(x),i.set(u,g)}return{get:function(u,h){return r[h.id]===!0||(h.addEventListener("dispose",a),r[h.id]=!0,t.memory.geometries++),h},update:function(u){const h=u.attributes;for(const f in h)e.update(h[f],s.ARRAY_BUFFER);const p=u.morphAttributes;for(const f in p){const m=p[f];for(let g=0,x=m.length;g<x;g++)e.update(m[g],s.ARRAY_BUFFER)}},getWireframeAttribute:function(u){const h=i.get(u);if(h){const p=u.index;p!==null&&h.version<p.version&&l(u)}else l(u);return i.get(u)}}}function Xd(s,e,t,n){const r=n.isWebGL2;let i,a,l;this.setMode=function(u){i=u},this.setIndex=function(u){a=u.type,l=u.bytesPerElement},this.render=function(u,h){s.drawElements(i,h,a,u*l),t.update(h,i,1)},this.renderInstances=function(u,h,p){if(p===0)return;let f,m;if(r)f=s,m="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",f===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");f[m](i,h,a,u*l,p),t.update(h,i,p)}}function On(s){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(e.calls++,n){case s.TRIANGLES:e.triangles+=r*(t/3);break;case s.LINES:e.lines+=r*(t/2);break;case s.LINE_STRIP:e.lines+=r*(t-1);break;case s.LINE_LOOP:e.lines+=r*t;break;case s.POINTS:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function dh(s,e){return s[0]-e[0]}function qd(s,e){return Math.abs(e[1])-Math.abs(s[1])}function Yd(s,e,t){const n={},r=new Float32Array(8),i=new WeakMap,a=new ot,l=[];for(let u=0;u<8;u++)l[u]=[u,0];return{update:function(u,h,p){const f=u.morphTargetInfluences;if(e.isWebGL2===!0){const m=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,g=m!==void 0?m.length:0;let x=i.get(h);if(x===void 0||x.count!==g){x!==void 0&&x.texture.dispose();const w=h.morphAttributes.position!==void 0,_=h.morphAttributes.normal!==void 0,T=h.morphAttributes.color!==void 0,A=h.morphAttributes.position||[],R=h.morphAttributes.normal||[],C=h.morphAttributes.color||[];let I=0;w===!0&&(I=1),_===!0&&(I=2),T===!0&&(I=3);let G=h.attributes.position.count*I,U=1;G>e.maxTextureSize&&(U=Math.ceil(G/e.maxTextureSize),G=e.maxTextureSize);const j=new Float32Array(G*U*4*g),N=new sl(j,G,U,g);N.type=xr,N.needsUpdate=!0;const J=4*I;for(let le=0;le<g;le++){const oe=A[le],xe=R[le],ge=C[le],Me=G*U*4*le;for(let Ae=0;Ae<oe.count;Ae++){const De=Ae*J;w===!0&&(a.fromBufferAttribute(oe,Ae),j[Me+De+0]=a.x,j[Me+De+1]=a.y,j[Me+De+2]=a.z,j[Me+De+3]=0),_===!0&&(a.fromBufferAttribute(xe,Ae),j[Me+De+4]=a.x,j[Me+De+5]=a.y,j[Me+De+6]=a.z,j[Me+De+7]=0),T===!0&&(a.fromBufferAttribute(ge,Ae),j[Me+De+8]=a.x,j[Me+De+9]=a.y,j[Me+De+10]=a.z,j[Me+De+11]=ge.itemSize===4?a.w:1)}}x={count:g,texture:N,size:new ce(G,U)},i.set(h,x),h.addEventListener("dispose",(function le(){N.dispose(),i.delete(h),h.removeEventListener("dispose",le)}))}let y=0;for(let w=0;w<f.length;w++)y+=f[w];const b=h.morphTargetsRelative?1:1-y;p.getUniforms().setValue(s,"morphTargetBaseInfluence",b),p.getUniforms().setValue(s,"morphTargetInfluences",f),p.getUniforms().setValue(s,"morphTargetsTexture",x.texture,t),p.getUniforms().setValue(s,"morphTargetsTextureSize",x.size)}else{const m=f===void 0?0:f.length;let g=n[h.id];if(g===void 0||g.length!==m){g=[];for(let _=0;_<m;_++)g[_]=[_,0];n[h.id]=g}for(let _=0;_<m;_++){const T=g[_];T[0]=_,T[1]=f[_]}g.sort(qd);for(let _=0;_<8;_++)_<m&&g[_][1]?(l[_][0]=g[_][0],l[_][1]=g[_][1]):(l[_][0]=Number.MAX_SAFE_INTEGER,l[_][1]=0);l.sort(dh);const x=h.morphAttributes.position,y=h.morphAttributes.normal;let b=0;for(let _=0;_<8;_++){const T=l[_],A=T[0],R=T[1];A!==Number.MAX_SAFE_INTEGER&&R?(x&&h.getAttribute("morphTarget"+_)!==x[A]&&h.setAttribute("morphTarget"+_,x[A]),y&&h.getAttribute("morphNormal"+_)!==y[A]&&h.setAttribute("morphNormal"+_,y[A]),r[_]=R,b+=R):(x&&h.hasAttribute("morphTarget"+_)===!0&&h.deleteAttribute("morphTarget"+_),y&&h.hasAttribute("morphNormal"+_)===!0&&h.deleteAttribute("morphNormal"+_),r[_]=0)}const w=h.morphTargetsRelative?1:1-b;p.getUniforms().setValue(s,"morphTargetBaseInfluence",w),p.getUniforms().setValue(s,"morphTargetInfluences",r)}}}}function ph(s,e,t,n){let r=new WeakMap;function i(a){const l=a.target;l.removeEventListener("dispose",i),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:function(a){const l=n.render.frame,u=a.geometry,h=e.get(a,u);return r.get(h)!==l&&(e.update(h),r.set(h,l)),a.isInstancedMesh&&(a.hasEventListener("dispose",i)===!1&&a.addEventListener("dispose",i),t.update(a.instanceMatrix,s.ARRAY_BUFFER),a.instanceColor!==null&&t.update(a.instanceColor,s.ARRAY_BUFFER)),h},dispose:function(){r=new WeakMap}}}const fh=new pn,Ps=new sl,Pn=new Ju,$n=new gl,or=[],kc=[],wl=new Float32Array(16),Ml=new Float32Array(9),Rf=new Float32Array(4);function qn(s,e,t){const n=s[0];if(n<=0||n>0)return s;const r=e*t;let i=or[r];if(i===void 0&&(i=new Float32Array(r),or[r]=i),e!==0){n.toArray(i,0);for(let a=1,l=0;a!==e;++a)l+=t,s[a].toArray(i,l)}return i}function Yn(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function Qn(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function Tl(s,e){let t=kc[e];t===void 0&&(t=new Int32Array(e),kc[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function Da(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function Xi(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yn(t,e))return;s.uniform2fv(this.addr,e),Qn(t,e)}}function Fc(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)t[0]===e.r&&t[1]===e.g&&t[2]===e.b||(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Yn(t,e))return;s.uniform3fv(this.addr,e),Qn(t,e)}}function Qd(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yn(t,e))return;s.uniform4fv(this.addr,e),Qn(t,e)}}function Zd(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Yn(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),Qn(t,e)}else{if(Yn(t,n))return;Rf.set(n),s.uniformMatrix2fv(this.addr,!1,Rf),Qn(t,n)}}function Lf(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Yn(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),Qn(t,e)}else{if(Yn(t,n))return;Ml.set(n),s.uniformMatrix3fv(this.addr,!1,Ml),Qn(t,n)}}function Pf(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Yn(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),Qn(t,e)}else{if(Yn(t,n))return;wl.set(n),s.uniformMatrix4fv(this.addr,!1,wl),Qn(t,n)}}function Cf(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function Df(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yn(t,e))return;s.uniform2iv(this.addr,e),Qn(t,e)}}function Of(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Yn(t,e))return;s.uniform3iv(this.addr,e),Qn(t,e)}}function If(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yn(t,e))return;s.uniform4iv(this.addr,e),Qn(t,e)}}function Nf(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function kf(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yn(t,e))return;s.uniform2uiv(this.addr,e),Qn(t,e)}}function Uc(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Yn(t,e))return;s.uniform3uiv(this.addr,e),Qn(t,e)}}function Ff(s,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yn(t,e))return;s.uniform4uiv(this.addr,e),Qn(t,e)}}function mh(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||fh,r)}function gh(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||Pn,r)}function Uf(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||$n,r)}function Kd(s,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||Ps,r)}function zf(s,e){s.uniform1fv(this.addr,e)}function Bf(s,e){const t=qn(e,this.size,2);s.uniform2fv(this.addr,t)}function Hf(s,e){const t=qn(e,this.size,3);s.uniform3fv(this.addr,t)}function jf(s,e){const t=qn(e,this.size,4);s.uniform4fv(this.addr,t)}function Jd(s,e){const t=qn(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function Gf(s,e){const t=qn(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function Vf(s,e){const t=qn(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function Wf(s,e){s.uniform1iv(this.addr,e)}function Tg(s,e){s.uniform2iv(this.addr,e)}function Xf(s,e){s.uniform3iv(this.addr,e)}function Eg(s,e){s.uniform4iv(this.addr,e)}function Ag(s,e){s.uniform1uiv(this.addr,e)}function qf(s,e){s.uniform2uiv(this.addr,e)}function Yf(s,e){s.uniform3uiv(this.addr,e)}function Qf(s,e){s.uniform4uiv(this.addr,e)}function vh(s,e,t){const n=this.cache,r=e.length,i=Tl(t,r);Yn(n,i)||(s.uniform1iv(this.addr,i),Qn(n,i));for(let a=0;a!==r;++a)t.setTexture2D(e[a]||fh,i[a])}function Rg(s,e,t){const n=this.cache,r=e.length,i=Tl(t,r);Yn(n,i)||(s.uniform1iv(this.addr,i),Qn(n,i));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||Pn,i[a])}function Lg(s,e,t){const n=this.cache,r=e.length,i=Tl(t,r);Yn(n,i)||(s.uniform1iv(this.addr,i),Qn(n,i));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||$n,i[a])}function Pg(s,e,t){const n=this.cache,r=e.length,i=Tl(t,r);Yn(n,i)||(s.uniform1iv(this.addr,i),Qn(n,i));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||Ps,i[a])}class da{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=(function(r){switch(r){case 5126:return Da;case 35664:return Xi;case 35665:return Fc;case 35666:return Qd;case 35674:return Zd;case 35675:return Lf;case 35676:return Pf;case 5124:case 35670:return Cf;case 35667:case 35671:return Df;case 35668:case 35672:return Of;case 35669:case 35673:return If;case 5125:return Nf;case 36294:return kf;case 36295:return Uc;case 36296:return Ff;case 35678:case 36198:case 36298:case 36306:case 35682:return mh;case 35679:case 36299:case 36307:return gh;case 35680:case 36300:case 36308:case 36293:return Uf;case 36289:case 36303:case 36311:case 36292:return Kd}})(t.type)}}class $d{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=(function(r){switch(r){case 5126:return zf;case 35664:return Bf;case 35665:return Hf;case 35666:return jf;case 35674:return Jd;case 35675:return Gf;case 35676:return Vf;case 5124:case 35670:return Wf;case 35667:case 35671:return Tg;case 35668:case 35672:return Xf;case 35669:case 35673:return Eg;case 5125:return Ag;case 36294:return qf;case 36295:return Yf;case 36296:return Qf;case 35678:case 36198:case 36298:case 36306:case 35682:return vh;case 35679:case 36299:case 36307:return Rg;case 35680:case 36300:case 36308:case 36293:return Lg;case 36289:case 36303:case 36311:case 36292:return Pg}})(t.type)}}class yh{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const l=r[i];l.setValue(e,t[l.id],n)}}}const xh=/(\w+)(\])?(\[|\.)?/g;function ep(s,e){s.seq.push(e),s.map[e.id]=e}function Zf(s,e,t){const n=s.name,r=n.length;for(xh.lastIndex=0;;){const i=xh.exec(n),a=xh.lastIndex;let l=i[1];const u=i[2]==="]",h=i[3];if(u&&(l|=0),h===void 0||h==="["&&a+2===r){ep(t,h===void 0?new da(l,s,e):new $d(l,s,e));break}{let p=t.map[l];p===void 0&&(p=new yh(l),ep(t,p)),t=p}}}class El{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const i=e.getActiveUniform(t,r);Zf(i,e.getUniformLocation(t,i.name),this)}}setValue(e,t,n,r){const i=this.map[t];i!==void 0&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const l=t[i],u=n[l.id];u.needsUpdate!==!1&&l.setValue(e,u.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function So(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}let tp=0;function bh(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),r=s.getShaderInfoLog(e).trim();if(n&&r==="")return"";const i=/ERROR: 0:(\d+)/.exec(r);if(i){const a=parseInt(i[1]);return t.toUpperCase()+`

`+r+`

`+(function(l,u){const h=l.split(`
`),p=[],f=Math.max(u-6,0),m=Math.min(u+6,h.length);for(let g=f;g<m;g++){const x=g+1;p.push(`${x===u?">":" "} ${x}: ${h[g]}`)}return p.join(`
`)})(s.getShaderSource(e),a)}return r}function Cg(s,e){const t=(function(n){switch(n){case jr:return["Linear","( value )"];case Ct:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}})(e);return"vec4 "+s+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Kf(s,e){let t;switch(e){case ad:t="Linear";break;case sd:t="Reinhard";break;case od:t="OptimizedCineon";break;case lc:t="ACESFilmic";break;case cc:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Al(s){return s!==""}function np(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function rp(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Jf=/^[ \t]*#include +<([\w\d./]+)>/gm;function ip(s){return s.replace(Jf,si)}function si(s,e){const t=bt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return ip(t)}const Vr=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ap(s){return s.replace(Vr,$f)}function $f(s,e,t,n){let r="";for(let i=parseInt(e);i<parseInt(t);i++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return r}function sp(s){let e="precision "+s.precision+` float;
precision `+s.precision+" int;";return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function em(s,e,t,n){const r=s.getContext(),i=t.defines;let a=t.vertexShader,l=t.fragmentShader;const u=(function(U){let j="SHADOWMAP_TYPE_BASIC";return U.shadowMapType===ir?j="SHADOWMAP_TYPE_PCF":U.shadowMapType===F?j="SHADOWMAP_TYPE_PCF_SOFT":U.shadowMapType===he&&(j="SHADOWMAP_TYPE_VSM"),j})(t),h=(function(U){let j="ENVMAP_TYPE_CUBE";if(U.envMap)switch(U.envMapMode){case Ci:case Di:j="ENVMAP_TYPE_CUBE";break;case Ws:j="ENVMAP_TYPE_CUBE_UV"}return j})(t),p=(function(U){let j="ENVMAP_MODE_REFLECTION";return U.envMap&&U.envMapMode===Di&&(j="ENVMAP_MODE_REFRACTION"),j})(t),f=(function(U){let j="ENVMAP_BLENDING_NONE";if(U.envMap)switch(U.combine){case Ga:j="ENVMAP_BLENDING_MULTIPLY";break;case Vs:j="ENVMAP_BLENDING_MIX";break;case Ru:j="ENVMAP_BLENDING_ADD"}return j})(t),m=(function(U){const j=U.envMapCubeUVHeight;if(j===null)return null;const N=Math.log2(j)-2,J=1/j;return{texelWidth:1/(3*Math.max(Math.pow(2,N),112)),texelHeight:J,maxMip:N}})(t),g=t.isWebGL2?"":(function(U){return[U.extensionDerivatives||U.envMapCubeUVHeight||U.bumpMap||U.tangentSpaceNormalMap||U.clearcoatNormalMap||U.flatShading||U.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(U.extensionFragDepth||U.logarithmicDepthBuffer)&&U.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",U.extensionDrawBuffers&&U.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(U.extensionShaderTextureLOD||U.envMap||U.transmission)&&U.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Al).join(`
`)})(t),x=(function(U){const j=[];for(const N in U){const J=U[N];J!==!1&&j.push("#define "+N+" "+J)}return j.join(`
`)})(i),y=r.createProgram();let b,w,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=[x].filter(Al).join(`
`),b.length>0&&(b+=`
`),w=[g,x].filter(Al).join(`
`),w.length>0&&(w+=`
`)):(b=[sp(t),"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Al).join(`
`),w=[g,sp(t),"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+p:"",t.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ra?"#define TONE_MAPPING":"",t.toneMapping!==ra?bt.tonemapping_pars_fragment:"",t.toneMapping!==ra?Kf("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",bt.encodings_pars_fragment,Cg("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Al).join(`
`)),a=ip(a),a=np(a,t),a=rp(a,t),l=ip(l),l=np(l,t),l=rp(l,t),a=ap(a),l=ap(l),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,w=["#define varying in",t.glslVersion===yc?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===yc?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const T=_+b+a,A=_+w+l,R=So(r,r.VERTEX_SHADER,T),C=So(r,r.FRAGMENT_SHADER,A);if(r.attachShader(y,R),r.attachShader(y,C),t.index0AttributeName!==void 0?r.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y),s.debug.checkShaderErrors){const U=r.getProgramInfoLog(y).trim(),j=r.getShaderInfoLog(R).trim(),N=r.getShaderInfoLog(C).trim();let J=!0,le=!0;if(r.getProgramParameter(y,r.LINK_STATUS)===!1){J=!1;const oe=bh(r,R,"vertex"),xe=bh(r,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,r.VALIDATE_STATUS)+`

Program Info Log: `+U+`
`+oe+`
`+xe)}else U!==""?console.warn("THREE.WebGLProgram: Program Info Log:",U):j!==""&&N!==""||(le=!1);le&&(this.diagnostics={runnable:J,programLog:U,vertexShader:{log:j,prefix:b},fragmentShader:{log:N,prefix:w}})}let I,G;return r.deleteShader(R),r.deleteShader(C),this.getUniforms=function(){return I===void 0&&(I=new El(r,y)),I},this.getAttributes=function(){return G===void 0&&(G=(function(U,j){const N={},J=U.getProgramParameter(j,U.ACTIVE_ATTRIBUTES);for(let le=0;le<J;le++){const oe=U.getActiveAttrib(j,le),xe=oe.name;let ge=1;oe.type===U.FLOAT_MAT2&&(ge=2),oe.type===U.FLOAT_MAT3&&(ge=3),oe.type===U.FLOAT_MAT4&&(ge=4),N[xe]={type:oe.type,location:U.getAttribLocation(j,xe),locationSize:ge}}return N})(r,y)),G},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.name=t.shaderName,this.id=tp++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=R,this.fragmentShader=C,this}let tm=0;class op{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(i)===!1&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new nm(e),t.set(e,n)),n}}class nm{constructor(e){this.id=tm++,this.code=e,this.usedTimes=0}}function lp(s,e,t,n,r,i,a){const l=new cn,u=new op,h=[],p=r.isWebGL2,f=r.logarithmicDepthBuffer,m=r.vertexTextures;let g=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(y,b,w,_,T){const A=_.fog,R=T.geometry,C=y.isMeshStandardMaterial?_.environment:null,I=(y.isMeshStandardMaterial?t:e).get(y.envMap||C),G=I&&I.mapping===Ws?I.image.height:null,U=x[y.type];y.precision!==null&&(g=r.getMaxPrecision(y.precision),g!==y.precision&&console.warn("THREE.WebGLProgram.getParameters:",y.precision,"not supported, using",g,"instead."));const j=R.morphAttributes.position||R.morphAttributes.normal||R.morphAttributes.color,N=j!==void 0?j.length:0;let J,le,oe,xe,ge=0;if(R.morphAttributes.position!==void 0&&(ge=1),R.morphAttributes.normal!==void 0&&(ge=2),R.morphAttributes.color!==void 0&&(ge=3),U){const re=bi[U];J=re.vertexShader,le=re.fragmentShader}else J=y.vertexShader,le=y.fragmentShader,u.update(y),oe=u.getVertexShaderID(y),xe=u.getFragmentShaderID(y);const Me=s.getRenderTarget(),Ae=y.alphaTest>0,De=y.clearcoat>0,pe=y.iridescence>0;return{isWebGL2:p,shaderID:U,shaderName:y.type,vertexShader:J,fragmentShader:le,defines:y.defines,customVertexShaderID:oe,customFragmentShaderID:xe,isRawShaderMaterial:y.isRawShaderMaterial===!0,glslVersion:y.glslVersion,precision:g,instancing:T.isInstancedMesh===!0,instancingColor:T.isInstancedMesh===!0&&T.instanceColor!==null,supportsVertexTextures:m,outputEncoding:Me===null?s.outputEncoding:Me.isXRRenderTarget===!0?Me.texture.encoding:jr,map:!!y.map,matcap:!!y.matcap,envMap:!!I,envMapMode:I&&I.mapping,envMapCubeUVHeight:G,lightMap:!!y.lightMap,aoMap:!!y.aoMap,emissiveMap:!!y.emissiveMap,bumpMap:!!y.bumpMap,normalMap:!!y.normalMap,objectSpaceNormalMap:y.normalMapType===of,tangentSpaceNormalMap:y.normalMapType===Ya,decodeVideoTexture:!!y.map&&y.map.isVideoTexture===!0&&y.map.encoding===Ct,clearcoat:De,clearcoatMap:De&&!!y.clearcoatMap,clearcoatRoughnessMap:De&&!!y.clearcoatRoughnessMap,clearcoatNormalMap:De&&!!y.clearcoatNormalMap,iridescence:pe,iridescenceMap:pe&&!!y.iridescenceMap,iridescenceThicknessMap:pe&&!!y.iridescenceThicknessMap,displacementMap:!!y.displacementMap,roughnessMap:!!y.roughnessMap,metalnessMap:!!y.metalnessMap,specularMap:!!y.specularMap,specularIntensityMap:!!y.specularIntensityMap,specularColorMap:!!y.specularColorMap,opaque:y.transparent===!1&&y.blending===Nt,alphaMap:!!y.alphaMap,alphaTest:Ae,gradientMap:!!y.gradientMap,sheen:y.sheen>0,sheenColorMap:!!y.sheenColorMap,sheenRoughnessMap:!!y.sheenRoughnessMap,transmission:y.transmission>0,transmissionMap:!!y.transmissionMap,thicknessMap:!!y.thicknessMap,combine:y.combine,vertexTangents:!!y.normalMap&&!!R.attributes.tangent,vertexColors:y.vertexColors,vertexAlphas:y.vertexColors===!0&&!!R.attributes.color&&R.attributes.color.itemSize===4,vertexUvs:!!(y.map||y.bumpMap||y.normalMap||y.specularMap||y.alphaMap||y.emissiveMap||y.roughnessMap||y.metalnessMap||y.clearcoatMap||y.clearcoatRoughnessMap||y.clearcoatNormalMap||y.iridescenceMap||y.iridescenceThicknessMap||y.displacementMap||y.transmissionMap||y.thicknessMap||y.specularIntensityMap||y.specularColorMap||y.sheenColorMap||y.sheenRoughnessMap),uvsVertexOnly:!(y.map||y.bumpMap||y.normalMap||y.specularMap||y.alphaMap||y.emissiveMap||y.roughnessMap||y.metalnessMap||y.clearcoatNormalMap||y.iridescenceMap||y.iridescenceThicknessMap||y.transmission>0||y.transmissionMap||y.thicknessMap||y.specularIntensityMap||y.specularColorMap||y.sheen>0||y.sheenColorMap||y.sheenRoughnessMap||!y.displacementMap),fog:!!A,useFog:y.fog===!0,fogExp2:A&&A.isFogExp2,flatShading:!!y.flatShading,sizeAttenuation:y.sizeAttenuation,logarithmicDepthBuffer:f,skinning:T.isSkinnedMesh===!0,morphTargets:R.morphAttributes.position!==void 0,morphNormals:R.morphAttributes.normal!==void 0,morphColors:R.morphAttributes.color!==void 0,morphTargetsCount:N,morphTextureStride:ge,numDirLights:b.directional.length,numPointLights:b.point.length,numSpotLights:b.spot.length,numSpotLightMaps:b.spotLightMap.length,numRectAreaLights:b.rectArea.length,numHemiLights:b.hemi.length,numDirLightShadows:b.directionalShadowMap.length,numPointLightShadows:b.pointShadowMap.length,numSpotLightShadows:b.spotShadowMap.length,numSpotLightShadowsWithMaps:b.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:y.dithering,shadowMapEnabled:s.shadowMap.enabled&&w.length>0,shadowMapType:s.shadowMap.type,toneMapping:y.toneMapped?s.toneMapping:ra,useLegacyLights:s.useLegacyLights,premultipliedAlpha:y.premultipliedAlpha,doubleSided:y.side===We,flipSided:y.side===Be,useDepthPacking:!!y.depthPacking,depthPacking:y.depthPacking||0,index0AttributeName:y.index0AttributeName,extensionDerivatives:y.extensions&&y.extensions.derivatives,extensionFragDepth:y.extensions&&y.extensions.fragDepth,extensionDrawBuffers:y.extensions&&y.extensions.drawBuffers,extensionShaderTextureLOD:y.extensions&&y.extensions.shaderTextureLOD,rendererExtensionFragDepth:p||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||n.has("EXT_shader_texture_lod"),customProgramCacheKey:y.customProgramCacheKey()}},getProgramCacheKey:function(y){const b=[];if(y.shaderID?b.push(y.shaderID):(b.push(y.customVertexShaderID),b.push(y.customFragmentShaderID)),y.defines!==void 0)for(const w in y.defines)b.push(w),b.push(y.defines[w]);return y.isRawShaderMaterial===!1&&((function(w,_){w.push(_.precision),w.push(_.outputEncoding),w.push(_.envMapMode),w.push(_.envMapCubeUVHeight),w.push(_.combine),w.push(_.vertexUvs),w.push(_.fogExp2),w.push(_.sizeAttenuation),w.push(_.morphTargetsCount),w.push(_.morphAttributeCount),w.push(_.numDirLights),w.push(_.numPointLights),w.push(_.numSpotLights),w.push(_.numSpotLightMaps),w.push(_.numHemiLights),w.push(_.numRectAreaLights),w.push(_.numDirLightShadows),w.push(_.numPointLightShadows),w.push(_.numSpotLightShadows),w.push(_.numSpotLightShadowsWithMaps),w.push(_.shadowMapType),w.push(_.toneMapping),w.push(_.numClippingPlanes),w.push(_.numClipIntersection),w.push(_.depthPacking)})(b,y),(function(w,_){l.disableAll(),_.isWebGL2&&l.enable(0),_.supportsVertexTextures&&l.enable(1),_.instancing&&l.enable(2),_.instancingColor&&l.enable(3),_.map&&l.enable(4),_.matcap&&l.enable(5),_.envMap&&l.enable(6),_.lightMap&&l.enable(7),_.aoMap&&l.enable(8),_.emissiveMap&&l.enable(9),_.bumpMap&&l.enable(10),_.normalMap&&l.enable(11),_.objectSpaceNormalMap&&l.enable(12),_.tangentSpaceNormalMap&&l.enable(13),_.clearcoat&&l.enable(14),_.clearcoatMap&&l.enable(15),_.clearcoatRoughnessMap&&l.enable(16),_.clearcoatNormalMap&&l.enable(17),_.iridescence&&l.enable(18),_.iridescenceMap&&l.enable(19),_.iridescenceThicknessMap&&l.enable(20),_.displacementMap&&l.enable(21),_.specularMap&&l.enable(22),_.roughnessMap&&l.enable(23),_.metalnessMap&&l.enable(24),_.gradientMap&&l.enable(25),_.alphaMap&&l.enable(26),_.alphaTest&&l.enable(27),_.vertexColors&&l.enable(28),_.vertexAlphas&&l.enable(29),_.vertexUvs&&l.enable(30),_.vertexTangents&&l.enable(31),_.uvsVertexOnly&&l.enable(32),w.push(l.mask),l.disableAll(),_.fog&&l.enable(0),_.useFog&&l.enable(1),_.flatShading&&l.enable(2),_.logarithmicDepthBuffer&&l.enable(3),_.skinning&&l.enable(4),_.morphTargets&&l.enable(5),_.morphNormals&&l.enable(6),_.morphColors&&l.enable(7),_.premultipliedAlpha&&l.enable(8),_.shadowMapEnabled&&l.enable(9),_.useLegacyLights&&l.enable(10),_.doubleSided&&l.enable(11),_.flipSided&&l.enable(12),_.useDepthPacking&&l.enable(13),_.dithering&&l.enable(14),_.specularIntensityMap&&l.enable(15),_.specularColorMap&&l.enable(16),_.transmission&&l.enable(17),_.transmissionMap&&l.enable(18),_.thicknessMap&&l.enable(19),_.sheen&&l.enable(20),_.sheenColorMap&&l.enable(21),_.sheenRoughnessMap&&l.enable(22),_.decodeVideoTexture&&l.enable(23),_.opaque&&l.enable(24),w.push(l.mask)})(b,y),b.push(s.outputEncoding)),b.push(y.customProgramCacheKey),b.join()},getUniforms:function(y){const b=x[y.type];let w;if(b){const _=bi[b];w=lh.clone(_.uniforms)}else w=y.uniforms;return w},acquireProgram:function(y,b){let w;for(let _=0,T=h.length;_<T;_++){const A=h[_];if(A.cacheKey===b){w=A,++w.usedTimes;break}}return w===void 0&&(w=new em(s,b,y,i),h.push(w)),w},releaseProgram:function(y){if(--y.usedTimes==0){const b=h.indexOf(y);h[b]=h[h.length-1],h.pop(),y.destroy()}},releaseShaderCache:function(y){u.remove(y)},programs:h,dispose:function(){u.dispose()}}}function rm(){let s=new WeakMap;return{get:function(e){let t=s.get(e);return t===void 0&&(t={},s.set(e,t)),t},remove:function(e){s.delete(e)},update:function(e,t,n){s.get(e)[t]=n},dispose:function(){s=new WeakMap}}}function im(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function Sh(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function _h(){const s=[];let e=0;const t=[],n=[],r=[];function i(a,l,u,h,p,f){let m=s[e];return m===void 0?(m={id:a.id,object:a,geometry:l,material:u,groupOrder:h,renderOrder:a.renderOrder,z:p,group:f},s[e]=m):(m.id=a.id,m.object=a,m.geometry=l,m.material=u,m.groupOrder=h,m.renderOrder=a.renderOrder,m.z=p,m.group=f),e++,m}return{opaque:t,transmissive:n,transparent:r,init:function(){e=0,t.length=0,n.length=0,r.length=0},push:function(a,l,u,h,p,f){const m=i(a,l,u,h,p,f);u.transmission>0?n.push(m):u.transparent===!0?r.push(m):t.push(m)},unshift:function(a,l,u,h,p,f){const m=i(a,l,u,h,p,f);u.transmission>0?n.unshift(m):u.transparent===!0?r.unshift(m):t.unshift(m)},finish:function(){for(let a=e,l=s.length;a<l;a++){const u=s[a];if(u.id===null)break;u.id=null,u.object=null,u.geometry=null,u.material=null,u.group=null}},sort:function(a,l){t.length>1&&t.sort(a||im),n.length>1&&n.sort(l||Sh),r.length>1&&r.sort(l||Sh)}}}function am(){let s=new WeakMap;return{get:function(e,t){const n=s.get(e);let r;return n===void 0?(r=new _h,s.set(e,[r])):t>=n.length?(r=new _h,n.push(r)):r=n[t],r},dispose:function(){s=new WeakMap}}}function cp(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new D,color:new Ne};break;case"SpotLight":t={position:new D,direction:new D,color:new Ne,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new D,color:new Ne,distance:0,decay:0};break;case"HemisphereLight":t={direction:new D,skyColor:new Ne,groundColor:new Ne};break;case"RectAreaLight":t={color:new Ne,position:new D,halfWidth:new D,halfHeight:new D}}return s[e.id]=t,t}}}let wh=0;function Dg(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function sm(s,e){const t=new cp,n=(function(){const u={};return{get:function(h){if(u[h.id]!==void 0)return u[h.id];let p;switch(h.type){case"DirectionalLight":case"SpotLight":p={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ce};break;case"PointLight":p={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ce,shadowCameraNear:1,shadowCameraFar:1e3}}return u[h.id]=p,p}}})(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new D);const i=new D,a=new Ie,l=new Ie;return{setup:function(u,h){let p=0,f=0,m=0;for(let U=0;U<9;U++)r.probe[U].set(0,0,0);let g=0,x=0,y=0,b=0,w=0,_=0,T=0,A=0,R=0,C=0;u.sort(Dg);const I=h===!0?Math.PI:1;for(let U=0,j=u.length;U<j;U++){const N=u[U],J=N.color,le=N.intensity,oe=N.distance,xe=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)p+=J.r*le*I,f+=J.g*le*I,m+=J.b*le*I;else if(N.isLightProbe)for(let ge=0;ge<9;ge++)r.probe[ge].addScaledVector(N.sh.coefficients[ge],le);else if(N.isDirectionalLight){const ge=t.get(N);if(ge.color.copy(N.color).multiplyScalar(N.intensity*I),N.castShadow){const Me=N.shadow,Ae=n.get(N);Ae.shadowBias=Me.bias,Ae.shadowNormalBias=Me.normalBias,Ae.shadowRadius=Me.radius,Ae.shadowMapSize=Me.mapSize,r.directionalShadow[g]=Ae,r.directionalShadowMap[g]=xe,r.directionalShadowMatrix[g]=N.shadow.matrix,_++}r.directional[g]=ge,g++}else if(N.isSpotLight){const ge=t.get(N);ge.position.setFromMatrixPosition(N.matrixWorld),ge.color.copy(J).multiplyScalar(le*I),ge.distance=oe,ge.coneCos=Math.cos(N.angle),ge.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),ge.decay=N.decay,r.spot[y]=ge;const Me=N.shadow;if(N.map&&(r.spotLightMap[R]=N.map,R++,Me.updateMatrices(N),N.castShadow&&C++),r.spotLightMatrix[y]=Me.matrix,N.castShadow){const Ae=n.get(N);Ae.shadowBias=Me.bias,Ae.shadowNormalBias=Me.normalBias,Ae.shadowRadius=Me.radius,Ae.shadowMapSize=Me.mapSize,r.spotShadow[y]=Ae,r.spotShadowMap[y]=xe,A++}y++}else if(N.isRectAreaLight){const ge=t.get(N);ge.color.copy(J).multiplyScalar(le),ge.halfWidth.set(.5*N.width,0,0),ge.halfHeight.set(0,.5*N.height,0),r.rectArea[b]=ge,b++}else if(N.isPointLight){const ge=t.get(N);if(ge.color.copy(N.color).multiplyScalar(N.intensity*I),ge.distance=N.distance,ge.decay=N.decay,N.castShadow){const Me=N.shadow,Ae=n.get(N);Ae.shadowBias=Me.bias,Ae.shadowNormalBias=Me.normalBias,Ae.shadowRadius=Me.radius,Ae.shadowMapSize=Me.mapSize,Ae.shadowCameraNear=Me.camera.near,Ae.shadowCameraFar=Me.camera.far,r.pointShadow[x]=Ae,r.pointShadowMap[x]=xe,r.pointShadowMatrix[x]=N.shadow.matrix,T++}r.point[x]=ge,x++}else if(N.isHemisphereLight){const ge=t.get(N);ge.skyColor.copy(N.color).multiplyScalar(le*I),ge.groundColor.copy(N.groundColor).multiplyScalar(le*I),r.hemi[w]=ge,w++}}b>0&&(e.isWebGL2||s.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=je.LTC_FLOAT_1,r.rectAreaLTC2=je.LTC_FLOAT_2):s.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=je.LTC_HALF_1,r.rectAreaLTC2=je.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=f,r.ambient[2]=m;const G=r.hash;G.directionalLength===g&&G.pointLength===x&&G.spotLength===y&&G.rectAreaLength===b&&G.hemiLength===w&&G.numDirectionalShadows===_&&G.numPointShadows===T&&G.numSpotShadows===A&&G.numSpotMaps===R||(r.directional.length=g,r.spot.length=y,r.rectArea.length=b,r.point.length=x,r.hemi.length=w,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=T,r.pointShadowMap.length=T,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=T,r.spotLightMatrix.length=A+R-C,r.spotLightMap.length=R,r.numSpotLightShadowsWithMaps=C,G.directionalLength=g,G.pointLength=x,G.spotLength=y,G.rectAreaLength=b,G.hemiLength=w,G.numDirectionalShadows=_,G.numPointShadows=T,G.numSpotShadows=A,G.numSpotMaps=R,r.version=wh++)},setupView:function(u,h){let p=0,f=0,m=0,g=0,x=0;const y=h.matrixWorldInverse;for(let b=0,w=u.length;b<w;b++){const _=u[b];if(_.isDirectionalLight){const T=r.directional[p];T.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(i),T.direction.transformDirection(y),p++}else if(_.isSpotLight){const T=r.spot[m];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(i),T.direction.transformDirection(y),m++}else if(_.isRectAreaLight){const T=r.rectArea[g];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),l.identity(),a.copy(_.matrixWorld),a.premultiply(y),l.extractRotation(a),T.halfWidth.set(.5*_.width,0,0),T.halfHeight.set(0,.5*_.height,0),T.halfWidth.applyMatrix4(l),T.halfHeight.applyMatrix4(l),g++}else if(_.isPointLight){const T=r.point[f];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),f++}else if(_.isHemisphereLight){const T=r.hemi[x];T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(y),x++}}},state:r}}function Mh(s,e){const t=new sm(s,e),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function(i){t.setup(n,i)},setupLightsView:function(i){t.setupView(n,i)},pushLight:function(i){n.push(i)},pushShadow:function(i){r.push(i)}}}function om(s,e){let t=new WeakMap;return{get:function(n,r=0){const i=t.get(n);let a;return i===void 0?(a=new Mh(s,e),t.set(n,[a])):r>=i.length?(a=new Mh(s,e),i.push(a)):a=i[r],a},dispose:function(){t=new WeakMap}}}class _o extends an{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ki,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class pa extends an{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new D,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Og=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,lm=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function up(s,e,t){let n=new Ra;const r=new ce,i=new ce,a=new ot,l=new _o({depthPacking:$s}),u=new pa,h={},p=t.maxTextureSize,f={[Se]:Be,[Be]:Se,[We]:We},m=new Bt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ce},radius:{value:4}},vertexShader:Og,fragmentShader:lm}),g=m.clone();g.defines.HORIZONTAL_PASS=1;const x=new ut;x.setAttribute("position",new pt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new ht(x,m),b=this;function w(A,R){const C=e.update(y);m.defines.VSM_SAMPLES!==A.blurSamples&&(m.defines.VSM_SAMPLES=A.blurSamples,g.defines.VSM_SAMPLES=A.blurSamples,m.needsUpdate=!0,g.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new Xt(r.x,r.y)),m.uniforms.shadow_pass.value=A.map.texture,m.uniforms.resolution.value=A.mapSize,m.uniforms.radius.value=A.radius,s.setRenderTarget(A.mapPass),s.clear(),s.renderBufferDirect(R,null,C,m,y,null),g.uniforms.shadow_pass.value=A.mapPass.texture,g.uniforms.resolution.value=A.mapSize,g.uniforms.radius.value=A.radius,s.setRenderTarget(A.map),s.clear(),s.renderBufferDirect(R,null,C,g,y,null)}function _(A,R,C,I,G,U){let j=null;const N=C.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(N!==void 0)j=N;else if(j=C.isPointLight===!0?u:l,s.localClippingEnabled&&R.clipShadows===!0&&Array.isArray(R.clippingPlanes)&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0||R.map&&R.alphaTest>0){const J=j.uuid,le=R.uuid;let oe=h[J];oe===void 0&&(oe={},h[J]=oe);let xe=oe[le];xe===void 0&&(xe=j.clone(),oe[le]=xe),j=xe}return j.visible=R.visible,j.wireframe=R.wireframe,j.side=U===he?R.shadowSide!==null?R.shadowSide:R.side:R.shadowSide!==null?R.shadowSide:f[R.side],j.alphaMap=R.alphaMap,j.alphaTest=R.alphaTest,j.map=R.map,j.clipShadows=R.clipShadows,j.clippingPlanes=R.clippingPlanes,j.clipIntersection=R.clipIntersection,j.displacementMap=R.displacementMap,j.displacementScale=R.displacementScale,j.displacementBias=R.displacementBias,j.wireframeLinewidth=R.wireframeLinewidth,j.linewidth=R.linewidth,C.isPointLight===!0&&j.isMeshDistanceMaterial===!0&&(j.referencePosition.setFromMatrixPosition(C.matrixWorld),j.nearDistance=I,j.farDistance=G),j}function T(A,R,C,I,G){if(A.visible===!1)return;if(A.layers.test(R.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&G===he)&&(!A.frustumCulled||n.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,A.matrixWorld);const j=e.update(A),N=A.material;if(Array.isArray(N)){const J=j.groups;for(let le=0,oe=J.length;le<oe;le++){const xe=J[le],ge=N[xe.materialIndex];if(ge&&ge.visible){const Me=_(A,ge,I,C.near,C.far,G);s.renderBufferDirect(C,null,j,Me,A,xe)}}}else if(N.visible){const J=_(A,N,I,C.near,C.far,G);s.renderBufferDirect(C,null,j,J,A,null)}}const U=A.children;for(let j=0,N=U.length;j<N;j++)T(U[j],R,C,I,G)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ir,this.render=function(A,R,C){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||A.length===0)return;const I=s.getRenderTarget(),G=s.getActiveCubeFace(),U=s.getActiveMipmapLevel(),j=s.state;j.setBlending(it),j.buffers.color.setClear(1,1,1,1),j.buffers.depth.setTest(!0),j.setScissorTest(!1);for(let N=0,J=A.length;N<J;N++){const le=A[N],oe=le.shadow;if(oe===void 0){console.warn("THREE.WebGLShadowMap:",le,"has no shadow.");continue}if(oe.autoUpdate===!1&&oe.needsUpdate===!1)continue;r.copy(oe.mapSize);const xe=oe.getFrameExtents();if(r.multiply(xe),i.copy(oe.mapSize),(r.x>p||r.y>p)&&(r.x>p&&(i.x=Math.floor(p/xe.x),r.x=i.x*xe.x,oe.mapSize.x=i.x),r.y>p&&(i.y=Math.floor(p/xe.y),r.y=i.y*xe.y,oe.mapSize.y=i.y)),oe.map===null){const Me=this.type!==he?{minFilter:Wt,magFilter:Wt}:{};oe.map=new Xt(r.x,r.y,Me),oe.map.texture.name=le.name+".shadowMap",oe.camera.updateProjectionMatrix()}s.setRenderTarget(oe.map),s.clear();const ge=oe.getViewportCount();for(let Me=0;Me<ge;Me++){const Ae=oe.getViewport(Me);a.set(i.x*Ae.x,i.y*Ae.y,i.x*Ae.z,i.y*Ae.w),j.viewport(a),oe.updateMatrices(le,Me),n=oe.getFrustum(),T(R,C,oe.camera,le,this.type)}oe.isPointLightShadow!==!0&&this.type===he&&w(oe,C),oe.needsUpdate=!1}b.needsUpdate=!1,s.setRenderTarget(I,G,U)}}function cm(s,e,t){const n=t.isWebGL2,r=new function(){let O=!1;const W=new ot;let Y=null;const te=new ot(0,0,0,0);return{setMask:function(ne){Y===ne||O||(s.colorMask(ne,ne,ne,ne),Y=ne)},setLocked:function(ne){O=ne},setClear:function(ne,me,Fe,Ge,Je){Je===!0&&(ne*=Ge,me*=Ge,Fe*=Ge),W.set(ne,me,Fe,Ge),te.equals(W)===!1&&(s.clearColor(ne,me,Fe,Ge),te.copy(W))},reset:function(){O=!1,Y=null,te.set(-1,0,0,0)}}},i=new function(){let O=!1,W=null,Y=null,te=null;return{setTest:function(ne){ne?_e(s.DEPTH_TEST):Ue(s.DEPTH_TEST)},setMask:function(ne){W===ne||O||(s.depthMask(ne),W=ne)},setFunc:function(ne){if(Y!==ne){switch(ne){case Au:s.depthFunc(s.NEVER);break;case zo:s.depthFunc(s.ALWAYS);break;case Bo:s.depthFunc(s.LESS);break;case Ho:s.depthFunc(s.LEQUAL);break;case jo:s.depthFunc(s.EQUAL);break;case oc:s.depthFunc(s.GEQUAL);break;case id:s.depthFunc(s.GREATER);break;case Go:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Y=ne}},setLocked:function(ne){O=ne},setClear:function(ne){te!==ne&&(s.clearDepth(ne),te=ne)},reset:function(){O=!1,W=null,Y=null,te=null}}},a=new function(){let O=!1,W=null,Y=null,te=null,ne=null,me=null,Fe=null,Ge=null,Je=null;return{setTest:function(Ve){O||(Ve?_e(s.STENCIL_TEST):Ue(s.STENCIL_TEST))},setMask:function(Ve){W===Ve||O||(s.stencilMask(Ve),W=Ve)},setFunc:function(Ve,wt,At){Y===Ve&&te===wt&&ne===At||(s.stencilFunc(Ve,wt,At),Y=Ve,te=wt,ne=At)},setOp:function(Ve,wt,At){me===Ve&&Fe===wt&&Ge===At||(s.stencilOp(Ve,wt,At),me=Ve,Fe=wt,Ge=At)},setLocked:function(Ve){O=Ve},setClear:function(Ve){Je!==Ve&&(s.clearStencil(Ve),Je=Ve)},reset:function(){O=!1,W=null,Y=null,te=null,ne=null,me=null,Fe=null,Ge=null,Je=null}}},l=new WeakMap,u=new WeakMap;let h={},p={},f=new WeakMap,m=[],g=null,x=!1,y=null,b=null,w=null,_=null,T=null,A=null,R=null,C=!1,I=null,G=null,U=null,j=null,N=null;const J=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let le=!1,oe=0;const xe=s.getParameter(s.VERSION);xe.indexOf("WebGL")!==-1?(oe=parseFloat(/^WebGL (\d)/.exec(xe)[1]),le=oe>=1):xe.indexOf("OpenGL ES")!==-1&&(oe=parseFloat(/^OpenGL ES (\d)/.exec(xe)[1]),le=oe>=2);let ge=null,Me={};const Ae=s.getParameter(s.SCISSOR_BOX),De=s.getParameter(s.VIEWPORT),pe=new ot().fromArray(Ae),re=new ot().fromArray(De);function ye(O,W,Y){const te=new Uint8Array(4),ne=s.createTexture();s.bindTexture(O,ne),s.texParameteri(O,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(O,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let me=0;me<Y;me++)s.texImage2D(W+me,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,te);return ne}const Ce={};function _e(O){h[O]!==!0&&(s.enable(O),h[O]=!0)}function Ue(O){h[O]!==!1&&(s.disable(O),h[O]=!1)}Ce[s.TEXTURE_2D]=ye(s.TEXTURE_2D,s.TEXTURE_2D,1),Ce[s.TEXTURE_CUBE_MAP]=ye(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),r.setClear(0,0,0,1),i.setClear(1),a.setClear(0),_e(s.DEPTH_TEST),i.setFunc(Ho),q(!1),B(Ot),_e(s.CULL_FACE),ie(it);const H={[Zn]:s.FUNC_ADD,[Dn]:s.FUNC_SUBTRACT,[Ye]:s.FUNC_REVERSE_SUBTRACT};if(n)H[mt]=s.MIN,H[et]=s.MAX;else{const O=e.get("EXT_blend_minmax");O!==null&&(H[mt]=O.MIN_EXT,H[et]=O.MAX_EXT)}const k={[se]:s.ZERO,[Re]:s.ONE,[Et]:s.SRC_COLOR,[Gt]:s.SRC_ALPHA,[sc]:s.SRC_ALPHA_SATURATE,[wn]:s.DST_COLOR,[dn]:s.DST_ALPHA,[Pt]:s.ONE_MINUS_SRC_COLOR,[Vt]:s.ONE_MINUS_SRC_ALPHA,[Jr]:s.ONE_MINUS_DST_COLOR,[rn]:s.ONE_MINUS_DST_ALPHA};function ie(O,W,Y,te,ne,me,Fe,Ge){if(O!==it){if(x===!1&&(_e(s.BLEND),x=!0),O===Kr)ne=ne||W,me=me||Y,Fe=Fe||te,W===b&&ne===T||(s.blendEquationSeparate(H[W],H[ne]),b=W,T=ne),Y===w&&te===_&&me===A&&Fe===R||(s.blendFuncSeparate(k[Y],k[te],k[me],k[Fe]),w=Y,_=te,A=me,R=Fe),y=O,C=!1;else if(O!==y||Ge!==C){if(b===Zn&&T===Zn||(s.blendEquation(s.FUNC_ADD),b=Zn,T=Zn),Ge)switch(O){case Nt:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case Un:s.blendFunc(s.ONE,s.ONE);break;case jn:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case pr:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}else switch(O){case Nt:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case Un:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case jn:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case pr:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}w=null,_=null,A=null,R=null,y=O,C=Ge}}else x===!0&&(Ue(s.BLEND),x=!1)}function q(O){I!==O&&(O?s.frontFace(s.CW):s.frontFace(s.CCW),I=O)}function B(O){O!==mn?(_e(s.CULL_FACE),O!==G&&(O===Ot?s.cullFace(s.BACK):O===Lt?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):Ue(s.CULL_FACE),G=O}function K(O,W,Y){O?(_e(s.POLYGON_OFFSET_FILL),j===W&&N===Y||(s.polygonOffset(W,Y),j=W,N=Y)):Ue(s.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:i,stencil:a},enable:_e,disable:Ue,bindFramebuffer:function(O,W){return p[O]!==W&&(s.bindFramebuffer(O,W),p[O]=W,n&&(O===s.DRAW_FRAMEBUFFER&&(p[s.FRAMEBUFFER]=W),O===s.FRAMEBUFFER&&(p[s.DRAW_FRAMEBUFFER]=W)),!0)},drawBuffers:function(O,W){let Y=m,te=!1;if(O)if(Y=f.get(W),Y===void 0&&(Y=[],f.set(W,Y)),O.isWebGLMultipleRenderTargets){const ne=O.texture;if(Y.length!==ne.length||Y[0]!==s.COLOR_ATTACHMENT0){for(let me=0,Fe=ne.length;me<Fe;me++)Y[me]=s.COLOR_ATTACHMENT0+me;Y.length=ne.length,te=!0}}else Y[0]!==s.COLOR_ATTACHMENT0&&(Y[0]=s.COLOR_ATTACHMENT0,te=!0);else Y[0]!==s.BACK&&(Y[0]=s.BACK,te=!0);te&&(t.isWebGL2?s.drawBuffers(Y):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Y))},useProgram:function(O){return g!==O&&(s.useProgram(O),g=O,!0)},setBlending:ie,setMaterial:function(O,W){O.side===We?Ue(s.CULL_FACE):_e(s.CULL_FACE);let Y=O.side===Be;W&&(Y=!Y),q(Y),O.blending===Nt&&O.transparent===!1?ie(it):ie(O.blending,O.blendEquation,O.blendSrc,O.blendDst,O.blendEquationAlpha,O.blendSrcAlpha,O.blendDstAlpha,O.premultipliedAlpha),i.setFunc(O.depthFunc),i.setTest(O.depthTest),i.setMask(O.depthWrite),r.setMask(O.colorWrite);const te=O.stencilWrite;a.setTest(te),te&&(a.setMask(O.stencilWriteMask),a.setFunc(O.stencilFunc,O.stencilRef,O.stencilFuncMask),a.setOp(O.stencilFail,O.stencilZFail,O.stencilZPass)),K(O.polygonOffset,O.polygonOffsetFactor,O.polygonOffsetUnits),O.alphaToCoverage===!0?_e(s.SAMPLE_ALPHA_TO_COVERAGE):Ue(s.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:B,setLineWidth:function(O){O!==U&&(le&&s.lineWidth(O),U=O)},setPolygonOffset:K,setScissorTest:function(O){O?_e(s.SCISSOR_TEST):Ue(s.SCISSOR_TEST)},activeTexture:function(O){O===void 0&&(O=s.TEXTURE0+J-1),ge!==O&&(s.activeTexture(O),ge=O)},bindTexture:function(O,W,Y){Y===void 0&&(Y=ge===null?s.TEXTURE0+J-1:ge);let te=Me[Y];te===void 0&&(te={type:void 0,texture:void 0},Me[Y]=te),te.type===O&&te.texture===W||(ge!==Y&&(s.activeTexture(Y),ge=Y),s.bindTexture(O,W||Ce[O]),te.type=O,te.texture=W)},unbindTexture:function(){const O=Me[ge];O!==void 0&&O.type!==void 0&&(s.bindTexture(O.type,null),O.type=void 0,O.texture=void 0)},compressedTexImage2D:function(){try{s.compressedTexImage2D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexImage3D:function(){try{s.compressedTexImage3D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage2D:function(){try{s.texImage2D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage3D:function(){try{s.texImage3D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},updateUBOMapping:function(O,W){let Y=u.get(W);Y===void 0&&(Y=new WeakMap,u.set(W,Y));let te=Y.get(O);te===void 0&&(te=s.getUniformBlockIndex(W,O.name),Y.set(O,te))},uniformBlockBinding:function(O,W){const Y=u.get(W).get(O);l.get(W)!==Y&&(s.uniformBlockBinding(W,Y,O.__bindingPointIndex),l.set(W,Y))},texStorage2D:function(){try{s.texStorage2D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texStorage3D:function(){try{s.texStorage3D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage2D:function(){try{s.texSubImage2D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage3D:function(){try{s.texSubImage3D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage2D:function(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage3D:function(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},scissor:function(O){pe.equals(O)===!1&&(s.scissor(O.x,O.y,O.z,O.w),pe.copy(O))},viewport:function(O){re.equals(O)===!1&&(s.viewport(O.x,O.y,O.z,O.w),re.copy(O))},reset:function(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),n===!0&&(s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null)),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),h={},ge=null,Me={},p={},f=new WeakMap,m=[],g=null,x=!1,y=null,b=null,w=null,_=null,T=null,A=null,R=null,C=!1,I=null,G=null,U=null,j=null,N=null,pe.set(0,0,s.canvas.width,s.canvas.height),re.set(0,0,s.canvas.width,s.canvas.height),r.reset(),i.reset(),a.reset()}}}function um(s,e,t,n,r,i,a){const l=r.isWebGL2,u=r.maxTextures,h=r.maxCubemapSize,p=r.maxTextureSize,f=r.maxSamples,m=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,g=typeof navigator<"u"&&/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let y;const b=new WeakMap;let w=!1;try{w=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(H,k){return w?new OffscreenCanvas(H,k):to("canvas")}function T(H,k,ie,q){let B=1;if((H.width>q||H.height>q)&&(B=q/Math.max(H.width,H.height)),B<1||k===!0){if(typeof HTMLImageElement<"u"&&H instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&H instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&H instanceof ImageBitmap){const K=k?mf:Math.floor,O=K(B*H.width),W=K(B*H.height);y===void 0&&(y=_(O,W));const Y=ie?_(O,W):y;return Y.width=O,Y.height=W,Y.getContext("2d").drawImage(H,0,0,O,W),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+H.width+"x"+H.height+") to ("+O+"x"+W+")."),Y}return"data"in H&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+H.width+"x"+H.height+")."),H}return H}function A(H){return bc(H.width)&&bc(H.height)}function R(H,k){return H.generateMipmaps&&k&&H.minFilter!==Wt&&H.minFilter!==_t}function C(H){s.generateMipmap(H)}function I(H,k,ie,q,B=!1){if(l===!1)return k;if(H!==null){if(s[H]!==void 0)return s[H];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+H+"'")}let K=k;return k===s.RED&&(ie===s.FLOAT&&(K=s.R32F),ie===s.HALF_FLOAT&&(K=s.R16F),ie===s.UNSIGNED_BYTE&&(K=s.R8)),k===s.RG&&(ie===s.FLOAT&&(K=s.RG32F),ie===s.HALF_FLOAT&&(K=s.RG16F),ie===s.UNSIGNED_BYTE&&(K=s.RG8)),k===s.RGBA&&(ie===s.FLOAT&&(K=s.RGBA32F),ie===s.HALF_FLOAT&&(K=s.RGBA16F),ie===s.UNSIGNED_BYTE&&(K=q===Ct&&B===!1?s.SRGB8_ALPHA8:s.RGBA8),ie===s.UNSIGNED_SHORT_4_4_4_4&&(K=s.RGBA4),ie===s.UNSIGNED_SHORT_5_5_5_1&&(K=s.RGB5_A1)),K!==s.R16F&&K!==s.R32F&&K!==s.RG16F&&K!==s.RG32F&&K!==s.RGBA16F&&K!==s.RGBA32F||e.get("EXT_color_buffer_float"),K}function G(H,k,ie){return R(H,ie)===!0||H.isFramebufferTexture&&H.minFilter!==Wt&&H.minFilter!==_t?Math.log2(Math.max(k.width,k.height))+1:H.mipmaps!==void 0&&H.mipmaps.length>0?H.mipmaps.length:H.isCompressedTexture&&Array.isArray(H.image)?k.mipmaps.length:1}function U(H){return H===Wt||H===Xs||H===ia?s.NEAREST:s.LINEAR}function j(H){const k=H.target;k.removeEventListener("dispose",j),(function(ie){const q=n.get(ie);if(q.__webglInit===void 0)return;const B=ie.source,K=b.get(B);if(K){const O=K[q.__cacheKey];O.usedTimes--,O.usedTimes===0&&J(ie),Object.keys(K).length===0&&b.delete(B)}n.remove(ie)})(k),k.isVideoTexture&&x.delete(k)}function N(H){const k=H.target;k.removeEventListener("dispose",N),(function(ie){const q=ie.texture,B=n.get(ie),K=n.get(q);if(K.__webglTexture!==void 0&&(s.deleteTexture(K.__webglTexture),a.memory.textures--),ie.depthTexture&&ie.depthTexture.dispose(),ie.isWebGLCubeRenderTarget)for(let O=0;O<6;O++)s.deleteFramebuffer(B.__webglFramebuffer[O]),B.__webglDepthbuffer&&s.deleteRenderbuffer(B.__webglDepthbuffer[O]);else{if(s.deleteFramebuffer(B.__webglFramebuffer),B.__webglDepthbuffer&&s.deleteRenderbuffer(B.__webglDepthbuffer),B.__webglMultisampledFramebuffer&&s.deleteFramebuffer(B.__webglMultisampledFramebuffer),B.__webglColorRenderbuffer)for(let O=0;O<B.__webglColorRenderbuffer.length;O++)B.__webglColorRenderbuffer[O]&&s.deleteRenderbuffer(B.__webglColorRenderbuffer[O]);B.__webglDepthRenderbuffer&&s.deleteRenderbuffer(B.__webglDepthRenderbuffer)}if(ie.isWebGLMultipleRenderTargets)for(let O=0,W=q.length;O<W;O++){const Y=n.get(q[O]);Y.__webglTexture&&(s.deleteTexture(Y.__webglTexture),a.memory.textures--),n.remove(q[O])}n.remove(q),n.remove(ie)})(k)}function J(H){const k=n.get(H);s.deleteTexture(k.__webglTexture);const ie=H.source;delete b.get(ie)[k.__cacheKey],a.memory.textures--}let le=0;function oe(H,k){const ie=n.get(H);if(H.isVideoTexture&&(function(q){const B=a.render.frame;x.get(q)!==B&&(x.set(q,B),q.update())})(H),H.isRenderTargetTexture===!1&&H.version>0&&ie.__version!==H.version){const q=H.image;if(q===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(q.complete!==!1)return void De(ie,H,k);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(s.TEXTURE_2D,ie.__webglTexture,s.TEXTURE0+k)}const xe={[$r]:s.REPEAT,[Gn]:s.CLAMP_TO_EDGE,[xs]:s.MIRRORED_REPEAT},ge={[Wt]:s.NEAREST,[Xs]:s.NEAREST_MIPMAP_NEAREST,[ia]:s.NEAREST_MIPMAP_LINEAR,[_t]:s.LINEAR,[hc]:s.LINEAR_MIPMAP_NEAREST,[Oi]:s.LINEAR_MIPMAP_LINEAR};function Me(H,k,ie){if(ie?(s.texParameteri(H,s.TEXTURE_WRAP_S,xe[k.wrapS]),s.texParameteri(H,s.TEXTURE_WRAP_T,xe[k.wrapT]),H!==s.TEXTURE_3D&&H!==s.TEXTURE_2D_ARRAY||s.texParameteri(H,s.TEXTURE_WRAP_R,xe[k.wrapR]),s.texParameteri(H,s.TEXTURE_MAG_FILTER,ge[k.magFilter]),s.texParameteri(H,s.TEXTURE_MIN_FILTER,ge[k.minFilter])):(s.texParameteri(H,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(H,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),H!==s.TEXTURE_3D&&H!==s.TEXTURE_2D_ARRAY||s.texParameteri(H,s.TEXTURE_WRAP_R,s.CLAMP_TO_EDGE),k.wrapS===Gn&&k.wrapT===Gn||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),s.texParameteri(H,s.TEXTURE_MAG_FILTER,U(k.magFilter)),s.texParameteri(H,s.TEXTURE_MIN_FILTER,U(k.minFilter)),k.minFilter!==Wt&&k.minFilter!==_t&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const q=e.get("EXT_texture_filter_anisotropic");if(k.magFilter===Wt||k.minFilter!==ia&&k.minFilter!==Oi||k.type===xr&&e.has("OES_texture_float_linear")===!1||l===!1&&k.type===br&&e.has("OES_texture_half_float_linear")===!1)return;(k.anisotropy>1||n.get(k).__currentAnisotropy)&&(s.texParameterf(H,q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,r.getMaxAnisotropy())),n.get(k).__currentAnisotropy=k.anisotropy)}}function Ae(H,k){let ie=!1;H.__webglInit===void 0&&(H.__webglInit=!0,k.addEventListener("dispose",j));const q=k.source;let B=b.get(q);B===void 0&&(B={},b.set(q,B));const K=(function(O){const W=[];return W.push(O.wrapS),W.push(O.wrapT),W.push(O.wrapR||0),W.push(O.magFilter),W.push(O.minFilter),W.push(O.anisotropy),W.push(O.internalFormat),W.push(O.format),W.push(O.type),W.push(O.generateMipmaps),W.push(O.premultiplyAlpha),W.push(O.flipY),W.push(O.unpackAlignment),W.push(O.encoding),W.join()})(k);if(K!==H.__cacheKey){B[K]===void 0&&(B[K]={texture:s.createTexture(),usedTimes:0},a.memory.textures++,ie=!0),B[K].usedTimes++;const O=B[H.__cacheKey];O!==void 0&&(B[H.__cacheKey].usedTimes--,O.usedTimes===0&&J(k)),H.__cacheKey=K,H.__webglTexture=B[K].texture}return ie}function De(H,k,ie){let q=s.TEXTURE_2D;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(q=s.TEXTURE_2D_ARRAY),k.isData3DTexture&&(q=s.TEXTURE_3D);const B=Ae(H,k),K=k.source;t.bindTexture(q,H.__webglTexture,s.TEXTURE0+ie);const O=n.get(K);if(K.version!==O.__version||B===!0){t.activeTexture(s.TEXTURE0+ie),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,k.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,k.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE);const W=(function(xt){return!l&&(xt.wrapS!==Gn||xt.wrapT!==Gn||xt.minFilter!==Wt&&xt.minFilter!==_t)})(k)&&A(k.image)===!1;let Y=T(k.image,W,!1,p);Y=Ue(k,Y);const te=A(Y)||l,ne=i.convert(k.format,k.encoding);let me,Fe=i.convert(k.type),Ge=I(k.internalFormat,ne,Fe,k.encoding,k.isVideoTexture);Me(q,k,te);const Je=k.mipmaps,Ve=l&&k.isVideoTexture!==!0,wt=O.__version===void 0||B===!0,At=G(k,Y,te);if(k.isDepthTexture)Ge=s.DEPTH_COMPONENT,l?Ge=k.type===xr?s.DEPTH_COMPONENT32F:k.type===Va?s.DEPTH_COMPONENT24:k.type===Wa?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT16:k.type===xr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),k.format===xa&&Ge===s.DEPTH_COMPONENT&&k.type!==qo&&k.type!==Va&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),k.type=Va,Fe=i.convert(k.type)),k.format===Ss&&Ge===s.DEPTH_COMPONENT&&(Ge=s.DEPTH_STENCIL,k.type!==Wa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),k.type=Wa,Fe=i.convert(k.type))),wt&&(Ve?t.texStorage2D(s.TEXTURE_2D,1,Ge,Y.width,Y.height):t.texImage2D(s.TEXTURE_2D,0,Ge,Y.width,Y.height,0,ne,Fe,null));else if(k.isDataTexture)if(Je.length>0&&te){Ve&&wt&&t.texStorage2D(s.TEXTURE_2D,At,Ge,Je[0].width,Je[0].height);for(let xt=0,Ft=Je.length;xt<Ft;xt++)me=Je[xt],Ve?t.texSubImage2D(s.TEXTURE_2D,xt,0,0,me.width,me.height,ne,Fe,me.data):t.texImage2D(s.TEXTURE_2D,xt,Ge,me.width,me.height,0,ne,Fe,me.data);k.generateMipmaps=!1}else Ve?(wt&&t.texStorage2D(s.TEXTURE_2D,At,Ge,Y.width,Y.height),t.texSubImage2D(s.TEXTURE_2D,0,0,0,Y.width,Y.height,ne,Fe,Y.data)):t.texImage2D(s.TEXTURE_2D,0,Ge,Y.width,Y.height,0,ne,Fe,Y.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){Ve&&wt&&t.texStorage3D(s.TEXTURE_2D_ARRAY,At,Ge,Je[0].width,Je[0].height,Y.depth);for(let xt=0,Ft=Je.length;xt<Ft;xt++)me=Je[xt],k.format!==Hr?ne!==null?Ve?t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,xt,0,0,0,me.width,me.height,Y.depth,ne,me.data,0,0):t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,xt,Ge,me.width,me.height,Y.depth,0,me.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ve?t.texSubImage3D(s.TEXTURE_2D_ARRAY,xt,0,0,0,me.width,me.height,Y.depth,ne,Fe,me.data):t.texImage3D(s.TEXTURE_2D_ARRAY,xt,Ge,me.width,me.height,Y.depth,0,ne,Fe,me.data)}else{Ve&&wt&&t.texStorage2D(s.TEXTURE_2D,At,Ge,Je[0].width,Je[0].height);for(let xt=0,Ft=Je.length;xt<Ft;xt++)me=Je[xt],k.format!==Hr?ne!==null?Ve?t.compressedTexSubImage2D(s.TEXTURE_2D,xt,0,0,me.width,me.height,ne,me.data):t.compressedTexImage2D(s.TEXTURE_2D,xt,Ge,me.width,me.height,0,me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ve?t.texSubImage2D(s.TEXTURE_2D,xt,0,0,me.width,me.height,ne,Fe,me.data):t.texImage2D(s.TEXTURE_2D,xt,Ge,me.width,me.height,0,ne,Fe,me.data)}else if(k.isDataArrayTexture)Ve?(wt&&t.texStorage3D(s.TEXTURE_2D_ARRAY,At,Ge,Y.width,Y.height,Y.depth),t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,Y.width,Y.height,Y.depth,ne,Fe,Y.data)):t.texImage3D(s.TEXTURE_2D_ARRAY,0,Ge,Y.width,Y.height,Y.depth,0,ne,Fe,Y.data);else if(k.isData3DTexture)Ve?(wt&&t.texStorage3D(s.TEXTURE_3D,At,Ge,Y.width,Y.height,Y.depth),t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,Y.width,Y.height,Y.depth,ne,Fe,Y.data)):t.texImage3D(s.TEXTURE_3D,0,Ge,Y.width,Y.height,Y.depth,0,ne,Fe,Y.data);else if(k.isFramebufferTexture){if(wt)if(Ve)t.texStorage2D(s.TEXTURE_2D,At,Ge,Y.width,Y.height);else{let xt=Y.width,Ft=Y.height;for(let un=0;un<At;un++)t.texImage2D(s.TEXTURE_2D,un,Ge,xt,Ft,0,ne,Fe,null),xt>>=1,Ft>>=1}}else if(Je.length>0&&te){Ve&&wt&&t.texStorage2D(s.TEXTURE_2D,At,Ge,Je[0].width,Je[0].height);for(let xt=0,Ft=Je.length;xt<Ft;xt++)me=Je[xt],Ve?t.texSubImage2D(s.TEXTURE_2D,xt,0,0,ne,Fe,me):t.texImage2D(s.TEXTURE_2D,xt,Ge,ne,Fe,me);k.generateMipmaps=!1}else Ve?(wt&&t.texStorage2D(s.TEXTURE_2D,At,Ge,Y.width,Y.height),t.texSubImage2D(s.TEXTURE_2D,0,0,0,ne,Fe,Y)):t.texImage2D(s.TEXTURE_2D,0,Ge,ne,Fe,Y);R(k,te)&&C(q),O.__version=K.version,k.onUpdate&&k.onUpdate(k)}H.__version=k.version}function pe(H,k,ie,q,B){const K=i.convert(ie.format,ie.encoding),O=i.convert(ie.type),W=I(ie.internalFormat,K,O,ie.encoding);n.get(k).__hasExternalTextures||(B===s.TEXTURE_3D||B===s.TEXTURE_2D_ARRAY?t.texImage3D(B,0,W,k.width,k.height,k.depth,0,K,O,null):t.texImage2D(B,0,W,k.width,k.height,0,K,O,null)),t.bindFramebuffer(s.FRAMEBUFFER,H),_e(k)?m.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,q,B,n.get(ie).__webglTexture,0,Ce(k)):(B===s.TEXTURE_2D||B>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&B<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,q,B,n.get(ie).__webglTexture,0),t.bindFramebuffer(s.FRAMEBUFFER,null)}function re(H,k,ie){if(s.bindRenderbuffer(s.RENDERBUFFER,H),k.depthBuffer&&!k.stencilBuffer){let q=s.DEPTH_COMPONENT16;if(ie||_e(k)){const B=k.depthTexture;B&&B.isDepthTexture&&(B.type===xr?q=s.DEPTH_COMPONENT32F:B.type===Va&&(q=s.DEPTH_COMPONENT24));const K=Ce(k);_e(k)?m.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,K,q,k.width,k.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,K,q,k.width,k.height)}else s.renderbufferStorage(s.RENDERBUFFER,q,k.width,k.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,H)}else if(k.depthBuffer&&k.stencilBuffer){const q=Ce(k);ie&&_e(k)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,q,s.DEPTH24_STENCIL8,k.width,k.height):_e(k)?m.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,q,s.DEPTH24_STENCIL8,k.width,k.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,k.width,k.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,H)}else{const q=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let B=0;B<q.length;B++){const K=q[B],O=i.convert(K.format,K.encoding),W=i.convert(K.type),Y=I(K.internalFormat,O,W,K.encoding),te=Ce(k);ie&&_e(k)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,te,Y,k.width,k.height):_e(k)?m.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,te,Y,k.width,k.height):s.renderbufferStorage(s.RENDERBUFFER,Y,k.width,k.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function ye(H){const k=n.get(H),ie=H.isWebGLCubeRenderTarget===!0;if(H.depthTexture&&!k.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");(function(q,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,q),!B.depthTexture||!B.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(B.depthTexture).__webglTexture&&B.depthTexture.image.width===B.width&&B.depthTexture.image.height===B.height||(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),oe(B.depthTexture,0);const K=n.get(B.depthTexture).__webglTexture,O=Ce(B);if(B.depthTexture.format===xa)_e(B)?m.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,K,0,O):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,K,0);else{if(B.depthTexture.format!==Ss)throw new Error("Unknown depthTexture format");_e(B)?m.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,K,0,O):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,K,0)}})(k.__webglFramebuffer,H)}else if(ie){k.__webglDepthbuffer=[];for(let q=0;q<6;q++)t.bindFramebuffer(s.FRAMEBUFFER,k.__webglFramebuffer[q]),k.__webglDepthbuffer[q]=s.createRenderbuffer(),re(k.__webglDepthbuffer[q],H,!1)}else t.bindFramebuffer(s.FRAMEBUFFER,k.__webglFramebuffer),k.__webglDepthbuffer=s.createRenderbuffer(),re(k.__webglDepthbuffer,H,!1);t.bindFramebuffer(s.FRAMEBUFFER,null)}function Ce(H){return Math.min(f,H.samples)}function _e(H){const k=n.get(H);return l&&H.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&k.__useRenderToTexture!==!1}function Ue(H,k){const ie=H.encoding,q=H.format,B=H.type;return H.isCompressedTexture===!0||H.isVideoTexture===!0||H.format===Yu||ie!==jr&&(ie===Ct?l===!1?e.has("EXT_sRGB")===!0&&q===Hr?(H.format=Yu,H.minFilter=_t,H.generateMipmaps=!1):k=io.sRGBToLinear(k):q===Hr&&B===Vn||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),k}this.allocateTextureUnit=function(){const H=le;return H>=u&&console.warn("THREE.WebGLTextures: Trying to use "+H+" texture units while this GPU supports only "+u),le+=1,H},this.resetTextureUnits=function(){le=0},this.setTexture2D=oe,this.setTexture2DArray=function(H,k){const ie=n.get(H);H.version>0&&ie.__version!==H.version?De(ie,H,k):t.bindTexture(s.TEXTURE_2D_ARRAY,ie.__webglTexture,s.TEXTURE0+k)},this.setTexture3D=function(H,k){const ie=n.get(H);H.version>0&&ie.__version!==H.version?De(ie,H,k):t.bindTexture(s.TEXTURE_3D,ie.__webglTexture,s.TEXTURE0+k)},this.setTextureCube=function(H,k){const ie=n.get(H);H.version>0&&ie.__version!==H.version?(function(q,B,K){if(B.image.length!==6)return;const O=Ae(q,B),W=B.source;t.bindTexture(s.TEXTURE_CUBE_MAP,q.__webglTexture,s.TEXTURE0+K);const Y=n.get(W);if(W.version!==Y.__version||O===!0){t.activeTexture(s.TEXTURE0+K),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,B.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,B.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE);const te=B.isCompressedTexture||B.image[0].isCompressedTexture,ne=B.image[0]&&B.image[0].isDataTexture,me=[];for(let gt=0;gt<6;gt++)me[gt]=te||ne?ne?B.image[gt].image:B.image[gt]:T(B.image[gt],!1,!0,h),me[gt]=Ue(B,me[gt]);const Fe=me[0],Ge=A(Fe)||l,Je=i.convert(B.format,B.encoding),Ve=i.convert(B.type),wt=I(B.internalFormat,Je,Ve,B.encoding),At=l&&B.isVideoTexture!==!0,xt=Y.__version===void 0||O===!0;let Ft,un=G(B,Fe,Ge);if(Me(s.TEXTURE_CUBE_MAP,B,Ge),te){At&&xt&&t.texStorage2D(s.TEXTURE_CUBE_MAP,un,wt,Fe.width,Fe.height);for(let gt=0;gt<6;gt++){Ft=me[gt].mipmaps;for(let hn=0;hn<Ft.length;hn++){const de=Ft[hn];B.format!==Hr?Je!==null?At?t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn,0,0,de.width,de.height,Je,de.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn,wt,de.width,de.height,0,de.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):At?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn,0,0,de.width,de.height,Je,Ve,de.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn,wt,de.width,de.height,0,Je,Ve,de.data)}}}else{Ft=B.mipmaps,At&&xt&&(Ft.length>0&&un++,t.texStorage2D(s.TEXTURE_CUBE_MAP,un,wt,me[0].width,me[0].height));for(let gt=0;gt<6;gt++)if(ne){At?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,0,0,me[gt].width,me[gt].height,Je,Ve,me[gt].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,wt,me[gt].width,me[gt].height,0,Je,Ve,me[gt].data);for(let hn=0;hn<Ft.length;hn++){const de=Ft[hn].image[gt].image;At?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn+1,0,0,de.width,de.height,Je,Ve,de.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn+1,wt,de.width,de.height,0,Je,Ve,de.data)}}else{At?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,0,0,Je,Ve,me[gt]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,wt,Je,Ve,me[gt]);for(let hn=0;hn<Ft.length;hn++){const de=Ft[hn];At?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn+1,0,0,Je,Ve,de.image[gt]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+gt,hn+1,wt,Je,Ve,de.image[gt])}}}R(B,Ge)&&C(s.TEXTURE_CUBE_MAP),Y.__version=W.version,B.onUpdate&&B.onUpdate(B)}q.__version=B.version})(ie,H,k):t.bindTexture(s.TEXTURE_CUBE_MAP,ie.__webglTexture,s.TEXTURE0+k)},this.rebindTextures=function(H,k,ie){const q=n.get(H);k!==void 0&&pe(q.__webglFramebuffer,H,H.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D),ie!==void 0&&ye(H)},this.setupRenderTarget=function(H){const k=H.texture,ie=n.get(H),q=n.get(k);H.addEventListener("dispose",N),H.isWebGLMultipleRenderTargets!==!0&&(q.__webglTexture===void 0&&(q.__webglTexture=s.createTexture()),q.__version=k.version,a.memory.textures++);const B=H.isWebGLCubeRenderTarget===!0,K=H.isWebGLMultipleRenderTargets===!0,O=A(H)||l;if(B){ie.__webglFramebuffer=[];for(let W=0;W<6;W++)ie.__webglFramebuffer[W]=s.createFramebuffer()}else{if(ie.__webglFramebuffer=s.createFramebuffer(),K)if(r.drawBuffers){const W=H.texture;for(let Y=0,te=W.length;Y<te;Y++){const ne=n.get(W[Y]);ne.__webglTexture===void 0&&(ne.__webglTexture=s.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&H.samples>0&&_e(H)===!1){const W=K?k:[k];ie.__webglMultisampledFramebuffer=s.createFramebuffer(),ie.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,ie.__webglMultisampledFramebuffer);for(let Y=0;Y<W.length;Y++){const te=W[Y];ie.__webglColorRenderbuffer[Y]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,ie.__webglColorRenderbuffer[Y]);const ne=i.convert(te.format,te.encoding),me=i.convert(te.type),Fe=I(te.internalFormat,ne,me,te.encoding,H.isXRRenderTarget===!0),Ge=Ce(H);s.renderbufferStorageMultisample(s.RENDERBUFFER,Ge,Fe,H.width,H.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Y,s.RENDERBUFFER,ie.__webglColorRenderbuffer[Y])}s.bindRenderbuffer(s.RENDERBUFFER,null),H.depthBuffer&&(ie.__webglDepthRenderbuffer=s.createRenderbuffer(),re(ie.__webglDepthRenderbuffer,H,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(B){t.bindTexture(s.TEXTURE_CUBE_MAP,q.__webglTexture),Me(s.TEXTURE_CUBE_MAP,k,O);for(let W=0;W<6;W++)pe(ie.__webglFramebuffer[W],H,k,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+W);R(k,O)&&C(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(K){const W=H.texture;for(let Y=0,te=W.length;Y<te;Y++){const ne=W[Y],me=n.get(ne);t.bindTexture(s.TEXTURE_2D,me.__webglTexture),Me(s.TEXTURE_2D,ne,O),pe(ie.__webglFramebuffer,H,ne,s.COLOR_ATTACHMENT0+Y,s.TEXTURE_2D),R(ne,O)&&C(s.TEXTURE_2D)}t.unbindTexture()}else{let W=s.TEXTURE_2D;(H.isWebGL3DRenderTarget||H.isWebGLArrayRenderTarget)&&(l?W=H.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(W,q.__webglTexture),Me(W,k,O),pe(ie.__webglFramebuffer,H,k,s.COLOR_ATTACHMENT0,W),R(k,O)&&C(W),t.unbindTexture()}H.depthBuffer&&ye(H)},this.updateRenderTargetMipmap=function(H){const k=A(H)||l,ie=H.isWebGLMultipleRenderTargets===!0?H.texture:[H.texture];for(let q=0,B=ie.length;q<B;q++){const K=ie[q];if(R(K,k)){const O=H.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,W=n.get(K).__webglTexture;t.bindTexture(O,W),C(O),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function(H){if(l&&H.samples>0&&_e(H)===!1){const k=H.isWebGLMultipleRenderTargets?H.texture:[H.texture],ie=H.width,q=H.height;let B=s.COLOR_BUFFER_BIT;const K=[],O=H.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,W=n.get(H),Y=H.isWebGLMultipleRenderTargets===!0;if(Y)for(let te=0;te<k.length;te++)t.bindFramebuffer(s.FRAMEBUFFER,W.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+te,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,W.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+te,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,W.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,W.__webglFramebuffer);for(let te=0;te<k.length;te++){K.push(s.COLOR_ATTACHMENT0+te),H.depthBuffer&&K.push(O);const ne=W.__ignoreDepthValues!==void 0&&W.__ignoreDepthValues;if(ne===!1&&(H.depthBuffer&&(B|=s.DEPTH_BUFFER_BIT),H.stencilBuffer&&(B|=s.STENCIL_BUFFER_BIT)),Y&&s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,W.__webglColorRenderbuffer[te]),ne===!0&&(s.invalidateFramebuffer(s.READ_FRAMEBUFFER,[O]),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[O])),Y){const me=n.get(k[te]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,me,0)}s.blitFramebuffer(0,0,ie,q,0,0,ie,q,B,s.NEAREST),g&&s.invalidateFramebuffer(s.READ_FRAMEBUFFER,K)}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),Y)for(let te=0;te<k.length;te++){t.bindFramebuffer(s.FRAMEBUFFER,W.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+te,s.RENDERBUFFER,W.__webglColorRenderbuffer[te]);const ne=n.get(k[te]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,W.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+te,s.TEXTURE_2D,ne,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,W.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=pe,this.useMultisampledRTT=_e}function Rl(s,e,t){const n=t.isWebGL2;return{convert:function(r,i=null){let a;if(r===Vn)return s.UNSIGNED_BYTE;if(r===dc)return s.UNSIGNED_SHORT_4_4_4_4;if(r===Lu)return s.UNSIGNED_SHORT_5_5_5_1;if(r===cd)return s.BYTE;if(r===Xo)return s.SHORT;if(r===qo)return s.UNSIGNED_SHORT;if(r===Yo)return s.INT;if(r===Va)return s.UNSIGNED_INT;if(r===xr)return s.FLOAT;if(r===br)return n?s.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(r===af)return s.ALPHA;if(r===Hr)return s.RGBA;if(r===bs)return s.LUMINANCE;if(r===ud)return s.LUMINANCE_ALPHA;if(r===xa)return s.DEPTH_COMPONENT;if(r===Ss)return s.DEPTH_STENCIL;if(r===Yu)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(r===Pu)return s.RED;if(r===hd)return s.RED_INTEGER;if(r===dd)return s.RG;if(r===pd)return s.RG_INTEGER;if(r===sf)return s.RGBA_INTEGER;if(r===Cu||r===Ln||r===Du||r===Qo)if(i===Ct){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a===null)return null;if(r===Cu)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===Ln)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===Du)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===Qo)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),a===null)return null;if(r===Cu)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Ln)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===Du)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Qo)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===Ou||r===Zo||r===fd||r===Iu){if(a=e.get("WEBGL_compressed_texture_pvrtc"),a===null)return null;if(r===Ou)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Zo)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===fd)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Iu)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===pc)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(r===Ii||r===md){if(a=e.get("WEBGL_compressed_texture_etc"),a===null)return null;if(r===Ii)return i===Ct?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(r===md)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(r===pi||r===gd||r===vd||r===yd||r===Ko||r===Jo||r===qs||r===$o||r===xd||r===bd||r===fc||r===Nu||r===mc||r===Ys){if(a=e.get("WEBGL_compressed_texture_astc"),a===null)return null;if(r===pi)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===gd)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===vd)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===yd)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===Ko)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===Jo)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===qs)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===$o)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===xd)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===bd)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===fc)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===Nu)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===mc)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===Ys)return i===Ct?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===ku){if(a=e.get("EXT_texture_compression_bptc"),a===null)return null;if(r===ku)return i===Ct?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(r===Fu||r===Kt||r===Uu||r===zu){if(a=e.get("EXT_texture_compression_rgtc"),a===null)return null;if(r===ku)return a.COMPRESSED_RED_RGTC1_EXT;if(r===Kt)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===Uu)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===zu)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===Wa?n?s.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):s[r]!==void 0?s[r]:null}}}class Mr extends vn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Cr extends St{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Ig={type:"move"};class Ll{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Cr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Cr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new D,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new D),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Cr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new D,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new D),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const l=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){a=!0;for(const y of e.hand.values()){const b=t.getJointPose(y,n),w=this._getHandJoint(h,y);b!==null&&(w.matrix.fromArray(b.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.jointRadius=b.radius),w.visible=b!==null}const p=h.joints["index-finger-tip"],f=h.joints["thumb-tip"],m=p.position.distanceTo(f.position),g=.02,x=.005;h.inputState.pinching&&m>g+x?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=g-x&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1));l!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Ig)))}return l!==null&&(l.visible=r!==null),u!==null&&(u.visible=i!==null),h!==null&&(h.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Cr;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class er extends pn{constructor(e,t,n,r,i,a,l,u,h,p){if((p=p!==void 0?p:xa)!==xa&&p!==Ss)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&p===xa&&(n=Va),n===void 0&&p===Ss&&(n=Wa),super(null,r,i,a,l,u,p,n,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=l!==void 0?l:Wt,this.minFilter=u!==void 0?u:Wt,this.flipY=!1,this.generateMipmaps=!1}}class Ng extends Fi{constructor(e,t){super();const n=this;let r=null,i=1,a=null,l="local-floor",u=1,h=null,p=null,f=null,m=null,g=null,x=null;const y=t.getContextAttributes();let b=null,w=null;const _=[],T=[],A=new Set,R=new Map,C=new vn;C.layers.enable(1),C.viewport=new ot;const I=new vn;I.layers.enable(2),I.viewport=new ot;const G=[C,I],U=new Mr;U.layers.enable(1),U.layers.enable(2);let j=null,N=null;function J(pe){const re=T.indexOf(pe.inputSource);if(re===-1)return;const ye=_[re];ye!==void 0&&ye.dispatchEvent({type:pe.type,data:pe.inputSource})}function le(){r.removeEventListener("select",J),r.removeEventListener("selectstart",J),r.removeEventListener("selectend",J),r.removeEventListener("squeeze",J),r.removeEventListener("squeezestart",J),r.removeEventListener("squeezeend",J),r.removeEventListener("end",le),r.removeEventListener("inputsourceschange",oe);for(let pe=0;pe<_.length;pe++){const re=T[pe];re!==null&&(T[pe]=null,_[pe].disconnect(re))}j=null,N=null,e.setRenderTarget(b),g=null,m=null,f=null,r=null,w=null,De.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function oe(pe){for(let re=0;re<pe.removed.length;re++){const ye=pe.removed[re],Ce=T.indexOf(ye);Ce>=0&&(T[Ce]=null,_[Ce].disconnect(ye))}for(let re=0;re<pe.added.length;re++){const ye=pe.added[re];let Ce=T.indexOf(ye);if(Ce===-1){for(let Ue=0;Ue<_.length;Ue++){if(Ue>=T.length){T.push(ye),Ce=Ue;break}if(T[Ue]===null){T[Ue]=ye,Ce=Ue;break}}if(Ce===-1)break}const _e=_[Ce];_e&&_e.connect(ye)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(pe){let re=_[pe];return re===void 0&&(re=new Ll,_[pe]=re),re.getTargetRaySpace()},this.getControllerGrip=function(pe){let re=_[pe];return re===void 0&&(re=new Ll,_[pe]=re),re.getGripSpace()},this.getHand=function(pe){let re=_[pe];return re===void 0&&(re=new Ll,_[pe]=re),re.getHandSpace()},this.setFramebufferScaleFactor=function(pe){i=pe,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(pe){l=pe,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(pe){h=pe},this.getBaseLayer=function(){return m!==null?m:g},this.getBinding=function(){return f},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=async function(pe){if(r=pe,r!==null){if(b=e.getRenderTarget(),r.addEventListener("select",J),r.addEventListener("selectstart",J),r.addEventListener("selectend",J),r.addEventListener("squeeze",J),r.addEventListener("squeezestart",J),r.addEventListener("squeezeend",J),r.addEventListener("end",le),r.addEventListener("inputsourceschange",oe),y.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const re={antialias:r.renderState.layers!==void 0||y.antialias,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:i};g=new XRWebGLLayer(r,t,re),r.updateRenderState({baseLayer:g}),w=new Xt(g.framebufferWidth,g.framebufferHeight,{format:Hr,type:Vn,encoding:e.outputEncoding,stencilBuffer:y.stencil})}else{let re=null,ye=null,Ce=null;y.depth&&(Ce=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,re=y.stencil?Ss:xa,ye=y.stencil?Wa:Va);const _e={colorFormat:t.RGBA8,depthFormat:Ce,scaleFactor:i};f=new XRWebGLBinding(r,t),m=f.createProjectionLayer(_e),r.updateRenderState({layers:[m]}),w=new Xt(m.textureWidth,m.textureHeight,{format:Hr,type:Vn,depthTexture:new er(m.textureWidth,m.textureHeight,ye,void 0,void 0,void 0,void 0,void 0,void 0,re),stencilBuffer:y.stencil,encoding:e.outputEncoding,samples:y.antialias?4:0}),e.properties.get(w).__ignoreDepthValues=m.ignoreDepthValues}w.isXRRenderTarget=!0,this.setFoveation(u),h=null,a=await r.requestReferenceSpace(l),De.setContext(r),De.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const xe=new D,ge=new D;function Me(pe,re){re===null?pe.matrixWorld.copy(pe.matrix):pe.matrixWorld.multiplyMatrices(re.matrixWorld,pe.matrix),pe.matrixWorldInverse.copy(pe.matrixWorld).invert()}this.updateCamera=function(pe){if(r===null)return;U.near=I.near=C.near=pe.near,U.far=I.far=C.far=pe.far,j===U.near&&N===U.far||(r.updateRenderState({depthNear:U.near,depthFar:U.far}),j=U.near,N=U.far);const re=pe.parent,ye=U.cameras;Me(U,re);for(let _e=0;_e<ye.length;_e++)Me(ye[_e],re);U.matrixWorld.decompose(U.position,U.quaternion,U.scale),pe.matrix.copy(U.matrix),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale);const Ce=pe.children;for(let _e=0,Ue=Ce.length;_e<Ue;_e++)Ce[_e].updateMatrixWorld(!0);ye.length===2?(function(_e,Ue,H){xe.setFromMatrixPosition(Ue.matrixWorld),ge.setFromMatrixPosition(H.matrixWorld);const k=xe.distanceTo(ge),ie=Ue.projectionMatrix.elements,q=H.projectionMatrix.elements,B=ie[14]/(ie[10]-1),K=ie[14]/(ie[10]+1),O=(ie[9]+1)/ie[5],W=(ie[9]-1)/ie[5],Y=(ie[8]-1)/ie[0],te=(q[8]+1)/q[0],ne=B*Y,me=B*te,Fe=k/(-Y+te),Ge=Fe*-Y;Ue.matrixWorld.decompose(_e.position,_e.quaternion,_e.scale),_e.translateX(Ge),_e.translateZ(Fe),_e.matrixWorld.compose(_e.position,_e.quaternion,_e.scale),_e.matrixWorldInverse.copy(_e.matrixWorld).invert();const Je=B+Fe,Ve=K+Fe,wt=ne-Ge,At=me+(k-Ge),xt=O*K/Ve*Je,Ft=W*K/Ve*Je;_e.projectionMatrix.makePerspective(wt,At,xt,Ft,Je,Ve)})(U,C,I):U.projectionMatrix.copy(C.projectionMatrix)},this.getCamera=function(){return U},this.getFoveation=function(){if(m!==null||g!==null)return u},this.setFoveation=function(pe){u=pe,m!==null&&(m.fixedFoveation=pe),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=pe)},this.getPlanes=function(){return A};let Ae=null;const De=new jd;De.setAnimationLoop((function(pe,re){if(p=re.getViewerPose(h||a),x=re,p!==null){const ye=p.views;g!==null&&(e.setRenderTargetFramebuffer(w,g.framebuffer),e.setRenderTarget(w));let Ce=!1;ye.length!==U.cameras.length&&(U.cameras.length=0,Ce=!0);for(let _e=0;_e<ye.length;_e++){const Ue=ye[_e];let H=null;if(g!==null)H=g.getViewport(Ue);else{const ie=f.getViewSubImage(m,Ue);H=ie.viewport,_e===0&&(e.setRenderTargetTextures(w,ie.colorTexture,m.ignoreDepthValues?void 0:ie.depthStencilTexture),e.setRenderTarget(w))}let k=G[_e];k===void 0&&(k=new vn,k.layers.enable(_e),k.viewport=new ot,G[_e]=k),k.matrix.fromArray(Ue.transform.matrix),k.projectionMatrix.fromArray(Ue.projectionMatrix),k.viewport.set(H.x,H.y,H.width,H.height),_e===0&&U.matrix.copy(k.matrix),Ce===!0&&U.cameras.push(k)}}for(let ye=0;ye<_.length;ye++){const Ce=T[ye],_e=_[ye];Ce!==null&&_e!==void 0&&_e.update(Ce,re,h||a)}if(Ae&&Ae(pe,re),re.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:re.detectedPlanes});let ye=null;for(const Ce of A)re.detectedPlanes.has(Ce)||(ye===null&&(ye=[]),ye.push(Ce));if(ye!==null)for(const Ce of ye)A.delete(Ce),R.delete(Ce),n.dispatchEvent({type:"planeremoved",data:Ce});for(const Ce of re.detectedPlanes)if(A.has(Ce)){const _e=R.get(Ce);Ce.lastChangedTime>_e&&(R.set(Ce,Ce.lastChangedTime),n.dispatchEvent({type:"planechanged",data:Ce}))}else A.add(Ce),R.set(Ce,re.lastChangedTime),n.dispatchEvent({type:"planeadded",data:Ce})}x=null})),this.setAnimationLoop=function(pe){Ae=pe},this.dispose=function(){}}}function nt(s,e){function t(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===Be&&(n.bumpScale.value*=-1)),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===Be&&n.normalScale.value.negate()),r.specularMap&&(n.specularMap.value=r.specularMap),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const i=e.get(r).envMap;if(i&&(n.envMap.value=i,n.flipEnvMap.value=i.isCubeTexture&&i.isRenderTargetTexture===!1?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const u=s.useLegacyLights===!0?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*u}let a,l;r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?a=r.map:r.specularMap?a=r.specularMap:r.displacementMap?a=r.displacementMap:r.normalMap?a=r.normalMap:r.bumpMap?a=r.bumpMap:r.roughnessMap?a=r.roughnessMap:r.metalnessMap?a=r.metalnessMap:r.alphaMap?a=r.alphaMap:r.emissiveMap?a=r.emissiveMap:r.clearcoatMap?a=r.clearcoatMap:r.clearcoatNormalMap?a=r.clearcoatNormalMap:r.clearcoatRoughnessMap?a=r.clearcoatRoughnessMap:r.iridescenceMap?a=r.iridescenceMap:r.iridescenceThicknessMap?a=r.iridescenceThicknessMap:r.specularIntensityMap?a=r.specularIntensityMap:r.specularColorMap?a=r.specularColorMap:r.transmissionMap?a=r.transmissionMap:r.thicknessMap?a=r.thicknessMap:r.sheenColorMap?a=r.sheenColorMap:r.sheenRoughnessMap&&(a=r.sheenRoughnessMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uvTransform.value.copy(a.matrix)),r.aoMap?l=r.aoMap:r.lightMap&&(l=r.lightMap),l!==void 0&&(l.isWebGLRenderTarget&&(l=l.texture),l.matrixAutoUpdate===!0&&l.updateMatrix(),n.uv2Transform.value.copy(l.matrix))}return{refreshFogUniforms:function(n,r){r.color.getRGB(n.fogColor.value,ji(s)),r.isFog?(n.fogNear.value=r.near,n.fogFar.value=r.far):r.isFogExp2&&(n.fogDensity.value=r.density)},refreshMaterialUniforms:function(n,r,i,a,l){r.isMeshBasicMaterial||r.isMeshLambertMaterial?t(n,r):r.isMeshToonMaterial?(t(n,r),(function(u,h){h.gradientMap&&(u.gradientMap.value=h.gradientMap)})(n,r)):r.isMeshPhongMaterial?(t(n,r),(function(u,h){u.specular.value.copy(h.specular),u.shininess.value=Math.max(h.shininess,1e-4)})(n,r)):r.isMeshStandardMaterial?(t(n,r),(function(u,h){u.roughness.value=h.roughness,u.metalness.value=h.metalness,h.roughnessMap&&(u.roughnessMap.value=h.roughnessMap),h.metalnessMap&&(u.metalnessMap.value=h.metalnessMap),e.get(h).envMap&&(u.envMapIntensity.value=h.envMapIntensity)})(n,r),r.isMeshPhysicalMaterial&&(function(u,h,p){u.ior.value=h.ior,h.sheen>0&&(u.sheenColor.value.copy(h.sheenColor).multiplyScalar(h.sheen),u.sheenRoughness.value=h.sheenRoughness,h.sheenColorMap&&(u.sheenColorMap.value=h.sheenColorMap),h.sheenRoughnessMap&&(u.sheenRoughnessMap.value=h.sheenRoughnessMap)),h.clearcoat>0&&(u.clearcoat.value=h.clearcoat,u.clearcoatRoughness.value=h.clearcoatRoughness,h.clearcoatMap&&(u.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(u.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(u.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),u.clearcoatNormalMap.value=h.clearcoatNormalMap,h.side===Be&&u.clearcoatNormalScale.value.negate())),h.iridescence>0&&(u.iridescence.value=h.iridescence,u.iridescenceIOR.value=h.iridescenceIOR,u.iridescenceThicknessMinimum.value=h.iridescenceThicknessRange[0],u.iridescenceThicknessMaximum.value=h.iridescenceThicknessRange[1],h.iridescenceMap&&(u.iridescenceMap.value=h.iridescenceMap),h.iridescenceThicknessMap&&(u.iridescenceThicknessMap.value=h.iridescenceThicknessMap)),h.transmission>0&&(u.transmission.value=h.transmission,u.transmissionSamplerMap.value=p.texture,u.transmissionSamplerSize.value.set(p.width,p.height),h.transmissionMap&&(u.transmissionMap.value=h.transmissionMap),u.thickness.value=h.thickness,h.thicknessMap&&(u.thicknessMap.value=h.thicknessMap),u.attenuationDistance.value=h.attenuationDistance,u.attenuationColor.value.copy(h.attenuationColor)),u.specularIntensity.value=h.specularIntensity,u.specularColor.value.copy(h.specularColor),h.specularIntensityMap&&(u.specularIntensityMap.value=h.specularIntensityMap),h.specularColorMap&&(u.specularColorMap.value=h.specularColorMap)})(n,r,l)):r.isMeshMatcapMaterial?(t(n,r),(function(u,h){h.matcap&&(u.matcap.value=h.matcap)})(n,r)):r.isMeshDepthMaterial?t(n,r):r.isMeshDistanceMaterial?(t(n,r),(function(u,h){u.referencePosition.value.copy(h.referencePosition),u.nearDistance.value=h.nearDistance,u.farDistance.value=h.farDistance})(n,r)):r.isMeshNormalMaterial?t(n,r):r.isLineBasicMaterial?((function(u,h){u.diffuse.value.copy(h.color),u.opacity.value=h.opacity})(n,r),r.isLineDashedMaterial&&(function(u,h){u.dashSize.value=h.dashSize,u.totalSize.value=h.dashSize+h.gapSize,u.scale.value=h.scale})(n,r)):r.isPointsMaterial?(function(u,h,p,f){u.diffuse.value.copy(h.color),u.opacity.value=h.opacity,u.size.value=h.size*p,u.scale.value=.5*f,h.map&&(u.map.value=h.map),h.alphaMap&&(u.alphaMap.value=h.alphaMap),h.alphaTest>0&&(u.alphaTest.value=h.alphaTest);let m;h.map?m=h.map:h.alphaMap&&(m=h.alphaMap),m!==void 0&&(m.matrixAutoUpdate===!0&&m.updateMatrix(),u.uvTransform.value.copy(m.matrix))})(n,r,i,a):r.isSpriteMaterial?(function(u,h){u.diffuse.value.copy(h.color),u.opacity.value=h.opacity,u.rotation.value=h.rotation,h.map&&(u.map.value=h.map),h.alphaMap&&(u.alphaMap.value=h.alphaMap),h.alphaTest>0&&(u.alphaTest.value=h.alphaTest);let p;h.map?p=h.map:h.alphaMap&&(p=h.alphaMap),p!==void 0&&(p.matrixAutoUpdate===!0&&p.updateMatrix(),u.uvTransform.value.copy(p.matrix))})(n,r):r.isShadowMaterial?(n.color.value.copy(r.color),n.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Pl(s,e,t,n){let r={},i={},a=[];const l=t.isWebGL2?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(f,m,g){const x=f.value;if(g[m]===void 0){if(typeof x=="number")g[m]=x;else{const y=Array.isArray(x)?x:[x],b=[];for(let w=0;w<y.length;w++)b.push(y[w].clone());g[m]=b}return!0}if(typeof x=="number"){if(g[m]!==x)return g[m]=x,!0}else{const y=Array.isArray(g[m])?g[m]:[g[m]],b=Array.isArray(x)?x:[x];for(let w=0;w<y.length;w++){const _=y[w];if(_.equals(b[w])===!1)return _.copy(b[w]),!0}}return!1}function h(f){const m={boundary:0,storage:0};return typeof f=="number"?(m.boundary=4,m.storage=4):f.isVector2?(m.boundary=8,m.storage=8):f.isVector3||f.isColor?(m.boundary=16,m.storage=12):f.isVector4?(m.boundary=16,m.storage=16):f.isMatrix3?(m.boundary=48,m.storage=48):f.isMatrix4?(m.boundary=64,m.storage=64):f.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",f),m}function p(f){const m=f.target;m.removeEventListener("dispose",p);const g=a.indexOf(m.__bindingPointIndex);a.splice(g,1),s.deleteBuffer(r[m.id]),delete r[m.id],delete i[m.id]}return{bind:function(f,m){const g=m.program;n.uniformBlockBinding(f,g)},update:function(f,m){let g=r[f.id];g===void 0&&((function(b){const w=b.uniforms;let _=0;const T=16;let A=0;for(let R=0,C=w.length;R<C;R++){const I=w[R],G={boundary:0,storage:0},U=Array.isArray(I.value)?I.value:[I.value];for(let j=0,N=U.length;j<N;j++){const J=h(U[j]);G.boundary+=J.boundary,G.storage+=J.storage}I.__data=new Float32Array(G.storage/Float32Array.BYTES_PER_ELEMENT),I.__offset=_,R>0&&(A=_%T,A!==0&&T-A-G.boundary<0&&(_+=T-A,I.__offset=_)),_+=G.storage}A=_%T,A>0&&(_+=T-A),b.__size=_,b.__cache={}})(f),g=(function(b){const w=(function(){for(let R=0;R<l;R++)if(a.indexOf(R)===-1)return a.push(R),R;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0})();b.__bindingPointIndex=w;const _=s.createBuffer(),T=b.__size,A=b.usage;return s.bindBuffer(s.UNIFORM_BUFFER,_),s.bufferData(s.UNIFORM_BUFFER,T,A),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,w,_),_})(f),r[f.id]=g,f.addEventListener("dispose",p));const x=m.program;n.updateUBOMapping(f,x);const y=e.render.frame;i[f.id]!==y&&((function(b){const w=r[b.id],_=b.uniforms,T=b.__cache;s.bindBuffer(s.UNIFORM_BUFFER,w);for(let A=0,R=_.length;A<R;A++){const C=_[A];if(u(C,A,T)===!0){const I=C.__offset,G=Array.isArray(C.value)?C.value:[C.value];let U=0;for(let j=0;j<G.length;j++){const N=G[j],J=h(N);typeof N=="number"?(C.__data[0]=N,s.bufferSubData(s.UNIFORM_BUFFER,I+U,C.__data)):N.isMatrix3?(C.__data[0]=N.elements[0],C.__data[1]=N.elements[1],C.__data[2]=N.elements[2],C.__data[3]=N.elements[0],C.__data[4]=N.elements[3],C.__data[5]=N.elements[4],C.__data[6]=N.elements[5],C.__data[7]=N.elements[0],C.__data[8]=N.elements[6],C.__data[9]=N.elements[7],C.__data[10]=N.elements[8],C.__data[11]=N.elements[0]):(N.toArray(C.__data,U),U+=J.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,I,C.__data)}}s.bindBuffer(s.UNIFORM_BUFFER,null)})(f),i[f.id]=y)},dispose:function(){for(const f in r)s.deleteBuffer(r[f]);a=[],r={},i={}}}}function Cl(s={}){this.isWebGLRenderer=!0;const e=s.canvas!==void 0?s.canvas:(function(){const X=to("canvas");return X.style.display="block",X})(),t=s.context!==void 0?s.context:null,n=s.depth===void 0||s.depth,r=s.stencil===void 0||s.stencil,i=s.antialias!==void 0&&s.antialias,a=s.premultipliedAlpha===void 0||s.premultipliedAlpha,l=s.preserveDrawingBuffer!==void 0&&s.preserveDrawingBuffer,u=s.powerPreference!==void 0?s.powerPreference:"default",h=s.failIfMajorPerformanceCaveat!==void 0&&s.failIfMajorPerformanceCaveat;let p;p=t!==null?t.getContextAttributes().alpha:s.alpha!==void 0&&s.alpha;let f=null,m=null;const g=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=jr,this.useLegacyLights=!0,this.toneMapping=ra,this.toneMappingExposure=1;const y=this;let b=!1,w=0,_=0,T=null,A=-1,R=null;const C=new ot,I=new ot;let G=null,U=e.width,j=e.height,N=1,J=null,le=null;const oe=new ot(0,0,U,j),xe=new ot(0,0,U,j);let ge=!1;const Me=new Ra;let Ae=!1,De=!1,pe=null;const re=new Ie,ye=new D,Ce={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function _e(){return T===null?N:1}let Ue,H,k,ie,q,B,K,O,W,Y,te,ne,me,Fe,Ge,Je,Ve,wt,At,xt,Ft,un,gt,hn,de=t;function nc(X,be){for(let Te=0;Te<X.length;Te++){const we=X[Te],Oe=e.getContext(we,be);if(Oe!==null)return Oe}return null}try{const X={alpha:!0,depth:n,stencil:r,antialias:i,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${$e}`),e.addEventListener("webglcontextlost",dx,!1),e.addEventListener("webglcontextrestored",px,!1),e.addEventListener("webglcontextcreationerror",fx,!1),de===null){const be=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&be.shift(),de=nc(be,X),de===null)throw nc(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}de.getShaderPrecisionFormat===void 0&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}function rc(){Ue=new _l(de),H=new yo(de,Ue,s),Ue.init(H),un=new Rl(de,Ue,H),k=new cm(de,Ue,H),ie=new On(de),q=new rm,B=new um(de,Ue,k,q,H,un,ie),K=new Ef(y),O=new Wd(y),W=new ch(de,H),gt=new yl(de,Ue,W,H),Y=new Af(de,W,ie,gt),te=new ph(de,Y,W,ie),At=new Yd(de,H,B),Je=new Vd(q),ne=new lp(y,K,O,Ue,H,gt,Je),me=new nt(y,q),Fe=new am,Ge=new om(Ue,H),wt=new Gd(y,K,O,k,te,p,a),Ve=new up(y,te,H),hn=new Pl(de,ie,H,k),xt=new Wi(de,Ue,ie,H),Ft=new Xd(de,Ue,ie,H),ie.programs=ne.programs,y.capabilities=H,y.extensions=Ue,y.properties=q,y.renderLists=Fe,y.shadowMap=Ve,y.state=k,y.info=ie}rc();const ya=new Ng(y,de);function dx(X){X.preventDefault(),b=!0}function px(){b=!1;const X=ie.autoReset,be=Ve.enabled,Te=Ve.autoUpdate,we=Ve.needsUpdate,Oe=Ve.type;rc(),ie.autoReset=X,Ve.enabled=be,Ve.autoUpdate=Te,Ve.needsUpdate=we,Ve.type=Oe}function fx(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function mx(X){const be=X.target;be.removeEventListener("dispose",mx),(function(Te){(function(we){const Oe=q.get(we).programs;Oe!==void 0&&(Oe.forEach((function(ft){ne.releaseProgram(ft)})),we.isShaderMaterial&&ne.releaseShaderCache(we))})(Te),q.remove(Te)})(be)}this.xr=ya,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const X=Ue.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){const X=Ue.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return N},this.setPixelRatio=function(X){X!==void 0&&(N=X,this.setSize(U,j,!1))},this.getSize=function(X){return X.set(U,j)},this.setSize=function(X,be,Te=!0){ya.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(U=X,j=be,e.width=Math.floor(X*N),e.height=Math.floor(be*N),Te===!0&&(e.style.width=X+"px",e.style.height=be+"px"),this.setViewport(0,0,X,be))},this.getDrawingBufferSize=function(X){return X.set(U*N,j*N).floor()},this.setDrawingBufferSize=function(X,be,Te){U=X,j=be,N=Te,e.width=Math.floor(X*Te),e.height=Math.floor(be*Te),this.setViewport(0,0,X,be)},this.getCurrentViewport=function(X){return X.copy(C)},this.getViewport=function(X){return X.copy(oe)},this.setViewport=function(X,be,Te,we){X.isVector4?oe.set(X.x,X.y,X.z,X.w):oe.set(X,be,Te,we),k.viewport(C.copy(oe).multiplyScalar(N).floor())},this.getScissor=function(X){return X.copy(xe)},this.setScissor=function(X,be,Te,we){X.isVector4?xe.set(X.x,X.y,X.z,X.w):xe.set(X,be,Te,we),k.scissor(I.copy(xe).multiplyScalar(N).floor())},this.getScissorTest=function(){return ge},this.setScissorTest=function(X){k.setScissorTest(ge=X)},this.setOpaqueSort=function(X){J=X},this.setTransparentSort=function(X){le=X},this.getClearColor=function(X){return X.copy(wt.getClearColor())},this.setClearColor=function(){wt.setClearColor.apply(wt,arguments)},this.getClearAlpha=function(){return wt.getClearAlpha()},this.setClearAlpha=function(){wt.setClearAlpha.apply(wt,arguments)},this.clear=function(X=!0,be=!0,Te=!0){let we=0;X&&(we|=de.COLOR_BUFFER_BIT),be&&(we|=de.DEPTH_BUFFER_BIT),Te&&(we|=de.STENCIL_BUFFER_BIT),de.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",dx,!1),e.removeEventListener("webglcontextrestored",px,!1),e.removeEventListener("webglcontextcreationerror",fx,!1),Fe.dispose(),Ge.dispose(),q.dispose(),K.dispose(),O.dispose(),te.dispose(),gt.dispose(),hn.dispose(),ne.dispose(),ya.dispose(),ya.removeEventListener("sessionstart",gx),ya.removeEventListener("sessionend",vx),pe&&(pe.dispose(),pe=null),wu.stop()},this.renderBufferDirect=function(X,be,Te,we,Oe,ft){be===null&&(be=Ce);const It=Oe.isMesh&&Oe.matrixWorld.determinant()<0,Ut=(function(qr,ic,gs,Mt,Tr){ic.isScene!==!0&&(ic=Ce),B.resetTextureUnits();const $0=ic.fog,RT=Mt.isMeshStandardMaterial?ic.environment:null,LT=T===null?y.outputEncoding:T.isXRRenderTarget===!0?T.texture.encoding:jr,rg=(Mt.isMeshStandardMaterial?O:K).get(Mt.envMap||RT),PT=Mt.vertexColors===!0&&!!gs.attributes.color&&gs.attributes.color.itemSize===4,CT=!!Mt.normalMap&&!!gs.attributes.tangent,DT=!!gs.morphAttributes.position,OT=!!gs.morphAttributes.normal,IT=!!gs.morphAttributes.color,NT=Mt.toneMapped?y.toneMapping:ra,Sx=gs.morphAttributes.position||gs.morphAttributes.normal||gs.morphAttributes.color,kT=Sx!==void 0?Sx.length:0,Sn=q.get(Mt),FT=m.state.lights;if(Ae===!0&&(De===!0||qr!==R)){const Rn=qr===R&&Mt.id===A;Je.setState(Mt,qr,Rn)}let No=!1;Mt.version===Sn.__version?Sn.needsLights&&Sn.lightsStateVersion!==FT.state.version||Sn.outputEncoding!==LT||Tr.isInstancedMesh&&Sn.instancing===!1?No=!0:Tr.isInstancedMesh||Sn.instancing!==!0?Tr.isSkinnedMesh&&Sn.skinning===!1?No=!0:Tr.isSkinnedMesh||Sn.skinning!==!0?Sn.envMap!==rg||Mt.fog===!0&&Sn.fog!==$0?No=!0:Sn.numClippingPlanes===void 0||Sn.numClippingPlanes===Je.numPlanes&&Sn.numIntersection===Je.numIntersection?(Sn.vertexAlphas!==PT||Sn.vertexTangents!==CT||Sn.morphTargets!==DT||Sn.morphNormals!==OT||Sn.morphColors!==IT||Sn.toneMapping!==NT||H.isWebGL2===!0&&Sn.morphTargetsCount!==kT)&&(No=!0):No=!0:No=!0:No=!0:(No=!0,Sn.__version=Mt.version);let Mu=Sn.currentProgram;No===!0&&(Mu=tg(Mt,ic,Tr));let _x=!1,Wp=!1,ev=!1;const Yr=Mu.getUniforms(),Tu=Sn.uniforms;if(k.useProgram(Mu.program)&&(_x=!0,Wp=!0,ev=!0),Mt.id!==A&&(A=Mt.id,Wp=!0),_x||R!==qr){if(Yr.setValue(de,"projectionMatrix",qr.projectionMatrix),H.logarithmicDepthBuffer&&Yr.setValue(de,"logDepthBufFC",2/(Math.log(qr.far+1)/Math.LN2)),R!==qr&&(R=qr,Wp=!0,ev=!0),Mt.isShaderMaterial||Mt.isMeshPhongMaterial||Mt.isMeshToonMaterial||Mt.isMeshStandardMaterial||Mt.envMap){const Rn=Yr.map.cameraPosition;Rn!==void 0&&Rn.setValue(de,ye.setFromMatrixPosition(qr.matrixWorld))}(Mt.isMeshPhongMaterial||Mt.isMeshToonMaterial||Mt.isMeshLambertMaterial||Mt.isMeshBasicMaterial||Mt.isMeshStandardMaterial||Mt.isShaderMaterial)&&Yr.setValue(de,"isOrthographic",qr.isOrthographicCamera===!0),(Mt.isMeshPhongMaterial||Mt.isMeshToonMaterial||Mt.isMeshLambertMaterial||Mt.isMeshBasicMaterial||Mt.isMeshStandardMaterial||Mt.isShaderMaterial||Mt.isShadowMaterial||Tr.isSkinnedMesh)&&Yr.setValue(de,"viewMatrix",qr.matrixWorldInverse)}if(Tr.isSkinnedMesh){Yr.setOptional(de,Tr,"bindMatrix"),Yr.setOptional(de,Tr,"bindMatrixInverse");const Rn=Tr.skeleton;Rn&&(H.floatVertexTextures?(Rn.boneTexture===null&&Rn.computeBoneTexture(),Yr.setValue(de,"boneTexture",Rn.boneTexture,B),Yr.setValue(de,"boneTextureSize",Rn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const tv=gs.morphAttributes;(tv.position!==void 0||tv.normal!==void 0||tv.color!==void 0&&H.isWebGL2===!0)&&At.update(Tr,gs,Mu),(Wp||Sn.receiveShadow!==Tr.receiveShadow)&&(Sn.receiveShadow=Tr.receiveShadow,Yr.setValue(de,"receiveShadow",Tr.receiveShadow)),Mt.isMeshGouraudMaterial&&Mt.envMap!==null&&(Tu.envMap.value=rg,Tu.flipEnvMap.value=rg.isCubeTexture&&rg.isRenderTargetTexture===!1?-1:1),Wp&&(Yr.setValue(de,"toneMappingExposure",y.toneMappingExposure),Sn.needsLights&&(function(Rn,ea){Rn.ambientLightColor.needsUpdate=ea,Rn.lightProbe.needsUpdate=ea,Rn.directionalLights.needsUpdate=ea,Rn.directionalLightShadows.needsUpdate=ea,Rn.pointLights.needsUpdate=ea,Rn.pointLightShadows.needsUpdate=ea,Rn.spotLights.needsUpdate=ea,Rn.spotLightShadows.needsUpdate=ea,Rn.rectAreaLights.needsUpdate=ea,Rn.hemisphereLights.needsUpdate=ea})(Tu,ev),$0&&Mt.fog===!0&&me.refreshFogUniforms(Tu,$0),me.refreshMaterialUniforms(Tu,Mt,N,j,pe),El.upload(de,Sn.uniformsList,Tu,B)),Mt.isShaderMaterial&&Mt.uniformsNeedUpdate===!0&&(El.upload(de,Sn.uniformsList,Tu,B),Mt.uniformsNeedUpdate=!1),Mt.isSpriteMaterial&&Yr.setValue(de,"center",Tr.center),Yr.setValue(de,"modelViewMatrix",Tr.modelViewMatrix),Yr.setValue(de,"normalMatrix",Tr.normalMatrix),Yr.setValue(de,"modelMatrix",Tr.matrixWorld),Yr.setValue(de,"envRotationMatrix",ic.envRotationMatrix);const wx=Tr.uniforms;for(let Rn in wx)Yr.setValue(de,Rn,wx[Rn]);if(Mt.isShaderMaterial||Mt.isRawShaderMaterial){const Rn=Mt.uniformsGroups;for(let ea=0,UT=Rn.length;ea<UT;ea++)if(H.isWebGL2){const Mx=Rn[ea];hn.update(Mx,Mu),hn.bind(Mx,Mu)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Mu})(X,be,Te,we,Oe);k.setMaterial(we,It);let tn=Te.index,An=1;we.wireframe===!0&&(tn=Y.getWireframeAttribute(Te),An=2);const on=Te.drawRange,Qt=Te.attributes.position;let di=on.start*An,ms=(on.start+on.count)*An;ft!==null&&(di=Math.max(di,ft.start*An),ms=Math.min(ms,(ft.start+ft.count)*An)),tn!==null?(di=Math.max(di,0),ms=Math.min(ms,tn.count)):Qt!=null&&(di=Math.max(di,0),ms=Math.min(ms,Qt.count));const Pi=ms-di;if(Pi<0||Pi===1/0)return;let ng;gt.setup(Oe,we,Ut,Te,tn);let zr=xt;if(tn!==null&&(ng=W.get(tn),zr=Ft,zr.setIndex(ng)),Oe.isMesh)we.wireframe===!0?(k.setLineWidth(we.wireframeLinewidth*_e()),zr.setMode(de.LINES)):zr.setMode(de.TRIANGLES);else if(Oe.isLine){let qr=we.linewidth;qr===void 0&&(qr=1),k.setLineWidth(qr*_e()),Oe.isLineSegments?zr.setMode(de.LINES):Oe.isLineLoop?zr.setMode(de.LINE_LOOP):zr.setMode(de.LINE_STRIP)}else Oe.isPoints?zr.setMode(de.POINTS):Oe.isSprite&&zr.setMode(de.TRIANGLES);if(Oe.isInstancedMesh)zr.renderInstances(di,Pi,Oe.count);else if(Te.isInstancedBufferGeometry){const qr=Te._maxInstanceCount!==void 0?Te._maxInstanceCount:1/0,ic=Math.min(Te.instanceCount,qr);zr.renderInstances(di,Pi,ic)}else zr.render(di,Pi)},this.compile=function(X,be){function Te(we,Oe,ft){we.transparent===!0&&we.side===We&&we.forceSinglePass===!1?(we.side=Be,we.needsUpdate=!0,tg(we,Oe,ft),we.side=Se,we.needsUpdate=!0,tg(we,Oe,ft),we.side=We):tg(we,Oe,ft)}m=Ge.get(X),m.init(),x.push(m),X.traverseVisible((function(we){we.isLight&&we.layers.test(be.layers)&&(m.pushLight(we),we.castShadow&&m.pushShadow(we))})),m.setupLights(y.useLegacyLights),X.traverse((function(we){const Oe=we.material;if(Oe)if(Array.isArray(Oe))for(let ft=0;ft<Oe.length;ft++)Te(Oe[ft],X,we);else Te(Oe,X,we)})),x.pop(),m=null};let J0=null;function gx(){wu.stop()}function vx(){wu.start()}const wu=new jd;function yx(X,be,Te,we){if(X.visible===!1)return;if(X.layers.test(be.layers)){if(X.isGroup)Te=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(be);else if(X.isLight)m.pushLight(X),X.castShadow&&m.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||Me.intersectsSprite(X)){we&&ye.setFromMatrixPosition(X.matrixWorld).applyMatrix4(re);const ft=te.update(X),It=X.material;It.visible&&f.push(X,ft,It,Te,ye.z,null)}}else if((X.isMesh||X.isLine||X.isPoints)&&(X.isSkinnedMesh&&X.skeleton.frame!==ie.render.frame&&(X.skeleton.update(),X.skeleton.frame=ie.render.frame),!X.frustumCulled||Me.intersectsObject(X))){we&&ye.setFromMatrixPosition(X.matrixWorld).applyMatrix4(re);const ft=te.update(X),It=X.material;if(Array.isArray(It)){const Ut=ft.groups;for(let tn=0,An=Ut.length;tn<An;tn++){const on=Ut[tn],Qt=It[on.materialIndex];Qt&&Qt.visible&&f.push(X,ft,Qt,Te,ye.z,on)}}else It.visible&&f.push(X,ft,It,Te,ye.z,null)}}const Oe=X.children;for(let ft=0,It=Oe.length;ft<It;ft++)yx(Oe[ft],be,Te,we)}function xx(X,be,Te,we){const Oe=X.opaque,ft=X.transmissive,It=X.transparent;m.setupLightsView(Te),Ae===!0&&Je.setGlobalState(y.clippingPlanes,Te),ft.length>0&&(function(Ut,tn,An){const on=H.isWebGL2;pe===null&&(pe=new Xt(1024,1024,{generateMipmaps:!0,type:Ue.has("EXT_color_buffer_half_float")?br:Vn,minFilter:Oi,samples:on&&i===!0?4:0}));const Qt=y.getRenderTarget();y.setRenderTarget(pe),y.clear();const di=y.toneMapping;y.toneMapping=ra,eg(Ut,tn,An),y.toneMapping=di,B.updateMultisampleRenderTarget(pe),B.updateRenderTargetMipmap(pe),y.setRenderTarget(Qt)})(Oe,be,Te),we&&k.viewport(C.copy(we)),Oe.length>0&&eg(Oe,be,Te),ft.length>0&&eg(ft,be,Te),It.length>0&&eg(It,be,Te),k.buffers.depth.setTest(!0),k.buffers.depth.setMask(!0),k.buffers.color.setMask(!0),k.setPolygonOffset(!1)}function eg(X,be,Te){const we=be.isScene===!0?be.overrideMaterial:null;for(let Oe=0,ft=X.length;Oe<ft;Oe++){const It=X[Oe],Ut=It.object,tn=It.geometry,An=we===null?It.material:we,on=It.group;Ut.layers.test(Te.layers)&&AT(Ut,be,Te,tn,An,on)}}function AT(X,be,Te,we,Oe,ft){X.onBeforeRender(y,be,Te,we,Oe,ft),X.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),Oe.onBeforeRender(y,be,Te,we,X,ft),Oe.transparent===!0&&Oe.side===We&&Oe.forceSinglePass===!1?(Oe.side=Be,Oe.needsUpdate=!0,y.renderBufferDirect(Te,be,we,Oe,X,ft),Oe.side=Se,Oe.needsUpdate=!0,y.renderBufferDirect(Te,be,we,Oe,X,ft),Oe.side=We):y.renderBufferDirect(Te,be,we,Oe,X,ft),X.onAfterRender(y,be,Te,we,Oe,ft)}function tg(X,be,Te){be.isScene!==!0&&(be=Ce);const we=q.get(X),Oe=m.state.lights,ft=m.state.shadowsArray,It=Oe.state.version,Ut=ne.getParameters(X,Oe.state,ft,be,Te),tn=ne.getProgramCacheKey(Ut);let An=we.programs;we.environment=X.isMeshStandardMaterial?be.environment:null,we.fog=be.fog,we.envMap=(X.isMeshStandardMaterial?O:K).get(X.envMap||we.environment),An===void 0&&(X.addEventListener("dispose",mx),An=new Map,we.programs=An);let on=An.get(tn);if(on!==void 0){if(we.currentProgram===on&&we.lightsStateVersion===It)return bx(X,Ut),on}else Ut.uniforms=ne.getUniforms(X),X.onBuild(Te,Ut,y),X.onBeforeCompile(Ut,y),on=ne.acquireProgram(Ut,tn),An.set(tn,on),we.uniforms=Ut.uniforms;const Qt=we.uniforms;(X.isShaderMaterial||X.isRawShaderMaterial)&&X.clipping!==!0||(Qt.clippingPlanes=Je.uniform),bx(X,Ut),we.needsLights=(function(Pi){return Pi.isMeshLambertMaterial||Pi.isMeshToonMaterial||Pi.isMeshPhongMaterial||Pi.isMeshStandardMaterial||Pi.isShadowMaterial||Pi.isShaderMaterial&&Pi.lights===!0})(X),we.lightsStateVersion=It,we.needsLights&&(Qt.ambientLightColor.value=Oe.state.ambient,Qt.lightProbe.value=Oe.state.probe,Qt.directionalLights.value=Oe.state.directional,Qt.directionalLightShadows.value=Oe.state.directionalShadow,Qt.spotLights.value=Oe.state.spot,Qt.spotLightShadows.value=Oe.state.spotShadow,Qt.rectAreaLights.value=Oe.state.rectArea,Qt.ltc_1.value=Oe.state.rectAreaLTC1,Qt.ltc_2.value=Oe.state.rectAreaLTC2,Qt.pointLights.value=Oe.state.point,Qt.pointLightShadows.value=Oe.state.pointShadow,Qt.hemisphereLights.value=Oe.state.hemi,Qt.directionalShadowMap.value=Oe.state.directionalShadowMap,Qt.directionalShadowMatrix.value=Oe.state.directionalShadowMatrix,Qt.spotShadowMap.value=Oe.state.spotShadowMap,Qt.spotLightMatrix.value=Oe.state.spotLightMatrix,Qt.spotLightMap.value=Oe.state.spotLightMap,Qt.pointShadowMap.value=Oe.state.pointShadowMap,Qt.pointShadowMatrix.value=Oe.state.pointShadowMatrix);const di=on.getUniforms(),ms=El.seqWithValue(di.seq,Qt);return we.currentProgram=on,we.uniformsList=ms,on}function bx(X,be){const Te=q.get(X);Te.outputEncoding=be.outputEncoding,Te.instancing=be.instancing,Te.skinning=be.skinning,Te.morphTargets=be.morphTargets,Te.morphNormals=be.morphNormals,Te.morphColors=be.morphColors,Te.morphTargetsCount=be.morphTargetsCount,Te.numClippingPlanes=be.numClippingPlanes,Te.numIntersection=be.numClipIntersection,Te.vertexAlphas=be.vertexAlphas,Te.vertexTangents=be.vertexTangents,Te.toneMapping=be.toneMapping}wu.setAnimationLoop((function(X){J0&&J0(X)})),typeof self<"u"&&wu.setContext(self),this.setAnimationLoop=function(X){J0=X,ya.setAnimationLoop(X),X===null?wu.stop():wu.start()},ya.addEventListener("sessionstart",gx),ya.addEventListener("sessionend",vx),this.render=function(X,be){if(be!==void 0&&be.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(b===!0)return;X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),be.parent===null&&be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),ya.enabled===!0&&ya.isPresenting===!0&&(ya.cameraAutoUpdate===!0&&ya.updateCamera(be),be=ya.getCamera()),X.isScene===!0&&X.onBeforeRender(y,X,be,T),m=Ge.get(X,x.length),m.init(),x.push(m),re.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),Me.setFromProjectionMatrix(re),De=this.localClippingEnabled,Ae=Je.init(this.clippingPlanes,De),f=Fe.get(X,g.length),f.init(),g.push(f),yx(X,be,0,y.sortObjects),f.finish(),y.sortObjects===!0&&f.sort(J,le),Ae===!0&&Je.beginShadows();const Te=m.state.shadowsArray;if(Ve.render(Te,X,be),Ae===!0&&Je.endShadows(),this.info.autoReset===!0&&this.info.reset(),wt.render(f,X),m.setupLights(y.useLegacyLights),be.isArrayCamera){const we=be.cameras;for(let Oe=0,ft=we.length;Oe<ft;Oe++){const It=we[Oe];xx(f,X,It,It.viewport)}}else xx(f,X,be);T!==null&&(B.updateMultisampleRenderTarget(T),B.updateRenderTargetMipmap(T)),X.isScene===!0&&X.onAfterRender(y,X,be),gt.resetDefaultState(),A=-1,R=null,x.pop(),m=x.length>0?x[x.length-1]:null,g.pop(),f=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(X,be,Te){q.get(X.texture).__webglTexture=be,q.get(X.depthTexture).__webglTexture=Te;const we=q.get(X);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=Te===void 0,we.__autoAllocateDepthBuffer||Ue.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(X,be){const Te=q.get(X);Te.__webglFramebuffer=be,Te.__useDefaultFramebuffer=be===void 0},this.setRenderTarget=function(X,be=0,Te=0){T=X,w=be,_=Te;let we=!0,Oe=null,ft=!1,It=!1;if(X){const Ut=q.get(X);Ut.__useDefaultFramebuffer!==void 0?(k.bindFramebuffer(de.FRAMEBUFFER,null),we=!1):Ut.__webglFramebuffer===void 0?B.setupRenderTarget(X):Ut.__hasExternalTextures&&B.rebindTextures(X,q.get(X.texture).__webglTexture,q.get(X.depthTexture).__webglTexture);const tn=X.texture;(tn.isData3DTexture||tn.isDataArrayTexture||tn.isCompressedArrayTexture)&&(It=!0);const An=q.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(Oe=An[be],ft=!0):Oe=H.isWebGL2&&X.samples>0&&B.useMultisampledRTT(X)===!1?q.get(X).__webglMultisampledFramebuffer:An,C.copy(X.viewport),I.copy(X.scissor),G=X.scissorTest}else C.copy(oe).multiplyScalar(N).floor(),I.copy(xe).multiplyScalar(N).floor(),G=ge;if(k.bindFramebuffer(de.FRAMEBUFFER,Oe)&&H.drawBuffers&&we&&k.drawBuffers(X,Oe),k.viewport(C),k.scissor(I),k.setScissorTest(G),ft){const Ut=q.get(X.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ut.__webglTexture,Te)}else if(It){const Ut=q.get(X.texture),tn=be||0;de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,Ut.__webglTexture,Te||0,tn)}A=-1},this.readRenderTargetPixels=function(X,be,Te,we,Oe,ft,It){if(!X||!X.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ut=q.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&It!==void 0&&(Ut=Ut[It]),Ut){k.bindFramebuffer(de.FRAMEBUFFER,Ut);try{const tn=X.texture,An=tn.format,on=tn.type;if(An!==Hr&&un.convert(An)!==de.getParameter(de.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Qt=on===br&&(Ue.has("EXT_color_buffer_half_float")||H.isWebGL2&&Ue.has("EXT_color_buffer_float"));if(!(on===Vn||un.convert(on)===de.getParameter(de.IMPLEMENTATION_COLOR_READ_TYPE)||on===xr&&(H.isWebGL2||Ue.has("OES_texture_float")||Ue.has("WEBGL_color_buffer_float"))||Qt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");be>=0&&be<=X.width-we&&Te>=0&&Te<=X.height-Oe&&de.readPixels(be,Te,we,Oe,un.convert(An),un.convert(on),ft)}finally{const tn=T!==null?q.get(T).__webglFramebuffer:null;k.bindFramebuffer(de.FRAMEBUFFER,tn)}}},this.copyFramebufferToTexture=function(X,be,Te=0){const we=Math.pow(2,-Te),Oe=Math.floor(be.image.width*we),ft=Math.floor(be.image.height*we);B.setTexture2D(be,0),de.copyTexSubImage2D(de.TEXTURE_2D,Te,0,0,X.x,X.y,Oe,ft),k.unbindTexture()},this.copyTextureToTexture=function(X,be,Te,we=0){const Oe=be.image.width,ft=be.image.height,It=un.convert(Te.format),Ut=un.convert(Te.type);B.setTexture2D(Te,0),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Te.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Te.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Te.unpackAlignment),be.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,we,X.x,X.y,Oe,ft,It,Ut,be.image.data):be.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,we,X.x,X.y,be.mipmaps[0].width,be.mipmaps[0].height,It,be.mipmaps[0].data):de.texSubImage2D(de.TEXTURE_2D,we,X.x,X.y,It,Ut,be.image),we===0&&Te.generateMipmaps&&de.generateMipmap(de.TEXTURE_2D),k.unbindTexture()},this.copyTextureToTexture3D=function(X,be,Te,we,Oe=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const ft=X.max.x-X.min.x+1,It=X.max.y-X.min.y+1,Ut=X.max.z-X.min.z+1,tn=un.convert(we.format),An=un.convert(we.type);let on;if(we.isData3DTexture)B.setTexture3D(we,0),on=de.TEXTURE_3D;else{if(!we.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");B.setTexture2DArray(we,0),on=de.TEXTURE_2D_ARRAY}de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,we.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,we.unpackAlignment);const Qt=de.getParameter(de.UNPACK_ROW_LENGTH),di=de.getParameter(de.UNPACK_IMAGE_HEIGHT),ms=de.getParameter(de.UNPACK_SKIP_PIXELS),Pi=de.getParameter(de.UNPACK_SKIP_ROWS),ng=de.getParameter(de.UNPACK_SKIP_IMAGES),zr=Te.isCompressedTexture?Te.mipmaps[0]:Te.image;de.pixelStorei(de.UNPACK_ROW_LENGTH,zr.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,zr.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,X.min.x),de.pixelStorei(de.UNPACK_SKIP_ROWS,X.min.y),de.pixelStorei(de.UNPACK_SKIP_IMAGES,X.min.z),Te.isDataTexture||Te.isData3DTexture?de.texSubImage3D(on,Oe,be.x,be.y,be.z,ft,It,Ut,tn,An,zr.data):Te.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(on,Oe,be.x,be.y,be.z,ft,It,Ut,tn,zr.data)):de.texSubImage3D(on,Oe,be.x,be.y,be.z,ft,It,Ut,tn,An,zr),de.pixelStorei(de.UNPACK_ROW_LENGTH,Qt),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,di),de.pixelStorei(de.UNPACK_SKIP_PIXELS,ms),de.pixelStorei(de.UNPACK_SKIP_ROWS,Pi),de.pixelStorei(de.UNPACK_SKIP_IMAGES,ng),Oe===0&&we.generateMipmaps&&de.generateMipmap(on),k.unbindTexture()},this.initTexture=function(X){X.isCubeTexture?B.setTextureCube(X,0):X.isData3DTexture?B.setTexture3D(X,0):X.isDataArrayTexture||X.isCompressedArrayTexture?B.setTexture2DArray(X,0):B.setTexture2D(X,0),k.unbindTexture()},this.resetState=function(){w=0,_=0,T=null,k.reset(),gt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(Cl.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(s){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!s}}});class hp extends Cl{}hp.prototype.isWebGL1Renderer=!0;class Th{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ne(e),this.density=t}clone(){return new Th(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Cs{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ne(e),this.near=t,this.far=n}clone(){return new Cs(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Oa extends St{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.envRotationMatrix=new Jn,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.envRotationMatrix!==null&&(this.envRotationMatrix=e.envRotationMatrix.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class Ds{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Qa,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=mi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=mi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=mi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Dr=new D;class Or{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Dr.fromBufferAttribute(this,t),Dr.applyMatrix4(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Dr.fromBufferAttribute(this,t),Dr.applyNormalMatrix(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Dr.fromBufferAttribute(this,t),Dr.transformDirection(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}setX(e,t){return this.normalized&&(t=ln(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ln(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ln(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ln(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Za(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Za(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Za(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Za(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ln(t,this.array),n=ln(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ln(t,this.array),n=ln(n,this.array),r=ln(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ln(t,this.array),n=ln(n,this.array),r=ln(r,this.array),i=ln(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(e===void 0){const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return new pt(new this.array.constructor(t),this.itemSize,this.normalized)}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Or(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Eh extends an{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ne(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Os;const wo=new D,Hn=new D,Ir=new D,_i=new ce,Dl=new ce,dp=new Ie,oi=new D,Ol=new D,wi=new D,hm=new ce,Ah=new ce,pp=new ce;class fp extends St{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Os===void 0){Os=new ut;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Ds(t,5);Os.setIndex([0,1,2,0,2,3]),Os.setAttribute("position",new Or(n,3,0,!1)),Os.setAttribute("uv",new Or(n,2,3,!1))}this.geometry=Os,this.material=e!==void 0?e:new Eh,this.center=new ce(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hn.setFromMatrixScale(this.matrixWorld),dp.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ir.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Hn.multiplyScalar(-Ir.z);const n=this.material.rotation;let r,i;n!==0&&(i=Math.cos(n),r=Math.sin(n));const a=this.center;zc(oi.set(-.5,-.5,0),Ir,a,Hn,r,i),zc(Ol.set(.5,-.5,0),Ir,a,Hn,r,i),zc(wi.set(.5,.5,0),Ir,a,Hn,r,i),hm.set(0,0),Ah.set(1,0),pp.set(1,1);let l=e.ray.intersectTriangle(oi,Ol,wi,!1,wo);if(l===null&&(zc(Ol.set(-.5,.5,0),Ir,a,Hn,r,i),Ah.set(0,1),l=e.ray.intersectTriangle(oi,wi,Ol,!1,wo),l===null))return;const u=e.ray.origin.distanceTo(wo);u<e.near||u>e.far||t.push({distance:u,point:wo.clone(),uv:vi.getUV(wo,oi,Ol,wi,hm,Ah,pp,new ce),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function zc(s,e,t,n,r,i){_i.subVectors(s,t).addScalar(.5).multiply(n),r!==void 0?(Dl.x=i*_i.x-r*_i.y,Dl.y=r*_i.x+i*_i.y):Dl.copy(_i),s.copy(e),s.x+=Dl.x,s.y+=Dl.y,s.applyMatrix4(dp)}const Rh=new D,Bc=new D;class Lh extends St{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const i=t[n];this.addLevel(i.object.clone(),i.distance,i.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let i;for(i=0;i<r.length&&!(t<r[i].distance);i++);return r.splice(i,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Rh.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Rh);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Rh.setFromMatrixPosition(e.matrixWorld),Bc.setFromMatrixPosition(this.matrixWorld);const n=Rh.distanceTo(Bc)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i;r++){let a=t[r].distance;if(t[r].object.visible&&(a-=a*t[r].hysteresis),!(n>=a))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const Mi=new D,qt=new ot,lr=new ot,tr=new D,vr=new Ie;class Nr extends ht{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ie,this.bindMatrixInverse=new Ie}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ot,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;qt.fromBufferAttribute(r.attributes.skinIndex,e),lr.fromBufferAttribute(r.attributes.skinWeight,e),Mi.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const a=lr.getComponent(i);if(a!==0){const l=qt.getComponent(i);vr.multiplyMatrices(n.bones[l].matrixWorld,n.boneInverses[l]),t.addScaledVector(tr.copy(Mi).applyMatrix4(vr),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class fa extends St{constructor(){super(),this.isBone=!0,this.type="Bone"}}class yn extends pn{constructor(e=null,t=1,n=1,r,i,a,l,u,h=Wt,p=Wt,f,m){super(null,a,l,u,h,p,r,i,f,m),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Il=new Ie,Mo=new Ie;class as{constructor(e=[],t=[]){this.uuid=mi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ie)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Ie;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const l=e[i]?e[i].matrixWorld:Mo;Il.multiplyMatrices(l,t[i]),Il.toArray(n,16*i)}r!==null&&(r.needsUpdate=!0)}clone(){return new as(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=ff(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new yn(t,e,e,Hr,xr);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const i=e.bones[n];let a=t[i];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new fa),this.bones.push(a),this.boneInverses.push(new Ie().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const a=t[r];e.bones.push(a.uuid);const l=n[r];e.boneInverses.push(l.toArray())}return e}}class Ia extends pt{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Nl=new Ie,Wr=new Ie,kl=[],Fl=new Ie,Ti=new ht;class To extends ht{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ia(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,Fl)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Ti.geometry=this.geometry,Ti.material=this.material,Ti.material!==void 0)for(let i=0;i<r;i++){this.getMatrixAt(i,Nl),Wr.multiplyMatrices(n,Nl),Ti.matrixWorld=Wr,Ti.raycast(e,kl);for(let a=0,l=kl.length;a<l;a++){const u=kl[a];u.instanceId=i,u.object=this,t.push(u)}kl.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ia(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class cr extends an{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ne(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ss=new D,Hc=new D,os=new Ie,Ul=new ol,Is=new zi;class qi extends St{constructor(e=new ut,t=new cr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,i=t.count;r<i;r++)ss.fromBufferAttribute(t,r-1),Hc.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ss.distanceTo(Hc);e.setAttribute("lineDistance",new He(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Is.copy(n.boundingSphere),Is.applyMatrix4(r),Is.radius+=i,e.ray.intersectsSphere(Is)===!1)return;os.copy(r).invert(),Ul.copy(e.ray).applyMatrix4(os);const l=i/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new D,p=new D,f=new D,m=new D,g=this.isLineSegments?2:1,x=n.index,y=n.attributes.position;if(x!==null)for(let b=Math.max(0,a.start),w=Math.min(x.count,a.start+a.count)-1;b<w;b+=g){const _=x.getX(b),T=x.getX(b+1);if(h.fromBufferAttribute(y,_),p.fromBufferAttribute(y,T),Ul.distanceSqToSegment(h,p,m,f)>u)continue;m.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(m);A<e.near||A>e.far||t.push({distance:A,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}else for(let b=Math.max(0,a.start),w=Math.min(y.count,a.start+a.count)-1;b<w;b+=g){if(h.fromBufferAttribute(y,b),p.fromBufferAttribute(y,b+1),Ul.distanceSqToSegment(h,p,m,f)>u)continue;m.applyMatrix4(this.matrixWorld);const _=e.ray.origin.distanceTo(m);_<e.near||_>e.far||t.push({distance:_,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,i=n.length;r<i;r++){const a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}const jc=new D,Gc=new D;class En extends qi{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,i=t.count;r<i;r+=2)jc.fromBufferAttribute(t,r),Gc.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+jc.distanceTo(Gc);e.setAttribute("lineDistance",new He(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Na extends qi{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class li extends an{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ne(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Xr=new Ie,Ph=new ol,zl=new zi,Bl=new D;class mp extends St{constructor(e=new ut,t=new li){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),zl.copy(n.boundingSphere),zl.applyMatrix4(r),zl.radius+=i,e.ray.intersectsSphere(zl)===!1)return;Xr.copy(r).invert(),Ph.copy(e.ray).applyMatrix4(Xr);const l=i/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=n.index,p=n.attributes.position;if(h!==null)for(let f=Math.max(0,a.start),m=Math.min(h.count,a.start+a.count);f<m;f++){const g=h.getX(f);Bl.fromBufferAttribute(p,g),ls(Bl,g,u,r,e,t,this)}else for(let f=Math.max(0,a.start),m=Math.min(p.count,a.start+a.count);f<m;f++)Bl.fromBufferAttribute(p,f),ls(Bl,f,u,r,e,t,this)}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,i=n.length;r<i;r++){const a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function ls(s,e,t,n,r,i,a){const l=Ph.distanceSqToPoint(s);if(l<t){const u=new D;Ph.closestPointToPoint(s,u),u.applyMatrix4(n);const h=r.ray.origin.distanceTo(u);if(h<r.near||h>r.far)return;i.push({distance:h,distanceToRay:Math.sqrt(l),point:u,index:e,face:null,object:a})}}class dm extends pn{constructor(e,t,n,r,i,a,l,u,h){super(e,t,n,r,i,a,l,u,h),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:_t,this.magFilter=i!==void 0?i:_t,this.generateMipmaps=!1;const p=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function f(){p.needsUpdate=!0,e.requestVideoFrameCallback(f)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class gp extends pn{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=Wt,this.minFilter=Wt,this.generateMipmaps=!1,this.needsUpdate=!0}}class cs extends pn{constructor(e,t,n,r,i,a,l,u,h,p,f,m){super(null,a,l,u,h,p,r,i,f,m),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class vp extends cs{constructor(e,t,n,r,i,a){super(e,t,n,i,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Gn}}class Eo extends pn{constructor(e,t,n,r,i,a,l,u,h){super(e,t,n,r,i,a,l,u,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ei{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let a;a=t||e*n[i-1];let l,u=0,h=i-1;for(;u<=h;)if(r=Math.floor(u+(h-u)/2),l=n[r]-a,l<0)u=r+1;else{if(!(l>0)){h=r;break}h=r-1}if(r=h,n[r]===a)return r/(i-1);const p=n[r];return(r+(a-p)/(n[r+1]-p))/(i-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),l=this.getPoint(i),u=t||(a.isVector2?new ce:new D);return u.copy(l).sub(a).normalize(),u}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new D,r=[],i=[],a=[],l=new D,u=new Ie;for(let g=0;g<=e;g++){const x=g/e;r[g]=this.getTangentAt(x,new D)}i[0]=new D,a[0]=new D;let h=Number.MAX_VALUE;const p=Math.abs(r[0].x),f=Math.abs(r[0].y),m=Math.abs(r[0].z);p<=h&&(h=p,n.set(1,0,0)),f<=h&&(h=f,n.set(0,1,0)),m<=h&&n.set(0,0,1),l.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],l),a[0].crossVectors(r[0],i[0]);for(let g=1;g<=e;g++){if(i[g]=i[g-1].clone(),a[g]=a[g-1].clone(),l.crossVectors(r[g-1],r[g]),l.length()>Number.EPSILON){l.normalize();const x=Math.acos(zn(r[g-1].dot(r[g]),-1,1));i[g].applyMatrix4(u.makeRotationAxis(l,x))}a[g].crossVectors(r[g],i[g])}if(t===!0){let g=Math.acos(zn(i[0].dot(i[e]),-1,1));g/=e,r[0].dot(l.crossVectors(i[0],i[e]))>0&&(g=-g);for(let x=1;x<=e;x++)i[x].applyMatrix4(u.makeRotationAxis(r[x],g*x)),a[x].crossVectors(r[x],i[x])}return{tangents:r,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Vc extends Ei{constructor(e=0,t=0,n=1,r=1,i=0,a=2*Math.PI,l=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=l,this.aRotation=u}getPoint(e,t){const n=t||new ce,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),this.aClockwise!==!0||a||(i===r?i=-r:i-=r);const l=this.aStartAngle+e*i;let u=this.aX+this.xRadius*Math.cos(l),h=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const p=Math.cos(this.aRotation),f=Math.sin(this.aRotation),m=u-this.aX,g=h-this.aY;u=m*p-g*f+this.aX,h=m*f+g*p+this.aY}return n.set(u,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Ch extends Vc{constructor(e,t,n,r,i,a){super(e,t,n,n,r,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Hl(){let s=0,e=0,t=0,n=0;function r(i,a,l,u){s=i,e=l,t=-3*i+3*a-2*l-u,n=2*i-2*a+l+u}return{initCatmullRom:function(i,a,l,u,h){r(a,l,h*(l-i),h*(u-a))},initNonuniformCatmullRom:function(i,a,l,u,h,p,f){let m=(a-i)/h-(l-i)/(h+p)+(l-a)/p,g=(l-a)/p-(u-a)/(p+f)+(u-l)/f;m*=p,g*=p,r(a,l,m,g)},calc:function(i){const a=i*i;return s+e*i+t*a+n*(a*i)}}}const Dh=new D,yp=new Hl,Oh=new Hl,Ih=new Hl;class Ns extends Ei{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new D){const n=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let l,u,h=Math.floor(a),p=a-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/i)+1)*i:p===0&&h===i-1&&(h=i-2,p=1),this.closed||h>0?l=r[(h-1)%i]:(Dh.subVectors(r[0],r[1]).add(r[0]),l=Dh);const f=r[h%i],m=r[(h+1)%i];if(this.closed||h+2<i?u=r[(h+2)%i]:(Dh.subVectors(r[i-1],r[i-2]).add(r[i-1]),u=Dh),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let x=Math.pow(l.distanceToSquared(f),g),y=Math.pow(f.distanceToSquared(m),g),b=Math.pow(m.distanceToSquared(u),g);y<1e-4&&(y=1),x<1e-4&&(x=y),b<1e-4&&(b=y),yp.initNonuniformCatmullRom(l.x,f.x,m.x,u.x,x,y,b),Oh.initNonuniformCatmullRom(l.y,f.y,m.y,u.y,x,y,b),Ih.initNonuniformCatmullRom(l.z,f.z,m.z,u.z,x,y,b)}else this.curveType==="catmullrom"&&(yp.initCatmullRom(l.x,f.x,m.x,u.x,this.tension),Oh.initCatmullRom(l.y,f.y,m.y,u.y,this.tension),Ih.initCatmullRom(l.z,f.z,m.z,u.z,this.tension));return n.set(yp.calc(p),Oh.calc(p),Ih.calc(p)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new D().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function pm(s,e,t,n,r){const i=.5*(n-e),a=.5*(r-t),l=s*s;return(2*t-2*n+i+a)*(s*l)+(-3*t+3*n-2*i-a)*l+i*s+t}function ka(s,e,t,n){return(function(r,i){const a=1-r;return a*a*i})(s,e)+(function(r,i){return 2*(1-r)*r*i})(s,t)+(function(r,i){return r*r*i})(s,n)}function jl(s,e,t,n,r){return(function(i,a){const l=1-i;return l*l*l*a})(s,e)+(function(i,a){const l=1-i;return 3*l*l*i*a})(s,t)+(function(i,a){return 3*(1-i)*i*i*a})(s,n)+(function(i,a){return i*i*i*a})(s,r)}class Cn extends Ei{constructor(e=new ce,t=new ce,n=new ce,r=new ce){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ce){const n=t,r=this.v0,i=this.v1,a=this.v2,l=this.v3;return n.set(jl(e,r.x,i.x,a.x,l.x),jl(e,r.y,i.y,a.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fm extends Ei{constructor(e=new D,t=new D,n=new D,r=new D){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new D){const n=t,r=this.v0,i=this.v1,a=this.v2,l=this.v3;return n.set(jl(e,r.x,i.x,a.x,l.x),jl(e,r.y,i.y,a.y,l.y),jl(e,r.z,i.z,a.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Wc extends Ei{constructor(e=new ce,t=new ce){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ce){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ce){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mm extends Ei{constructor(e=new D,t=new D){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new D){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new D){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xp extends Ei{constructor(e=new ce,t=new ce,n=new ce){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ce){const n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(ka(e,r.x,i.x,a.x),ka(e,r.y,i.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Xc extends Ei{constructor(e=new D,t=new D,n=new D){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new D){const n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(ka(e,r.x,i.x,a.x),ka(e,r.y,i.y,a.y),ka(e,r.z,i.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Nh extends Ei{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ce){const n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),l=i-a,u=r[a===0?a:a-1],h=r[a],p=r[a>r.length-2?r.length-1:a+1],f=r[a>r.length-3?r.length-1:a+2];return n.set(pm(l,u.x,h.x,p.x,f.x),pm(l,u.y,h.y,p.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new ce().fromArray(r))}return this}}class gm extends Ei{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Wc(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const a=r[i]-n,l=this.curves[i],u=l.getLength(),h=u===0?0:1-a/u;return l.getPointAt(h,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const a=i[r],l=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,u=a.getPoints(l);for(let h=0;h<u.length;h++){const p=u[h];n&&n.equals(p)||(t.push(p),n=p)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new ee[r.type]().fromJSON(r))}return this}}class kr extends gm{constructor(e){super(),this.type="Path",this.currentPoint=new ce,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Wc(this.currentPoint.clone(),new ce(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new xp(this.currentPoint.clone(),new ce(e,t),new ce(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,a){const l=new Cn(this.currentPoint.clone(),new ce(e,t),new ce(n,r),new ce(i,a));return this.curves.push(l),this.currentPoint.set(i,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Nh(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,a){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+l,t+u,n,r,i,a),this}absarc(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}ellipse(e,t,n,r,i,a,l,u){const h=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(e+h,t+p,n,r,i,a,l,u),this}absellipse(e,t,n,r,i,a,l,u){const h=new Vc(e,t,n,r,i,a,l,u);if(this.curves.length>0){const f=h.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(h);const p=h.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class us extends ut{constructor(e=[new ce(0,-.5),new ce(.5,0),new ce(0,.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=zn(r,0,2*Math.PI);const i=[],a=[],l=[],u=[],h=[],p=1/t,f=new D,m=new ce,g=new D,x=new D,y=new D;let b=0,w=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:b=e[_+1].x-e[_].x,w=e[_+1].y-e[_].y,g.x=1*w,g.y=-b,g.z=0*w,y.copy(g),g.normalize(),u.push(g.x,g.y,g.z);break;case e.length-1:u.push(y.x,y.y,y.z);break;default:b=e[_+1].x-e[_].x,w=e[_+1].y-e[_].y,g.x=1*w,g.y=-b,g.z=0*w,x.copy(g),g.x+=y.x,g.y+=y.y,g.z+=y.z,g.normalize(),u.push(g.x,g.y,g.z),y.copy(x)}for(let _=0;_<=t;_++){const T=n+_*p*r,A=Math.sin(T),R=Math.cos(T);for(let C=0;C<=e.length-1;C++){f.x=e[C].x*A,f.y=e[C].y,f.z=e[C].x*R,a.push(f.x,f.y,f.z),m.x=_/t,m.y=C/(e.length-1),l.push(m.x,m.y);const I=u[3*C+0]*A,G=u[3*C+1],U=u[3*C+0]*R;h.push(I,G,U)}}for(let _=0;_<t;_++)for(let T=0;T<e.length-1;T++){const A=T+_*e.length,R=A,C=A+e.length,I=A+e.length+1,G=A+1;i.push(R,C,G),i.push(I,G,C)}this.setIndex(i),this.setAttribute("position",new He(a,3)),this.setAttribute("uv",new He(l,2)),this.setAttribute("normal",new He(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new us(e.points,e.segments,e.phiStart,e.phiLength)}}class Gl extends us{constructor(e=1,t=1,n=4,r=8){const i=new kr;i.absarc(0,-t/2,e,1.5*Math.PI,0),i.absarc(0,t/2,e,0,.5*Math.PI),super(i.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new Gl(e.radius,e.length,e.capSegments,e.radialSegments)}}class Ai extends ut{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],l=[],u=[],h=new D,p=new ce;a.push(0,0,0),l.push(0,0,1),u.push(.5,.5);for(let f=0,m=3;f<=t;f++,m+=3){const g=n+f/t*r;h.x=e*Math.cos(g),h.y=e*Math.sin(g),a.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(a[m]/e+1)/2,p.y=(a[m+1]/e+1)/2,u.push(p.x,p.y)}for(let f=1;f<=t;f++)i.push(f,f+1,0);this.setIndex(i),this.setAttribute("position",new He(a,3)),this.setAttribute("normal",new He(l,3)),this.setAttribute("uv",new He(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ai(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ma extends ut{constructor(e=1,t=1,n=1,r=32,i=1,a=!1,l=0,u=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:l,thetaLength:u};const h=this;r=Math.floor(r),i=Math.floor(i);const p=[],f=[],m=[],g=[];let x=0;const y=[],b=n/2;let w=0;function _(T){const A=x,R=new ce,C=new D;let I=0;const G=T===!0?e:t,U=T===!0?1:-1;for(let N=1;N<=r;N++)f.push(0,b*U,0),m.push(0,U,0),g.push(.5,.5),x++;const j=x;for(let N=0;N<=r;N++){const J=N/r*u+l,le=Math.cos(J),oe=Math.sin(J);C.x=G*oe,C.y=b*U,C.z=G*le,f.push(C.x,C.y,C.z),m.push(0,U,0),R.x=.5*le+.5,R.y=.5*oe*U+.5,g.push(R.x,R.y),x++}for(let N=0;N<r;N++){const J=A+N,le=j+N;T===!0?p.push(le,le+1,J):p.push(le+1,le,J),I+=3}h.addGroup(w,I,T===!0?1:2),w+=I}(function(){const T=new D,A=new D;let R=0;const C=(t-e)/n;for(let I=0;I<=i;I++){const G=[],U=I/i,j=U*(t-e)+e;for(let N=0;N<=r;N++){const J=N/r,le=J*u+l,oe=Math.sin(le),xe=Math.cos(le);A.x=j*oe,A.y=-U*n+b,A.z=j*xe,f.push(A.x,A.y,A.z),T.set(oe,C,xe).normalize(),m.push(T.x,T.y,T.z),g.push(J,1-U),G.push(x++)}y.push(G)}for(let I=0;I<r;I++)for(let G=0;G<i;G++){const U=y[G][I],j=y[G+1][I],N=y[G+1][I+1],J=y[G][I+1];p.push(U,j,J),p.push(j,N,J),R+=6}h.addGroup(w,R,0),w+=R})(),a===!1&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(p),this.setAttribute("position",new He(f,3)),this.setAttribute("normal",new He(m,3)),this.setAttribute("uv",new He(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ma(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Yi extends ma{constructor(e=1,t=1,n=32,r=1,i=!1,a=0,l=2*Math.PI){super(0,e,t,n,r,i,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:l}}static fromJSON(e){return new Yi(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ri extends ut{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],a=[];function l(m,g,x,y){const b=y+1,w=[];for(let _=0;_<=b;_++){w[_]=[];const T=m.clone().lerp(x,_/b),A=g.clone().lerp(x,_/b),R=b-_;for(let C=0;C<=R;C++)w[_][C]=C===0&&_===b?T:T.clone().lerp(A,C/R)}for(let _=0;_<b;_++)for(let T=0;T<2*(b-_)-1;T++){const A=Math.floor(T/2);T%2==0?(u(w[_][A+1]),u(w[_+1][A]),u(w[_][A])):(u(w[_][A+1]),u(w[_+1][A+1]),u(w[_+1][A]))}}function u(m){i.push(m.x,m.y,m.z)}function h(m,g){const x=3*m;g.x=e[x+0],g.y=e[x+1],g.z=e[x+2]}function p(m,g,x,y){y<0&&m.x===1&&(a[g]=m.x-1),x.x===0&&x.z===0&&(a[g]=y/2/Math.PI+.5)}function f(m){return Math.atan2(m.z,-m.x)}(function(m){const g=new D,x=new D,y=new D;for(let b=0;b<t.length;b+=3)h(t[b+0],g),h(t[b+1],x),h(t[b+2],y),l(g,x,y,m)})(r),(function(m){const g=new D;for(let x=0;x<i.length;x+=3)g.x=i[x+0],g.y=i[x+1],g.z=i[x+2],g.normalize().multiplyScalar(m),i[x+0]=g.x,i[x+1]=g.y,i[x+2]=g.z})(n),(function(){const m=new D;for(let x=0;x<i.length;x+=3){m.x=i[x+0],m.y=i[x+1],m.z=i[x+2];const y=f(m)/2/Math.PI+.5,b=(g=m,Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))/Math.PI+.5);a.push(y,1-b)}var g;(function(){const x=new D,y=new D,b=new D,w=new D,_=new ce,T=new ce,A=new ce;for(let R=0,C=0;R<i.length;R+=9,C+=6){x.set(i[R+0],i[R+1],i[R+2]),y.set(i[R+3],i[R+4],i[R+5]),b.set(i[R+6],i[R+7],i[R+8]),_.set(a[C+0],a[C+1]),T.set(a[C+2],a[C+3]),A.set(a[C+4],a[C+5]),w.copy(x).add(y).add(b).divideScalar(3);const I=f(w);p(_,C+0,x,I),p(T,C+2,y,I),p(A,C+4,b,I)}})(),(function(){for(let x=0;x<a.length;x+=6){const y=a[x+0],b=a[x+2],w=a[x+4],_=Math.max(y,b,w),T=Math.min(y,b,w);_>.9&&T<.1&&(y<.2&&(a[x+0]+=1),b<.2&&(a[x+2]+=1),w<.2&&(a[x+4]+=1))}})()})(),this.setAttribute("position",new He(i,3)),this.setAttribute("normal",new He(i.slice(),3)),this.setAttribute("uv",new He(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ri(e.vertices,e.indices,e.radius,e.details)}}class ks extends Ri{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ks(e.radius,e.detail)}}const Vl=new D,kh=new D,qc=new D,Fh=new vi;class Uh extends ut{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),i=Math.cos(eo*t),a=e.getIndex(),l=e.getAttribute("position"),u=a?a.count:l.count,h=[0,0,0],p=["a","b","c"],f=new Array(3),m={},g=[];for(let x=0;x<u;x+=3){a?(h[0]=a.getX(x),h[1]=a.getX(x+1),h[2]=a.getX(x+2)):(h[0]=x,h[1]=x+1,h[2]=x+2);const{a:y,b,c:w}=Fh;if(y.fromBufferAttribute(l,h[0]),b.fromBufferAttribute(l,h[1]),w.fromBufferAttribute(l,h[2]),Fh.getNormal(qc),f[0]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,f[1]=`${Math.round(b.x*r)},${Math.round(b.y*r)},${Math.round(b.z*r)}`,f[2]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,f[0]!==f[1]&&f[1]!==f[2]&&f[2]!==f[0])for(let _=0;_<3;_++){const T=(_+1)%3,A=f[_],R=f[T],C=Fh[p[_]],I=Fh[p[T]],G=`${A}_${R}`,U=`${R}_${A}`;U in m&&m[U]?(qc.dot(m[U].normal)<=i&&(g.push(C.x,C.y,C.z),g.push(I.x,I.y,I.z)),m[U]=null):G in m||(m[G]={index0:h[_],index1:h[T],normal:qc.clone()})}}for(const x in m)if(m[x]){const{index0:y,index1:b}=m[x];Vl.fromBufferAttribute(l,y),kh.fromBufferAttribute(l,b),g.push(Vl.x,Vl.y,Vl.z),g.push(kh.x,kh.y,kh.z)}this.setAttribute("position",new He(g,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Fa extends kr{constructor(e){super(e),this.uuid=mi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new kr().fromJSON(r))}return this}}const zh=function(s,e,t=2){const n=e&&e.length,r=n?e[0]*t:s.length;let i=Yc(s,0,r,t,!0);const a=[];if(!i||i.next===i.prev)return a;let l,u,h,p,f,m,g;if(n&&(i=(function(x,y,b,w){const _=[];let T,A,R,C,I;for(T=0,A=y.length;T<A;T++)R=y[T]*w,C=T<A-1?y[T+1]*w:x.length,I=Yc(x,R,C,w,!1),I===I.next&&(I.steiner=!0),_.push(jh(I));for(_.sort(Sp),T=0;T<_.length;T++)b=Hh(_[T],b);return b})(s,e,i,t)),s.length>80*t){l=h=s[0],u=p=s[1];for(let x=t;x<r;x+=t)f=s[x],m=s[x+1],f<l&&(l=f),m<u&&(u=m),f>h&&(h=f),m>p&&(p=m);g=Math.max(h-l,p-u),g=g!==0?32767/g:0}return Ao(i,a,t,l,u,g,0),a};function Yc(s,e,t,n,r){let i,a;if(r===(function(l,u,h,p){let f=0;for(let m=u,g=h-p;m<h;m+=p)f+=(l[g]-l[m])*(l[m+1]+l[g+1]),g=m;return f})(s,e,t,n)>0)for(i=e;i<t;i+=n)a=M(i,s[i],s[i+1],a);else for(i=t-n;i>=e;i-=n)a=M(i,s[i],s[i+1],a);return a&&Ro(a,a.next)&&(L(a),a=a.next),a}function Fs(s,e){if(!s)return s;e||(e=s);let t,n=s;do if(t=!1,n.steiner||!Ro(n,n.next)&&In(n.prev,n,n.next)!==0)n=n.next;else{if(L(n),n=e=n.prev,n===n.next)break;t=!0}while(t||n!==e);return e}function Ao(s,e,t,n,r,i,a){if(!s)return;!a&&i&&(function(p,f,m,g){let x=p;do x.z===0&&(x.z=_p(x.x,x.y,f,m,g)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next;while(x!==p);x.prevZ.nextZ=null,x.prevZ=null,(function(y){let b,w,_,T,A,R,C,I,G=1;do{for(w=y,y=null,A=null,R=0;w;){for(R++,_=w,C=0,b=0;b<G&&(C++,_=_.nextZ,_);b++);for(I=G;C>0||I>0&&_;)C!==0&&(I===0||!_||w.z<=_.z)?(T=w,w=w.nextZ,C--):(T=_,_=_.nextZ,I--),A?A.nextZ=T:y=T,T.prevZ=A,A=T;w=_}A.nextZ=null,G*=2}while(R>1)})(x)})(s,n,r,i);let l,u,h=s;for(;s.prev!==s.next;)if(l=s.prev,u=s.next,i?vm(s,n,r,i):kg(s))e.push(l.i/t|0),e.push(s.i/t|0),e.push(u.i/t|0),L(s),s=u.next,h=u.next;else if((s=u)===h){a?a===1?Ao(s=bp(Fs(s),e,t),e,t,n,r,i,2):a===2&&Bh(s,e,t,n,r,i):Ao(Fs(s),e,t,n,r,i,1);break}}function kg(s){const e=s.prev,t=s,n=s.next;if(In(e,t,n)>=0)return!1;const r=e.x,i=t.x,a=n.x,l=e.y,u=t.y,h=n.y,p=r<i?r<a?r:a:i<a?i:a,f=l<u?l<h?l:h:u<h?u:h,m=r>i?r>a?r:a:i>a?i:a,g=l>u?l>h?l:h:u>h?u:h;let x=n.next;for(;x!==e;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&Wl(r,l,i,u,a,h,x.x,x.y)&&In(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function vm(s,e,t,n){const r=s.prev,i=s,a=s.next;if(In(r,i,a)>=0)return!1;const l=r.x,u=i.x,h=a.x,p=r.y,f=i.y,m=a.y,g=l<u?l<h?l:h:u<h?u:h,x=p<f?p<m?p:m:f<m?f:m,y=l>u?l>h?l:h:u>h?u:h,b=p>f?p>m?p:m:f>m?f:m,w=_p(g,x,e,t,n),_=_p(y,b,e,t,n);let T=s.prevZ,A=s.nextZ;for(;T&&T.z>=w&&A&&A.z<=_;){if(T.x>=g&&T.x<=y&&T.y>=x&&T.y<=b&&T!==r&&T!==a&&Wl(l,p,u,f,h,m,T.x,T.y)&&In(T.prev,T,T.next)>=0||(T=T.prevZ,A.x>=g&&A.x<=y&&A.y>=x&&A.y<=b&&A!==r&&A!==a&&Wl(l,p,u,f,h,m,A.x,A.y)&&In(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;T&&T.z>=w;){if(T.x>=g&&T.x<=y&&T.y>=x&&T.y<=b&&T!==r&&T!==a&&Wl(l,p,u,f,h,m,T.x,T.y)&&In(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;A&&A.z<=_;){if(A.x>=g&&A.x<=y&&A.y>=x&&A.y<=b&&A!==r&&A!==a&&Wl(l,p,u,f,h,m,A.x,A.y)&&In(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function bp(s,e,t){let n=s;do{const r=n.prev,i=n.next.next;!Ro(r,i)&&o(r,n,n.next,i)&&v(r,i)&&v(i,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(i.i/t|0),L(n),L(n.next),n=s=i),n=n.next}while(n!==s);return Fs(n)}function Bh(s,e,t,n,r,i){let a=s;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&Qc(a,l)){let u=S(a,l);return a=Fs(a,a.next),u=Fs(u,u.next),Ao(a,e,t,n,r,i,0),void Ao(u,e,t,n,r,i,0)}l=l.next}a=a.next}while(a!==s)}function Sp(s,e){return s.x-e.x}function Hh(s,e){const t=(function(r,i){let a,l=i,u=-1/0;const h=r.x,p=r.y;do{if(p<=l.y&&p>=l.next.y&&l.next.y!==l.y){const b=l.x+(p-l.y)*(l.next.x-l.x)/(l.next.y-l.y);if(b<=h&&b>u&&(u=b,a=l.x<l.next.x?l:l.next,b===h))return a}l=l.next}while(l!==i);if(!a)return null;const f=a,m=a.x,g=a.y;let x,y=1/0;l=a;do h>=l.x&&l.x>=m&&h!==l.x&&Wl(p<g?h:u,p,m,g,p<g?u:h,p,l.x,l.y)&&(x=Math.abs(p-l.y)/(h-l.x),v(l,r)&&(x<y||x===y&&(l.x>a.x||l.x===a.x&&ym(a,l)))&&(a=l,y=x)),l=l.next;while(l!==f);return a})(s,e);if(!t)return e;const n=S(t,s);return Fs(n,n.next),Fs(t,t.next)}function ym(s,e){return In(s.prev,s,e.prev)<0&&In(e.next,s,s.next)<0}function _p(s,e,t,n,r){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-t)*r|0)|s<<8))|s<<4))|s<<2))|s<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jh(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function Wl(s,e,t,n,r,i,a,l){return(r-a)*(e-l)>=(s-a)*(i-l)&&(s-a)*(n-l)>=(t-a)*(e-l)&&(t-a)*(i-l)>=(r-a)*(n-l)}function Qc(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!(function(t,n){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==n.i&&r.next.i!==n.i&&o(r,r.next,t,n))return!0;r=r.next}while(r!==t);return!1})(s,e)&&(v(s,e)&&v(e,s)&&(function(t,n){let r=t,i=!1;const a=(t.x+n.x)/2,l=(t.y+n.y)/2;do r.y>l!=r.next.y>l&&r.next.y!==r.y&&a<(r.next.x-r.x)*(l-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i})(s,e)&&(In(s.prev,s,e.prev)||In(s,e.prev,e))||Ro(s,e)&&In(s.prev,s,s.next)>0&&In(e.prev,e,e.next)>0)}function In(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Ro(s,e){return s.x===e.x&&s.y===e.y}function o(s,e,t,n){const r=d(In(s,e,t)),i=d(In(s,e,n)),a=d(In(t,n,s)),l=d(In(t,n,e));return r!==i&&a!==l||!(r!==0||!c(s,t,e))||!(i!==0||!c(s,n,e))||!(a!==0||!c(t,s,n))||!(l!==0||!c(t,e,n))}function c(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function d(s){return s>0?1:s<0?-1:0}function v(s,e){return In(s.prev,s,s.next)<0?In(s,e,s.next)>=0&&In(s,s.prev,e)>=0:In(s,e,s.prev)<0||In(s,s.next,e)<0}function S(s,e){const t=new V(s.i,s.x,s.y),n=new V(e.i,e.x,e.y),r=s.next,i=e.prev;return s.next=e,e.prev=s,t.next=r,r.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function M(s,e,t,n){const r=new V(s,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function L(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function V(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Q{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return .5*n}static isClockWise(e){return Q.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];fe(e),Le(n,e);let a=e.length;t.forEach(fe);for(let u=0;u<t.length;u++)r.push(a),a+=t[u].length,Le(n,t[u]);const l=zh(n,r);for(let u=0;u<l.length;u+=3)i.push(l.slice(u,u+3));return i}}function fe(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function Le(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class Pe extends ut{constructor(e=new Fa([new ce(.5,.5),new ce(-.5,.5),new ce(-.5,-.5),new ce(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let l=0,u=e.length;l<u;l++)a(e[l]);function a(l){const u=[],h=t.curveSegments!==void 0?t.curveSegments:12,p=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let m=t.bevelEnabled===void 0||t.bevelEnabled,g=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:g-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,b=t.bevelSegments!==void 0?t.bevelSegments:3;const w=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:Ee;let T,A,R,C,I,G=!1;w&&(T=w.getSpacedPoints(p),G=!0,m=!1,A=w.computeFrenetFrames(p,!1),R=new D,C=new D,I=new D),m||(b=0,g=0,x=0,y=0);const U=l.extractPoints(h);let j=U.shape;const N=U.holes;if(!Q.isClockWise(j)){j=j.reverse();for(let q=0,B=N.length;q<B;q++){const K=N[q];Q.isClockWise(K)&&(N[q]=K.reverse())}}const J=Q.triangulateShape(j,N),le=j;for(let q=0,B=N.length;q<B;q++){const K=N[q];j=j.concat(K)}function oe(q,B,K){return B||console.error("THREE.ExtrudeGeometry: vec does not exist"),q.clone().addScaledVector(B,K)}const xe=j.length,ge=J.length;function Me(q,B,K){let O,W,Y;const te=q.x-B.x,ne=q.y-B.y,me=K.x-q.x,Fe=K.y-q.y,Ge=te*te+ne*ne,Je=te*Fe-ne*me;if(Math.abs(Je)>Number.EPSILON){const Ve=Math.sqrt(Ge),wt=Math.sqrt(me*me+Fe*Fe),At=B.x-ne/Ve,xt=B.y+te/Ve,Ft=((K.x-Fe/wt-At)*Fe-(K.y+me/wt-xt)*me)/(te*Fe-ne*me);O=At+te*Ft-q.x,W=xt+ne*Ft-q.y;const un=O*O+W*W;if(un<=2)return new ce(O,W);Y=Math.sqrt(un/2)}else{let Ve=!1;te>Number.EPSILON?me>Number.EPSILON&&(Ve=!0):te<-Number.EPSILON?me<-Number.EPSILON&&(Ve=!0):Math.sign(ne)===Math.sign(Fe)&&(Ve=!0),Ve?(O=-ne,W=te,Y=Math.sqrt(Ge)):(O=te,W=ne,Y=Math.sqrt(Ge/2))}return new ce(O/Y,W/Y)}const Ae=[];for(let q=0,B=le.length,K=B-1,O=q+1;q<B;q++,K++,O++)K===B&&(K=0),O===B&&(O=0),Ae[q]=Me(le[q],le[K],le[O]);const De=[];let pe,re=Ae.concat();for(let q=0,B=N.length;q<B;q++){const K=N[q];pe=[];for(let O=0,W=K.length,Y=W-1,te=O+1;O<W;O++,Y++,te++)Y===W&&(Y=0),te===W&&(te=0),pe[O]=Me(K[O],K[Y],K[te]);De.push(pe),re=re.concat(pe)}for(let q=0;q<b;q++){const B=q/b,K=g*Math.cos(B*Math.PI/2),O=x*Math.sin(B*Math.PI/2)+y;for(let W=0,Y=le.length;W<Y;W++){const te=oe(le[W],Ae[W],O);_e(te.x,te.y,-K)}for(let W=0,Y=N.length;W<Y;W++){const te=N[W];pe=De[W];for(let ne=0,me=te.length;ne<me;ne++){const Fe=oe(te[ne],pe[ne],O);_e(Fe.x,Fe.y,-K)}}}const ye=x+y;for(let q=0;q<xe;q++){const B=m?oe(j[q],re[q],ye):j[q];G?(C.copy(A.normals[0]).multiplyScalar(B.x),R.copy(A.binormals[0]).multiplyScalar(B.y),I.copy(T[0]).add(C).add(R),_e(I.x,I.y,I.z)):_e(B.x,B.y,0)}for(let q=1;q<=p;q++)for(let B=0;B<xe;B++){const K=m?oe(j[B],re[B],ye):j[B];G?(C.copy(A.normals[q]).multiplyScalar(K.x),R.copy(A.binormals[q]).multiplyScalar(K.y),I.copy(T[q]).add(C).add(R),_e(I.x,I.y,I.z)):_e(K.x,K.y,f/p*q)}for(let q=b-1;q>=0;q--){const B=q/b,K=g*Math.cos(B*Math.PI/2),O=x*Math.sin(B*Math.PI/2)+y;for(let W=0,Y=le.length;W<Y;W++){const te=oe(le[W],Ae[W],O);_e(te.x,te.y,f+K)}for(let W=0,Y=N.length;W<Y;W++){const te=N[W];pe=De[W];for(let ne=0,me=te.length;ne<me;ne++){const Fe=oe(te[ne],pe[ne],O);G?_e(Fe.x,Fe.y+T[p-1].y,T[p-1].x+K):_e(Fe.x,Fe.y,f+K)}}}function Ce(q,B){let K=q.length;for(;--K>=0;){const O=K;let W=K-1;W<0&&(W=q.length-1);for(let Y=0,te=p+2*b;Y<te;Y++){const ne=xe*Y,me=xe*(Y+1);H(B+O+ne,B+W+ne,B+W+me,B+O+me)}}}function _e(q,B,K){u.push(q),u.push(B),u.push(K)}function Ue(q,B,K){k(q),k(B),k(K);const O=r.length/3,W=_.generateTopUV(n,r,O-3,O-2,O-1);ie(W[0]),ie(W[1]),ie(W[2])}function H(q,B,K,O){k(q),k(B),k(O),k(B),k(K),k(O);const W=r.length/3,Y=_.generateSideWallUV(n,r,W-6,W-3,W-2,W-1);ie(Y[0]),ie(Y[1]),ie(Y[3]),ie(Y[1]),ie(Y[2]),ie(Y[3])}function k(q){r.push(u[3*q+0]),r.push(u[3*q+1]),r.push(u[3*q+2])}function ie(q){i.push(q.x),i.push(q.y)}(function(){const q=r.length/3;if(m){let B=0,K=xe*B;for(let O=0;O<ge;O++){const W=J[O];Ue(W[2]+K,W[1]+K,W[0]+K)}B=p+2*b,K=xe*B;for(let O=0;O<ge;O++){const W=J[O];Ue(W[0]+K,W[1]+K,W[2]+K)}}else{for(let B=0;B<ge;B++){const K=J[B];Ue(K[2],K[1],K[0])}for(let B=0;B<ge;B++){const K=J[B];Ue(K[0]+xe*p,K[1]+xe*p,K[2]+xe*p)}}n.addGroup(q,r.length/3-q,0)})(),(function(){const q=r.length/3;let B=0;Ce(le,B),B+=le.length;for(let K=0,O=N.length;K<O;K++){const W=N[K];Ce(W,B),B+=W.length}n.addGroup(q,r.length/3-q,1)})()}this.setAttribute("position",new He(r,3)),this.setAttribute("uv",new He(i,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return(function(t,n,r){if(r.shapes=[],Array.isArray(t))for(let i=0,a=t.length;i<a;i++){const l=t[i];r.shapes.push(l.uuid)}else r.shapes.push(t.uuid);return r.options=Object.assign({},n),n.extrudePath!==void 0&&(r.options.extrudePath=n.extrudePath.toJSON()),r})(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,a=e.shapes.length;i<a;i++){const l=t[e.shapes[i]];n.push(l)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new ee[r.type]().fromJSON(r)),new Pe(n,e.options)}}const Ee={generateTopUV:function(s,e,t,n,r){const i=e[3*t],a=e[3*t+1],l=e[3*n],u=e[3*n+1],h=e[3*r],p=e[3*r+1];return[new ce(i,a),new ce(l,u),new ce(h,p)]},generateSideWallUV:function(s,e,t,n,r,i){const a=e[3*t],l=e[3*t+1],u=e[3*t+2],h=e[3*n],p=e[3*n+1],f=e[3*n+2],m=e[3*r],g=e[3*r+1],x=e[3*r+2],y=e[3*i],b=e[3*i+1],w=e[3*i+2];return Math.abs(l-p)<Math.abs(a-h)?[new ce(a,1-u),new ce(h,1-f),new ce(m,1-x),new ce(y,1-w)]:[new ce(l,1-u),new ce(p,1-f),new ce(g,1-x),new ce(b,1-w)]}};class Xe extends Ri{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Xe(e.radius,e.detail)}}class Qe extends Ri{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Qe(e.radius,e.detail)}}class tt extends ut{constructor(e=.5,t=1,n=32,r=1,i=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},n=Math.max(3,n);const l=[],u=[],h=[],p=[];let f=e;const m=(t-e)/(r=Math.max(1,r)),g=new D,x=new ce;for(let y=0;y<=r;y++){for(let b=0;b<=n;b++){const w=i+b/n*a;g.x=f*Math.cos(w),g.y=f*Math.sin(w),u.push(g.x,g.y,g.z),h.push(0,0,1),x.x=(g.x/t+1)/2,x.y=(g.y/t+1)/2,p.push(x.x,x.y)}f+=m}for(let y=0;y<r;y++){const b=y*(n+1);for(let w=0;w<n;w++){const _=w+b,T=_,A=_+n+1,R=_+n+2,C=_+1;l.push(T,A,C),l.push(A,R,C)}}this.setIndex(l),this.setAttribute("position",new He(u,3)),this.setAttribute("normal",new He(h,3)),this.setAttribute("uv",new He(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tt(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class xn extends ut{constructor(e=new Fa([new ce(0,.5),new ce(-.5,-.5),new ce(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],a=[];let l=0,u=0;if(Array.isArray(e)===!1)h(e);else for(let p=0;p<e.length;p++)h(e[p]),this.addGroup(l,u,p),l+=u,u=0;function h(p){const f=r.length/3,m=p.extractPoints(t);let g=m.shape;const x=m.holes;Q.isClockWise(g)===!1&&(g=g.reverse());for(let b=0,w=x.length;b<w;b++){const _=x[b];Q.isClockWise(_)===!0&&(x[b]=_.reverse())}const y=Q.triangulateShape(g,x);for(let b=0,w=x.length;b<w;b++){const _=x[b];g=g.concat(_)}for(let b=0,w=g.length;b<w;b++){const _=g[b];r.push(_.x,_.y,0),i.push(0,0,1),a.push(_.x,_.y)}for(let b=0,w=y.length;b<w;b++){const _=y[b],T=_[0]+f,A=_[1]+f,R=_[2]+f;n.push(T,A,R),u+=3}}this.setIndex(n),this.setAttribute("position",new He(r,3)),this.setAttribute("normal",new He(i,3)),this.setAttribute("uv",new He(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return(function(t,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++){const a=t[r];n.shapes.push(a.uuid)}else n.shapes.push(t.uuid);return n})(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const a=t[e.shapes[r]];n.push(a)}return new xn(n,e.curveSegments)}}class ae extends ut{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:l},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(a+l,Math.PI);let h=0;const p=[],f=new D,m=new D,g=[],x=[],y=[],b=[];for(let w=0;w<=n;w++){const _=[],T=w/n;let A=0;w==0&&a==0?A=.5/t:w==n&&u==Math.PI&&(A=-.5/t);for(let R=0;R<=t;R++){const C=R/t;f.x=-e*Math.cos(r+C*i)*Math.sin(a+T*l),f.y=e*Math.cos(a+T*l),f.z=e*Math.sin(r+C*i)*Math.sin(a+T*l),x.push(f.x,f.y,f.z),m.copy(f).normalize(),y.push(m.x,m.y,m.z),b.push(C+A,1-T),_.push(h++)}p.push(_)}for(let w=0;w<n;w++)for(let _=0;_<t;_++){const T=p[w][_+1],A=p[w][_],R=p[w+1][_],C=p[w+1][_+1];(w!==0||a>0)&&g.push(T,A,C),(w!==n-1||u<Math.PI)&&g.push(A,R,C)}this.setIndex(g),this.setAttribute("position",new He(x,3)),this.setAttribute("normal",new He(y,3)),this.setAttribute("uv",new He(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ae(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Z extends Ri{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Z(e.radius,e.detail)}}class ue extends ut{constructor(e=1,t=.4,n=12,r=48,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],u=[],h=[],p=new D,f=new D,m=new D;for(let g=0;g<=n;g++)for(let x=0;x<=r;x++){const y=x/r*i,b=g/n*Math.PI*2;f.x=(e+t*Math.cos(b))*Math.cos(y),f.y=(e+t*Math.cos(b))*Math.sin(y),f.z=t*Math.sin(b),l.push(f.x,f.y,f.z),p.x=e*Math.cos(y),p.y=e*Math.sin(y),m.subVectors(f,p).normalize(),u.push(m.x,m.y,m.z),h.push(x/r),h.push(g/n)}for(let g=1;g<=n;g++)for(let x=1;x<=r;x++){const y=(r+1)*g+x-1,b=(r+1)*(g-1)+x-1,w=(r+1)*(g-1)+x,_=(r+1)*g+x;a.push(y,b,_),a.push(b,w,_)}this.setIndex(a),this.setAttribute("position",new He(l,3)),this.setAttribute("normal",new He(u,3)),this.setAttribute("uv",new He(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ue(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class ke extends ut{constructor(e=1,t=.4,n=64,r=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);const l=[],u=[],h=[],p=[],f=new D,m=new D,g=new D,x=new D,y=new D,b=new D,w=new D;for(let T=0;T<=n;++T){const A=T/n*i*Math.PI*2;_(A,i,a,e,g),_(A+.01,i,a,e,x),b.subVectors(x,g),w.addVectors(x,g),y.crossVectors(b,w),w.crossVectors(y,b),y.normalize(),w.normalize();for(let R=0;R<=r;++R){const C=R/r*Math.PI*2,I=-t*Math.cos(C),G=t*Math.sin(C);f.x=g.x+(I*w.x+G*y.x),f.y=g.y+(I*w.y+G*y.y),f.z=g.z+(I*w.z+G*y.z),u.push(f.x,f.y,f.z),m.subVectors(f,g).normalize(),h.push(m.x,m.y,m.z),p.push(T/n),p.push(R/r)}}for(let T=1;T<=n;T++)for(let A=1;A<=r;A++){const R=(r+1)*(T-1)+(A-1),C=(r+1)*T+(A-1),I=(r+1)*T+A,G=(r+1)*(T-1)+A;l.push(R,C,G),l.push(C,I,G)}function _(T,A,R,C,I){const G=Math.cos(T),U=Math.sin(T),j=R/A*T,N=Math.cos(j);I.x=C*(2+N)*.5*G,I.y=C*(2+N)*U*.5,I.z=C*Math.sin(j)*.5}this.setIndex(l),this.setAttribute("position",new He(u,3)),this.setAttribute("normal",new He(h,3)),this.setAttribute("uv",new He(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ke(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class rt extends ut{constructor(e=new Xc(new D(-1,-1,0),new D(-1,1,0),new D(1,1,0)),t=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new D,u=new D,h=new ce;let p=new D;const f=[],m=[],g=[],x=[];function y(b){p=e.getPointAt(b/t,p);const w=a.normals[b],_=a.binormals[b];for(let T=0;T<=r;T++){const A=T/r*Math.PI*2,R=Math.sin(A),C=-Math.cos(A);u.x=C*w.x+R*_.x,u.y=C*w.y+R*_.y,u.z=C*w.z+R*_.z,u.normalize(),m.push(u.x,u.y,u.z),l.x=p.x+n*u.x,l.y=p.y+n*u.y,l.z=p.z+n*u.z,f.push(l.x,l.y,l.z)}}(function(){for(let b=0;b<t;b++)y(b);y(i===!1?t:0),(function(){for(let b=0;b<=t;b++)for(let w=0;w<=r;w++)h.x=b/t,h.y=w/r,g.push(h.x,h.y)})(),(function(){for(let b=1;b<=t;b++)for(let w=1;w<=r;w++){const _=(r+1)*(b-1)+(w-1),T=(r+1)*b+(w-1),A=(r+1)*b+w,R=(r+1)*(b-1)+w;x.push(_,T,R),x.push(T,A,R)}})()})(),this.setIndex(x),this.setAttribute("position",new He(f,3)),this.setAttribute("normal",new He(m,3)),this.setAttribute("uv",new He(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new rt(new ee[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class lt extends ut{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new D,i=new D;if(e.index!==null){const a=e.attributes.position,l=e.index;let u=e.groups;u.length===0&&(u=[{start:0,count:l.count,materialIndex:0}]);for(let h=0,p=u.length;h<p;++h){const f=u[h],m=f.start;for(let g=m,x=m+f.count;g<x;g+=3)for(let y=0;y<3;y++){const b=l.getX(g+y),w=l.getX(g+(y+1)%3);r.fromBufferAttribute(a,b),i.fromBufferAttribute(a,w),dt(r,i,n)===!0&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const a=e.attributes.position;for(let l=0,u=a.count/3;l<u;l++)for(let h=0;h<3;h++){const p=3*l+h,f=3*l+(h+1)%3;r.fromBufferAttribute(a,p),i.fromBufferAttribute(a,f),dt(r,i,n)===!0&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new He(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function dt(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)!==!0&&t.has(r)!==!0&&(t.add(n),t.add(r),!0)}class yt extends an{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ne(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class ur extends Bt{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class st extends an{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ne(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fr extends st{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ce(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return zn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ne(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ne(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ne(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Zc extends an{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ne(16777215),this.specular=new Ne(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ga,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Sv extends an{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ne(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Fg extends an{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Ug extends an{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ne(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ga,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _v extends an{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ne(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wv extends cr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ua(s,e,t){return zg(s)?new s.constructor(s.subarray(e,t!==void 0?t:s.length)):s.slice(e,t)}function Kc(s,e,t){return!s||!t&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function zg(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Mv(s){const e=s.length,t=new Array(e);for(let n=0;n!==e;++n)t[n]=n;return t.sort((function(n,r){return s[n]-s[r]})),t}function Bg(s,e,t){const n=s.length,r=new s.constructor(n);for(let i=0,a=0;a!==n;++i){const l=t[i]*e;for(let u=0;u!==e;++u)r[a++]=s[l+u]}return r}function Hg(s,e,t,n){let r=1,i=s[0];for(;i!==void 0&&i[n]===void 0;)i=s[r++];if(i===void 0)return;let a=i[n];if(a!==void 0)if(Array.isArray(a))do a=i[n],a!==void 0&&(e.push(i.time),t.push.apply(t,a)),i=s[r++];while(i!==void 0);else if(a.toArray!==void 0)do a=i[n],a!==void 0&&(e.push(i.time),a.toArray(t,t.length)),i=s[r++];while(i!==void 0);else do a=i[n],a!==void 0&&(e.push(i.time),t.push(a)),i=s[r++];while(i!==void 0)}const vb={arraySlice:Ua,convertArray:Kc,isTypedArray:zg,getKeyframeOrder:Mv,sortedArray:Bg,flattenJSON:Hg,subclip:function(s,e,t,n,r=30){const i=s.clone();i.name=e;const a=[];for(let u=0;u<i.tracks.length;++u){const h=i.tracks[u],p=h.getValueSize(),f=[],m=[];for(let g=0;g<h.times.length;++g){const x=h.times[g]*r;if(!(x<t||x>=n)){f.push(h.times[g]);for(let y=0;y<p;++y)m.push(h.values[g*p+y])}}f.length!==0&&(h.times=Kc(f,h.times.constructor),h.values=Kc(m,h.values.constructor),a.push(h))}i.tracks=a;let l=1/0;for(let u=0;u<i.tracks.length;++u)l>i.tracks[u].times[0]&&(l=i.tracks[u].times[0]);for(let u=0;u<i.tracks.length;++u)i.tracks[u].shift(-1*l);return i.resetDuration(),i},makeClipAdditive:function(s,e=0,t=s,n=30){n<=0&&(n=30);const r=t.tracks.length,i=e/n;for(let a=0;a<r;++a){const l=t.tracks[a],u=l.ValueTypeName;if(u==="bool"||u==="string")continue;const h=s.tracks.find((function(w){return w.name===l.name&&w.ValueTypeName===u}));if(h===void 0)continue;let p=0;const f=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=f/3);let m=0;const g=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=g/3);const x=l.times.length-1;let y;if(i<=l.times[0]){const w=p,_=f-p;y=Ua(l.values,w,_)}else if(i>=l.times[x]){const w=x*f+p,_=w+f-p;y=Ua(l.values,w,_)}else{const w=l.createInterpolant(),_=p,T=f-p;w.evaluate(i),y=Ua(w.resultBuffer,_,T)}u==="quaternion"&&new Jt().fromArray(y).normalize().conjugate().toArray(y);const b=h.times.length;for(let w=0;w<b;++w){const _=w*g+m;if(u==="quaternion")Jt.multiplyQuaternionsFlat(h.values,_,y,0,h.values,_);else{const T=g-2*m;for(let A=0;A<T;++A)h.values[_+A]-=y[A]}}}return s.blendMode=Js,s}};class Gh{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let l=n+2;;){if(r===void 0){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===l)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=i)break e;{const l=t[1];e<l&&(n=2,i=l);for(let u=n-2;;){if(i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0}}for(;n<a;){const l=n+a>>>1;e<t[l]?a=l:n=l+1}if(r=t[n],i=t[n-1],i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Tv extends Gh{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ei,endingEnd:ei}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,l=r[i],u=r[a];if(l===void 0)switch(this.getSettings_().endingStart){case ti:i=e,l=2*t-n;break;case Ni:i=r.length-2,l=t+r[i]-r[i+1];break;default:i=e,l=n}if(u===void 0)switch(this.getSettings_().endingEnd){case ti:a=e,u=2*n-t;break;case Ni:a=1,u=n+r[1]-r[0];break;default:a=e-1,u=t}const h=.5*(n-t),p=this.valueSize;this._weightPrev=h/(t-l),this._weightNext=h/(u-n),this._offsetPrev=i*p,this._offsetNext=a*p}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=e*l,h=u-l,p=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,g=this._weightNext,x=(n-t)/(r-t),y=x*x,b=y*x,w=-m*b+2*m*y-m*x,_=(1+m)*b+(-1.5-2*m)*y+(-.5+m)*x+1,T=(-1-g)*b+(1.5+g)*y+.5*x,A=g*b-g*y;for(let R=0;R!==l;++R)i[R]=w*a[p+R]+_*a[h+R]+T*a[u+R]+A*a[f+R];return i}}class jg extends Gh{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=e*l,h=u-l,p=(n-t)/(r-t),f=1-p;for(let m=0;m!==l;++m)i[m]=a[h+m]*f+a[u+m]*p;return i}}class Ev extends Gh{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class hs{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kc(t,this.TimeBufferType),this.values=Kc(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Kc(e.times,Array),values:Kc(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Ev(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new jg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Tv(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Qs:t=this.InterpolantFactoryMethodDiscrete;break;case Xa:t=this.InterpolantFactoryMethodLinear;break;case Zs:t=this.InterpolantFactoryMethodSmooth}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Qs;case this.InterpolantFactoryMethodLinear:return Xa;case this.InterpolantFactoryMethodSmooth:return Zs}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;a!==-1&&n[a]>t;)--a;if(++a,i!==0||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const l=this.getValueSize();this.times=Ua(n,i,a),this.values=Ua(this.values,i*l,a*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==i;l++){const u=n[l];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(a!==null&&a>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,a),e=!1;break}a=u}if(r!==void 0&&zg(r))for(let l=0,u=r.length;l!==u;++l){const h=r[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),e=!1;break}}return e}optimize(){const e=Ua(this.times),t=Ua(this.values),n=this.getValueSize(),r=this.getInterpolation()===Zs,i=e.length-1;let a=1;for(let l=1;l<i;++l){let u=!1;const h=e[l];if(h!==e[l+1]&&(l!==1||h!==e[0]))if(r)u=!0;else{const p=l*n,f=p-n,m=p+n;for(let g=0;g!==n;++g){const x=t[p+g];if(x!==t[f+g]||x!==t[m+g]){u=!0;break}}}if(u){if(l!==a){e[a]=e[l];const p=l*n,f=a*n;for(let m=0;m!==n;++m)t[f+m]=t[p+m]}++a}}if(i>0){e[a]=e[i];for(let l=i*n,u=a*n,h=0;h!==n;++h)t[u+h]=t[l+h];++a}return a!==e.length?(this.times=Ua(e,0,a),this.values=Ua(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=Ua(this.times,0),t=Ua(this.values,0),n=new this.constructor(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}hs.prototype.TimeBufferType=Float32Array,hs.prototype.ValueBufferType=Float32Array,hs.prototype.DefaultInterpolation=Xa;class Jc extends hs{}Jc.prototype.ValueTypeName="bool",Jc.prototype.ValueBufferType=Array,Jc.prototype.DefaultInterpolation=Qs,Jc.prototype.InterpolantFactoryMethodLinear=void 0,Jc.prototype.InterpolantFactoryMethodSmooth=void 0;class Gg extends hs{}Gg.prototype.ValueTypeName="color";class $c extends hs{}$c.prototype.ValueTypeName="number";class Av extends Gh{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=(n-t)/(r-t);let h=e*l;for(let p=h+l;h!==p;h+=4)Jt.slerpFlat(i,0,a,h-l,a,h,u);return i}}class Lo extends hs{InterpolantFactoryMethodLinear(e){return new Av(this.times,this.values,this.getValueSize(),e)}}Lo.prototype.ValueTypeName="quaternion",Lo.prototype.DefaultInterpolation=Xa,Lo.prototype.InterpolantFactoryMethodSmooth=void 0;class eu extends hs{}eu.prototype.ValueTypeName="string",eu.prototype.ValueBufferType=Array,eu.prototype.DefaultInterpolation=Qs,eu.prototype.InterpolantFactoryMethodLinear=void 0,eu.prototype.InterpolantFactoryMethodSmooth=void 0;class tu extends hs{}tu.prototype.ValueTypeName="vector";class nu{constructor(e,t=-1,n,r=Ks){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=mi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,l=n.length;a!==l;++a)t.push(yb(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,a=n.length;i!==a;++i)t.push(hs.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let l=0;l<i;l++){let u=[],h=[];u.push((l+i-1)%i,l,(l+1)%i),h.push(0,1,0);const p=Mv(u);u=Bg(u,1,p),h=Bg(h,1,p),r||u[0]!==0||(u.push(i),h.push(h[0])),a.push(new $c(".morphTargetInfluences["+t[l].name+"]",u,h).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let l=0,u=e.length;l<u;l++){const h=e[l],p=h.name.match(i);if(p&&p.length>1){const f=p[1];let m=r[f];m||(r[f]=m=[]),m.push(h)}}const a=[];for(const l in r)a.push(this.CreateFromMorphTargetSequence(l,r[l],t,n));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(p,f,m,g,x){if(m.length!==0){const y=[],b=[];Hg(m,y,b,g),y.length!==0&&x.push(new p(f,y,b))}},r=[],i=e.name||"default",a=e.fps||30,l=e.blendMode;let u=e.length||-1;const h=e.hierarchy||[];for(let p=0;p<h.length;p++){const f=h[p].keys;if(f&&f.length!==0)if(f[0].morphTargets){const m={};let g;for(g=0;g<f.length;g++)if(f[g].morphTargets)for(let x=0;x<f[g].morphTargets.length;x++)m[f[g].morphTargets[x]]=-1;for(const x in m){const y=[],b=[];for(let w=0;w!==f[g].morphTargets.length;++w){const _=f[g];y.push(_.time),b.push(_.morphTarget===x?1:0)}r.push(new $c(".morphTargetInfluence["+x+"]",y,b))}u=m.length*a}else{const m=".bones["+t[p].name+"]";n(tu,m+".position",f,"pos",r),n(Lo,m+".quaternion",f,"rot",r),n(tu,m+".scale",f,"scl",r)}}return r.length===0?null:new this(i,u,r,l)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function yb(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=(function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $c;case"vector":case"vector2":case"vector3":case"vector4":return tu;case"color":return Gg;case"quaternion":return Lo;case"bool":case"boolean":return Jc;case"string":return eu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)})(s.type);if(s.times===void 0){const t=[],n=[];Hg(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const Xl={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class Vg{constructor(e,t,n){const r=this;let i,a=!1,l=0,u=0;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(p){u++,a===!1&&r.onStart!==void 0&&r.onStart(p,l,u),a=!0},this.itemEnd=function(p){l++,r.onProgress!==void 0&&r.onProgress(p,l,u),l===u&&(a=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(p){r.onError!==void 0&&r.onError(p)},this.resolveURL=function(p){return i?i(p):p},this.setURLModifier=function(p){return i=p,this},this.addHandler=function(p,f){return h.push(p,f),this},this.removeHandler=function(p){const f=h.indexOf(p);return f!==-1&&h.splice(f,2),this},this.getHandler=function(p){for(let f=0,m=h.length;f<m;f+=2){const g=h[f],x=h[f+1];if(g.global&&(g.lastIndex=0),g.test(p))return x}return null}}}const Rv=new Vg;class ci{constructor(e){this.manager=e!==void 0?e:Rv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}async function Lv(s){return new Promise(((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(s)}))}const Po={};class xb extends Error{constructor(e,t){super(e),this.response=t}}class Li extends ci{constructor(e){super(e)}load(e,t,n,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=Xl.get(e);if(a===void 0&&i)return this.manager.itemStart(e),void(this.responseType==="arraybuffer"?(async function(p){return new Promise(((f,m)=>{const g=new FileReader;g.onload=()=>f(g.result),g.onerror=m,g.readAsArrayBuffer(p)}))})(i):(async function(p){return new Promise(((f,m)=>{const g=new FileReader;g.onload=()=>f(g.result),g.onerror=m,g.readAsText(p)}))})(i)).then((p=>{Xl.add(e,p),t&&t(p),this.manager.itemEnd(e)}));if(a!==void 0)return this.manager.itemStart(e),setTimeout((()=>{t&&t(a),this.manager.itemEnd(e)}),0),a;if(Po[e]!==void 0)return void Po[e].push({onLoad:t,onProgress:n,onError:r});Po[e]=[],Po[e].push({onLoad:t,onProgress:n,onError:r});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,h=this.responseType;fetch(l).then((p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const f=Po[e],m=p.body.getReader(),g=p.headers.get("Content-Length")||p.headers.get("X-File-Size"),x=g?parseInt(g):0,y=x!==0;let b=0;const w=new ReadableStream({start(_){(function T(){m.read().then((({done:A,value:R})=>{if(A)_.close();else{b+=R.byteLength;const C=new ProgressEvent("progress",{lengthComputable:y,loaded:b,total:x});for(let I=0,G=f.length;I<G;I++){const U=f[I];U.onProgress&&U.onProgress(C)}_.enqueue(R),T()}}))})()}});return new Response(w)}throw new xb(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)})).then((p=>{switch(h){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then((f=>new DOMParser().parseFromString(f,u)));case"json":return p.json();default:if(u===void 0)return p.text();{const f=/charset="?([^;"\s]*)"?/i.exec(u),m=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(m);return p.arrayBuffer().then((x=>g.decode(x)))}}})).then((p=>{Xl.add(e,p);const f=Po[e];delete Po[e];for(let m=0,g=f.length;m<g;m++){const x=f[m];x.onLoad&&x.onLoad(p)}})).catch((p=>{const f=Po[e];if(f===void 0)throw this.manager.itemError(e),p;delete Po[e];for(let m=0,g=f.length;m<g;m++){const x=f[m];x.onError&&x.onError(p)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class bb extends ci{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new Li(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(l){try{t(i.parse(JSON.parse(l)))}catch(u){r?r(u):console.error(u),i.manager.itemError(e)}}),n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=nu.parse(e[n]);t.push(r)}return t}}class Sb extends ci{constructor(e){super(e)}load(e,t,n,r){const i=this,a=[],l=new cs,u=new Li(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(i.withCredentials);let h=0;function p(f){u.load(e[f],(function(m){const g=i.parse(m,!0);a[f]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},h+=1,h===6&&(g.mipmapCount===1&&(l.minFilter=_t),l.image=a,l.format=g.format,l.needsUpdate=!0,t&&t(l))}),n,r)}if(Array.isArray(e))for(let f=0,m=e.length;f<m;++f)p(f);else u.load(e,(function(f){const m=i.parse(f,!0);if(m.isCubemap){const g=m.mipmaps.length/m.mipmapCount;for(let x=0;x<g;x++){a[x]={mipmaps:[]};for(let y=0;y<m.mipmapCount;y++)a[x].mipmaps.push(m.mipmaps[x*m.mipmapCount+y]),a[x].format=m.format,a[x].width=m.width,a[x].height=m.height}l.image=a}else l.image.width=m.width,l.image.height=m.height,l.mipmaps=m.mipmaps;m.mipmapCount===1&&(l.minFilter=_t),l.format=m.format,l.needsUpdate=!0,t&&t(l)}),n,r);return l}}class wp extends ci{constructor(e){super(e)}load(e,t,n,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,l=Xl.get(e);if(l!==void 0)return a.manager.itemStart(e),setTimeout((function(){t&&t(l),a.manager.itemEnd(e)}),0),l;const u=to("img");function h(){f(),Xl.add(e,this),t&&t(this),a.manager.itemEnd(e)}function p(m){f(),r&&r(m),a.manager.itemError(e),a.manager.itemEnd(e)}function f(){u.removeEventListener("load",h,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",h,!1),u.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),i?Lv(i).then((m=>{u.src=m})):u.src=e,u}}class _b extends ci{constructor(e){super(e)}load(e,t,n,r){const i=new gl,a=new wp(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let l=0;function u(h){a.load(e[h],(function(p){i.images[h]=p,l++,l===6&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(let h=0;h<e.length;++h)u(h);return i}}class Pv extends ci{constructor(e){super(e)}load(e,t,n,r,i){const a=this,l=new yn,u=new Li(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(a.withCredentials),u.load(e,(function(h){const p=a.parse(h);p&&(p.image!==void 0?l.image=p.image:p.data!==void 0&&(l.image.width=p.width,l.image.height=p.height,l.image.data=p.data),l.wrapS=p.wrapS!==void 0?p.wrapS:Gn,l.wrapT=p.wrapT!==void 0?p.wrapT:Gn,l.magFilter=p.magFilter!==void 0?p.magFilter:_t,l.minFilter=p.minFilter!==void 0?p.minFilter:_t,l.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.encoding!==void 0&&(l.encoding=p.encoding),p.flipY!==void 0&&(l.flipY=p.flipY),p.format!==void 0&&(l.format=p.format),p.type!==void 0&&(l.type=p.type),p.mipmaps!==void 0&&(l.mipmaps=p.mipmaps,l.minFilter=Oi),p.mipmapCount===1&&(l.minFilter=_t),p.generateMipmaps!==void 0&&(l.generateMipmaps=p.generateMipmaps),l.needsUpdate=!0,t&&t(l,p))}),n,r,i),l}}class xm extends ci{constructor(e){super(e)}load(e,t,n,r,i){const a=new pn,l=new wp(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,(function(u){a.image=u,a.needsUpdate=!0,t!==void 0&&t(a)}),n,r,i),a}}class ql extends St{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ne(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class Cv extends ql{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(St.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ne(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Wg=new Ie,Dv=new D,Ov=new D;class Xg{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ce(512,512),this.map=null,this.mapPass=null,this.matrix=new Ie,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ra,this._frameExtents=new ce(1,1),this._viewportCount=1,this._viewports=[new ot(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Dv.setFromMatrixPosition(e.matrixWorld),t.position.copy(Dv),Ov.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Ov),t.updateMatrixWorld(),Wg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Wg),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Wg)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class wb extends Xg{constructor(){super(new vn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*rl*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class bm extends ql{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(St.DEFAULT_UP),this.updateMatrix(),this.target=new St,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new wb}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Iv=new Ie,Mp=new D,qg=new D;class Mb extends Xg{constructor(){super(new vn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ce(4,2),this._viewportCount=6,this._viewports=[new ot(2,1,1,1),new ot(0,1,1,1),new ot(3,1,1,1),new ot(1,1,1,1),new ot(3,0,1,1),new ot(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Mp.setFromMatrixPosition(e.matrixWorld),n.position.copy(Mp),qg.copy(n.position),qg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(qg),n.updateMatrixWorld(),r.makeTranslation(-Mp.x,-Mp.y,-Mp.z),Iv.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Iv)}}class Tp extends ql{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Mb}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Tb extends Xg{constructor(){super(new Pr(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Sm extends ql{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(St.DEFAULT_UP),this.updateMatrix(),this.target=new St,this.shadow=new Tb}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Yg extends ql{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Nv extends ql{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class kv{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new D)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class _m extends ql{constructor(e=new kv,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class wm extends ci{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,a=new Li(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(l){try{t(i.parse(JSON.parse(l)))}catch(u){r?r(u):console.error(u),i.manager.itemError(e)}}),n,r)}parse(e){const t=this.textures;function n(i){return t[i]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",i),t[i]}const r=wm.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Ne().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const i in e.uniforms){const a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=new Ne().setHex(a.value);break;case"v2":r.uniforms[i].value=new ce().fromArray(a.value);break;case"v3":r.uniforms[i].value=new D().fromArray(a.value);break;case"v4":r.uniforms[i].value=new ot().fromArray(a.value);break;case"m3":r.uniforms[i].value=new Jn().fromArray(a.value);break;case"m4":r.uniforms[i].value=new Ie().fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const i in e.extensions)r.extensions[i]=e.extensions[i];if(e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let i=e.normalScale;Array.isArray(i)===!1&&(i=[i,i]),r.normalScale=new ce().fromArray(i)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new ce().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:yt,SpriteMaterial:Eh,RawShaderMaterial:ur,ShaderMaterial:Bt,PointsMaterial:li,MeshPhysicalMaterial:Fr,MeshStandardMaterial:st,MeshPhongMaterial:Zc,MeshToonMaterial:Sv,MeshNormalMaterial:Fg,MeshLambertMaterial:Ug,MeshDepthMaterial:_o,MeshDistanceMaterial:pa,MeshBasicMaterial:mr,MeshMatcapMaterial:_v,LineDashedMaterial:wv,LineBasicMaterial:cr,Material:an}[e]}}class ru{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Mm extends ut{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Fv extends ci{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new Li(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(l){try{t(i.parse(JSON.parse(l)))}catch(u){r?r(u):console.error(u),i.manager.itemError(e)}}),n,r)}parse(e){const t={},n={};function r(f,m){if(t[m]!==void 0)return t[m];const g=f.interleavedBuffers[m],x=(function(w,_){if(n[_]!==void 0)return n[_];const T=w.arrayBuffers,A=T[_],R=new Uint32Array(A).buffer;return n[_]=R,R})(f,g.buffer),y=il(g.type,x),b=new Ds(y,g.stride);return b.uuid=g.uuid,t[m]=b,b}const i=e.isInstancedBufferGeometry?new Mm:new ut,a=e.data.index;if(a!==void 0){const f=il(a.type,a.array);i.setIndex(new pt(f,1))}const l=e.data.attributes;for(const f in l){const m=l[f];let g;if(m.isInterleavedBufferAttribute){const x=r(e.data,m.data);g=new Or(x,m.itemSize,m.offset,m.normalized)}else{const x=il(m.type,m.array);g=new(m.isInstancedBufferAttribute?Ia:pt)(x,m.itemSize,m.normalized)}m.name!==void 0&&(g.name=m.name),m.usage!==void 0&&g.setUsage(m.usage),m.updateRange!==void 0&&(g.updateRange.offset=m.updateRange.offset,g.updateRange.count=m.updateRange.count),i.setAttribute(f,g)}const u=e.data.morphAttributes;if(u)for(const f in u){const m=u[f],g=[];for(let x=0,y=m.length;x<y;x++){const b=m[x];let w;if(b.isInterleavedBufferAttribute){const _=r(e.data,b.data);w=new Or(_,b.itemSize,b.offset,b.normalized)}else{const _=il(b.type,b.array);w=new pt(_,b.itemSize,b.normalized)}b.name!==void 0&&(w.name=b.name),g.push(w)}i.morphAttributes[f]=g}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let f=0,m=h.length;f!==m;++f){const g=h[f];i.addGroup(g.start,g.count,g.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const f=new D;p.center!==void 0&&f.fromArray(p.center),i.boundingSphere=new zi(f,p.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}class Eb extends ci{constructor(e){super(e)}load(e,t,n,r){const i=this,a=this.path===""?ru.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const l=new Li(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(u){let h=null;try{h=JSON.parse(u)}catch(f){return r!==void 0&&r(f),void console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message)}const p=h.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry")return r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);i.parse(h,t)}),n,r)}async loadAsync(e,t){const n=this.path===""?ru.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new Li(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),a=JSON.parse(i),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,(function(){t!==void 0&&t(h)})),l=this.parseTextures(e.textures,a),u=this.parseMaterials(e.materials,l),h=this.parseObject(e.object,i,u,l,n),p=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,p),t!==void 0){let f=!1;for(const m in a)if(a[m].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,r,l,a,t),h=this.parseSkeletons(e.skeletons,u);return this.bindSkeletons(u,h),u}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const i=new Fa().fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse((function(i){i.isBone&&(r[i.uuid]=i)})),e!==void 0)for(let i=0,a=e.length;i<a;i++){const l=new as().fromJSON(e[i],r);n[l.uuid]=l}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new Fv;for(let i=0,a=e.length;i<a;i++){let l;const u=e[i];switch(u.type){case"BufferGeometry":case"InstancedBufferGeometry":l=r.parse(u);break;default:u.type in z?l=z[u.type].fromJSON(u,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${u.type}"`)}l.uuid=u.uuid,u.name!==void 0&&(l.name=u.name),u.userData!==void 0&&(l.userData=u.userData),n[u.uuid]=l}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const i=new wm;i.setTextures(t);for(let a=0,l=e.length;a<l;a++){const u=e[a];n[u.uuid]===void 0&&(n[u.uuid]=i.parse(u)),r[u.uuid]=n[u.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],i=nu.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function a(l){if(typeof l=="string"){const u=l;return(function(h){return n.manager.itemStart(h),i.load(h,(function(){n.manager.itemEnd(h)}),void 0,(function(){n.manager.itemError(h),n.manager.itemEnd(h)}))})(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:n.resourcePath+u)}return l.data?{data:il(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new Vg(t);i=new wp(l),i.setCrossOrigin(this.crossOrigin);for(let u=0,h=e.length;u<h;u++){const p=e[u],f=p.url;if(Array.isArray(f)){const m=[];for(let g=0,x=f.length;g<x;g++){const y=a(f[g]);y!==null&&(y instanceof HTMLImageElement?m.push(y):m.push(new yn(y.data,y.width,y.height)))}r[p.uuid]=new sa(m)}else{const m=a(p.url);r[p.uuid]=new sa(m)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(a){if(typeof a=="string"){const l=a,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:t.resourcePath+l;return await r.loadAsync(u)}return a.data?{data:il(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new wp(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,l=e.length;a<l;a++){const u=e[a],h=u.url;if(Array.isArray(h)){const p=[];for(let f=0,m=h.length;f<m;f++){const g=h[f],x=await i(g);x!==null&&(x instanceof HTMLImageElement?p.push(x):p.push(new yn(x.data,x.width,x.height)))}n[u.uuid]=new sa(p)}else{const p=await i(u.url);n[u.uuid]=new sa(p)}}}return n}parseTextures(e,t){function n(i,a){return typeof i=="number"?i:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",i),a[i])}const r={};if(e!==void 0)for(let i=0,a=e.length;i<a;i++){const l=e[i];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const u=t[l.image],h=u.data;let p;Array.isArray(h)?(p=new gl,h.length===6&&(p.needsUpdate=!0)):(p=h&&h.data?new yn:new pn,h&&(p.needsUpdate=!0)),p.source=u,p.uuid=l.uuid,l.name!==void 0&&(p.name=l.name),l.mapping!==void 0&&(p.mapping=n(l.mapping,Ab)),l.offset!==void 0&&p.offset.fromArray(l.offset),l.repeat!==void 0&&p.repeat.fromArray(l.repeat),l.center!==void 0&&p.center.fromArray(l.center),l.rotation!==void 0&&(p.rotation=l.rotation),l.wrap!==void 0&&(p.wrapS=n(l.wrap[0],Uv),p.wrapT=n(l.wrap[1],Uv)),l.format!==void 0&&(p.format=l.format),l.internalFormat!==void 0&&(p.internalFormat=l.internalFormat),l.type!==void 0&&(p.type=l.type),l.encoding!==void 0&&(p.encoding=l.encoding),l.minFilter!==void 0&&(p.minFilter=n(l.minFilter,zv)),l.magFilter!==void 0&&(p.magFilter=n(l.magFilter,zv)),l.anisotropy!==void 0&&(p.anisotropy=l.anisotropy),l.flipY!==void 0&&(p.flipY=l.flipY),l.generateMipmaps!==void 0&&(p.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(p.unpackAlignment=l.unpackAlignment),l.userData!==void 0&&(p.userData=l.userData),r[l.uuid]=p}return r}parseObject(e,t,n,r,i){let a,l,u;function h(m){return t[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),t[m]}function p(m){if(m!==void 0){if(Array.isArray(m)){const g=[];for(let x=0,y=m.length;x<y;x++){const b=m[x];n[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),g.push(n[b])}return g}return n[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),n[m]}}function f(m){return r[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),r[m]}switch(e.type){case"Scene":a=new Oa,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Ne(e.background):a.background=f(e.background)),e.environment!==void 0&&(a.environment=f(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new Cs(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new Th(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new vn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Pr(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Yg(e.color,e.intensity);break;case"DirectionalLight":a=new Sm(e.color,e.intensity);break;case"PointLight":a=new Tp(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Nv(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new bm(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Cv(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new _m().fromJSON(e);break;case"SkinnedMesh":l=h(e.geometry),u=p(e.material),a=new Nr(l,u),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":l=h(e.geometry),u=p(e.material),a=new ht(l,u);break;case"InstancedMesh":l=h(e.geometry),u=p(e.material);const m=e.count,g=e.instanceMatrix,x=e.instanceColor;a=new To(l,u,m),a.instanceMatrix=new Ia(new Float32Array(g.array),16),x!==void 0&&(a.instanceColor=new Ia(new Float32Array(x.array),x.itemSize));break;case"LOD":a=new Lh;break;case"Line":a=new qi(h(e.geometry),p(e.material));break;case"LineLoop":a=new Na(h(e.geometry),p(e.material));break;case"LineSegments":a=new En(h(e.geometry),p(e.material));break;case"PointCloud":case"Points":a=new mp(h(e.geometry),p(e.material));break;case"Sprite":a=new fp(p(e.material));break;case"Group":a=new Cr;break;case"Bone":a=new fa;break;default:a=new St}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let g=0;g<m.length;g++)a.add(this.parseObject(m[g],t,n,r,i))}if(e.animations!==void 0){const m=e.animations;for(let g=0;g<m.length;g++){const x=m[g];a.animations.push(i[x])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const m=e.levels;for(let g=0;g<m.length;g++){const x=m[g],y=a.getObjectByProperty("uuid",x.object);y!==void 0&&a.addLevel(y,x.distance,x.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse((function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}}))}}const Ab={UVMapping:uc,CubeReflectionMapping:Ci,CubeRefractionMapping:Di,EquirectangularReflectionMapping:ys,EquirectangularRefractionMapping:Vo,CubeUVReflectionMapping:Ws},Uv={RepeatWrapping:$r,ClampToEdgeWrapping:Gn,MirroredRepeatWrapping:xs},zv={NearestFilter:Wt,NearestMipmapNearestFilter:Xs,NearestMipmapLinearFilter:ia,LinearFilter:_t,LinearMipmapNearestFilter:hc,LinearMipmapLinearFilter:Oi};class Bv extends ci{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Xl.get(e);if(a!==void 0)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader,fetch(e,l).then((function(u){return u.blob()})).then((function(u){return createImageBitmap(u,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(u){Xl.add(e,u),t&&t(u),i.manager.itemEnd(e)})).catch((function(u){r&&r(u),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}let Tm;class Qg{static getContext(){return Tm===void 0&&(Tm=new(window.AudioContext||window.webkitAudioContext)),Tm}static setContext(e){Tm=e}}class Hv extends ci{constructor(e){super(e)}load(e,t,n,r,i){const a=this,l=new Li(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(u){try{const h=u.slice(0);Qg.getContext().decodeAudioData(h,(function(p){t(p)}))}catch(h){r?r(h):console.error(h),a.manager.itemError(e)}}),n,r,i?.mainFile)}}class Rb extends _m{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=new Ne().set(e),i=new Ne().set(t),a=new D(r.r,r.g,r.b),l=new D(i.r,i.g,i.b),u=Math.sqrt(Math.PI),h=u*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(l).multiplyScalar(u),this.sh.coefficients[1].copy(a).sub(l).multiplyScalar(h)}}class Lb extends _m{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=new Ne().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const jv=new Ie,Gv=new Ie,iu=new Ie;class Pb{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new vn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new vn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,iu.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(eo*t.fov*.5)/t.zoom;let a,l;Gv.elements[12]=-n,jv.elements[12]=n,a=-i*t.aspect+r,l=i*t.aspect+r,iu.elements[0]=2*t.near/(l-a),iu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(iu),a=-i*t.aspect-r,l=i*t.aspect-r,iu.elements[0]=2*t.near/(l-a),iu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(iu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Gv),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(jv)}}class Vv{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Wv(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Wv();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Wv(){return(typeof performance>"u"?Date:performance).now()}const au=new D,Xv=new Jt,Cb=new D,su=new D;class Em extends St{constructor(){super(),this.type="AudioListener",this.context=Qg.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Vv}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(au,Xv,Cb),su.set(0,0,-1).applyQuaternion(Xv),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(au.x,r),t.positionY.linearRampToValueAtTime(au.y,r),t.positionZ.linearRampToValueAtTime(au.z,r),t.forwardX.linearRampToValueAtTime(su.x,r),t.forwardY.linearRampToValueAtTime(su.y,r),t.forwardZ.linearRampToValueAtTime(su.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(au.x,au.y,au.z),t.setOrientation(su.x,su.y,su.z,n.x,n.y,n.z)}}class Zg extends St{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl!==!1)return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl!==!1)return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const ou=new D,qv=new Jt,Db=new D,lu=new D;class Yv extends Zg{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ou,qv,Db),lu.set(0,0,1).applyQuaternion(qv);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(ou.x,n),t.positionY.linearRampToValueAtTime(ou.y,n),t.positionZ.linearRampToValueAtTime(ou.z,n),t.orientationX.linearRampToValueAtTime(lu.x,n),t.orientationY.linearRampToValueAtTime(lu.y,n),t.orientationZ.linearRampToValueAtTime(lu.z,n)}else t.setPosition(ou.x,ou.y,ou.z),t.setOrientation(lu.x,lu.y,lu.z)}}class Ob{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Qv{constructor(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let l=0;l!==r;++l)n[i+l]=n[l];a=t}else{a+=t;const l=t/a;this._mixBufferRegion(n,i,0,l,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const u=t*this._origIndex;this._mixBufferRegion(n,r,u,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let u=t,h=t+t;u!==h;++u)if(n[u]!==n[u+t]){l.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){Jt.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;Jt.multiplyQuaternionsFlat(e,a,e,t,e,n),Jt.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let l=0;l!==i;++l){const u=t+l;e[u]=e[u]*a+e[n+l]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const l=t+a;e[l]=e[l]+e[n+a]*r}}}const Kg="\\[\\]\\.:\\/",Ib=new RegExp("["+Kg+"]","g"),Jg="[^"+Kg+"]",Nb="[^"+Kg.replace("\\.","")+"]",kb=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Jg)+/(WCOD+)?/.source.replace("WCOD",Nb)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Jg)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Jg)+"$"),Fb=["material","materials","bones","map"];class kt{constructor(e,t,n){this.path=t,this.parsedPath=n||kt.parseTrackName(t),this.node=kt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new kt.Composite(e,t,n):new kt(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Ib,"")}static parseTrackName(e){const t=kb.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const i=n.nodeName.substring(r+1);Fb.indexOf(i)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(i){for(let a=0;a<i.length;a++){const l=i[a];if(l.name===t||l.uuid===t)return l;const u=n(l.children);if(u)return u}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=kt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===h){h=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(e[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(h!==void 0){if(e[h]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[h]}}const a=e[r];if(a===void 0){const h=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e)}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(i!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else a.fromArray!==void 0&&a.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}kt.Composite=class{constructor(s,e,t){const n=t||kt.parseTrackName(e);this._targetGroup=s,this._bindings=s.subscribe_(e,n)}getValue(s,e){this.bind();const t=this._targetGroup.nCachedObjects_,n=this._bindings[t];n!==void 0&&n.getValue(s,e)}setValue(s,e){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=t.length;n!==r;++n)t[n].setValue(s,e)}bind(){const s=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=s.length;e!==t;++e)s[e].bind()}unbind(){const s=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=s.length;e!==t;++e)s[e].unbind()}},kt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},kt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},kt.prototype.GetterByBindingType=[kt.prototype._getValue_direct,kt.prototype._getValue_array,kt.prototype._getValue_arrayElement,kt.prototype._getValue_toArray],kt.prototype.SetterByBindingTypeAndVersioning=[[kt.prototype._setValue_direct,kt.prototype._setValue_direct_setNeedsUpdate,kt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_array,kt.prototype._setValue_array_setNeedsUpdate,kt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_arrayElement,kt.prototype._setValue_arrayElement_setNeedsUpdate,kt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_fromArray,kt.prototype._setValue_fromArray_setNeedsUpdate,kt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Ub{constructor(){this.isAnimationObjectGroup=!0,this.uuid=mi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length;let l,u=e.length,h=this.nCachedObjects_;for(let p=0,f=arguments.length;p!==f;++p){const m=arguments[p],g=m.uuid;let x=t[g];if(x===void 0){x=u++,t[g]=x,e.push(m);for(let y=0,b=a;y!==b;++y)i[y].push(new kt(m,n[y],r[y]))}else if(x<h){l=e[x];const y=--h,b=e[y];t[b.uuid]=x,e[x]=b,t[g]=y,e[y]=m;for(let w=0,_=a;w!==_;++w){const T=i[w],A=T[y];let R=T[x];T[x]=A,R===void 0&&(R=new kt(m,n[w],r[w])),T[y]=R}}else e[x]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],h=u.uuid,p=t[h];if(p!==void 0&&p>=i){const f=i++,m=e[f];t[m.uuid]=p,e[p]=m,t[h]=f,e[f]=u;for(let g=0,x=r;g!==x;++g){const y=n[g],b=y[f],w=y[p];y[p]=b,y[f]=w}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,a=e.length;for(let l=0,u=arguments.length;l!==u;++l){const h=arguments[l].uuid,p=t[h];if(p!==void 0)if(delete t[h],p<i){const f=--i,m=e[f],g=--a,x=e[g];t[m.uuid]=p,e[p]=m,t[x.uuid]=f,e[f]=x,e.pop();for(let y=0,b=r;y!==b;++y){const w=n[y],_=w[f],T=w[g];w[p]=_,w[f]=T,w.pop()}}else{const f=--a,m=e[f];f>0&&(t[m.uuid]=p),e[p]=m,e.pop();for(let g=0,x=r;g!==x;++g){const y=n[g];y[p]=y[f],y.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(r!==void 0)return i[r];const a=this._paths,l=this._parsedPaths,u=this._objects,h=u.length,p=this.nCachedObjects_,f=new Array(h);r=i.length,n[e]=r,a.push(e),l.push(t),i.push(f);for(let m=p,g=u.length;m!==g;++m){const x=u[m];f[m]=new kt(x,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,i=this._parsedPaths,a=this._bindings,l=a.length-1,u=a[l];t[e[l]]=n,a[n]=u,a.pop(),i[n]=i[l],i.pop(),r[n]=r[l],r.pop()}}}class zb{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,l=new Array(a),u={endingStart:ei,endingEnd:ei};for(let h=0;h!==a;++h){const p=i[h].createInterpolant(null);l[h]=p,p.settings=u}this._interpolantSettings=u,this._interpolants=l,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Sd,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,i=e._clip.duration,a=i/r,l=r/i;e.warp(1,a,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=r._lendControlInterpolant(),this._timeScaleInterpolant=l);const u=l.parameterPositions,h=l.sampleValues;return u[0]=i,u[1]=i+n,h[0]=e/a,h[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(i!==null){const u=(e-i)*n;u<0||n===0?t=0:(this._startTime=null,t=n*u)}t*=this._updateTimeScale(e);const a=this._updateTime(t),l=this._updateWeight(e);if(l>0){const u=this._interpolants,h=this._propertyBindings;if(this.blendMode===Js)for(let p=0,f=u.length;p!==f;++p)u[p].evaluate(a),h[p].accumulateAdditive(l);else for(let p=0,f=u.length;p!==f;++p)u[p].evaluate(a),h[p].accumulate(r,l)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=n===_d;if(e===0)return i===-1?r:a&&(1&i)==1?t-r:r;if(n===Bu){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const l=Math.floor(r/t);r-=t*l,i+=Math.abs(l);const u=this.repetitions-i;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const h=e<0;this._setEndings(h,!h,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=r;if(a&&(1&i)==1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=ti,r.endingEnd=ti):(r.endingStart=e?this.zeroSlopeAtStart?ti:ei:Ni,r.endingEnd=t?this.zeroSlopeAtEnd?ti:ei:Ni)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=i,u[0]=t,l[1]=i+e,u[1]=n,this}}const Bb=new Float32Array(1);class Hb extends Fi{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,l=e._interpolants,u=n.uuid,h=this._bindingsByRootAndName;let p=h[u];p===void 0&&(p={},h[u]=p);for(let f=0;f!==i;++f){const m=r[f],g=m.name;let x=p[g];if(x!==void 0)++x.referenceCount,a[f]=x;else{if(x=a[f],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,u,g));continue}const y=t&&t._propertyBindings[f].binding.parsedPath;x=new Qv(kt.create(n,g,y),m.ValueTypeName,m.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,u,g),a[f]=x}l[f].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];i.useCount++==0&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.useCount==0&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const l=a.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,l=a[i],u=l.knownActions,h=u[u.length-1],p=e._byClipCacheIndex;h._byClipCacheIndex=p,u[p]=h,u.pop(),e._byClipCacheIndex=null,delete l.actionByRoot[(e._localRoot||this._root).uuid],u.length===0&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.referenceCount==0&&this._removeInactiveBinding(i)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,l=a[r],u=t[t.length-1],h=e._cacheIndex;u._cacheIndex=h,t[h]=u,t.pop(),delete l[i],Object.keys(l).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new jg(new Float32Array(2),new Float32Array(2),1,Bb),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a=typeof e=="string"?nu.findByName(r,e):e;const l=a!==null?a.uuid:e,u=this._actionsByClip[l];let h=null;if(n===void 0&&(n=a!==null?a.blendMode:Ks),u!==void 0){const f=u.actionByRoot[i];if(f!==void 0&&f.blendMode===n)return f;h=u.knownActions[0],a===null&&(a=h._clip)}if(a===null)return null;const p=new zb(this,a,t,n);return this._bindAction(p,h),this._addInactiveAction(p,l,i),p}existingAction(e,t){const n=t||this._root,r=n.uuid,i=typeof e=="string"?nu.findByName(n,e):e,a=i?i.uuid:e,l=this._actionsByClip[a];return l!==void 0&&l.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let h=0;h!==n;++h)t[h]._update(r,e,i,a);const l=this._bindings,u=this._nActiveBindings;for(let h=0;h!==u;++h)l[h].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(i!==void 0){const a=i.knownActions;for(let l=0,u=a.length;l!==u;++l){const h=a[l];this._deactivateAction(h);const p=h._cacheIndex,f=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,f._cacheIndex=p,t[p]=f,t.pop(),this._removeInactiveBindingsForAction(h)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const a=n[i].actionByRoot[t];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}const r=this._bindingsByRootAndName[t];if(r!==void 0)for(const i in r){const a=r[i];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class qe{constructor(e){this.value=e}clone(){return new qe(this.value.clone===void 0?this.value:this.value.clone())}}let jb=0;class Gb extends Fi{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:jb++}),this.name="",this.usage=Qa,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this}clone(){return new this.constructor().copy(this)}}class Zv extends Ds{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Vb{constructor(e,t,n,r,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class Wb{constructor(e,t,n=0,r=1/0){this.ray=new ol(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new cn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return $g(e,this,n,t),n.sort(Kv),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)$g(e[r],this,n,t);return n.sort(Kv),n}}function Kv(s,e){return s.distance-e.distance}function $g(s,e,t,n){if(s.layers.test(e.layers)&&s.raycast(e,t),n===!0){const r=s.children;for(let i=0,a=r.length;i<a;i++)$g(r[i],e,t,!0)}}class Jv{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(zn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Xb{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const $v=new ce;class qb{constructor(e=new ce(1/0,1/0),t=new ce(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=$v.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,$v).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const e1=new D,Am=new D;class Yb{constructor(e=new D,t=new D){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){e1.subVectors(e,this.start),Am.subVectors(this.end,this.start);const n=Am.dot(Am);let r=Am.dot(e1)/n;return t&&(r=zn(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const t1=new D;class n1 extends St{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new ut,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,l=1,u=32;a<u;a++,l++){const h=a/u*Math.PI*2,p=l/u*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(p),Math.sin(p),1)}n.setAttribute("position",new He(r,3));const i=new cr({fog:!1,toneMapped:!1});this.cone=new En(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),t1.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t1),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Yl=new D,Rm=new Ie,e0=new Ie;class Qb extends En{constructor(e){const t=r1(e),n=new ut,r=[],i=[],a=new Ne(0,0,1),l=new Ne(0,1,0);for(let u=0;u<t.length;u++){const h=t[u];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(l.r,l.g,l.b))}n.setAttribute("position",new He(r,3)),n.setAttribute("color",new He(i,3)),super(n,new cr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");e0.copy(this.root.matrixWorld).invert();for(let i=0,a=0;i<t.length;i++){const l=t[i];l.parent&&l.parent.isBone&&(Rm.multiplyMatrices(e0,l.matrixWorld),Yl.setFromMatrixPosition(Rm),r.setXYZ(a,Yl.x,Yl.y,Yl.z),Rm.multiplyMatrices(e0,l.parent.matrixWorld),Yl.setFromMatrixPosition(Rm),r.setXYZ(a+1,Yl.x,Yl.y,Yl.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function r1(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push.apply(e,r1(s.children[t]));return e}class i1 extends ht{constructor(e,t,n){super(new ae(t,4,2),new mr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Zb=new D,a1=new Ne,s1=new Ne;class Kb extends St{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Qe(t);r.rotateY(.5*Math.PI),this.material=new mr({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new pt(a,3)),this.add(new ht(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");a1.copy(this.light.color),s1.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const i=n<r/2?a1:s1;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Zb.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Jb extends En{constructor(e=10,t=10,n=4473924,r=8947848){n=new Ne(n),r=new Ne(r);const i=t/2,a=e/t,l=e/2,u=[],h=[];for(let f=0,m=0,g=-l;f<=t;f++,g+=a){u.push(-l,0,g,l,0,g),u.push(g,0,-l,g,0,l);const x=f===i?n:r;x.toArray(h,m),m+=3,x.toArray(h,m),m+=3,x.toArray(h,m),m+=3,x.toArray(h,m),m+=3}const p=new ut;p.setAttribute("position",new He(u,3)),p.setAttribute("color",new He(h,3)),super(p,new cr({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class $b extends En{constructor(e=10,t=16,n=8,r=64,i=4473924,a=8947848){i=new Ne(i),a=new Ne(a);const l=[],u=[];if(t>1)for(let p=0;p<t;p++){const f=p/t*(2*Math.PI),m=Math.sin(f)*e,g=Math.cos(f)*e;l.push(0,0,0),l.push(m,0,g);const x=1&p?i:a;u.push(x.r,x.g,x.b),u.push(x.r,x.g,x.b)}for(let p=0;p<n;p++){const f=1&p?i:a,m=e-e/n*p;for(let g=0;g<r;g++){let x=g/r*(2*Math.PI),y=Math.sin(x)*m,b=Math.cos(x)*m;l.push(y,0,b),u.push(f.r,f.g,f.b),x=(g+1)/r*(2*Math.PI),y=Math.sin(x)*m,b=Math.cos(x)*m,l.push(y,0,b),u.push(f.r,f.g,f.b)}}const h=new ut;h.setAttribute("position",new He(l,3)),h.setAttribute("color",new He(u,3)),super(h,new cr({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const o1=new D,Lm=new D,l1=new D;class c1 extends St{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new ut;r.setAttribute("position",new He([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new cr({fog:!1,toneMapped:!1});this.lightPlane=new qi(r,i),this.add(this.lightPlane),r=new ut,r.setAttribute("position",new He([0,0,0,0,0,1],3)),this.targetLine=new qi(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),o1.setFromMatrixPosition(this.light.matrixWorld),Lm.setFromMatrixPosition(this.light.target.matrixWorld),l1.subVectors(Lm,o1),this.lightPlane.lookAt(Lm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Lm),this.targetLine.scale.z=l1.length()}}const Pm=new D,nr=new Ls;class eS extends En{constructor(e){const t=new ut,n=new cr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={};function l(x,y){u(x),u(y)}function u(x){r.push(0,0,0),i.push(0,0,0),a[x]===void 0&&(a[x]=[]),a[x].push(r.length/3-1)}l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4"),t.setAttribute("position",new He(r,3)),t.setAttribute("color",new He(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const h=new Ne(16755200),p=new Ne(16711680),f=new Ne(43775),m=new Ne(16777215),g=new Ne(3355443);this.setColors(h,p,f,m,g)}setColors(e,t,n,r,i){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;nr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),hr("c",t,e,nr,0,0,-1),hr("t",t,e,nr,0,0,1),hr("n1",t,e,nr,-1,-1,-1),hr("n2",t,e,nr,1,-1,-1),hr("n3",t,e,nr,-1,1,-1),hr("n4",t,e,nr,1,1,-1),hr("f1",t,e,nr,-1,-1,1),hr("f2",t,e,nr,1,-1,1),hr("f3",t,e,nr,-1,1,1),hr("f4",t,e,nr,1,1,1),hr("u1",t,e,nr,.7,1.1,-1),hr("u2",t,e,nr,-.7,1.1,-1),hr("u3",t,e,nr,0,2,-1),hr("cf1",t,e,nr,-1,0,1),hr("cf2",t,e,nr,1,0,1),hr("cf3",t,e,nr,0,-1,1),hr("cf4",t,e,nr,0,1,1),hr("cn1",t,e,nr,-1,0,-1),hr("cn2",t,e,nr,1,0,-1),hr("cn3",t,e,nr,0,-1,-1),hr("cn4",t,e,nr,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function hr(s,e,t,n,r,i,a){Pm.set(r,i,a).unproject(n);const l=e[s];if(l!==void 0){const u=t.getAttribute("position");for(let h=0,p=l.length;h<p;h++)u.setXYZ(l[h],Pm.x,Pm.y,Pm.z)}}const Cm=new ba;class tS extends En{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new ut;i.setIndex(new pt(n,1)),i.setAttribute("position",new pt(r,3)),super(i,new cr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Cm.setFromObject(this.object),Cm.isEmpty())return;const t=Cm.min,n=Cm.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class nS extends En{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new ut;r.setIndex(new pt(n,1)),r.setAttribute("position",new He([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new cr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class rS extends qi{constructor(e,t=1,n=16776960){const r=n,i=new ut;i.setAttribute("position",new He([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new cr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=new ut;a.setAttribute("position",new He([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),a.computeBoundingSphere(),this.add(new ht(a,new mr({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const u1=new D;let Dm,t0;class iS extends St{constructor(e=new D(0,0,1),t=new D(0,0,0),n=1,r=16776960,i=.2*n,a=.2*i){super(),this.type="ArrowHelper",Dm===void 0&&(Dm=new ut,Dm.setAttribute("position",new He([0,0,0,0,1,0],3)),t0=new ma(0,.5,1,5,1),t0.translate(0,-.5,0)),this.position.copy(t),this.line=new qi(Dm,new cr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ht(t0,new mr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{u1.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(u1,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class aS extends En{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new ut;n.setAttribute("position",new He(t,3)),n.setAttribute("color",new He([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new cr({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Ne,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class sS{constructor(){this.type="ShapePath",this.color=new Ne,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new kr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(b,w){const _=w.length;let T=!1;for(let A=_-1,R=0;R<_;A=R++){let C=w[A],I=w[R],G=I.x-C.x,U=I.y-C.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(C=w[R],G=-G,I=w[A],U=-U),b.y<C.y||b.y>I.y)continue;if(b.y===C.y){if(b.x===C.x)return!0}else{const j=U*(b.x-C.x)-G*(b.y-C.y);if(j===0)return!0;if(j<0)continue;T=!T}}else{if(b.y!==C.y)continue;if(I.x<=b.x&&b.x<=C.x||C.x<=b.x&&b.x<=I.x)return!0}}return T}const n=Q.isClockWise,r=this.subPaths;if(r.length===0)return[];let i,a,l;const u=[];if(r.length===1)return a=r[0],l=new Fa,l.curves=a.curves,u.push(l),u;let h=!n(r[0].getPoints());h=e?!h:h;const p=[],f=[];let m,g,x=[],y=0;f[y]=void 0,x[y]=[];for(let b=0,w=r.length;b<w;b++)a=r[b],m=a.getPoints(),i=n(m),i=e?!i:i,i?(!h&&f[y]&&y++,f[y]={s:new Fa,p:m},f[y].s.curves=a.curves,h&&y++,x[y]=[]):x[y].push({h:a,p:m[0]});if(!f[0])return(function(b){const w=[];for(let _=0,T=b.length;_<T;_++){const A=b[_],R=new Fa;R.curves=A.curves,w.push(R)}return w})(r);if(f.length>1){let b=!1,w=0;for(let _=0,T=f.length;_<T;_++)p[_]=[];for(let _=0,T=f.length;_<T;_++){const A=x[_];for(let R=0;R<A.length;R++){const C=A[R];let I=!0;for(let G=0;G<f.length;G++)t(C.p,f[G].p)&&(_!==G&&w++,I?(I=!1,p[G].push(C)):b=!0);I&&p[_].push(C)}}w>0&&b===!1&&(x=p)}for(let b=0,w=f.length;b<w;b++){l=f[b].s,u.push(l),g=x[b];for(let _=0,T=g.length;_<T;_++)l.holes.push(g[_].h)}return u}}const Co=oS();function oS(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let u=0;u<256;++u){const h=u-127;h<-27?(n[u]=0,n[256|u]=32768,r[u]=24,r[256|u]=24):h<-14?(n[u]=1024>>-h-14,n[256|u]=1024>>-h-14|32768,r[u]=-h-1,r[256|u]=-h-1):h<=15?(n[u]=h+15<<10,n[256|u]=h+15<<10|32768,r[u]=13,r[256|u]=13):h<128?(n[u]=31744,n[256|u]=64512,r[u]=24,r[256|u]=24):(n[u]=31744,n[256|u]=64512,r[u]=13,r[256|u]=13)}const i=new Uint32Array(2048),a=new Uint32Array(64),l=new Uint32Array(64);for(let u=1;u<1024;++u){let h=u<<13,p=0;for(;(8388608&h)==0;)h<<=1,p-=8388608;h&=-8388609,p+=947912704,i[u]=h|p}for(let u=1024;u<2048;++u)i[u]=939524096+(u-1024<<13);for(let u=1;u<31;++u)a[u]=u<<23;a[31]=1199570944,a[32]=2147483648;for(let u=33;u<63;++u)a[u]=2147483648+(u-32<<23);a[63]=3347054592;for(let u=1;u<64;++u)u!==32&&(l[u]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:a,offsetTable:l}}const Ep={toHalfFloat:function(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=zn(s,-65504,65504),Co.floatView[0]=s;const e=Co.uint32View[0],t=e>>23&511;return Co.baseTable[t]+((8388607&e)>>Co.shiftTable[t])},fromHalfFloat:function(s){const e=s>>10;return Co.uint32View[0]=Co.mantissaTable[Co.offsetTable[e]+(1023&s)]+Co.exponentTable[e],Co.floatView[0]}};class lS extends Xn{constructor(e,t,n,r,i,a){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,r,i,a)}}class cS extends Gl{constructor(e,t,n,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,r)}}class uS extends Ai{constructor(e,t,n,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,r)}}class hS extends Yi{constructor(e,t,n,r,i,a,l){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,r,i,a,l)}}class dS extends ma{constructor(e,t,n,r,i,a,l,u){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,r,i,a,l,u)}}class pS extends ks{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class fS extends Pe{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class mS extends Xe{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class gS extends us{constructor(e,t,n,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,r)}}class vS extends Qe{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class yS extends Vi{constructor(e,t,n,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,r)}}class xS extends Ri{constructor(e,t,n,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,r)}}class bS extends tt{constructor(e,t,n,r,i,a){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,r,i,a)}}class SS extends xn{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class _S extends ae{constructor(e,t,n,r,i,a,l){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,r,i,a,l)}}class wS extends Z{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class MS extends ue{constructor(e,t,n,r,i){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,r,i)}}class TS extends ke{constructor(e,t,n,r,i,a){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,r,i,a)}}class ES extends rt{constructor(e,t,n,r,i){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,r,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$e}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$e);class AS{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}dot4(e,t,n,r,i){return e[0]*t+e[1]*n+e[2]*r+e[3]*i}noise(e,t){let n,r,i;const a=(e+t)*(.5*(Math.sqrt(3)-1)),l=Math.floor(e+a),u=Math.floor(t+a),h=(3-Math.sqrt(3))/6,p=(l+u)*h,f=e-(l-p),m=t-(u-p);let g,x;f>m?(g=1,x=0):(g=0,x=1);const y=f-g+h,b=m-x+h,w=f-1+2*h,_=m-1+2*h,T=255&l,A=255&u,R=this.perm[T+this.perm[A]]%12,C=this.perm[T+g+this.perm[A+x]]%12,I=this.perm[T+1+this.perm[A+1]]%12;let G=.5-f*f-m*m;G<0?n=0:(G*=G,n=G*G*this.dot(this.grad3[R],f,m));let U=.5-y*y-b*b;U<0?r=0:(U*=U,r=U*U*this.dot(this.grad3[C],y,b));let j=.5-w*w-_*_;return j<0?i=0:(j*=j,i=j*j*this.dot(this.grad3[I],w,_)),70*(n+r+i)}noise3d(e,t,n){let r,i,a,l;const u=(e+t+n)*.3333333333333333,h=Math.floor(e+u),p=Math.floor(t+u),f=Math.floor(n+u),m=1/6,g=(h+p+f)*m,x=e-(h-g),y=t-(p-g),b=n-(f-g);let w,_,T,A,R,C;x>=y?y>=b?(w=1,_=0,T=0,A=1,R=1,C=0):x>=b?(w=1,_=0,T=0,A=1,R=0,C=1):(w=0,_=0,T=1,A=1,R=0,C=1):y<b?(w=0,_=0,T=1,A=0,R=1,C=1):x<b?(w=0,_=1,T=0,A=0,R=1,C=1):(w=0,_=1,T=0,A=1,R=1,C=0);const I=x-w+m,G=y-_+m,U=b-T+m,j=x-A+2*m,N=y-R+2*m,J=b-C+2*m,le=x-1+.5,oe=y-1+.5,xe=b-1+.5,ge=255&h,Me=255&p,Ae=255&f,De=this.perm[ge+this.perm[Me+this.perm[Ae]]]%12,pe=this.perm[ge+w+this.perm[Me+_+this.perm[Ae+T]]]%12,re=this.perm[ge+A+this.perm[Me+R+this.perm[Ae+C]]]%12,ye=this.perm[ge+1+this.perm[Me+1+this.perm[Ae+1]]]%12;let Ce=.6-x*x-y*y-b*b;Ce<0?r=0:(Ce*=Ce,r=Ce*Ce*this.dot3(this.grad3[De],x,y,b));let _e=.6-I*I-G*G-U*U;_e<0?i=0:(_e*=_e,i=_e*_e*this.dot3(this.grad3[pe],I,G,U));let Ue=.6-j*j-N*N-J*J;Ue<0?a=0:(Ue*=Ue,a=Ue*Ue*this.dot3(this.grad3[re],j,N,J));let H=.6-le*le-oe*oe-xe*xe;return H<0?l=0:(H*=H,l=H*H*this.dot3(this.grad3[ye],le,oe,xe)),32*(r+i+a+l)}noise4d(e,t,n,r){const i=this.grad4,a=this.simplex,l=this.perm,u=(Math.sqrt(5)-1)/4,h=(5-Math.sqrt(5))/20;let p,f,m,g,x;const y=(e+t+n+r)*u,b=Math.floor(e+y),w=Math.floor(t+y),_=Math.floor(n+y),T=Math.floor(r+y),A=(b+w+_+T)*h,R=e-(b-A),C=t-(w-A),I=n-(_-A),G=r-(T-A),U=(R>C?32:0)+(R>I?16:0)+(C>I?8:0)+(R>G?4:0)+(C>G?2:0)+(I>G?1:0),j=a[U][0]>=3?1:0,N=a[U][1]>=3?1:0,J=a[U][2]>=3?1:0,le=a[U][3]>=3?1:0,oe=a[U][0]>=2?1:0,xe=a[U][1]>=2?1:0,ge=a[U][2]>=2?1:0,Me=a[U][3]>=2?1:0,Ae=a[U][0]>=1?1:0,De=a[U][1]>=1?1:0,pe=a[U][2]>=1?1:0,re=a[U][3]>=1?1:0,ye=R-j+h,Ce=C-N+h,_e=I-J+h,Ue=G-le+h,H=R-oe+2*h,k=C-xe+2*h,ie=I-ge+2*h,q=G-Me+2*h,B=R-Ae+3*h,K=C-De+3*h,O=I-pe+3*h,W=G-re+3*h,Y=R-1+4*h,te=C-1+4*h,ne=I-1+4*h,me=G-1+4*h,Fe=255&b,Ge=255&w,Je=255&_,Ve=255&T,wt=l[Fe+l[Ge+l[Je+l[Ve]]]]%32,At=l[Fe+j+l[Ge+N+l[Je+J+l[Ve+le]]]]%32,xt=l[Fe+oe+l[Ge+xe+l[Je+ge+l[Ve+Me]]]]%32,Ft=l[Fe+Ae+l[Ge+De+l[Je+pe+l[Ve+re]]]]%32,un=l[Fe+1+l[Ge+1+l[Je+1+l[Ve+1]]]]%32;let gt=.6-R*R-C*C-I*I-G*G;gt<0?p=0:(gt*=gt,p=gt*gt*this.dot4(i[wt],R,C,I,G));let hn=.6-ye*ye-Ce*Ce-_e*_e-Ue*Ue;hn<0?f=0:(hn*=hn,f=hn*hn*this.dot4(i[At],ye,Ce,_e,Ue));let de=.6-H*H-k*k-ie*ie-q*q;de<0?m=0:(de*=de,m=de*de*this.dot4(i[xt],H,k,ie,q));let nc=.6-B*B-K*K-O*O-W*W;nc<0?g=0:(nc*=nc,g=nc*nc*this.dot4(i[Ft],B,K,O,W));let rc=.6-Y*Y-te*te-ne*ne-me*me;return rc<0?x=0:(rc*=rc,x=rc*rc*this.dot4(i[un],Y,te,ne,me)),27*(p+f+m+g+x)}}class RS extends St{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const Vh=new D,h1=new Ie,d1=new Ie,p1=new D,f1=new D;class LS{constructor(e={}){const t=this;let n,r,i,a;const l={objects:new WeakMap},u=e.element!==void 0?e.element:document.createElement("div");function h(f,m,g){if(f.isCSS2DObject){Vh.setFromMatrixPosition(f.matrixWorld),Vh.applyMatrix4(d1);const x=f.visible===!0&&Vh.z>=-1&&Vh.z<=1&&f.layers.test(g.layers)===!0;if(f.element.style.display=x===!0?"":"none",x===!0){f.onBeforeRender(t,m,g);const b=f.element;b.style.transform="translate(-50%,-50%) translate("+(Vh.x*i+i)+"px,"+(-Vh.y*a+a)+"px)",b.parentNode!==u&&u.appendChild(b),f.onAfterRender(t,m,g)}const y={distanceToCameraSquared:p(g,f)};l.objects.set(f,y)}for(let x=0,y=f.children.length;x<y;x++)h(f.children[x],m,g)}function p(f,m){return p1.setFromMatrixPosition(f.matrixWorld),f1.setFromMatrixPosition(m.matrixWorld),p1.distanceToSquared(f1)}u.style.overflow="hidden",this.domElement=u,this.getSize=function(){return{width:n,height:r}},this.render=function(f,m){f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),m.parent===null&&m.matrixWorldAutoUpdate===!0&&m.updateMatrixWorld(),h1.copy(m.matrixWorldInverse),d1.multiplyMatrices(m.projectionMatrix,h1),h(f,f,m),(function(g){const x=(function(b){const w=[];return b.traverse((function(_){_.isCSS2DObject&&w.push(_)})),w})(g).sort((function(b,w){return b.renderOrder!==w.renderOrder?w.renderOrder-b.renderOrder:l.objects.get(b).distanceToCameraSquared-l.objects.get(w).distanceToCameraSquared})),y=x.length;for(let b=0,w=x.length;b<w;b++)x[b].element.style.zIndex=y-b})(f)},this.setSize=function(f,m){n=f,r=m,i=n/2,a=r/2,u.style.width=f+"px",u.style.height=m+"px"}}}const m1=new D,PS=new Jt,g1=new D;class v1 extends St{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}class CS extends v1{constructor(e){super(e),this.isCSS3DSprite=!0,this.rotation2D=0}copy(e,t){return super.copy(e,t),this.rotation2D=e.rotation2D,this}}const Us=new Ie,DS=new Ie;class OS{constructor(e={}){const t=this;let n,r,i,a;const l={camera:{fov:0,style:""},objects:new WeakMap},u=e.element!==void 0?e.element:document.createElement("div");u.style.overflow="hidden",this.domElement=u;const h=document.createElement("div");h.style.transformOrigin="0 0",h.style.pointerEvents="none",u.appendChild(h);const p=document.createElement("div");function f(y){return Math.abs(y)<1e-10?0:y}function m(y){const b=y.elements;return"matrix3d("+f(b[0])+","+f(-b[1])+","+f(b[2])+","+f(b[3])+","+f(b[4])+","+f(-b[5])+","+f(b[6])+","+f(b[7])+","+f(b[8])+","+f(-b[9])+","+f(b[10])+","+f(b[11])+","+f(b[12])+","+f(-b[13])+","+f(b[14])+","+f(b[15])+")"}function g(y){const b=y.elements;return"translate(-50%,-50%)"+("matrix3d("+f(b[0])+","+f(b[1])+","+f(b[2])+","+f(b[3])+","+f(-b[4])+","+f(-b[5])+","+f(-b[6])+","+f(-b[7])+","+f(b[8])+","+f(b[9])+","+f(b[10])+","+f(b[11])+","+f(b[12])+","+f(b[13])+","+f(b[14])+","+f(b[15])+")")}function x(y,b,w,_){if(y.isCSS3DObject){const T=y.visible===!0&&y.layers.test(w.layers)===!0;if(y.element.style.display=T===!0?"":"none",T===!0){let A;y.onBeforeRender(t,b,w),y.isCSS3DSprite?(Us.copy(w.matrixWorldInverse),Us.transpose(),y.rotation2D!==0&&Us.multiply(DS.makeRotationZ(y.rotation2D)),y.matrixWorld.decompose(m1,PS,g1),Us.setPosition(m1),Us.scale(g1),Us.elements[3]=0,Us.elements[7]=0,Us.elements[11]=0,Us.elements[15]=1,A=g(Us)):A=g(y.matrixWorld);const R=y.element,C=l.objects.get(y);if(C===void 0||C.style!==A){R.style.transform=A;const I={style:A};l.objects.set(y,I)}R.parentNode!==p&&p.appendChild(R),y.onAfterRender(t,b,w)}}for(let T=0,A=y.children.length;T<A;T++)x(y.children[T],b,w)}p.style.transformStyle="preserve-3d",h.appendChild(p),this.getSize=function(){return{width:n,height:r}},this.render=function(y,b){const w=b.projectionMatrix.elements[5]*a;let _,T;l.camera.fov!==w&&(h.style.perspective=b.isPerspectiveCamera?w+"px":"",l.camera.fov=w),b.view&&b.view.enabled?(h.style.transform=`translate( ${-b.view.offsetX*(n/b.view.width)}px, ${-b.view.offsetY*(r/b.view.height)}px )`,h.style.transform+=`scale( ${b.view.fullWidth/b.view.width}, ${b.view.fullHeight/b.view.height} )`):h.style.transform="",y.matrixWorldAutoUpdate===!0&&y.updateMatrixWorld(),b.parent===null&&b.matrixWorldAutoUpdate===!0&&b.updateMatrixWorld(),b.isOrthographicCamera&&(_=-(b.right+b.left)/2,T=(b.top+b.bottom)/2);const A=b.view&&b.view.enabled?b.view.height/b.view.fullHeight:1,R=b.isOrthographicCamera?`scale( ${A} )scale(`+w+")translate("+f(_)+"px,"+f(T)+"px)"+m(b.matrixWorldInverse):`scale( ${A} )translateZ(`+w+"px)"+m(b.matrixWorldInverse),C=R+"translate("+i+"px,"+a+"px)";l.camera.style!==C&&(p.style.transform=C,l.camera.style=C),x(y,y,b)},this.setSize=function(y,b){n=y,r=b,i=n/2,a=r/2,u.style.width=y+"px",u.style.height=b+"px",h.style.width=y+"px",h.style.height=b+"px",p.style.width=y+"px",p.style.height=b+"px"}}}class y1{constructor(){this.id=0,this.object=null,this.z=0,this.renderOrder=0}}class x1{constructor(){this.id=0,this.v1=new cu,this.v2=new cu,this.v3=new cu,this.normalModel=new D,this.vertexNormalsModel=[new D,new D,new D],this.vertexNormalsLength=0,this.color=new Ne,this.material=null,this.uvs=[new ce,new ce,new ce],this.z=0,this.renderOrder=0}}class cu{constructor(){this.position=new D,this.positionWorld=new D,this.positionScreen=new ot,this.visible=!0}copy(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)}}class b1{constructor(){this.id=0,this.v1=new cu,this.v2=new cu,this.vertexColors=[new Ne,new Ne],this.material=null,this.z=0,this.renderOrder=0}}class S1{constructor(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new ce,this.material=null,this.renderOrder=0}}class IS{constructor(){let e,t,n,r,i,a,l,u,h,p,f,m=0,g=0,x=0,y=0,b=0;const w={objects:[],lights:[],elements:[]},_=new D,T=new ot,A=new ba(new D(-1,-1,-1),new D(1,1,1)),R=new ba,C=new Array(3),I=new Ie,G=new Ie,U=new Ie,j=new Ra,N=[],J=[],le=[],oe=[],xe=[],ge=new function(){const re=[],ye=[],Ce=[];let _e=null;const Ue=new Jn;function H(q){const B=q.position,K=q.positionWorld,O=q.positionScreen;K.copy(B).applyMatrix4(f),O.copy(K).applyMatrix4(G);const W=1/O.w;O.x*=W,O.y*=W,O.z*=W,q.visible=O.x>=-1&&O.x<=1&&O.y>=-1&&O.y<=1&&O.z>=-1&&O.z<=1}function k(q,B,K){return q.visible===!0||B.visible===!0||K.visible===!0||(C[0]=q.positionScreen,C[1]=B.positionScreen,C[2]=K.positionScreen,A.intersectsBox(R.setFromPoints(C)))}function ie(q,B,K){return(K.positionScreen.x-q.positionScreen.x)*(B.positionScreen.y-q.positionScreen.y)-(K.positionScreen.y-q.positionScreen.y)*(B.positionScreen.x-q.positionScreen.x)<0}return{setObject:function(q){_e=q,Ue.getNormalMatrix(_e.matrixWorld),re.length=0,ye.length=0,Ce.length=0},projectVertex:H,checkTriangleVisibility:k,checkBackfaceCulling:ie,pushVertex:function(q,B,K){n=(function(){if(r===g){const O=new cu;return J.push(O),g++,r++,O}return J[r++]})(),n.position.set(q,B,K),H(n)},pushNormal:function(q,B,K){re.push(q,B,K)},pushColor:function(q,B,K){ye.push(q,B,K)},pushUv:function(q,B){Ce.push(q,B)},pushLine:function(q,B){const K=J[q],O=J[B];K.positionScreen.copy(K.position).applyMatrix4(U),O.positionScreen.copy(O.position).applyMatrix4(U),(function(W,Y){let te=0,ne=1;const me=W.z+W.w,Fe=Y.z+Y.w,Ge=-W.z+W.w,Je=-Y.z+Y.w;return me>=0&&Fe>=0&&Ge>=0&&Je>=0||!(me<0&&Fe<0||Ge<0&&Je<0)&&(me<0?te=Math.max(te,me/(me-Fe)):Fe<0&&(ne=Math.min(ne,me/(me-Fe))),Ge<0?te=Math.max(te,Ge/(Ge-Je)):Je<0&&(ne=Math.min(ne,Ge/(Ge-Je))),!(ne<te)&&(W.lerp(Y,te),Y.lerp(W,1-ne),!0))})(K.positionScreen,O.positionScreen)===!0&&(K.positionScreen.multiplyScalar(1/K.positionScreen.w),O.positionScreen.multiplyScalar(1/O.positionScreen.w),l=(function(){if(u===y){const W=new b1;return oe.push(W),y++,u++,W}return oe[u++]})(),l.id=_e.id,l.v1.copy(K),l.v2.copy(O),l.z=Math.max(K.positionScreen.z,O.positionScreen.z),l.renderOrder=_e.renderOrder,l.material=_e.material,_e.material.vertexColors&&(l.vertexColors[0].fromArray(ye,3*q),l.vertexColors[1].fromArray(ye,3*B)),w.elements.push(l))},pushTriangle:function(q,B,K,O){const W=J[q],Y=J[B],te=J[K];if(k(W,Y,te)!==!1&&(O.side===We||ie(W,Y,te)===!0)){i=(function(){if(a===x){const ne=new x1;return le.push(ne),x++,a++,ne}return le[a++]})(),i.id=_e.id,i.v1.copy(W),i.v2.copy(Y),i.v3.copy(te),i.z=(W.positionScreen.z+Y.positionScreen.z+te.positionScreen.z)/3,i.renderOrder=_e.renderOrder,_.subVectors(te.position,Y.position),T.subVectors(W.position,Y.position),_.cross(T),i.normalModel.copy(_),i.normalModel.applyMatrix3(Ue).normalize();for(let ne=0;ne<3;ne++){const me=i.vertexNormalsModel[ne];me.fromArray(re,3*arguments[ne]),me.applyMatrix3(Ue).normalize(),i.uvs[ne].fromArray(Ce,2*arguments[ne])}i.vertexNormalsLength=3,i.material=O,O.vertexColors&&i.color.fromArray(ye,3*q),w.elements.push(i)}}}};function Me(re){if(re.visible===!1)return;if(re.isLight)w.lights.push(re);else if(re.isMesh||re.isLine||re.isPoints){if(re.material.visible===!1||re.frustumCulled===!0&&j.intersectsObject(re)===!1)return;Ae(re)}else if(re.isSprite){if(re.material.visible===!1||re.frustumCulled===!0&&j.intersectsSprite(re)===!1)return;Ae(re)}const ye=re.children;for(let Ce=0,_e=ye.length;Ce<_e;Ce++)Me(ye[Ce])}function Ae(re){e=(function(){if(t===m){const ye=new y1;return N.push(ye),m++,t++,ye}return N[t++]})(),e.id=re.id,e.object=re,_.setFromMatrixPosition(re.matrixWorld),_.applyMatrix4(G),e.z=_.z,e.renderOrder=re.renderOrder,w.objects.push(e)}function De(re,ye,Ce){const _e=1/re.w;re.z*=_e,re.z>=-1&&re.z<=1&&(h=(function(){if(p===b){const Ue=new S1;return xe.push(Ue),b++,p++,Ue}return xe[p++]})(),h.id=ye.id,h.x=re.x*_e,h.y=re.y*_e,h.z=re.z,h.renderOrder=ye.renderOrder,h.object=ye,h.rotation=ye.rotation,h.scale.x=ye.scale.x*Math.abs(h.x-(re.x+Ce.projectionMatrix.elements[0])/(re.w+Ce.projectionMatrix.elements[12])),h.scale.y=ye.scale.y*Math.abs(h.y-(re.y+Ce.projectionMatrix.elements[5])/(re.w+Ce.projectionMatrix.elements[13])),h.material=ye.material,w.elements.push(h))}function pe(re,ye){return re.renderOrder!==ye.renderOrder?re.renderOrder-ye.renderOrder:re.z!==ye.z?ye.z-re.z:re.id!==ye.id?re.id-ye.id:0}this.projectScene=function(re,ye,Ce,_e){a=0,u=0,p=0,w.elements.length=0,re.matrixWorldAutoUpdate===!0&&re.updateMatrixWorld(),ye.parent===null&&ye.matrixWorldAutoUpdate===!0&&ye.updateMatrixWorld(),I.copy(ye.matrixWorldInverse),G.multiplyMatrices(ye.projectionMatrix,I),j.setFromProjectionMatrix(G),t=0,w.objects.length=0,w.lights.length=0,Me(re),Ce===!0&&w.objects.sort(pe);const Ue=w.objects;for(let H=0,k=Ue.length;H<k;H++){const ie=Ue[H].object,q=ie.geometry;if(ge.setObject(ie),f=ie.matrixWorld,r=0,ie.isMesh){let B=ie.material;const K=Array.isArray(B),O=q.attributes,W=q.groups;if(O.position===void 0)continue;const Y=O.position.array;for(let te=0,ne=Y.length;te<ne;te+=3){let me=Y[te],Fe=Y[te+1],Ge=Y[te+2];const Je=q.morphAttributes.position;if(Je!==void 0){const Ve=q.morphTargetsRelative,wt=ie.morphTargetInfluences;for(let At=0,xt=Je.length;At<xt;At++){const Ft=wt[At];if(Ft===0)continue;const un=Je[At];Ve?(me+=un.getX(te/3)*Ft,Fe+=un.getY(te/3)*Ft,Ge+=un.getZ(te/3)*Ft):(me+=(un.getX(te/3)-Y[te])*Ft,Fe+=(un.getY(te/3)-Y[te+1])*Ft,Ge+=(un.getZ(te/3)-Y[te+2])*Ft)}}ge.pushVertex(me,Fe,Ge)}if(O.normal!==void 0){const te=O.normal.array;for(let ne=0,me=te.length;ne<me;ne+=3)ge.pushNormal(te[ne],te[ne+1],te[ne+2])}if(O.color!==void 0){const te=O.color.array;for(let ne=0,me=te.length;ne<me;ne+=3)ge.pushColor(te[ne],te[ne+1],te[ne+2])}if(O.uv!==void 0){const te=O.uv.array;for(let ne=0,me=te.length;ne<me;ne+=2)ge.pushUv(te[ne],te[ne+1])}if(q.index!==null){const te=q.index.array;if(W.length>0)for(let ne=0;ne<W.length;ne++){const me=W[ne];if(B=K===!0?ie.material[me.materialIndex]:ie.material,B!==void 0)for(let Fe=me.start,Ge=me.start+me.count;Fe<Ge;Fe+=3)ge.pushTriangle(te[Fe],te[Fe+1],te[Fe+2],B)}else for(let ne=0,me=te.length;ne<me;ne+=3)ge.pushTriangle(te[ne],te[ne+1],te[ne+2],B)}else if(W.length>0)for(let te=0;te<W.length;te++){const ne=W[te];if(B=K===!0?ie.material[ne.materialIndex]:ie.material,B!==void 0)for(let me=ne.start,Fe=ne.start+ne.count;me<Fe;me+=3)ge.pushTriangle(me,me+1,me+2,B)}else for(let te=0,ne=Y.length/3;te<ne;te+=3)ge.pushTriangle(te,te+1,te+2,B)}else if(ie.isLine){U.multiplyMatrices(G,f);const B=q.attributes;if(B.position!==void 0){const K=B.position.array;for(let O=0,W=K.length;O<W;O+=3)ge.pushVertex(K[O],K[O+1],K[O+2]);if(B.color!==void 0){const O=B.color.array;for(let W=0,Y=O.length;W<Y;W+=3)ge.pushColor(O[W],O[W+1],O[W+2])}if(q.index!==null){const O=q.index.array;for(let W=0,Y=O.length;W<Y;W+=2)ge.pushLine(O[W],O[W+1])}else{const O=ie.isLineSegments?2:1;for(let W=0,Y=K.length/3-1;W<Y;W+=O)ge.pushLine(W,W+1)}}}else if(ie.isPoints){U.multiplyMatrices(G,f);const B=q.attributes;if(B.position!==void 0){const K=B.position.array;for(let O=0,W=K.length;O<W;O+=3)T.set(K[O],K[O+1],K[O+2],1),T.applyMatrix4(U),De(T,ie,ye)}}else ie.isSprite&&(ie.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,ie.matrixWorld),T.set(f.elements[12],f.elements[13],f.elements[14],1),T.applyMatrix4(G),De(T,ie,ye))}return _e===!0&&w.elements.sort(pe),w}}}function NS(){throw new Error("BufferGeometryUtils: computeTangents renamed to computeMikkTSpaceTangents.")}function kS(s,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!s.hasAttribute("position")||!s.hasAttribute("normal")||!s.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function n(a){if(a.normalized||a.isInterleavedBufferAttribute){const l=new Float32Array(a.getCount()*a.itemSize);for(let u=0,h=0;u<a.getCount();u++)l[h++]=a.getX(u),l[h++]=a.getY(u),a.itemSize>2&&(l[h++]=a.getZ(u));return l}return a.array instanceof Float32Array?a.array:new Float32Array(a.array)}const r=s.index?s.toNonIndexed():s,i=e.generateTangents(n(r.attributes.position),n(r.attributes.normal),n(r.attributes.uv));if(t)for(let a=3;a<i.length;a+=4)i[a]*=-1;return r.setAttribute("tangent",new pt(i,4)),s!==r&&s.copy(r),s}function FS(s,e=!1){const t=s[0].index!==null,n=new Set(Object.keys(s[0].attributes)),r=new Set(Object.keys(s[0].morphAttributes)),i={},a={},l=s[0].morphTargetsRelative,u=new ut;let h=0;for(let p=0;p<s.length;++p){const f=s[p];let m=0;if(t!==(f.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const g in f.attributes){if(!n.has(g))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+'. All geometries must have compatible attributes; make sure "'+g+'" attribute exists among all geometries, or in none of them.'),null;i[g]===void 0&&(i[g]=[]),i[g].push(f.attributes[g]),m++}if(m!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". Make sure all geometries have the same number of attributes."),null;if(l!==f.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const g in f.morphAttributes){if(!r.has(g))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+".  .morphAttributes must be consistent throughout all geometries."),null;a[g]===void 0&&(a[g]=[]),a[g].push(f.morphAttributes[g])}if(e){let g;if(t)g=f.index.count;else{if(f.attributes.position===void 0)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". The geometry must have either an index or a position attribute"),null;g=f.attributes.position.count}u.addGroup(h,g,p),h+=g}}if(t){let p=0;const f=[];for(let m=0;m<s.length;++m){const g=s[m].index;for(let x=0;x<g.count;++x)f.push(g.getX(x)+p);p+=s[m].attributes.position.count}u.setIndex(f)}for(const p in i){const f=n0(i[p]);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+p+" attribute."),null;u.setAttribute(p,f)}for(const p in a){const f=a[p][0].length;if(f===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[p]=[];for(let m=0;m<f;++m){const g=[];for(let y=0;y<a[p].length;++y)g.push(a[p][y][m]);const x=n0(g);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+p+" morphAttribute."),null;u.morphAttributes[p].push(x)}}return u}function n0(s){let e,t,n,r=0;for(let l=0;l<s.length;++l){const u=s[l];if(u.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=u.array.constructor),e!==u.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=u.itemSize),t!==u.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=u.normalized),n!==u.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=u.array.length}const i=new e(r);let a=0;for(let l=0;l<s.length;++l)i.set(s[l].array,a),a+=s[l].array.length;return new pt(i,t,n)}function Om(s){return s.isInstancedInterleavedBufferAttribute||s.isInterleavedBufferAttribute?Im(s):s.isInstancedBufferAttribute?new Ia().copy(s):new pt().copy(s)}function US(s){let e,t=0,n=0;for(let h=0,p=s.length;h<p;++h){const f=s[h];if(e===void 0&&(e=f.array.constructor),e!==f.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=f.array.length,n+=f.itemSize}const r=new Ds(new e(t),n);let i=0;const a=[],l=["getX","getY","getZ","getW"],u=["setX","setY","setZ","setW"];for(let h=0,p=s.length;h<p;h++){const f=s[h],m=f.itemSize,g=f.count,x=new Or(r,m,i,f.normalized);a.push(x),i+=m;for(let y=0;y<g;y++)for(let b=0;b<m;b++)x[u[b]](y,f[l[b]](y))}return a}function Im(s){const e=s.data.array.constructor,t=s.count,n=s.itemSize,r=s.normalized,i=new e(t*n);let a;a=s.isInstancedInterleavedBufferAttribute?new Ia(i,n,r,s.meshPerAttribute):new pt(i,n,r);for(let l=0;l<t;l++)a.setX(l,s.getX(l)),n>=2&&a.setY(l,s.getY(l)),n>=3&&a.setZ(l,s.getZ(l)),n>=4&&a.setW(l,s.getW(l));return a}function zS(s){const e=s.attributes,t=s.morphTargets,n=new Map;for(const r in e){const i=e[r];i.isInterleavedBufferAttribute&&(n.has(i)||n.set(i,Im(i)),e[r]=n.get(i))}for(const r in t){const i=t[r];i.isInterleavedBufferAttribute&&(n.has(i)||n.set(i,Im(i)),t[r]=n.get(i))}}function BS(s){let e=0;for(const n in s.attributes){const r=s.getAttribute(n);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}const t=s.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function HS(s,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},n=s.getIndex(),r=s.getAttribute("position"),i=n?n.count:r.count;let a=0;const l=Object.keys(s.attributes),u={},h={},p=[],f=["getX","getY","getZ","getW"],m=["setX","setY","setZ","setW"];for(let b=0,w=l.length;b<w;b++){const _=l[b],T=s.attributes[_];u[_]=new pt(new T.array.constructor(T.count*T.itemSize),T.itemSize,T.normalized);const A=s.morphAttributes[_];A&&(h[_]=new pt(new A.array.constructor(A.count*A.itemSize),A.itemSize,A.normalized))}const g=Math.log10(1/e),x=Math.pow(10,g);for(let b=0;b<i;b++){const w=n?n.getX(b):b;let _="";for(let T=0,A=l.length;T<A;T++){const R=l[T],C=s.getAttribute(R),I=C.itemSize;for(let G=0;G<I;G++)_+=~~(C[f[G]](w)*x)+","}if(_ in t)p.push(t[_]);else{for(let T=0,A=l.length;T<A;T++){const R=l[T],C=s.getAttribute(R),I=s.morphAttributes[R],G=C.itemSize,U=u[R],j=h[R];for(let N=0;N<G;N++){const J=f[N],le=m[N];if(U[le](a,C[J](w)),I)for(let oe=0,xe=I.length;oe<xe;oe++)j[oe][le](a,I[oe][J](w))}}t[_]=a,p.push(a),a++}}const y=s.clone();for(const b in s.attributes){const w=u[b];if(y.setAttribute(b,new pt(w.array.slice(0,a*w.itemSize),w.itemSize,w.normalized)),b in h)for(let _=0;_<h[b].length;_++){const T=h[b][_];y.morphAttributes[b][_]=new pt(T.array.slice(0,a*T.itemSize),T.itemSize,T.normalized)}}return y.setIndex(p),y}function r0(s,e){if(e===qa)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),s;if(e===gc||e===wd){let t=s.getIndex();if(t===null){const a=[],l=s.getAttribute("position");if(l===void 0)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),s;for(let u=0;u<l.count;u++)a.push(u);s.setIndex(a),t=s.getIndex()}const n=t.count-2,r=[];if(e===gc)for(let a=1;a<=n;a++)r.push(t.getX(0)),r.push(t.getX(a)),r.push(t.getX(a+1));else for(let a=0;a<n;a++)a%2==0?(r.push(t.getX(a)),r.push(t.getX(a+1)),r.push(t.getX(a+2))):(r.push(t.getX(a+2)),r.push(t.getX(a+1)),r.push(t.getX(a)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=s.clone();return i.setIndex(r),i.clearGroups(),i}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),s}function jS(s){const e=new D,t=new D,n=new D,r=new D,i=new D,a=new D,l=new D,u=new D,h=new D;function p(Me,Ae,De,pe,re,ye,Ce,_e){e.fromBufferAttribute(Ae,re),t.fromBufferAttribute(Ae,ye),n.fromBufferAttribute(Ae,Ce);const Ue=Me.morphTargetInfluences;if(De&&Ue){l.set(0,0,0),u.set(0,0,0),h.set(0,0,0);for(let H=0,k=De.length;H<k;H++){const ie=Ue[H],q=De[H];ie!==0&&(r.fromBufferAttribute(q,re),i.fromBufferAttribute(q,ye),a.fromBufferAttribute(q,Ce),pe?(l.addScaledVector(r,ie),u.addScaledVector(i,ie),h.addScaledVector(a,ie)):(l.addScaledVector(r.sub(e),ie),u.addScaledVector(i.sub(t),ie),h.addScaledVector(a.sub(n),ie)))}e.add(l),t.add(u),n.add(h)}Me.isSkinnedMesh&&(Me.boneTransform(re,e),Me.boneTransform(ye,t),Me.boneTransform(Ce,n)),_e[3*re+0]=e.x,_e[3*re+1]=e.y,_e[3*re+2]=e.z,_e[3*ye+0]=t.x,_e[3*ye+1]=t.y,_e[3*ye+2]=t.z,_e[3*Ce+0]=n.x,_e[3*Ce+1]=n.y,_e[3*Ce+2]=n.z}const f=s.geometry,m=s.material;let g,x,y;const b=f.index,w=f.attributes.position,_=f.morphAttributes.position,T=f.morphTargetsRelative,A=f.attributes.normal,R=f.morphAttributes.position,C=f.groups,I=f.drawRange;let G,U,j,N,J,le,oe;const xe=new Float32Array(w.count*w.itemSize),ge=new Float32Array(A.count*A.itemSize);if(b!==null)if(Array.isArray(m))for(G=0,j=C.length;G<j;G++)for(J=C[G],le=Math.max(J.start,I.start),oe=Math.min(J.start+J.count,I.start+I.count),U=le,N=oe;U<N;U+=3)g=b.getX(U),x=b.getX(U+1),y=b.getX(U+2),p(s,w,_,T,g,x,y,xe),p(s,A,R,T,g,x,y,ge);else for(le=Math.max(0,I.start),oe=Math.min(b.count,I.start+I.count),G=le,j=oe;G<j;G+=3)g=b.getX(G),x=b.getX(G+1),y=b.getX(G+2),p(s,w,_,T,g,x,y,xe),p(s,A,R,T,g,x,y,ge);else if(Array.isArray(m))for(G=0,j=C.length;G<j;G++)for(J=C[G],le=Math.max(J.start,I.start),oe=Math.min(J.start+J.count,I.start+I.count),U=le,N=oe;U<N;U+=3)g=U,x=U+1,y=U+2,p(s,w,_,T,g,x,y,xe),p(s,A,R,T,g,x,y,ge);else for(le=Math.max(0,I.start),oe=Math.min(w.count,I.start+I.count),G=le,j=oe;G<j;G+=3)g=G,x=G+1,y=G+2,p(s,w,_,T,g,x,y,xe),p(s,A,R,T,g,x,y,ge);return{positionAttribute:w,normalAttribute:A,morphedPositionAttribute:new He(xe,3),morphedNormalAttribute:new He(ge,3)}}function _1(s){if(s.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),s;let e=s.groups;if(e=e.sort(((a,l)=>a.materialIndex!==l.materialIndex?a.materialIndex-l.materialIndex:a.start-l.start)),s.getIndex()===null){const a=s.getAttribute("position"),l=[];for(let u=0;u<a.count;u+=3)l.push(u,u+1,u+2);s.setIndex(l)}const t=s.getIndex(),n=[];for(let a=0;a<e.length;a++){const l=e[a],u=l.start,h=u+l.count;for(let p=u;p<h;p++)n.push(t.getX(p))}s.dispose(),s.setIndex(n);let r=0;for(let a=0;a<e.length;a++){const l=e[a];l.start=r,r+=l.count}let i=e[0];s.groups=[i];for(let a=1;a<e.length;a++){const l=e[a];i.materialIndex===l.materialIndex?i.count+=l.count:(i=l,s.groups.push(i))}return s}function GS(s,e=Math.PI/3){const t=Math.cos(e),n=100*(1+1e-10),r=[new D,new D,new D],i=new D,a=new D,l=new D,u=new D;function h(y){return`${~~(y.x*n)},${~~(y.y*n)},${~~(y.z*n)}`}const p=s.toNonIndexed(),f=p.attributes.position,m={};for(let y=0,b=f.count/3;y<b;y++){const w=3*y,_=r[0].fromBufferAttribute(f,w+0),T=r[1].fromBufferAttribute(f,w+1),A=r[2].fromBufferAttribute(f,w+2);i.subVectors(A,T),a.subVectors(_,T);const R=new D().crossVectors(i,a).normalize();for(let C=0;C<3;C++){const I=h(r[C]);I in m||(m[I]=[]),m[I].push(R)}}const g=new Float32Array(3*f.count),x=new pt(g,3,!1);for(let y=0,b=f.count/3;y<b;y++){const w=3*y,_=r[0].fromBufferAttribute(f,w+0),T=r[1].fromBufferAttribute(f,w+1),A=r[2].fromBufferAttribute(f,w+2);i.subVectors(A,T),a.subVectors(_,T),l.crossVectors(i,a).normalize();for(let R=0;R<3;R++){const C=m[h(r[R])];u.set(0,0,0);for(let I=0,G=C.length;I<G;I++){const U=C[I];l.dot(U)>t&&u.add(U)}u.normalize(),x.setXYZ(w+R,u.x,u.y,u.z)}}return p.setAttribute("normal",x),p}const w1=new Ne,M1=new Ie;function VS(s){const e=new Cr,t=s.count,n=s.geometry,r=s.material;for(let i=0;i<t;i++){const a=new ht(n,r);s.getMatrixAt(i,a.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),e.add(a)}return e.copy(s),e.updateMatrixWorld(),e}function WS(s){if(Array.isArray(s.material)===!1)return console.warn("THREE.SceneUtils.createMeshesFromMultiMaterialMesh(): The given mesh has no multiple materials."),s;const e=new Cr;e.copy(s);const t=_1(s.geometry),n=t.index,r=t.groups,i=Object.keys(t.attributes);for(let a=0;a<r.length;a++){const l=r[a],u=l.start,h=u+l.count,p=new ut,f=s.material[l.materialIndex];for(let g=0;g<i.length;g++){const x=i[g],y=t.attributes[x],b=y.itemSize,w=l.count*b,_=new y.array.constructor(w),T=new pt(_,b);for(let A=u,R=0;A<h;A++,R++){const C=n.getX(A);b>=1&&T.setX(R,y.getX(C)),b>=2&&T.setY(R,y.getY(C)),b>=3&&T.setZ(R,y.getZ(C)),b>=4&&T.setW(R,y.getW(C))}p.setAttribute(x,T)}const m=new ht(p,f);e.add(m)}return e}function XS(s,e){const t=new Cr;for(let n=0,r=e.length;n<r;n++)t.add(new ht(s,e[n]));return t}function qS(s,e,t){let n=t;const r=new D;return s.updateWorldMatrix(!0,!0),s.traverseVisible((i=>{const{geometry:a}=i;if(a!==void 0){const{position:l}=a.attributes;if(l!==void 0)for(let u=0,h=l.count;u<h;u++)i.isMesh?i.getVertexPosition(u,r):r.fromBufferAttribute(l,u),i.isSkinnedMesh||r.applyMatrix4(i.matrixWorld),n=e(n,r)}})),n}function YS(s,e){const t=Om(s.instanceMatrix),n=s.instanceColor?Om(s.instanceColor):null,r=new Map;for(const a in s.geometry.attributes){const l=s.geometry.attributes[a];l.isInstancedBufferAttribute&&r.set(l,Om(l))}const i=[];for(let a=0;a<s.count;a++)i.push(a);i.sort(e);for(let a=0;a<i.length;a++){const l=i[a];M1.fromArray(t.array,l*s.instanceMatrix.itemSize),M1.toArray(s.instanceMatrix.array,a*s.instanceMatrix.itemSize),s.instanceColor&&(w1.fromArray(n.array,l*s.instanceColor.itemSize),w1.toArray(s.instanceColor.array,a*s.instanceColor.itemSize));for(const u in s.geometry.attributes){const h=s.geometry.attributes[u];if(h.isInstancedBufferAttribute){const p=r.get(h);h.setX(a,p.getX(l)),h.itemSize>1&&h.setY(a,p.getY(l)),h.itemSize>2&&h.setZ(a,p.getZ(l)),h.itemSize>3&&h.setW(a,p.getW(l))}}}}function $t(s,e,t=!1){for(let n in e){let r=e[n];if(r===void 0)continue;let i=n.split("-"),a=s,l=a;for(let u=0,h=i.length;u<h;u++)(t||l.hasOwnProperty(i[u]))&&(a=l[i[u]],u==h-1&&(a&&a.copy?a.copy(r):a instanceof Object?Object.assign(a,r):l[i[u]]=r),l=a)}return s}function QS(...s){let e=new Ne;return s.length===1?e.set(s[0]):s.length===3&&e.setRGB(s[0],s[1],s[2]),e}function ZS(s,e){return new ce(s,e??s)}function T1(s,e,t){return new D(s,e??s,t??s)}function KS(s,e,t,n){return new ot(s,e??s,t??s,n??s)}function E1(s,e,t){return new wr(s,e,t)}function JS(s,e,t,n){return new Jt(s,e,t,n)}function $S(s,e,t){let n={};s.traverse((a=>{if(a.visible&&a.isMesh&&a.geometry){if(t&&t(a))return;let l=a.geometry.uuid+a.material?.name;n[l]==null&&(n[l]={geometry:a.geometry,material:a.material,group:[]}),n[l].group.push(a)}}));let r=0,i=new Cr;for(let a in n){let l=n[a],{geometry:u,material:h,group:p}=l,f=new To(u,h,p.length);for(let m=p.length;m--;)p[m].updateWorldMatrix(!0,!1),f.setMatrixAt(m,p[m].matrixWorld);$t(f,e),i.add(f),r+=p.length}return i}function Nm(s){let e=s.split(".");return e.length>1?e.pop():""}function A1(s){let e=s.lastIndexOf("/");return e!==-1?s.substring(0,e):""}function i0(s,e){let t=s.split("/").pop();return e?t.replace(e,"").replace(".",""):t}function e_(){let s=new ut;return s.setAttribute("position",new He([-1,3,0,-1,-1,0,3,-1,0],3)),s.setAttribute("uv",new He([0,2,0,0,2,0],2)),s}class R1{texture;texCoords;meshCoords;constructor(e,t,n){this.texture=e,this.texCoords=t,this.meshCoords=n}}const t_={x:.5,y:.5};class L1{json;texture;_spriteFrames={};_animations={};constructor(e,t){this.json=e,this.texture=t;let n=e.meta.size,r=e.meta.scale/Math.max(n.w,n.h),i=e.frames;for(let a in i){let{frame:l,sourceSize:u,spriteSourceSize:h,anchor:p}=i[a],f=l.x/n.w,m=l.y/n.h,g=l.w/n.w,x=l.h/n.h,y=u,b=h,w=p||t_,_=r;this._spriteFrames[a]=new R1(t,new ot(f,1-(m+x),g,x),new ot(b.x+.5*b.w-y.w*w.x,-(b.y+.5*b.h-y.h*w.y),b.w,b.h).multiplyScalar(_))}for(let a in e.animations)this._animations[a]=e.animations[a].map((l=>this._spriteFrames[l]))}getAnimation(e){return this._animations[e]}getSpriteFrame(e){return this._spriteFrames[e]}}class Ql{name=""}class P1 extends Ql{extensions=["json"];load({url:e,file:t,onLoad:n,onProgress:r,onError:i}){return new Li().load(e,(a=>n(JSON.parse(a))),r,i,t)}}class C1 extends Ql{extensions=["png","jpg","webp","avif"];load({url:e,file:t,onLoad:n,onProgress:r,onError:i,settings:a}){new xm().load(e,(l=>n(Object.assign(l,a))),r,i,t)}}var D1=function(s){return URL.createObjectURL(new Blob([s],{type:"text/javascript"}))};try{URL.revokeObjectURL(D1(""))}catch{D1=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var za=Uint8Array,uu=Uint16Array,a0=Uint32Array,O1=new za([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),I1=new za([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),n_=new za([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),N1=function(s,e){for(var t=new uu(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];var r=new a0(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)r[i]=i-t[n]<<5|n;return[t,r]},k1=N1(O1,2),F1=k1[0],r_=k1[1];F1[28]=258,r_[258]=28;for(var U1=N1(I1,0),i_=U1[0],z1=(U1[1],new uu(32768)),Nn=0;Nn<32768;++Nn){var hu=(43690&Nn)>>>1|(21845&Nn)<<1;hu=(61680&(hu=(52428&hu)>>>2|(13107&hu)<<2))>>>4|(3855&hu)<<4,z1[Nn]=((65280&hu)>>>8|(255&hu)<<8)>>>1}var Ap=function(s,e,t){for(var n=s.length,r=0,i=new uu(e);r<n;++r)++i[s[r]-1];var a,l=new uu(e);for(r=0;r<e;++r)l[r]=l[r-1]+i[r-1]<<1;{a=new uu(1<<e);var u=15-e;for(r=0;r<n;++r)if(s[r])for(var h=r<<4|s[r],p=e-s[r],f=l[s[r]-1]++<<p,m=f|(1<<p)-1;f<=m;++f)a[z1[f]>>>u]=h}return a},Rp=new za(288);for(Nn=0;Nn<144;++Nn)Rp[Nn]=8;for(Nn=144;Nn<256;++Nn)Rp[Nn]=9;for(Nn=256;Nn<280;++Nn)Rp[Nn]=7;for(Nn=280;Nn<288;++Nn)Rp[Nn]=8;var B1=new za(32);for(Nn=0;Nn<32;++Nn)B1[Nn]=5;var a_=Ap(Rp,9),s_=Ap(B1,5),s0=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},ds=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(7&e)&t},o0=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(7&e)},o_=function(s){return(s/8|0)+(7&s&&1)},l_=function(s,e,t){(t==null||t>s.length)&&(t=s.length);var n=new(s instanceof uu?uu:s instanceof a0?a0:za)(t-e);return n.set(s.subarray(e,t)),n},c_=function(s,e,t){var n=s.length;if(!n||t&&!t.l&&n<5)return e||new za(0);var r=!e||t,i=!t||t.i;t||(t={}),e||(e=new za(3*n));var a=function(H){var k=e.length;if(H>k){var ie=new za(Math.max(2*k,H));ie.set(e),e=ie}},l=t.f||0,u=t.p||0,h=t.b||0,p=t.l,f=t.d,m=t.m,g=t.n,x=8*n;do{if(!p){t.f=l=ds(s,u,1);var y=ds(s,u+1,3);if(u+=3,!y){var b=s[(N=o_(u)+4)-4]|s[N-3]<<8,w=N+b;if(w>n){if(i)throw"unexpected EOF";break}r&&a(h+b),e.set(s.subarray(N,w),h),t.b=h+=b,t.p=u=8*w;continue}if(y==1)p=a_,f=s_,m=9,g=5;else{if(y!=2)throw"invalid block type";var _=ds(s,u,31)+257,T=ds(s,u+10,15)+4,A=_+ds(s,u+5,31)+1;u+=14;for(var R=new za(A),C=new za(19),I=0;I<T;++I)C[n_[I]]=ds(s,u+3*I,7);u+=3*T;var G=s0(C),U=(1<<G)-1,j=Ap(C,G);for(I=0;I<A;){var N,J=j[ds(s,u,U)];if(u+=15&J,(N=J>>>4)<16)R[I++]=N;else{var le=0,oe=0;for(N==16?(oe=3+ds(s,u,3),u+=2,le=R[I-1]):N==17?(oe=3+ds(s,u,7),u+=3):N==18&&(oe=11+ds(s,u,127),u+=7);oe--;)R[I++]=le}}var xe=R.subarray(0,_),ge=R.subarray(_);m=s0(xe),g=s0(ge),p=Ap(xe,m),f=Ap(ge,g)}if(u>x){if(i)throw"unexpected EOF";break}}r&&a(h+131072);for(var Me=(1<<m)-1,Ae=(1<<g)-1,De=u;;De=u){var pe=(le=p[o0(s,u)&Me])>>>4;if((u+=15&le)>x){if(i)throw"unexpected EOF";break}if(!le)throw"invalid length/literal";if(pe<256)e[h++]=pe;else{if(pe==256){De=u,p=null;break}var re=pe-254;if(pe>264){var ye=O1[I=pe-257];re=ds(s,u,(1<<ye)-1)+F1[I],u+=ye}var Ce=f[o0(s,u)&Ae],_e=Ce>>>4;if(!Ce)throw"invalid distance";if(u+=15&Ce,ge=i_[_e],_e>3&&(ye=I1[_e],ge+=o0(s,u)&(1<<ye)-1,u+=ye),u>x){if(i)throw"unexpected EOF";break}r&&a(h+131072);for(var Ue=h+re;h<Ue;h+=4)e[h]=e[h-ge],e[h+1]=e[h+1-ge],e[h+2]=e[h+2-ge],e[h+3]=e[h+3-ge];h=Ue}}t.l=p,t.p=De,t.b=h,p&&(l=1,t.m=m,t.d=f,t.n=g)}while(!l);return h==e.length?e:l_(e,0,h)},u_=new za(0),h_=function(s){if((15&s[0])!=8||s[0]>>>4>7||(s[0]<<8|s[1])%31)throw"invalid zlib data";if(32&s[1])throw"invalid zlib data: preset dictionaries not supported"};function d_(s,e){return c_((h_(s),s.subarray(2,-4)),e)}var p_=typeof TextDecoder<"u"&&new TextDecoder;try{p_.decode(u_,{stream:!0})}catch{}function H1(s,e,t){const n=t.length-s-1;if(e>=t[n])return n-1;if(e<=t[s])return s;let r=s,i=n,a=Math.floor((r+i)/2);for(;e<t[a]||e>=t[a+1];)e<t[a]?i=a:r=a,a=Math.floor((r+i)/2);return a}function f_(s,e,t,n){const r=[],i=[],a=[];r[0]=1;for(let l=1;l<=t;++l){i[l]=e-n[s+1-l],a[l]=n[s+l]-e;let u=0;for(let h=0;h<l;++h){const p=a[h+1],f=i[l-h],m=r[h]/(p+f);r[h]=u+p*m,u=f*m}r[l]=u}return r}function m_(s,e){let t=1;for(let r=2;r<=s;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=s-e;++r)n*=r;return t/n}function g_(s,e,t,n,r){const i=(function(a,l,u,h,p){const f=p<a?p:a,m=[],g=H1(a,h,l),x=(function(b,w,_,T,A){const R=[];for(let N=0;N<=_;++N)R[N]=0;const C=[];for(let N=0;N<=T;++N)C[N]=R.slice(0);const I=[];for(let N=0;N<=_;++N)I[N]=R.slice(0);I[0][0]=1;const G=R.slice(0),U=R.slice(0);for(let N=1;N<=_;++N){G[N]=w-A[b+1-N],U[N]=A[b+N]-w;let J=0;for(let le=0;le<N;++le){const oe=U[le+1],xe=G[N-le];I[N][le]=oe+xe;const ge=I[le][N-1]/I[N][le];I[le][N]=J+oe*ge,J=xe*ge}I[N][N]=J}for(let N=0;N<=_;++N)C[0][N]=I[N][_];for(let N=0;N<=_;++N){let J=0,le=1;const oe=[];for(let xe=0;xe<=_;++xe)oe[xe]=R.slice(0);oe[0][0]=1;for(let xe=1;xe<=T;++xe){let ge=0;const Me=N-xe,Ae=_-xe;N>=xe&&(oe[le][0]=oe[J][0]/I[Ae+1][Me],ge=oe[le][0]*I[Me][Ae]);const De=N-1<=Ae?xe-1:_-N;for(let re=Me>=-1?1:-Me;re<=De;++re)oe[le][re]=(oe[J][re]-oe[J][re-1])/I[Ae+1][Me+re],ge+=oe[le][re]*I[Me+re][Ae];N<=Ae&&(oe[le][xe]=-oe[J][xe-1]/I[Ae+1][N],ge+=oe[le][xe]*I[N][Ae]),C[xe][N]=ge;const pe=J;J=le,le=pe}}let j=_;for(let N=1;N<=T;++N){for(let J=0;J<=_;++J)C[N][J]*=j;j*=_-N}return C})(g,h,a,f,l),y=[];for(let b=0;b<u.length;++b){const w=u[b].clone(),_=w.w;w.x*=_,w.y*=_,w.z*=_,y[b]=w}for(let b=0;b<=f;++b){const w=y[g-a].clone().multiplyScalar(x[b][0]);for(let _=1;_<=a;++_)w.add(y[g-a+_].clone().multiplyScalar(x[b][_]));m[b]=w}for(let b=f+1;b<=p+1;++b)m[b]=new ot(0,0,0);return m})(s,e,t,n,r);return(function(a){const l=a.length,u=[],h=[];for(let f=0;f<l;++f){const m=a[f];u[f]=new D(m.x,m.y,m.z),h[f]=m.w}const p=[];for(let f=0;f<l;++f){const m=u[f].clone();for(let g=1;g<=f;++g)m.sub(p[f-g].clone().multiplyScalar(m_(f,g)*h[g]));p[f]=m.divideScalar(h[0])}return p})(i)}class v_ extends Ei{constructor(e,t,n,r,i){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||this.knots.length-1;for(let a=0;a<n.length;++a){const l=n[a];this.controlPoints[a]=new ot(l.x,l.y,l.z,l.w)}}getPoint(e,t=new D){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=(function(a,l,u,h){const p=H1(a,h,l),f=f_(p,h,a,l),m=new ot(0,0,0,0);for(let g=0;g<=a;++g){const x=u[p-a+g],y=f[g],b=x.w*y;m.x+=x.x*b,m.y+=x.y*b,m.z+=x.z*b,m.w+=x.w*y}return m})(this.degree,this.knots,this.controlPoints,r);return i.w!==1&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(e,t=new D){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=g_(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}}let Ht,dr,Qi;class y_ extends ci{constructor(e){super(e)}load(e,t,n,r,i){const a=this,l=a.path===""?ru.extractUrlBase(e):a.path,u=new Li(this.manager);u.setPath(a.path),u.setResponseType("arraybuffer"),u.setRequestHeader(a.requestHeader),u.setWithCredentials(a.withCredentials),u.load(e,(function(h){try{t(a.parse(h,l))}catch(p){r?r(p):console.error(p),a.manager.itemError(e)}}),n,r,i?.mainFile)}parse(e,t){if((function(r){const i="Kaydara FBX Binary  \0";return r.byteLength>=i.length&&i===q1(r,0,i.length)})(e))Ht=new w_().parse(e);else{const r=q1(e);if(!(function(i){const a=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let l=0;function u(h){const p=i[h-1];return i=i.slice(l+h),l++,p}for(let h=0;h<a.length;++h)if(u(1)===a[h])return!1;return!0})(r))throw new Error("THREE.FBXLoader: Unknown format.");if(V1(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+V1(r));Ht=new __().parse(r)}const n=new xm(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new x_(n,this.manager).parse(Ht)}}class x_{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){dr=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),i=new b_().parse(r);return this.parseScene(r,i,n),Qi}parseConnections(){const e=new Map;return"Connections"in Ht&&Ht.Connections.connections.forEach((function(t){const n=t[0],r=t[1],i=t[2];e.has(n)||e.set(n,{parents:[],children:[]});const a={ID:r,relationship:i};e.get(n).parents.push(a),e.has(r)||e.set(r,{parents:[],children:[]});const l={ID:n,relationship:i};e.get(r).children.push(l)})),e}parseImages(){const e={},t={};if("Video"in Ht.Objects){const n=Ht.Objects.Video;for(const r in n){const i=n[r];if(e[parseInt(r)]=i.RelativeFilename||i.Filename,"Content"in i){const a=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,l=typeof i.Content=="string"&&i.Content!=="";if(a||l){const u=this.parseImage(n[r]);t[i.RelativeFilename||i.Filename]=u}}}}for(const n in e){const r=e[n];t[r]!==void 0?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),i="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if(typeof t=="string")return"data:"+i+";base64,"+t;{const a=new Uint8Array(t);return window.URL.createObjectURL(new Blob([a],{type:i}))}}parseTextures(e){const t=new Map;if("Texture"in Ht.Objects){const n=Ht.Objects.Texture;for(const r in n){const i=this.parseTexture(n[r],e);t.set(parseInt(r),i)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,i=e.WrapModeV,a=r!==void 0?r.value:0,l=i!==void 0?i.value:0;if(n.wrapS=a===0?$r:Gn,n.wrapT=l===0?$r:Gn,"Scaling"in e){const u=e.Scaling.value;n.repeat.x=u[0],n.repeat.y=u[1]}if("Translation"in e){const u=e.Translation.value;n.offset.x=u[0],n.offset.y=u[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,i=dr.get(e.id).children;let a;i!==void 0&&i.length>0&&t[i[0].ID]!==void 0&&(n=t[i[0].ID],n.indexOf("blob:")!==0&&n.indexOf("data:")!==0||this.textureLoader.setPath(void 0));const l=e.FileName.slice(-3).toLowerCase();if(l==="tga"){const u=this.manager.getHandler(".tga");u===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new pn):(u.setPath(this.textureLoader.path),a=u.load(n))}else l==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new pn):a=this.textureLoader.load(n);return this.textureLoader.setPath(r),a}parseMaterials(e){const t=new Map;if("Material"in Ht.Objects){const n=Ht.Objects.Material;for(const r in n){const i=this.parseMaterial(n[r],e);i!==null&&t.set(parseInt(r),i)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let i=e.ShadingModel;if(typeof i=="object"&&(i=i.value),!dr.has(n))return null;const a=this.parseParameters(e,t,n);let l;switch(i.toLowerCase()){case"phong":l=new Zc;break;case"lambert":l=new Ug;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),l=new Zc}return l.setValues(a),l.name=r,l}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=new Ne().fromArray(e.Diffuse.value):!e.DiffuseColor||e.DiffuseColor.type!=="Color"&&e.DiffuseColor.type!=="ColorRGB"||(r.color=new Ne().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=new Ne().fromArray(e.Emissive.value):!e.EmissiveColor||e.EmissiveColor.type!=="Color"&&e.EmissiveColor.type!=="ColorRGB"||(r.emissive=new Ne().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=new Ne().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=new Ne().fromArray(e.SpecularColor.value));const i=this;return dr.get(n).children.forEach((function(a){const l=a.relationship;switch(l){case"Bump":r.bumpMap=i.getTexture(t,a.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(t,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(t,a.ID),r.map!==void 0&&(r.map.encoding=Ct);break;case"DisplacementColor":r.displacementMap=i.getTexture(t,a.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(t,a.ID),r.emissiveMap!==void 0&&(r.emissiveMap.encoding=Ct);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(t,a.ID);break;case"ReflectionColor":r.envMap=i.getTexture(t,a.ID),r.envMap!==void 0&&(r.envMap.mapping=ys,r.envMap.encoding=Ct);break;case"SpecularColor":r.specularMap=i.getTexture(t,a.ID),r.specularMap!==void 0&&(r.specularMap.encoding=Ct);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(t,a.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",l)}})),r}getTexture(e,t){return"LayeredTexture"in Ht.Objects&&t in Ht.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=dr.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Ht.Objects){const n=Ht.Objects.Deformer;for(const r in n){const i=n[r],a=dr.get(parseInt(r));if(i.attrType==="Skin"){const l=this.parseSkeleton(a,n);l.ID=r,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=a.parents[0].ID,e[r]=l}else if(i.attrType==="BlendShape"){const l={id:r};l.rawTargets=this.parseMorphTargets(a,n),l.id=r,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=l}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach((function(r){const i=t[r.ID];if(i.attrType!=="Cluster")return;const a={ID:r.ID,indices:[],weights:[],transformLink:new Ie().fromArray(i.TransformLink.a)};"Indexes"in i&&(a.indices=i.Indexes.a,a.weights=i.Weights.a),n.push(a)})),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const i=e.children[r],a=t[i.ID],l={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;l.geoID=dr.get(parseInt(i.ID)).children.filter((function(u){return u.relationship===void 0}))[0].ID,n.push(l)}return n}parseScene(e,t,n){Qi=new Cr;const r=this.parseModels(e.skeletons,t,n),i=Ht.Objects.Model,a=this;r.forEach((function(u){const h=i[u.ID];a.setLookAtProperties(u,h),dr.get(u.ID).parents.forEach((function(p){const f=r.get(p.ID);f!==void 0&&f.add(u)})),u.parent===null&&Qi.add(u)})),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),Qi.traverse((function(u){if(u.userData.transformData){u.parent&&(u.userData.transformData.parentMatrix=u.parent.matrix,u.userData.transformData.parentMatrixWorld=u.parent.matrixWorld);const h=W1(u.userData.transformData);u.applyMatrix4(h),u.updateWorldMatrix()}}));const l=new S_().parse();Qi.children.length===1&&Qi.children[0].isGroup&&(Qi.children[0].animations=l,Qi=Qi.children[0]),Qi.animations=l}parseModels(e,t,n){const r=new Map,i=Ht.Objects.Model;for(const a in i){const l=parseInt(a),u=i[a],h=dr.get(l);let p=this.buildSkeleton(h,e,l,u.attrName);if(!p){switch(u.attrType){case"Camera":p=this.createCamera(h);break;case"Light":p=this.createLight(h);break;case"Mesh":p=this.createMesh(h,t,n);break;case"NurbsCurve":p=this.createCurve(h,t);break;case"LimbNode":case"Root":p=new fa;break;default:p=new Cr}p.name=u.attrName?kt.sanitizeNodeName(u.attrName):"",p.ID=l}this.getTransformData(p,u),r.set(l,p)}return r}buildSkeleton(e,t,n,r){let i=null;return e.parents.forEach((function(a){for(const l in t){const u=t[l];u.rawBones.forEach((function(h,p){if(h.ID===a.ID){const f=i;i=new fa,i.matrixWorld.copy(h.transformLink),i.name=r?kt.sanitizeNodeName(r):"",i.ID=n,u.bones[p]=i,f!==null&&i.add(f)}}))}})),i}createCamera(e){let t,n;if(e.children.forEach((function(r){const i=Ht.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)})),n===void 0)t=new St;else{let r=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(r=1);let i=1;n.NearPlane!==void 0&&(i=n.NearPlane.value/1e3);let a=1e3;n.FarPlane!==void 0&&(a=n.FarPlane.value/1e3);let l=window.innerWidth,u=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(l=n.AspectWidth.value,u=n.AspectHeight.value);const h=l/u;let p=45;n.FieldOfView!==void 0&&(p=n.FieldOfView.value);const f=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new vn(p,h,i,a),f!==null&&t.setFocalLength(f);break;case 1:t=new Pr(-l/2,l/2,u/2,-u/2,i,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new St}}return t}createLight(e){let t,n;if(e.children.forEach((function(r){const i=Ht.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)})),n===void 0)t=new St;else{let r;r=n.LightType===void 0?0:n.LightType.value;let i=16777215;n.Color!==void 0&&(i=new Ne().fromArray(n.Color.value));let a=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(a=0);let l=0;n.FarAttenuationEnd!==void 0&&(l=n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?0:n.FarAttenuationEnd.value);const u=1;switch(r){case 0:t=new Tp(i,a,l,u);break;case 1:t=new Sm(i,a);break;case 2:let h=Math.PI/3;n.InnerAngle!==void 0&&(h=Kn.degToRad(n.InnerAngle.value));let p=0;n.OuterAngle!==void 0&&(p=Kn.degToRad(n.OuterAngle.value),p=Math.max(p,1)),t=new bm(i,a,l,h,p,u);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Tp(i,a)}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,i=null,a=null;const l=[];return e.children.forEach((function(u){t.has(u.ID)&&(i=t.get(u.ID)),n.has(u.ID)&&l.push(n.get(u.ID))})),l.length>1?a=l:l.length>0?a=l[0]:(a=new Zc({color:13421772}),l.push(a)),"color"in i.attributes&&l.forEach((function(u){u.vertexColors=!0})),i.FBX_Deformer?(r=new Nr(i,a),r.normalizeSkinWeights()):r=new ht(i,a),r}createCurve(e,t){const n=e.children.reduce((function(i,a){return t.has(a.ID)&&(i=t.get(a.ID)),i}),null),r=new cr({color:3342591,linewidth:1});return new qi(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?X1(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&dr.get(e.ID).children.forEach((function(n){if(n.relationship==="LookAtProperty"){const r=Ht.Objects.Model[n.ID];if("Lcl_Translation"in r){const i=r.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(i),Qi.add(e.target)):e.lookAt(new D().fromArray(i))}}}))}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const i in e){const a=e[i];dr.get(parseInt(a.ID)).parents.forEach((function(l){if(t.has(l.ID)){const u=l.ID;dr.get(u).parents.forEach((function(h){n.has(h.ID)&&n.get(h.ID).bind(new as(a.bones),r[h.ID])}))}}))}}parsePoseNodes(){const e={};if("Pose"in Ht.Objects){const t=Ht.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach((function(i){e[i.Node]=new Ie().fromArray(i.Matrix.a)})):e[r.Node]=new Ie().fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in Ht&&"AmbientColor"in Ht.GlobalSettings){const e=Ht.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(t!==0||n!==0||r!==0){const i=new Ne(t,n,r);Qi.add(new Yg(i,1))}}}}class b_{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in Ht.Objects){const n=Ht.Objects.Geometry;for(const r in n){const i=dr.get(parseInt(r)),a=this.parseGeometry(i,n[r],e);t.set(parseInt(r),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,i=[],a=e.parents.map((function(f){return Ht.Objects.Model[f.ID]}));if(a.length===0)return;const l=e.children.reduce((function(f,m){return r[m.ID]!==void 0&&(f=r[m.ID]),f}),null);e.children.forEach((function(f){n.morphTargets[f.ID]!==void 0&&i.push(n.morphTargets[f.ID])}));const u=a[0],h={};"RotationOrder"in u&&(h.eulerOrder=X1(u.RotationOrder.value)),"InheritType"in u&&(h.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(h.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(h.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(h.scale=u.GeometricScaling.value);const p=W1(h);return this.genGeometry(t,l,i,p)}genGeometry(e,t,n,r){const i=new ut;e.attrName&&(i.name=e.attrName);const a=this.parseGeoNode(e,t),l=this.genBuffers(a),u=new He(l.vertex,3);if(u.applyMatrix4(r),i.setAttribute("position",u),l.colors.length>0&&i.setAttribute("color",new He(l.colors,3)),t&&(i.setAttribute("skinIndex",new ua(l.weightsIndices,4)),i.setAttribute("skinWeight",new He(l.vertexWeights,4)),i.FBX_Deformer=t),l.normal.length>0){const h=new Jn().getNormalMatrix(r),p=new He(l.normal,3);p.applyNormalMatrix(h),i.setAttribute("normal",p)}if(l.uvs.forEach((function(h,p){let f="uv"+(p+1).toString();p===0&&(f="uv"),i.setAttribute(f,new He(l.uvs[p],2))})),a.material&&a.material.mappingType!=="AllSame"){let h=l.materialIndex[0],p=0;if(l.materialIndex.forEach((function(f,m){f!==h&&(i.addGroup(p,m-p,h),h=f,p=m)})),i.groups.length>0){const f=i.groups[i.groups.length-1],m=f.start+f.count;m!==l.materialIndex.length&&i.addGroup(m,l.materialIndex.length-m,h)}i.groups.length===0&&i.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return this.addMorphTargets(i,e,n,r),i}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach((function(r,i){r.indices.forEach((function(a,l){n.weightTable[a]===void 0&&(n.weightTable[a]=[]),n.weightTable[a].push({id:i,weight:r.weights[l]})}))}))),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,i=!1,a=[],l=[],u=[],h=[],p=[],f=[];const m=this;return e.vertexIndices.forEach((function(g,x){let y,b=!1;g<0&&(g^=-1,b=!0);let w=[],_=[];if(a.push(3*g,3*g+1,3*g+2),e.color){const T=km(x,n,g,e.color);u.push(T[0],T[1],T[2])}if(e.skeleton){if(e.weightTable[g]!==void 0&&e.weightTable[g].forEach((function(T){_.push(T.weight),w.push(T.id)})),_.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const T=[0,0,0,0],A=[0,0,0,0];_.forEach((function(R,C){let I=R,G=w[C];A.forEach((function(U,j,N){if(I>U){N[j]=I,I=U;const J=T[j];T[j]=G,G=J}}))})),w=T,_=A}for(;_.length<4;)_.push(0),w.push(0);for(let T=0;T<4;++T)p.push(_[T]),f.push(w[T])}if(e.normal){const T=km(x,n,g,e.normal);l.push(T[0],T[1],T[2])}e.material&&e.material.mappingType!=="AllSame"&&(y=km(x,n,g,e.material)[0],y<0&&(m.negativeMaterialIndices=!0,y=0)),e.uv&&e.uv.forEach((function(T,A){const R=km(x,n,g,T);h[A]===void 0&&(h[A]=[]),h[A].push(R[0]),h[A].push(R[1])})),r++,b&&(r>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),m.genFace(t,e,a,y,l,u,h,p,f,r),n++,r=0,a=[],l=[],u=[],h=[],p=[],f=[])})),t}genFace(e,t,n,r,i,a,l,u,h,p){for(let f=2;f<p;f++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(f-1)]]),e.vertex.push(t.vertexPositions[n[3*(f-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(f-1)+2]]),e.vertex.push(t.vertexPositions[n[3*f]]),e.vertex.push(t.vertexPositions[n[3*f+1]]),e.vertex.push(t.vertexPositions[n[3*f+2]]),t.skeleton&&(e.vertexWeights.push(u[0]),e.vertexWeights.push(u[1]),e.vertexWeights.push(u[2]),e.vertexWeights.push(u[3]),e.vertexWeights.push(u[4*(f-1)]),e.vertexWeights.push(u[4*(f-1)+1]),e.vertexWeights.push(u[4*(f-1)+2]),e.vertexWeights.push(u[4*(f-1)+3]),e.vertexWeights.push(u[4*f]),e.vertexWeights.push(u[4*f+1]),e.vertexWeights.push(u[4*f+2]),e.vertexWeights.push(u[4*f+3]),e.weightsIndices.push(h[0]),e.weightsIndices.push(h[1]),e.weightsIndices.push(h[2]),e.weightsIndices.push(h[3]),e.weightsIndices.push(h[4*(f-1)]),e.weightsIndices.push(h[4*(f-1)+1]),e.weightsIndices.push(h[4*(f-1)+2]),e.weightsIndices.push(h[4*(f-1)+3]),e.weightsIndices.push(h[4*f]),e.weightsIndices.push(h[4*f+1]),e.weightsIndices.push(h[4*f+2]),e.weightsIndices.push(h[4*f+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(f-1)]),e.colors.push(a[3*(f-1)+1]),e.colors.push(a[3*(f-1)+2]),e.colors.push(a[3*f]),e.colors.push(a[3*f+1]),e.colors.push(a[3*f+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(f-1)]),e.normal.push(i[3*(f-1)+1]),e.normal.push(i[3*(f-1)+2]),e.normal.push(i[3*f]),e.normal.push(i[3*f+1]),e.normal.push(i[3*f+2])),t.uv&&t.uv.forEach((function(m,g){e.uvs[g]===void 0&&(e.uvs[g]=[]),e.uvs[g].push(l[g][0]),e.uvs[g].push(l[g][1]),e.uvs[g].push(l[g][2*(f-1)]),e.uvs[g].push(l[g][2*(f-1)+1]),e.uvs[g].push(l[g][2*f]),e.uvs[g].push(l[g][2*f+1])}))}addMorphTargets(e,t,n,r){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const i=this;n.forEach((function(a){a.rawTargets.forEach((function(l){const u=Ht.Objects.Geometry[l.geoID];u!==void 0&&i.genMorphGeometry(e,t,u,r,l.name)}))}))}genMorphGeometry(e,t,n,r,i){const a=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],l=n.Vertices!==void 0?n.Vertices.a:[],u=n.Indexes!==void 0?n.Indexes.a:[],h=3*e.attributes.position.count,p=new Float32Array(h);for(let x=0;x<u.length;x++){const y=3*u[x];p[y]=l[3*x],p[y+1]=l[3*x+1],p[y+2]=l[3*x+2]}const f={vertexIndices:a,vertexPositions:p},m=this.genBuffers(f),g=new He(m.vertex,3);g.name=i||n.attrName,g.applyMatrix4(r),e.morphAttributes.position.push(g)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let i=[];return n==="IndexToDirect"&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let i=[];return n==="IndexToDirect"&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let i=[];return n==="IndexToDirect"&&(i=e.ColorIndex.a),{dataSize:4,buffer:r,indices:i,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,i=[];for(let a=0;a<r.length;++a)i.push(a);return{dataSize:1,buffer:r,indices:i,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new ut;const n=t-1,r=e.KnotVector.a,i=[],a=e.Points.a;for(let p=0,f=a.length;p<f;p+=4)i.push(new ot().fromArray(a,p));let l,u;if(e.Form==="Closed")i.push(i[0]);else if(e.Form==="Periodic"){l=n,u=r.length-1-l;for(let p=0;p<n;++p)i.push(i[p])}const h=new v_(n,r,i,l,u).getPoints(12*i.length);return new ut().setFromPoints(h)}}class S_{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const r=t[n],i=this.addClip(r);e.push(i)}return e}parseClips(){if(Ht.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Ht.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const i={id:r.id,attr:r.attrName,curves:{}};t.set(i.id,i)}}return t}parseAnimationCurves(e){const t=Ht.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(M_),values:t[n].KeyValueFloat.a},i=dr.get(r.id);if(i!==void 0){const a=i.parents[0].ID,l=i.parents[0].relationship;l.match(/X/)?e.get(a).curves.x=r:l.match(/Y/)?e.get(a).curves.y=r:l.match(/Z/)?e.get(a).curves.z=r:l.match(/d|DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=r)}}}parseAnimationLayers(e){const t=Ht.Objects.AnimationLayer,n=new Map;for(const r in t){const i=[],a=dr.get(parseInt(r));a!==void 0&&(a.children.forEach((function(l,u){if(e.has(l.ID)){const h=e.get(l.ID);if(h.curves.x!==void 0||h.curves.y!==void 0||h.curves.z!==void 0){if(i[u]===void 0){const p=dr.get(l.ID).parents.filter((function(f){return f.relationship!==void 0}))[0].ID;if(p!==void 0){const f=Ht.Objects.Model[p.toString()];if(f===void 0)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const m={modelName:f.attrName?kt.sanitizeNodeName(f.attrName):"",ID:f.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Qi.traverse((function(g){g.ID===f.id&&(m.transform=g.matrix,g.userData.transformData&&(m.eulerOrder=g.userData.transformData.eulerOrder))})),m.transform||(m.transform=new Ie),"PreRotation"in f&&(m.preRotation=f.PreRotation.value),"PostRotation"in f&&(m.postRotation=f.PostRotation.value),i[u]=m}}i[u]&&(i[u][h.attr]=h)}else if(h.curves.morph!==void 0){if(i[u]===void 0){const p=dr.get(l.ID).parents.filter((function(b){return b.relationship!==void 0}))[0].ID,f=dr.get(p).parents[0].ID,m=dr.get(f).parents[0].ID,g=dr.get(m).parents[0].ID,x=Ht.Objects.Model[g],y={modelName:x.attrName?kt.sanitizeNodeName(x.attrName):"",morphName:Ht.Objects.Deformer[p].attrName};i[u]=y}i[u][h.attr]=h}}})),n.set(parseInt(r),i))}return n}parseAnimStacks(e){const t=Ht.Objects.AnimationStack,n={};for(const r in t){const i=dr.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(i[0].ID);n[r]={name:t[r].attrName,layer:a}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach((function(r){t=t.concat(n.generateTracks(r))})),new nu(e.name,-1,t)}generateTracks(e){const t=[];let n=new D,r=new Jt,i=new D;if(e.transform&&e.transform.decompose(n,r,i),n=n.toArray(),r=new wr().setFromQuaternion(r,e.eulerOrder).toArray(),i=i.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");a!==void 0&&t.push(a)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const a=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);a!==void 0&&t.push(a)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");a!==void 0&&t.push(a)}if(e.DeformPercent!==void 0){const a=this.generateMorphTrack(e);a!==void 0&&t.push(a)}return t}generateVectorTrack(e,t,n,r){const i=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(i,t,n);return new tu(e+"."+r,i,a)}generateRotationTrack(e,t,n,r,i,a){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(Kn.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(Kn.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(Kn.degToRad));const l=this.getTimesForAllAxes(t),u=this.getKeyframeTrackValues(l,t,n);r!==void 0&&((r=r.map(Kn.degToRad)).push(a),r=new wr().fromArray(r),r=new Jt().setFromEuler(r)),i!==void 0&&((i=i.map(Kn.degToRad)).push(a),i=new wr().fromArray(i),i=new Jt().setFromEuler(i).invert());const h=new Jt,p=new wr,f=[];for(let m=0;m<u.length;m+=3)p.set(u[m],u[m+1],u[m+2],a),h.setFromEuler(p),r!==void 0&&h.premultiply(r),i!==void 0&&h.multiply(i),h.toArray(f,m/3*4);return new Lo(e+".quaternion",l,f)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map((function(i){return i/100})),r=Qi.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new $c(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort((function(n,r){return n-r})),t.length>1){let n=1,r=t[0];for(let i=1;i<t.length;i++){const a=t[i];a!==r&&(t[n]=a,r=a,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,i=[];let a=-1,l=-1,u=-1;return e.forEach((function(h){if(t.x&&(a=t.x.times.indexOf(h)),t.y&&(l=t.y.times.indexOf(h)),t.z&&(u=t.z.times.indexOf(h)),a!==-1){const p=t.x.values[a];i.push(p),r[0]=p}else i.push(r[0]);if(l!==-1){const p=t.y.values[l];i.push(p),r[1]=p}else i.push(r[1]);if(u!==-1){const p=t.z.values[u];i.push(p),r[2]=p}else i.push(r[2])})),i}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,i=Math.abs(r);if(i>=180){const a=i/180,l=r/a;let u=n+l;const h=e.times[t-1],p=(e.times[t]-h)/a;let f=h+p;const m=[],g=[];for(;f<e.times[t];)m.push(f),f+=p,g.push(u),u+=l;e.times=Y1(e.times,t,m),e.values=Y1(e.values,t,g)}}}}class __{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new G1,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach((function(r,i){const a=r.match(/^[\s\t]*;/),l=r.match(/^[\s\t]*$/);if(a||l)return;const u=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),h=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),p=r.match("^\\t{"+(t.currentIndent-1)+"}}");u?t.parseNodeBegin(r,u):h?t.parseNodeProperty(r,h,n[++i]):p?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)})),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map((function(u){return u.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:n},a=this.parseNodeAttr(r),l=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,i):n in l?(n==="PoseNode"?l.PoseNode.push(i):l[n].id!==void 0&&(l[n]={},l[n][l[n].id]=l[n]),a.id!==""&&(l[n][a.id]=i)):typeof a.id=="number"?(l[n]={},l[n][a.id]=i):n!=="Properties70"&&(l[n]=n==="PoseNode"?[i]:i),typeof a.id=="number"&&(i.id=a.id),a.name!==""&&(i.attrName=a.name),a.type!==""&&(i.attrType=a.type),this.pushStack(i)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&i===","&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name!=="Properties70"){if(r==="C"){const l=i.split(",").slice(1),u=parseInt(l[0]),h=parseInt(l[1]);let p=i.split(",").slice(3);p=p.map((function(f){return f.trim().replace(/^"/,"")})),r="connections",i=[u,h],(function(f,m){for(let g=0,x=f.length,y=m.length;g<y;g++,x++)f[x]=m[g]})(i,p),a[r]===void 0&&(a[r]=[])}r==="Node"&&(a.id=i),r in a&&Array.isArray(a[r])?a[r].push(i):r!=="a"?a[r]=i:a.a=i,this.setCurrentProp(a,r),r==="a"&&i.slice(-1)!==","&&(a.a=c0(i))}else this.parseNodeSpecialProperty(e,r,i)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=c0(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map((function(p){return p.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=r[0],a=r[1],l=r[2],u=r[3];let h=r[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=c0(h)}this.getPrevNode()[i]={type:a,type2:l,flag:u,value:h},this.setCurrentProp(this.getPrevNode(),i)}}class w_{parse(e){const t=new j1(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new G1;for(;!this.endOfContent(t);){const i=this.parseNode(t,n);i!==null&&r.add(i.name,i)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),l=e.getString(a);if(r===0)return null;const u=[];for(let m=0;m<i;m++)u.push(this.parseProperty(e));const h=u.length>0?u[0]:"",p=u.length>1?u[1]:"",f=u.length>2?u[2]:"";for(n.singleProperty=i===1&&e.getOffset()===r;r>e.getOffset();){const m=this.parseNode(e,t);m!==null&&this.parseSubNode(l,n,m)}return n.propertyList=u,typeof h=="number"&&(n.id=h),p!==""&&(n.attrName=p),f!==""&&(n.attrType=f),l!==""&&(n.name=l),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if(e==="Connections"&&n.name==="C"){const r=[];n.propertyList.forEach((function(i,a){a!==0&&r.push(i)})),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(n.name==="Properties70")Object.keys(n).forEach((function(r){t[r]=n[r]}));else if(e==="Properties70"&&n.name==="P"){let r=n.propertyList[0],i=n.propertyList[1];const a=n.propertyList[2],l=n.propertyList[3];let u;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),u=i==="Color"||i==="ColorRGB"||i==="Vector"||i==="Vector3D"||i.indexOf("Lcl_")===0?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[r]={type:i,type2:a,flag:l,value:u}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(i===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const l=d_(new Uint8Array(e.getArrayBuffer(a))),u=new j1(l.buffer);switch(t){case"b":case"c":return u.getBooleanArray(r);case"d":return u.getFloat64Array(r);case"f":return u.getFloat32Array(r);case"i":return u.getInt32Array(r);case"l":return u.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class j1{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t===void 0||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=n.indexOf(0);return r>=0&&(n=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(n)}}class G1{add(e,t){this[e]=t}}function V1(s){const e=s.match(/FBXVersion: (\d+)/);if(e)return parseInt(e[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function M_(s){return s/46186158e3}const T_=[];function km(s,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=s;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(r=n.indices[r]);const i=r*n.dataSize,a=i+n.dataSize;return(function(l,u,h,p){for(let f=h,m=0;f<p;f++,m++)l[m]=u[f];return l})(T_,n.buffer,i,a)}const l0=new wr,Wh=new D;function W1(s){const e=new Ie,t=new Ie,n=new Ie,r=new Ie,i=new Ie,a=new Ie,l=new Ie,u=new Ie,h=new Ie,p=new Ie,f=new Ie,m=new Ie,g=s.inheritType?s.inheritType:0;if(s.translation&&e.setPosition(Wh.fromArray(s.translation)),s.preRotation){const j=s.preRotation.map(Kn.degToRad);j.push(s.eulerOrder||wr.DEFAULT_ORDER),t.makeRotationFromEuler(l0.fromArray(j))}if(s.rotation){const j=s.rotation.map(Kn.degToRad);j.push(s.eulerOrder||wr.DEFAULT_ORDER),n.makeRotationFromEuler(l0.fromArray(j))}if(s.postRotation){const j=s.postRotation.map(Kn.degToRad);j.push(s.eulerOrder||wr.DEFAULT_ORDER),r.makeRotationFromEuler(l0.fromArray(j)),r.invert()}s.scale&&i.scale(Wh.fromArray(s.scale)),s.scalingOffset&&l.setPosition(Wh.fromArray(s.scalingOffset)),s.scalingPivot&&a.setPosition(Wh.fromArray(s.scalingPivot)),s.rotationOffset&&u.setPosition(Wh.fromArray(s.rotationOffset)),s.rotationPivot&&h.setPosition(Wh.fromArray(s.rotationPivot)),s.parentMatrixWorld&&(f.copy(s.parentMatrix),p.copy(s.parentMatrixWorld));const x=t.clone().multiply(n).multiply(r),y=new Ie;y.extractRotation(p);const b=new Ie;b.copyPosition(p);const w=b.clone().invert().multiply(p),_=y.clone().invert().multiply(w),T=i,A=new Ie;if(g===0)A.copy(y).multiply(x).multiply(_).multiply(T);else if(g===1)A.copy(y).multiply(_).multiply(x).multiply(T);else{const j=new Ie().scale(new D().setFromMatrixScale(f)).clone().invert(),N=_.clone().multiply(j);A.copy(y).multiply(x).multiply(N).multiply(T)}const R=h.clone().invert(),C=a.clone().invert();let I=e.clone().multiply(u).multiply(h).multiply(t).multiply(n).multiply(r).multiply(R).multiply(l).multiply(a).multiply(i).multiply(C);const G=new Ie().copyPosition(I),U=p.clone().multiply(G);return m.copyPosition(U),I=m.clone().multiply(A),I.premultiply(p.invert()),I}function X1(s){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return(s=s||0)===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[s]}function c0(s){return s.split(",").map((function(e){return parseFloat(e)}))}function q1(s,e,t){return e===void 0&&(e=0),t===void 0&&(t=s.byteLength),new TextDecoder().decode(new Uint8Array(s,e,t))}function Y1(s,e,t){return s.slice(0,e).concat(t).concat(s.slice(e))}const u0=new WeakMap;class E_ extends ci{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const i=new Li(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(a=>{this.parse(a,t,r)}),n,r)}parse(e,t,n){this.decodeDracoFile(e,t,null,null,Sr).catch(n)}decodeDracoFile(e,t,n,r,i=aa){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:i};return this.decodeGeometry(e,a).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(u0.has(e)){const u=u0.get(e);if(u.key===n)return u.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const i=this.workerNextTaskID++,a=e.byteLength,l=this._getWorker(i,a).then((u=>(r=u,new Promise(((h,p)=>{r._callbacks[i]={resolve:h,reject:p},r.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))))).then((u=>this._createGeometry(u.geometry)));return l.catch((()=>!0)).then((()=>{r&&i&&this._releaseTask(r,i)})),u0.set(e,{key:n,promise:l}),l}_createGeometry(e){const t=new ut;e.index&&t.setIndex(new pt(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],i=r.name,a=r.array,l=r.itemSize,u=new pt(a,l);i==="color"&&this._assignVertexColorSpace(u,r.vertexColorSpace),t.setAttribute(i,u)}return t}_assignVertexColorSpace(e,t){if(t!==Sr)return;const n=new Ne;for(let r=0,i=e.count;r<i;r++)n.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new Li(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((r,i)=>{n.load(e,r,void 0,i)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const i=A_.toString(),a=["/* draco decoder */",r,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(i){const a=i.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort((function(r,i){return r._taskLoad>i._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){this.workerPool.map((e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function A_(){let s,e;function t(n,r,i,a,l,u){const h=u.num_components(),p=i.num_points()*h,f=p*l.BYTES_PER_ELEMENT,m=(function(y,b){switch(b){case Float32Array:return y.DT_FLOAT32;case Int8Array:return y.DT_INT8;case Int16Array:return y.DT_INT16;case Int32Array:return y.DT_INT32;case Uint8Array:return y.DT_UINT8;case Uint16Array:return y.DT_UINT16;case Uint32Array:return y.DT_UINT32}})(n,l),g=n._malloc(f);r.GetAttributeDataArrayForAllPoints(i,u,m,f,g);const x=new l(n.HEAPF32.buffer,g,p).slice();return n._free(g),{name:a,array:x,itemSize:h}}onmessage=function(n){const r=n.data;switch(r.type){case"init":s=r.decoderConfig,e=new Promise((function(l){s.onModuleLoaded=function(u){l({draco:u})},DracoDecoderModule(s)}));break;case"decode":const i=r.buffer,a=r.taskConfig;e.then((l=>{const u=l.draco,h=new u.Decoder;try{const p=(function(m,g,x,y){const b=y.attributeIDs,w=y.attributeTypes;let _,T;const A=g.GetEncodedGeometryType(x);if(A===m.TRIANGULAR_MESH)_=new m.Mesh,T=g.DecodeArrayToMesh(x,x.byteLength,_);else{if(A!==m.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");_=new m.PointCloud,T=g.DecodeArrayToPointCloud(x,x.byteLength,_)}if(!T.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+T.error_msg());const R={index:null,attributes:[]};for(const C in b){const I=self[w[C]];let G,U;if(y.useUniqueIDs)U=b[C],G=g.GetAttributeByUniqueId(_,U);else{if(U=g.GetAttributeId(_,m[b[C]]),U===-1)continue;G=g.GetAttribute(_,U)}const j=t(m,g,_,C,I,G);C==="color"&&(j.vertexColorSpace=y.vertexColorSpace),R.attributes.push(j)}return A===m.TRIANGULAR_MESH&&(R.index=(function(C,I,G){const U=G.num_faces(),j=3*U,N=4*j,J=C._malloc(N);I.GetTrianglesUInt32Array(G,N,J);const le=new Uint32Array(C.HEAPF32.buffer,J,j).slice();return C._free(J),{array:le,itemSize:1}})(m,g,_)),m.destroy(_),R})(u,h,new Int8Array(i),a),f=p.attributes.map((m=>m.array.buffer));p.index&&f.push(p.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:p},f)}catch(p){console.error(p),self.postMessage({type:"error",id:r.id,error:p.message})}finally{u.destroy(h)}}))}}}class R_ extends ci{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new O_(t)})),this.register((function(t){return new B_(t)})),this.register((function(t){return new H_(t)})),this.register((function(t){return new j_(t)})),this.register((function(t){return new N_(t)})),this.register((function(t){return new k_(t)})),this.register((function(t){return new F_(t)})),this.register((function(t){return new U_(t)})),this.register((function(t){return new D_(t)})),this.register((function(t){return new z_(t)})),this.register((function(t){return new I_(t)})),this.register((function(t){return new P_(t)})),this.register((function(t){return new G_(t)})),this.register((function(t){return new V_(t)}))}load(e,t,n,r,i){const a=this;let l;l=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:ru.extractUrlBase(e),this.manager.itemStart(e);const u=function(p){r?r(p):console.error(p),a.manager.itemError(e),a.manager.itemEnd(e)},h=new Li(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,(function(p){try{a.parse(p,l,(function(f){t(f),a.manager.itemEnd(e)}),u,i?.additionalFiles)}catch(f){u(f)}}),n,u,i?.mainFile)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r,i){let a;const l={},u={},h=new TextDecoder;if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(h.decode(new Uint8Array(e,0,4))===Q1){try{l[Yt.KHR_BINARY_GLTF]=new q_(e)}catch(f){return void(r&&r(f))}a=JSON.parse(l[Yt.KHR_BINARY_GLTF].content)}else a=JSON.parse(h.decode(e));else a=e;if(a.asset===void 0||a.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const p=new sw(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const m=this.pluginCallbacks[f](p);u[m.name]=m,l[m.name]=!0}if(a.extensionsUsed)for(let f=0;f<a.extensionsUsed.length;++f){const m=a.extensionsUsed[f],g=a.extensionsRequired||[];switch(m){case Yt.KHR_MATERIALS_UNLIT:l[m]=new C_;break;case Yt.KHR_DRACO_MESH_COMPRESSION:l[m]=new Y_(a,this.dracoLoader);break;case Yt.KHR_TEXTURE_TRANSFORM:l[m]=new Q_;break;case Yt.KHR_MESH_QUANTIZATION:l[m]=new Z_;break;default:g.indexOf(m)>=0&&u[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}a.additionalFiles=i,p.setExtensions(l),p.setPlugins(u),p.parse(n,r)}parseAsync(e,t){const n=this;return new Promise((function(r,i){n.parse(e,t,r,i)}))}}function L_(){let s={};return{get:function(e){return s[e]},add:function(e,t){s[e]=t},remove:function(e){delete s[e]},removeAll:function(){s={}}}}const Yt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class P_{constructor(e){this.parser=e,this.name=Yt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const i=t[n];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const i=t.json,a=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let l;const u=new Ne(16777215);a.color!==void 0&&u.fromArray(a.color);const h=a.range!==void 0?a.range:0;switch(a.type){case"directional":l=new Sm(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Tp(u),l.distance=h;break;case"spot":l=new bm(u),l.distance=h,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),l.decay=2,Zl(l,a),a.intensity!==void 0&&(l.intensity=a.intensity),l.name=t.createUniqueName(a.name||"light_"+e),r=Promise.resolve(l),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return i===void 0?null:this._loadLight(i).then((function(a){return n._getNodeRef(t.cache,i,a)}))}}class C_{constructor(){this.name=Yt.KHR_MATERIALS_UNLIT}getMaterialType(){return mr}extendParams(e,t,n){const r=[];e.color=new Ne(1,1,1),e.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}i.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",i.baseColorTexture,Ct))}return Promise.all(r)}}class D_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class O_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const l=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ce(l,l)}return Promise.all(i)}}class I_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&i.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&i.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(i)}}class N_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new Ne(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];return a.sheenColorFactor!==void 0&&t.sheenColor.fromArray(a.sheenColorFactor),a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Ct)),a.sheenRoughnessTexture!==void 0&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}class k_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&i.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}class F_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const l=a.attenuationColor||[1,1,1];return t.attenuationColor=new Ne(l[0],l[1],l[2]),Promise.all(i)}}class U_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class z_{constructor(e){this.parser=e,this.name=Yt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Fr:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const l=a.specularColorFactor||[1,1,1];return t.specularColor=new Ne(l[0],l[1],l[2]),a.specularColorTexture!==void 0&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,Ct)),Promise.all(i)}}class B_{constructor(e){this.parser=e,this.name=Yt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,a)}}class H_{constructor(e){this.parser=e,this.name=Yt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const a=i.extensions[t],l=r.images[a.source];let u=n.textureLoader;if(l.uri){const h=n.options.manager.getHandler(l.uri);h!==null&&(u=h)}return this.detectSupport().then((function(h){if(h)return n.loadTextureImage(e,a.source,u);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}}))),this.isSupported}}class j_{constructor(e){this.parser=e,this.name=Yt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const a=i.extensions[t],l=r.images[a.source];let u=n.textureLoader;if(l.uri){const h=n.options.manager.getHandler(l.uri);h!==null&&(u=h)}return this.detectSupport().then((function(h){if(h)return n.loadTextureImage(e,a.source,u);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}}))),this.isSupported}}class G_{constructor(e){this.name=Yt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then((function(l){const u=r.byteOffset||0,h=r.byteLength||0,p=r.count,f=r.byteStride,m=new Uint8Array(l,u,h);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(p,f,m,r.mode,r.filter).then((function(g){return g.buffer})):a.ready.then((function(){const g=new ArrayBuffer(p*f);return a.decodeGltfBuffer(new Uint8Array(g),p,f,m,r.mode,r.filter),g}))}))}return null}}class V_{constructor(e){this.name=Yt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=t.meshes[n.mesh];for(const u of r.primitives)if(u.mode!==Ba.TRIANGLES&&u.mode!==Ba.TRIANGLE_STRIP&&u.mode!==Ba.TRIANGLE_FAN&&u.mode!==void 0)return null;const i=n.extensions[this.name].attributes,a=[],l={};for(const u in i)a.push(this.parser.getDependency("accessor",i[u]).then((h=>(l[u]=h,l[u]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then((u=>{const h=u.pop(),p=h.isGroup?h.children:[h],f=u[0].count,m=[];for(const g of p){const x=new Ie,y=new D,b=new Jt,w=new D(1,1,1),_=new To(g.geometry,g.material,f);for(let T=0;T<f;T++)l.TRANSLATION&&y.fromBufferAttribute(l.TRANSLATION,T),l.ROTATION&&b.fromBufferAttribute(l.ROTATION,T),l.SCALE&&w.fromBufferAttribute(l.SCALE,T),_.setMatrixAt(T,x.compose(y,b,w));for(const T in l)T!=="TRANSLATION"&&T!=="ROTATION"&&T!=="SCALE"&&g.geometry.setAttribute(T,l[T]);St.prototype.copy.call(_,g),_.frustumCulled=!1,this.parser.assignFinalMaterial(_),m.push(_)}return h.isGroup?(h.clear(),h.add(...m),h):m[0]})))}}const Q1="glTF",W_=1313821514,X_=5130562;class q_{constructor(e){this.name=Yt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Q1)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,i=new DataView(e,12);let a=0;for(;a<r;){const l=i.getUint32(a,!0);a+=4;const u=i.getUint32(a,!0);if(a+=4,u===W_){const h=new Uint8Array(e,12+a,l);this.content=n.decode(h)}else if(u===X_){const h=12+a;this.body=e.slice(h,h+l)}a+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Y_{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Yt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,l={},u={},h={};for(const p in a){const f=d0[p]||p.toLowerCase();l[f]=a[p]}for(const p in e.attributes){const f=d0[p]||p.toLowerCase();if(a[p]!==void 0){const m=n.accessors[e.attributes[p]],g=Xh[m.componentType];h[f]=g.name,u[f]=m.normalized===!0}}return t.getDependency("bufferView",i).then((function(p){return new Promise((function(f){r.decodeDracoFile(p,(function(m){for(const g in m.attributes){const x=m.attributes[g],y=u[g];y!==void 0&&(x.normalized=y)}f(m)}),l,h)}))}))}}class Q_{constructor(){this.name=Yt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Z_{constructor(){this.name=Yt.KHR_MESH_QUANTIZATION}}class Z1 extends Gh{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r;for(let a=0;a!==r;a++)t[a]=n[i+a];return t}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=2*l,h=3*l,p=r-t,f=(n-t)/p,m=f*f,g=m*f,x=e*h,y=x-h,b=-2*g+3*m,w=g-m,_=1-b,T=w-m+f;for(let A=0;A!==l;A++){const R=a[y+A+l],C=a[y+A+u]*p,I=a[x+A+l],G=a[x+A]*p;i[A]=_*R+T*C+b*I+w*G}return i}}const K_=new Jt;class J_ extends Z1{interpolate_(e,t,n,r){const i=super.interpolate_(e,t,n,r);return K_.fromArray(i).normalize().toArray(i),i}}const Ba={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Xh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},K1={9728:Wt,9729:_t,9984:Xs,9985:hc,9986:ia,9987:Oi},J1={33071:Gn,33648:xs,10497:$r},h0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},d0={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},qh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},$_={CUBICSPLINE:void 0,LINEAR:Xa,STEP:Qs},ew="OPAQUE",tw="MASK",nw="BLEND";function Lp(s,e,t){for(const n in t.extensions)s[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Zl(s,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(s.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function rw(s,e){if(s.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)s.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(s.morphTargetInfluences.length===t.length){s.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)s.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function iw(s){const e=s.extensions&&s.extensions[Yt.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+$1(e.attributes):s.indices+":"+$1(s.attributes)+":"+s.mode,t}function $1(s){let e="";const t=Object.keys(s).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+s[t[n]]+";";return e}function p0(s){switch(s){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const aw=new Ie;class sw{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new L_,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,i=-1;typeof navigator<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,i=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&i<98?this.textureLoader=new xm(this.options.manager):this.textureLoader=new Bv(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Li(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(a){return a._markDefs&&a._markDefs()})),Promise.all(this._invokeAll((function(a){return a.beforeRoot&&a.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(a){const l={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:n,userData:{}};Lp(i,l,r),Zl(l,r),Promise.all(n._invokeAll((function(u){return u.afterRoot&&u.afterRoot(l)}))).then((function(){e(l)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,i=t.length;r<i;r++){const a=t[r].joints;for(let l=0,u=a.length;l<u;l++)e[a[l]].isBone=!0}for(let r=0,i=e.length;r<i;r++){const a=e[r];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(n[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),i=(a,l)=>{const u=this.associations.get(a);u!=null&&this.associations.set(l,u);for(const[h,p]of a.children.entries())i(p,l.children[h])};return i(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const i=e(t[r]);i&&n.push(i)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(i){return i.loadNode&&i.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(i){return i.loadMesh&&i.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(i){return i.loadBufferView&&i.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(i){return i.loadMaterial&&i.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(i){return i.loadTexture&&i.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(i){return i.loadAnimation&&i.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne((function(i){return i!=this&&i.getDependency&&i.getDependency(e,t)})),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map((function(i,a){return n.getDependency(e,a)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Yt.KHR_BINARY_GLTF].body);let r=this.json.additionalFiles,i=r?r.find((l=>l.name===t.uri)):null;const a=this.options;return new Promise((function(l,u){n.load(ru.resolveURL(t.uri,a.path),l,void 0,(function(){u(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}),i)}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(n){const r=t.byteLength||0,i=t.byteOffset||0;return n.slice(i,i+r)}))}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const a=h0[r.type],l=Xh[r.componentType],u=r.normalized===!0,h=new l(r.count*a);return Promise.resolve(new pt(h,a,u))}const i=[];return r.bufferView!==void 0?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),r.sparse!==void 0&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(a){const l=a[0],u=h0[r.type],h=Xh[r.componentType],p=h.BYTES_PER_ELEMENT,f=p*u,m=r.byteOffset||0,g=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,x=r.normalized===!0;let y,b;if(g&&g!==f){const w=Math.floor(m/g),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+w+":"+r.count;let T=t.cache.get(_);T||(y=new h(l,w*g,r.count*g/p),T=new Ds(y,g/p),t.cache.add(_,T)),b=new Or(T,u,m%g/p,x)}else y=l===null?new h(r.count*u):new h(l,m,r.count*u),b=new pt(y,u,x);if(r.sparse!==void 0){const w=h0.SCALAR,_=Xh[r.sparse.indices.componentType],T=r.sparse.indices.byteOffset||0,A=r.sparse.values.byteOffset||0,R=new _(a[1],T,r.sparse.count*w),C=new h(a[2],A,r.sparse.count*u);l!==null&&(b=new pt(b.array.slice(),b.itemSize,b.normalized));for(let I=0,G=R.length;I<G;I++){const U=R[I];if(b.setX(U,C[I*u]),u>=2&&b.setY(U,C[I*u+1]),u>=3&&b.setZ(U,C[I*u+2]),u>=4&&b.setW(U,C[I*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return b}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r];let a=this.textureLoader;if(i.uri){const l=n.manager.getHandler(i.uri);l!==null&&(a=l)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,t,n){const r=this,i=this.json,a=i.textures[e],l=i.images[t],u=(l.uri||l.bufferView)+":"+a.sampler;if(this.textureCache[u])return this.textureCache[u];const h=this.loadImageSource(t,n).then((function(p){p.flipY=!1,p.name=a.name||l.name||"";const f=(i.samplers||{})[a.sampler]||{};return p.magFilter=K1[f.magFilter]||_t,p.minFilter=K1[f.minFilter]||Oi,p.wrapS=J1[f.wrapS]||$r,p.wrapT=J1[f.wrapT]||$r,r.associations.set(p,{textures:e}),p})).catch((function(){return null}));return this.textureCache[u]=h,h}loadImageSource(e,t){const n=this,r=this.json,i=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then((f=>f.clone()));const a=r.images[e],l=self.URL||self.webkitURL;let u=a.uri||"",h=!1;if(a.bufferView!==void 0)u=n.getDependency("bufferView",a.bufferView).then((function(f){h=!0;const m=new Blob([f],{type:a.mimeType});return u=l.createObjectURL(m),u}));else{if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");if(r.additionalFiles){let f=u.split("\\").pop().split("/").pop(),m=r.additionalFiles.find((g=>f===g.name));m&&(u=Lv(m))}}const p=Promise.resolve(u).then((function(f){return new Promise((function(m,g){let x=m;t.isImageBitmapLoader===!0&&(x=function(y){const b=new pn(y);b.needsUpdate=!0,m(b)}),t.load(ru.resolveURL(f,i.path),x,void 0,g)}))})).then((function(f){var m;return h===!0&&l.revokeObjectURL(u),f.userData.mimeType=a.mimeType||((m=a.uri).search(/\.jpe?g($|\?)/i)>0||m.search(/^data\:image\/jpeg/)===0?"image/jpeg":m.search(/\.webp($|\?)/i)>0||m.search(/^data\:image\/webp/)===0?"image/webp":"image/png"),f})).catch((function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",u),f}));return this.sourceCache[e]=p,p}assignTexture(e,t,n,r){const i=this;return this.getDependency("texture",n.index).then((function(a){if(!a)return null;if(n.texCoord===void 0||n.texCoord==0||t==="aoMap"&&n.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),i.extensions[Yt.KHR_TEXTURE_TRANSFORM]){const l=n.extensions!==void 0?n.extensions[Yt.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const u=i.associations.get(a);a=i.extensions[Yt.KHR_TEXTURE_TRANSFORM].extendTexture(a,l),i.associations.set(a,u)}}return r!==void 0&&(a.encoding=r),e[t]=a,a}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,i=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const l="PointsMaterial:"+n.uuid;let u=this.cache.get(l);u||(u=new li,an.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(l,u)),n=u}else if(e.isLine){const l="LineBasicMaterial:"+n.uuid;let u=this.cache.get(l);u||(u=new cr,an.prototype.copy.call(u,n),u.color.copy(n.color),this.cache.add(l,u)),n=u}if(r||i||a){let l="ClonedMaterial:"+n.uuid+":";r&&(l+="derivative-tangents:"),i&&(l+="vertex-colors:"),a&&(l+="flat-shading:");let u=this.cache.get(l);u||(u=n.clone(),i&&(u.vertexColors=!0),a&&(u.flatShading=!0),r&&(u.normalScale&&(u.normalScale.y*=-1),u.clearcoatNormalScale&&(u.clearcoatNormalScale.y*=-1)),this.cache.add(l,u),this.associations.set(u,this.associations.get(n))),n=u}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return st}loadMaterial(e){const t=this,n=this.json,r=this.extensions,i=n.materials[e];let a;const l={},u=[];if((i.extensions||{})[Yt.KHR_MATERIALS_UNLIT]){const p=r[Yt.KHR_MATERIALS_UNLIT];a=p.getMaterialType(),u.push(p.extendParams(l,i,t))}else{const p=i.pbrMetallicRoughness||{};if(l.color=new Ne(1,1,1),l.opacity=1,Array.isArray(p.baseColorFactor)){const f=p.baseColorFactor;l.color.fromArray(f),l.opacity=f[3]}p.baseColorTexture!==void 0&&u.push(t.assignTexture(l,"map",p.baseColorTexture,Ct)),l.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,l.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(l,"metalnessMap",p.metallicRoughnessTexture)),u.push(t.assignTexture(l,"roughnessMap",p.metallicRoughnessTexture))),a=this._invokeOne((function(f){return f.getMaterialType&&f.getMaterialType(e)})),u.push(Promise.all(this._invokeAll((function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,l)}))))}i.doubleSided===!0&&(l.side=We);const h=i.alphaMode||ew;if(h===nw?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,h===tw&&(l.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&a!==mr&&(u.push(t.assignTexture(l,"normalMap",i.normalTexture)),l.normalScale=new ce(1,1),i.normalTexture.scale!==void 0)){const p=i.normalTexture.scale;l.normalScale.set(p,p)}return i.occlusionTexture!==void 0&&a!==mr&&(u.push(t.assignTexture(l,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&a!==mr&&(l.emissive=new Ne().fromArray(i.emissiveFactor)),i.emissiveTexture!==void 0&&a!==mr&&u.push(t.assignTexture(l,"emissiveMap",i.emissiveTexture,Ct)),Promise.all(u).then((function(){const p=new a(l);return i.name&&(p.name=i.name),Zl(p,i),t.associations.set(p,{materials:e}),i.extensions&&Lp(r,p,i),p}))}createUniqueName(e){const t=kt.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function i(l){return n[Yt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then((function(u){return ey(u,l,t)}))}const a=[];for(let l=0,u=e.length;l<u;l++){const h=e[l],p=iw(h),f=r[p];if(f)a.push(f.promise);else{let m;m=h.extensions&&h.extensions[Yt.KHR_DRACO_MESH_COMPRESSION]?i(h):ey(new ut,h,t),r[p]={primitive:h,promise:m},a.push(m)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,r=this.extensions,i=n.meshes[e],a=i.primitives,l=[];for(let h=0,p=a.length;h<p;h++){const f=a[h].material===void 0?((u=this.cache).DefaultMaterial===void 0&&(u.DefaultMaterial=new st({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Se})),u.DefaultMaterial):this.getDependency("material",a[h].material);l.push(f)}var u;return l.push(t.loadGeometries(a)),Promise.all(l).then((function(h){const p=h.slice(0,h.length-1),f=h[h.length-1],m=[];for(let x=0,y=f.length;x<y;x++){const b=f[x],w=a[x];let _;const T=p[x];if(w.mode===Ba.TRIANGLES||w.mode===Ba.TRIANGLE_STRIP||w.mode===Ba.TRIANGLE_FAN||w.mode===void 0)_=i.isSkinnedMesh===!0?new Nr(b,T):new ht(b,T),_.isSkinnedMesh===!0&&_.normalizeSkinWeights(),w.mode===Ba.TRIANGLE_STRIP?_.geometry=r0(_.geometry,wd):w.mode===Ba.TRIANGLE_FAN&&(_.geometry=r0(_.geometry,gc));else if(w.mode===Ba.LINES)_=new En(b,T);else if(w.mode===Ba.LINE_STRIP)_=new qi(b,T);else if(w.mode===Ba.LINE_LOOP)_=new Na(b,T);else{if(w.mode!==Ba.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);_=new mp(b,T)}Object.keys(_.geometry.morphAttributes).length>0&&rw(_,i),_.name=t.createUniqueName(i.name||"mesh_"+e),Zl(_,i),w.extensions&&Lp(r,_,w),t.assignFinalMaterial(_),m.push(_)}for(let x=0,y=m.length;x<y;x++)t.associations.set(m[x],{meshes:e,primitives:x});if(m.length===1)return m[0];const g=new Cr;t.associations.set(g,{meshes:e});for(let x=0,y=m.length;x<y;x++)g.add(m[x]);return g}))}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return n.type==="perspective"?t=new vn(Kn.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new Pr(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Zl(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,i=t.joints.length;r<i;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(r){const i=r.pop(),a=r,l=[],u=[];for(let h=0,p=a.length;h<p;h++){const f=a[h];if(f){l.push(f);const m=new Ie;i!==null&&m.fromArray(i.array,16*h),u.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new as(l,u)}))}loadAnimation(e){const t=this.json.animations[e],n=[],r=[],i=[],a=[],l=[];for(let u=0,h=t.channels.length;u<h;u++){const p=t.channels[u],f=t.samplers[p.sampler],m=p.target,g=m.node,x=t.parameters!==void 0?t.parameters[f.input]:f.input,y=t.parameters!==void 0?t.parameters[f.output]:f.output;n.push(this.getDependency("node",g)),r.push(this.getDependency("accessor",x)),i.push(this.getDependency("accessor",y)),a.push(f),l.push(m)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(l)]).then((function(u){const h=u[0],p=u[1],f=u[2],m=u[3],g=u[4],x=[];for(let b=0,w=h.length;b<w;b++){const _=h[b],T=p[b],A=f[b],R=m[b],C=g[b];if(_===void 0)continue;let I;switch(_.updateMatrix(),qh[C.path]){case qh.weights:I=$c;break;case qh.rotation:I=Lo;break;default:I=tu}const G=_.name?_.name:_.uuid,U=R.interpolation!==void 0?$_[R.interpolation]:Xa,j=[];qh[C.path]===qh.weights?_.traverse((function(J){J.morphTargetInfluences&&j.push(J.name?J.name:J.uuid)})):j.push(G);let N=A.array;if(A.normalized){const J=p0(N.constructor),le=new Float32Array(N.length);for(let oe=0,xe=N.length;oe<xe;oe++)le[oe]=N[oe]*J;N=le}for(let J=0,le=j.length;J<le;J++){const oe=new I(j[J]+"."+qh[C.path],T.array,N,U);R.interpolation==="CUBICSPLINE"&&(oe.createInterpolant=function(xe){return new(this instanceof Lo?J_:Z1)(this.times,this.values,this.getValueSize()/3,xe)},oe.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),x.push(oe)}}const y=t.name?t.name:"animation_"+e;return new nu(y,void 0,x)}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then((function(i){const a=n._getNodeRef(n.meshCache,r.mesh,i);return r.weights!==void 0&&a.traverse((function(l){if(l.isMesh)for(let u=0,h=r.weights.length;u<h;u++)l.morphTargetInfluences[u]=r.weights[u]})),a}))}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),i=[],a=n.children||[];for(let u=0,h=a.length;u<h;u++)i.push(t.getDependency("node",a[u]));const l=n.skin===void 0?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(i),l]).then((function(u){const h=u[0],p=u[1],f=u[2];f!==null&&h.traverse((function(m){m.isSkinnedMesh&&m.bind(f,aw)}));for(let m=0,g=p.length;m<g;m++)h.add(p[m]);return h}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const i=t.nodes[e],a=i.name?r.createUniqueName(i.name):"",l=[],u=r._invokeOne((function(h){return h.createNodeMesh&&h.createNodeMesh(e)}));return u&&l.push(u),i.camera!==void 0&&l.push(r.getDependency("camera",i.camera).then((function(h){return r._getNodeRef(r.cameraCache,i.camera,h)}))),r._invokeAll((function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)})).forEach((function(h){l.push(h)})),this.nodeCache[e]=Promise.all(l).then((function(h){let p;if(p=i.isBone===!0?new fa:h.length>1?new Cr:h.length===1?h[0]:new St,p!==h[0])for(let f=0,m=h.length;f<m;f++)p.add(h[f]);if(i.name&&(p.userData.name=i.name,p.name=a),Zl(p,i),i.extensions&&Lp(n,p,i),i.matrix!==void 0){const f=new Ie;f.fromArray(i.matrix),p.applyMatrix4(f)}else i.translation!==void 0&&p.position.fromArray(i.translation),i.rotation!==void 0&&p.quaternion.fromArray(i.rotation),i.scale!==void 0&&p.scale.fromArray(i.scale);return r.associations.has(p)||r.associations.set(p,{}),r.associations.get(p).nodes=e,p})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,i=new Cr;n.name&&(i.name=r.createUniqueName(n.name)),Zl(i,n),n.extensions&&Lp(t,i,n);const a=n.nodes||[],l=[];for(let u=0,h=a.length;u<h;u++)l.push(r.getDependency("node",a[u]));return Promise.all(l).then((function(u){for(let h=0,p=u.length;h<p;h++)i.add(u[h]);return r.associations=(h=>{const p=new Map;for(const[f,m]of r.associations)(f instanceof an||f instanceof pn)&&p.set(f,m);return h.traverse((f=>{const m=r.associations.get(f);m!=null&&p.set(f,m)})),p})(i),i}))}}function ey(s,e,t){const n=e.attributes,r=[];function i(a,l){return t.getDependency("accessor",a).then((function(u){s.setAttribute(l,u)}))}for(const a in n){const l=d0[a]||a.toLowerCase();l in s.attributes||r.push(i(n[a],l))}if(e.indices!==void 0&&!s.index){const a=t.getDependency("accessor",e.indices).then((function(l){s.setIndex(l)}));r.push(a)}return Zl(s,e),(function(a,l,u){const h=l.attributes,p=new ba;if(h.POSITION===void 0)return;{const g=u.json.accessors[h.POSITION],x=g.min,y=g.max;if(x===void 0||y===void 0)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(p.set(new D(x[0],x[1],x[2]),new D(y[0],y[1],y[2])),g.normalized){const b=p0(Xh[g.componentType]);p.min.multiplyScalar(b),p.max.multiplyScalar(b)}}const f=l.targets;if(f!==void 0){const g=new D,x=new D;for(let y=0,b=f.length;y<b;y++){const w=f[y];if(w.POSITION!==void 0){const _=u.json.accessors[w.POSITION],T=_.min,A=_.max;if(T!==void 0&&A!==void 0){if(x.setX(Math.max(Math.abs(T[0]),Math.abs(A[0]))),x.setY(Math.max(Math.abs(T[1]),Math.abs(A[1]))),x.setZ(Math.max(Math.abs(T[2]),Math.abs(A[2]))),_.normalized){const R=p0(Xh[_.componentType]);x.multiplyScalar(R)}g.max(x)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}p.expandByVector(g)}a.boundingBox=p;const m=new zi;p.getCenter(m.center),m.radius=p.min.distanceTo(p.max)/2,a.boundingSphere=m})(s,e,t),Promise.all(r).then((function(){return e.targets!==void 0?(function(a,l,u){let h=!1,p=!1,f=!1;for(let y=0,b=l.length;y<b;y++){const w=l[y];if(w.POSITION!==void 0&&(h=!0),w.NORMAL!==void 0&&(p=!0),w.COLOR_0!==void 0&&(f=!0),h&&p&&f)break}if(!h&&!p&&!f)return Promise.resolve(a);const m=[],g=[],x=[];for(let y=0,b=l.length;y<b;y++){const w=l[y];if(h){const _=w.POSITION!==void 0?u.getDependency("accessor",w.POSITION):a.attributes.position;m.push(_)}if(p){const _=w.NORMAL!==void 0?u.getDependency("accessor",w.NORMAL):a.attributes.normal;g.push(_)}if(f){const _=w.COLOR_0!==void 0?u.getDependency("accessor",w.COLOR_0):a.attributes.color;x.push(_)}}return Promise.all([Promise.all(m),Promise.all(g),Promise.all(x)]).then((function(y){const b=y[0],w=y[1],_=y[2];return h&&(a.morphAttributes.position=b),p&&(a.morphAttributes.normal=w),f&&(a.morphAttributes.color=_),a.morphTargetsRelative=!0,a}))})(s,e.targets,t):s}))}var Yh,ow=(function(){var s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var t,n=WebAssembly.validate(s)?"b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;t9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;h8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgohAaoclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;uzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:EPliuo97eue978Jjjjjbca9Rhidndnadcl9hmbdnaec98GglTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaiaeciGgvcdtgdVcbczad9R;8kbaiabalcdtfglad;8qbbdnavTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkalaiad;8qbbskdnaec98GgxTmbcbhvabhdinadczfglalpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgvax6mbkkaxae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabaxcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbhdabheinaeaepbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbaeczfheadclfgdav6mbkkdnaval9pmbaialciGgdcdtgeVcbc;abae9R;8kbaiabavcdtfgvae;8qbbdnadTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiae;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb":"b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:P8Yqdbk;3sezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfgocl4cifcd4hxdndndndnaoc9WGgmTmbcbhPcehsawcjdfhzalhHinaraH9Rax6midnaraHaxfgl9RcK6mbczhoinawcj;cbfaogifgoc9WfhOdndndndndnaHaic9WfgAco4fRbbaAci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOalRblalRbbgAco4gCaCciSgCE86bbaocGfalclfaCfgORbbaAcl4ciGgCaCciSgCE86bbaocVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbaoc7faOaCfgORbbaAciGgAaAciSgAE86bbaoctfaOaAfgARbbalRbegOco4gCaCciSgCE86bbaoc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc93faAaCfgARbbaOciGgOaOciSgOE86bbaoc94faAaOfgARbbalRbdgOco4gCaCciSgCE86bbaoc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc97faAaCfgARbbaOciGgOaOciSgOE86bbaoc98faAaOfgORbbalRbiglco4gAaAciSgAE86bbaoc99faOaAfgORbbalcl4ciGgAaAciSgAE86bbaoc9:faOaAfgORbbalcd4ciGgAaAciSgAE86bbaocufaOaAfgoRbbalciGglalciSglE86bbaoalfhlxdkaOalRbwalRbbgAcl4gCaCcsSgCE86bbaocGfalcwfaCfgORbbaAcsGgAaAcsSgAE86bbaocVfaOaAfgORbbalRbegAcl4gCaCcsSgCE86bbaoc7faOaCfgORbbaAcsGgAaAcsSgAE86bbaoctfaOaAfgORbbalRbdgAcl4gCaCcsSgCE86bbaoc91faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc4faOaAfgORbbalRbigAcl4gCaCcsSgCE86bbaoc93faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc94faOaAfgORbbalRblgAcl4gCaCcsSgCE86bbaoc95faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc96faOaAfgORbbalRbvgAcl4gCaCcsSgCE86bbaoc97faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc98faOaAfgORbbalRbogAcl4gCaCcsSgCE86bbaoc99faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc9:faOaAfgORbbalRbrglcl4gAaAcsSgAE86bbaocufaOaAfgoRbbalcsGglalcsSglE86bbaoalfhlxekaOal8Pbb83bbaOcwfalcwf8Pbb83bbalczfhlkdnaiam9pmbaiczfhoaral9RcL0mekkaiam6mialTmidnakTmbawaPfRbbhOcbhoazhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkkazcefhzaPcefgPad6hsalhHaPad9hmexvkkcbhlasceGmdxikalaxad2fhCdnakTmbcbhHcehsawcjdfhminaral9Rax6mialTmdalaxfhlawaHfRbbhOcbhoamhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkamcefhmaHcefgHad6hsaHad9hmbkaChlxikcbhocehsinaral9Rax6mdalTmealaxfhlaocefgoad6hsadao9hmbkaChlxdkcbhlasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqalmbkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;yzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2geTmbinababydbgdcwtcw91:Yadce91cjjj;8ifcjjj98G::NUdbabclfhbaecufgembkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaiczfhiaeczfheadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",r=WebAssembly.instantiate(i(n),{}).then((function(x){(t=x.instance).exports.__wasm_call_ctors()}));function i(x){for(var y=new Uint8Array(x.length),b=0;b<x.length;++b){var w=x.charCodeAt(b);y[b]=w>96?w-97:w>64?w-39:w+4}var _=0;for(b=0;b<x.length;++b)y[_++]=y[b]<60?e[y[b]]:64*(y[b]-60)+y[++b];return y.buffer.slice(0,_)}function a(x,y,b,w,_,T){var A=t.exports.sbrk,R=b+3&-4,C=A(R*w),I=A(_.length),G=new Uint8Array(t.exports.memory.buffer);G.set(_,I);var U=x(C,b,w,I,_.length);if(U==0&&T&&T(C,R,w),y.set(G.subarray(C,C+b*w)),A(C-A(0)),U!=0)throw new Error("Malformed buffer data: "+U)}var l={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},u={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},h=[],p=0;function f(x){var y={object:new Worker(x),pending:0,requests:{}};return y.object.onmessage=function(b){var w=b.data;y.pending-=w.count,y.requests[w.id][w.action](w.value),delete y.requests[w.id]},y}function m(x){for(var y="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(i(n))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+a.toString()+g.toString(),b=new Blob([y],{type:"text/javascript"}),w=URL.createObjectURL(b),_=0;_<x;++_)h[_]=f(w);URL.revokeObjectURL(w)}function g(x){r.then((function(){var y=x.data;try{var b=new Uint8Array(y.count*y.size);a(t.exports[y.mode],b,y.count,y.size,y.source,t.exports[y.filter]),self.postMessage({id:y.id,count:y.count,action:"resolve",value:b},[b.buffer])}catch(w){self.postMessage({id:y.id,count:y.count,action:"reject",value:w})}}))}return{ready:r,supported:!0,useWorkers:function(x){m(x)},decodeVertexBuffer:function(x,y,b,w,_){a(t.exports.meshopt_decodeVertexBuffer,x,y,b,w,t.exports[l[_]])},decodeIndexBuffer:function(x,y,b,w){a(t.exports.meshopt_decodeIndexBuffer,x,y,b,w)},decodeIndexSequence:function(x,y,b,w){a(t.exports.meshopt_decodeIndexSequence,x,y,b,w)},decodeGltfBuffer:function(x,y,b,w,_,T){a(t.exports[u[_]],x,y,b,w,t.exports[l[T]])},decodeGltfBufferAsync:function(x,y,b,w,_){return h.length>0?(function(T,A,R,C,I){for(var G=h[0],U=1;U<h.length;++U)h[U].pending<G.pending&&(G=h[U]);return new Promise((function(j,N){var J=new Uint8Array(R),le=p++;G.pending+=T,G.requests[le]={resolve:j,reject:N},G.object.postMessage({id:le,count:T,size:A,source:J,mode:C,filter:I},[J.buffer])}))})(x,y,b,u[w],l[_]):r.then((function(){var T=new Uint8Array(x*y);return a(t.exports[u[w]],T,x,y,b,t.exports[l[_]]),T}))}}})();class lw extends Pv{constructor(e){super(e),this.type=br}parse(e){const t=function(u,h){switch(u){case 1:console.error("THREE.RGBELoader Read Error: "+(h||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(h||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(h||""));break;default:console.error("THREE.RGBELoader: Error: "+(h||""))}return-1},n=function(u,h,p){h=h||1024;let f=u.pos,m=-1,g=0,x="",y=String.fromCharCode.apply(null,new Uint16Array(u.subarray(f,f+128)));for(;0>(m=y.indexOf(`
`))&&g<h&&f<u.byteLength;)x+=y,g+=y.length,f+=128,y+=String.fromCharCode.apply(null,new Uint16Array(u.subarray(f,f+128)));return-1<m&&(u.pos+=g+m+1,x+y.slice(0,m))},r=function(u,h,p,f){const m=u[h+3],g=Math.pow(2,m-128)/255;p[f+0]=u[h+0]*g,p[f+1]=u[h+1]*g,p[f+2]=u[h+2]*g,p[f+3]=1},i=function(u,h,p,f){const m=u[h+3],g=Math.pow(2,m-128)/255;p[f+0]=Ep.toHalfFloat(Math.min(u[h+0]*g,65504)),p[f+1]=Ep.toHalfFloat(Math.min(u[h+1]*g,65504)),p[f+2]=Ep.toHalfFloat(Math.min(u[h+2]*g,65504)),p[f+3]=Ep.toHalfFloat(1)},a=new Uint8Array(e);a.pos=0;const l=(function(u){const h=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,p=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,f=/^\s*FORMAT=(\S+)\s*$/,m=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,g={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let x,y;if(u.pos>=u.byteLength||!(x=n(u)))return t(1,"no header found");if(!(y=x.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(g.valid|=1,g.programtype=y[1],g.string+=x+`
`;x=n(u),x!==!1;)if(g.string+=x+`
`,x.charAt(0)!=="#"){if((y=x.match(h))&&(g.gamma=parseFloat(y[1])),(y=x.match(p))&&(g.exposure=parseFloat(y[1])),(y=x.match(f))&&(g.valid|=2,g.format=y[1]),(y=x.match(m))&&(g.valid|=4,g.height=parseInt(y[1],10),g.width=parseInt(y[2],10)),2&g.valid&&4&g.valid)break}else g.comments+=x+`
`;return 2&g.valid?4&g.valid?g:t(3,"missing image size specifier"):t(3,"missing format specifier")})(a);if(l!==-1){const u=l.width,h=l.height,p=(function(f,m,g){const x=m;if(x<8||x>32767||f[0]!==2||f[1]!==2||128&f[2])return new Uint8Array(f);if(x!==(f[2]<<8|f[3]))return t(3,"wrong scanline width");const y=new Uint8Array(4*m*g);if(!y.length)return t(4,"unable to allocate buffer space");let b=0,w=0;const _=4*x,T=new Uint8Array(4),A=new Uint8Array(_);let R=g;for(;R>0&&w<f.byteLength;){if(w+4>f.byteLength)return t(1);if(T[0]=f[w++],T[1]=f[w++],T[2]=f[w++],T[3]=f[w++],T[0]!=2||T[1]!=2||(T[2]<<8|T[3])!=x)return t(3,"bad rgbe scanline format");let C,I=0;for(;I<_&&w<f.byteLength;){C=f[w++];const U=C>128;if(U&&(C-=128),C===0||I+C>_)return t(3,"bad scanline data");if(U){const j=f[w++];for(let N=0;N<C;N++)A[I++]=j}else A.set(f.subarray(w,w+C),I),I+=C,w+=C}const G=x;for(let U=0;U<G;U++){let j=0;y[b]=A[U+j],j+=x,y[b+1]=A[U+j],j+=x,y[b+2]=A[U+j],j+=x,y[b+3]=A[U+j],b+=4}R--}return y})(a.subarray(a.pos),u,h);if(p!==-1){let f,m,g;switch(this.type){case xr:g=p.length/4;const x=new Float32Array(4*g);for(let b=0;b<g;b++)r(p,4*b,x,4*b);f=x,m=xr;break;case br:g=p.length/4;const y=new Uint16Array(4*g);for(let b=0;b<g;b++)i(p,4*b,y,4*b);f=y,m=br;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:u,height:h,data:f,header:l.string,gamma:l.gamma,exposure:l.exposure,type:m}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,r,i){return super.load(e,(function(a,l){switch(a.type){case xr:case br:a.encoding=jr,a.minFilter=_t,a.magFilter=_t,a.generateMipmaps=!1,a.flipY=!0}t&&t(a,l)}),n,r,i)}}class Zi{static loaders=new Map;static caches=new Map;static Clear(){this.caches.clear()}static RegistLoader(e){let t=new e;for(let n of t.extensions)this.loaders.set(n,t)}static Load(e){return new Promise(((t,n)=>{let{url:r,file:i,ext:a}=(function(h){let p="",f=null,m="";return typeof File<"u"&&h instanceof File?(p=h.name,m=Nm(p),f=h):typeof h=="object"?(p=h.mainFile.name,m=Nm(p),f=h):(p+=h,m=Nm(p)),{url:p,file:f,ext:m}})(e.url),l=(function(h,p){let f=[h];for(let m in p)f.push(m+"="+p[m]);return f.join(",")})(r,e.settings),u=this.caches.get(l);if(u)t(u);else{const h=p=>{this.caches.set(l,p),t(p)};this.loaders.has(a)?this.loaders.get(a).load({...e,url:r,file:i,onLoad:h,onError:n}):n("missing loader for"+a)}}))}}Zi.RegistLoader(class extends Ql{extensions=["atlas"];load({url:s,file:e,onLoad:t,onProgress:n,onError:r,settings:i}){(async()=>{let a=await(function({url:u,file:h,onProgress:p}){return new Promise(((f,m)=>new P1().load({url:u,file:h,onLoad:f,onError:m,onProgress:p})))})({url:s,file:e}).catch(r),l=await(function({url:u,file:h,onProgress:p,settings:f}){return new Promise(((m,g)=>new C1().load({url:u,file:h,onLoad:m,onError:g,onProgress:p,settings:f})))})({url:`${A1(s)}/${a.meta.image}`,file:e,onProgress:n,settings:i}).catch(r);t(new L1(a,l))})()}}),Zi.RegistLoader(class extends Ql{extensions=["fbx"];load({url:s,file:e,onLoad:t,onProgress:n,onError:r}){new y_().load(s,t,n,r,e)}}),Zi.RegistLoader(class extends Ql{extensions=["gltf","glb"];load({url:s,file:e,onLoad:t,onProgress:n,onError:r}){let i=new E_;i.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.5/");let a=new R_;a.setMeshoptDecoder(ow),a.setDRACOLoader(i),a.load(s,(l=>t(Object.assign(l.scene,{animations:l.animations}))),n,r,e)}}),Zi.RegistLoader(class extends Ql{extensions=["hdr"];load({url:s,file:e,onLoad:t,onProgress:n,onError:r,settings:i}){new lw().load(s,(a=>t(Object.assign(a,i))),n,r,e)}}),Zi.RegistLoader(P1),Zi.RegistLoader(C1),Zi.RegistLoader(class extends Ql{extensions=["mp3","wav","ogg"];load({url:s,file:e,onLoad:t,onProgress:n,onError:r}){new Hv().load(s,t,n,r,e)}}),(function(s){s[s.Destroyed=1]="Destroyed",s[s.OnLoadCalled=2]="OnLoadCalled",s[s.OnEnableCalled=4]="OnEnableCalled",s[s.StartCalled=8]="StartCalled",s[s.Deactivating=16]="Deactivating"})(Yh||(Yh={}));let cw=100;class Do extends at{static Flags=Yh;uuid=""+cw++;name="";_objFlags=0;constructor(e){super(),this.name=e||this.name}__setFlag(e){this._objFlags|=e}__clearFlag(e){this._objFlags&=~e}__getFlag(e){return!!(this._objFlags&e)}get isValid(){return!(this._objFlags&Yh.Destroyed)}destroy(){return!this.__getFlag(Yh.Destroyed)&&(this.destroyImmediate(),!0)}destroyImmediate(){this._onPreDestroy&&this._onPreDestroy(),this.__setFlag(Yh.Destroyed)}}class en extends Do{viewer;node;isComponent=!0;_enabled=!0;get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this.viewer?.componentScheduler.enableComponent(this,e))}_onPreDestroy(){this.unscheduleAll(),this.viewer?.removeComponent(this.node,this),this._enabled&&this.viewer?.componentScheduler.enableComponent(this,!1),this.onDestroy&&this.__getFlag(Do.Flags.OnLoadCalled)&&this.onDestroy()}schedule(e,t,n=-1){this.viewer?.scheduler.schedule(this,e,t,n)}unshedule(e){this.viewer?.scheduler.unshedule(this,e)}unscheduleAll(){this.viewer?.scheduler.unscheduleAll(this)}}class ui extends en{isPlugin=!0}class Fm extends ui{update(e){this.viewer.render(e)}}class f0{_targets=[];_callback;constructor(e){this._callback=e}add(e){this._targets.push(e)}remove(e){let t=this._targets.indexOf(e);t!==-1&&this._targets.splice(t,1)}invoke(e){let t=this._callback;for(let n of this._targets)t(n,e)}}class uw extends f0{invoke(e){if(this._targets.length>0){let t=this._callback;for(let n of this._targets)t(n,e);this._targets.length=0}}}class hw{startInvoker=new uw((e=>e.start()));updateInvoker=new f0(((e,t)=>e.update(t)));lastUpdateInvoker=new f0(((e,t)=>e.lastUpdate(t)));start(){this.startInvoker.invoke(0)}update(e){this.updateInvoker.invoke(e)}lastUpdate(e){this.lastUpdateInvoker.invoke(e)}enableComponent(e,t){t?e.__getFlag(Do.Flags.OnEnableCalled)===!1&&(e.__setFlag(Do.Flags.OnEnableCalled),e.onEnable&&e.onEnable(),e.start&&this.startInvoker.add(e),e.update&&this.updateInvoker.add(e),e.lastUpdate&&this.lastUpdateInvoker.add(e)):e.__getFlag(Do.Flags.OnEnableCalled)&&(e.__clearFlag(Do.Flags.OnEnableCalled),e.onDisable&&e.onDisable(),e.start&&this.startInvoker.remove(e),e.update&&this.updateInvoker.remove(e),e.lastUpdate&&this.lastUpdateInvoker.remove(e))}}class dw extends Do{_scheduler=new Zt;_componentScheduler=new hw;get scheduler(){return this._scheduler}get componentScheduler(){return this._componentScheduler}update(e){this._scheduler.update(e),this._componentScheduler.start(),this._componentScheduler.update(e),this._componentScheduler.lastUpdate(e)}destroyNode(e){e.removeFromParent(),this.destroyComponents(e)}activeNode(e,t){e.visible=t,this.activeComponents(e)}destroyComponents(e){let t=this._getComponents(e);for(let n of t)n.destroy();e._components=[];for(let n of e.children)this.destroyComponents(n)}activeComponents(e){let t=e.visible;for(let n of this._getComponents(e))this._activeComponent(n,t);for(let n of e.children)this.activeComponents(n)}addComponent(e,t,n){let r=e instanceof en?e.node:e,i=typeof t=="function",a=this._findComponent(r,i?t:t.constructor);if(a===void 0){a=i?new t:t,a.node=r,a.viewer=this;let l=a._dependencies;if(l)for(let u of l)this.getComponent(r,u)==null&&this.addComponent(r,u);a.__getFlag(Do.Flags.OnLoadCalled)===!1&&(a.__setFlag(Do.Flags.OnLoadCalled),a.onLoad&&a.onLoad(n||{})),this._getComponents(r).push(a),this._activeComponent(a,!0),this.emit("component-changed",{action:"add",target:a})}return a}removeComponent(e,t){let n=this._getComponents(e),r=n.indexOf(t);return r!=-1&&(n.splice(r,1),this.emit("omponent-changed",{action:"remove",target:t})),this}getComponent(e,t){return this._findComponent(e,t)}getComponentsInChidren(e,t,n=[]){let r=this._getComponents(e);for(let i=r.length;i--;)r[i]instanceof t&&n.push(r[i]);for(let i of e.children)this.getComponentsInChidren(i,t,n);return n}_getComponents(e){let t=e._components;return t==null&&(t=e._components=[]),t}_findComponent(e,t){let n=this._getComponents(e);for(let r=n.length;r--;){let i=n[r];if(i instanceof t)return i}}_activeComponent(e,t){this._componentScheduler.enableComponent(e,t)}}var Ki=Fn(622),pw=Fn(631);const{Tween:fw,getAll:mw,remove:gw,update:vw}=Fn(622),{TweenChain:yw}=Fn(631);class ty{static Tween(e){return new fw(e)}static Timeline(e){return new yw(e)}static KillTweensOf(e){let t=mw();for(let n of t)n._object===e&&gw(n)}static TweenUpdate(e){vw(e)}}class ny extends ui{update(e){ty.TweenUpdate()}}class bn{viewer;static MOUSE_WHEEL="mousewheel";static TOUCH_START="touchstart";static TOUCH_END="touchend";static TOUCH_MOVE="touchmove";static POINTER_DOWN="pointerdown";static POINTER_UP="pointerup";static POINTER_MOVE="pointermove";static KEYDOWN="keydown";static KEYPRESS="keypress";static KEYUP="keyup";static RESIZE="resize";_listeners=[];_mouseWheel=0;_touches=[];_touchCount=0;_pointerButton=-1;_pointerPosition=new ce;_pointer=new ce;_keys={};get pointerButton(){return this._pointerButton}get pointer(){return this._pointer}get pointerPosition(){return this._pointerPosition}get mouseWheel(){return this._mouseWheel}get touchCount(){return this._touchCount}get touches(){return this._touches}get keys(){return this._keys}constructor(e){this.viewer=e}addEventListeners(){const e=this.viewer.renderer.domElement;e.style.touchAction="none",this._addEventListener(window,"resize",(()=>this._onResize())),this._addEventListener(e,"contextmenu",(t=>t.preventDefault())),this._addEventListener(e,"pointerdown",(t=>this._onPointerDown(t)),{passive:!1}),this._addEventListener(e,"pointerup",(t=>this._onPointerUp(t)),{passive:!1}),this._addEventListener(e,"pointermove",(t=>{this._onPointerMove(t)}),{passive:!0}),this._addEventListener(e,"mousewheel",(t=>this._onMouseWheel(t)),{passive:!1}),this._addEventListener(e,"touchstart",(t=>this._onTouchStart(t)),{passive:!0}),this._addEventListener(e,"touchend",(t=>this._onTouchEnd(t)),{passive:!0}),this._addEventListener(e,"touchmove",(t=>this._onTouchMove(t)),{passive:!0}),this._addEventListener(e,"keydown",(t=>this._onKeyDown(t)),{passive:!0}),this._addEventListener(e,"keypress",(t=>this._onKeyPress(t)),{passive:!0}),this._addEventListener(e,"keyup",(t=>this._onKeyUp(t)),{passive:!0}),this._onResize()}_onResize(){this.viewer.resize(window.innerWidth,window.innerHeight),this.viewer.emit(bn.RESIZE,window.innerWidth,window.innerHeight)}_onPointerDown(e){e.preventDefault(),this._pointerButton=e.button,this.viewer.emit(bn.POINTER_DOWN,e)}_onPointerUp(e){e.preventDefault(),this._pointerButton=-1,this.viewer.emit(bn.POINTER_UP,e)}_onPointerMove(e){this._pointer.x=e.pageX/window.innerWidth*2-1,this._pointer.y=1-e.pageY/window.innerHeight*2,this._pointerPosition.set(e.pageX,e.pageY),this.viewer.emit(bn.POINTER_MOVE,e)}_onMouseWheel(e){e.preventDefault(),this._mouseWheel=e.deltaY,this.viewer.emit(bn.MOUSE_WHEEL,e)}_onTouchStart(e){this.viewer.emit(bn.TOUCH_START,e)}_onTouchEnd(e){this.viewer.emit(bn.TOUCH_END,e)}_onTouchMove(e){let t=e.touches,n=this._touches;for(let r=t.length;r--;){n[r]==null&&(n[r]={id:-1,position:new ce});const i=t[r];n[r].id=i.identifier,n[r].position.set(i.pageX,i.pageY)}this._touchCount=t.length,this.viewer.emit(bn.TOUCH_MOVE,e)}_onKeyDown(e){this._keys[e.key]=!0,this.viewer.emit(bn.KEYDOWN,e)}_onKeyPress(e){this._keys[e.key]=!0,this.viewer.emit(bn.KEYPRESS,e)}_onKeyUp(e){this._keys[e.key]=!1,this.viewer.emit(bn.KEYUP,e)}_addEventListener(e,t,n,r){e.addEventListener?e.addEventListener(t,n):e.on&&e.on(t,n,e),this._listeners.push({target:e,type:t,callback:n})}removeAllListeners(){for(let{target:e,type:t,callback:n}of this._listeners)e.removeEventListener?e.removeEventListener(t,n):e.off&&e.off(t,n,e);this._listeners=[]}}bt.matrix=`
mat4 getInstanceMatrix(vec3 p, vec4 q, vec3 s) {
    mat4 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    float sx = s.x;
    float sy = s.y;
    float sz = s.z;
    m[0][0] = (1. - (yy + zz)) * sx;
    m[0][1] = (xy + wz) * sx;
    m[0][2] = (xz - wy) * sx;
    m[0][3] = 0.;
    m[1][0] = (xy - wz) * sy;
    m[1][1] = (1. - (xx + zz)) * sy;
    m[1][2] = (yz + wx) * sy;
    m[1][3] = 0.;
    m[2][0] = (xz + wy) * sz;
    m[2][1] = (yz - wx) * sz;
    m[2][2] = (1. - (xx + yy)) * sz;
    m[2][3] = 0.;
    m[3][0] = p.x;
    m[3][1] = p.y;
    m[3][2] = p.z;
    m[3][3] = 1.;
    return m;
}
mat3 getInstanceRotationMatrix(vec4 q) {
    mat3 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    m[0][0] = (1. - (yy + zz));
    m[0][1] = (xy + wz);
    m[0][2] = (xz - wy);
    m[1][0] = (xy - wz);
    m[1][1] = (1. - (xx + zz));
    m[1][2] = (yz + wx);
    m[2][0] = (xz + wy);
    m[2][1] = (yz - wx);
    m[2][2] = (1. - (xx + yy));
    return m;
}
`;let xw=new D,bw=new D,Sw=new ce;class _w extends dw{_time=0;_running=!1;_renderer;_scene;_camera;_viewport={width:1,height:1,factor:1};_states=[];_input=new bn(this);_user=null;_environment=null;_background=null;get environment(){return this._environment}get background(){return this._background}get input(){return this._input}get time(){return this._time}get renderer(){return this._renderer}get scene(){return this._scene}get camera(){return this._camera}get dpr(){return Math.min(2,window.devicePixelRatio)}get viewport(){return this._viewport}get size(){return this._renderer.getSize(Sw)}get user(){return this._user}constructor({canvas:e,shadows:t=!1,linear:n=!0,outputEncoding:r=Ct,toneMapping:i=lc,toneMappingExposure:a=1,camera:l={fov:45,near:1,far:1e3},user:u={},...h}){super(),this._user=u,this._scene=new Oa,this._camera=$t(new vn(l.fov,l.aspect||window.innerWidth/window.innerHeight,l.near,l.far),l),this._renderer=new Cl({canvas:e,...h}),this._renderer.setPixelRatio(this.dpr),this._renderer.outputEncoding=r,this._renderer.toneMapping=i,this._renderer.toneMappingExposure=a,this._renderer.shadowMap.enabled=!!t,this._renderer.shadowMap.type=typeof t=="boolean"?F:t,this._renderer.info.autoReset=!1,this._input.addEventListeners(),this._addDefaultPlugins(),this._printInfo(n),e||document.body.appendChild(this._renderer.domElement),this.start()}_printInfo(e){ar.enabled=e;const t=this._renderer.getContext();["Welcome to xviewer.js","Three Version: "+$e,"WebGL Version: "+t.getParameter(t.VERSION),"ColorSpace: "+ar.workingColorSpace].join(`
`)}_onPreDestroy(){Zi.Clear(),this._user={},this._input.removeAllListeners(),this._renderer.dispose(),this.destroyComponents(this._scene),this.stop()}async load({replace:e,castShadow:t,receiveShadow:n,parent:r=this._scene,...i}){let a=await Zi.Load(i);return e&&(r.clear(),this.emit("node-changed",{action:"clear",target:r})),(t||n)&&a.traverse((l=>{l instanceof ht&&(l.castShadow=!!t,l.receiveShadow=!!n)})),r.add(a),this.emit("node-changed",{action:"add",target:a}),a}async setEnvironment(e){let t=e?e.url:null;this._environment!==t&&(this._environment=t,this.emit("env-changed",t),this._scene.environment=t?await Zi.Load({...e,settings:Object.assign({mapping:ys},e.settings)}):null),e&&e.noBackground||this.setBackground(e)}async setBackground(e){let t=e?e.color||e.url:null;this._background!==t&&(this._background=t,this.emit("bg-changed",t),this._scene.background=t?e.color||await Zi.Load({...e,settings:Object.assign({mapping:ys},e.settings)}):null)}pushScene(e=new Oa){return this._states.push({scene:this._scene,camera:this._camera}),this._scene=e||this._scene,this}popScene(){let e=this._states.pop();return e&&(this._scene=e.scene,this._camera=e.camera),this}addNode(e,t={},n=this._scene){let r,i;if(typeof e=="function"){let a=t&&t.args,l=a?new e(...a):new e;l.isCamera&&t.makeDefault&&(l.manual=l.aspect!==this.camera.aspect,this._camera=l),l.isObject3D?r=n.addObject($t(l,t)):(r=n.addObject(l.create&&l.create(t)||new St),i=this.addComponent(r,l,t))}else r=n.addObject($t(e,t));return this.emit("node-changed",{action:"add",target:r}),i||r}addPlugin(e,t){return this.addComponent(this._scene,e,t)}removePlugin(e){return this.removeComponent(this._scene,e)}getPlugin(e){return this.getComponent(this._scene,e)}_addDefaultPlugins(){this.addPlugin(Fm),this.addPlugin(ny)}resize(e,t){let n=this._camera;if(n.isOrthographicCamera)this._viewport={width:e/n.zoom,height:t/n.zoom,factor:1};else if(n.isPerspectiveCamera){n.manual||(n.aspect=e/t,n.updateProjectionMatrix());let r=n.getWorldPosition(bw).distanceTo(xw),i=2*Math.tan(Kn.degToRad(.5*n.fov))*r,a=i*e/t;this._viewport={width:a,height:i,factor:e/a}}this._renderer.setSize(e,t)}start(){if(this._running==0){this._running=!0;let e=t=>{let n=this._time!==0?t-this._time:0;return this._time=t,n};this._renderer.setAnimationLoop((t=>this.update(e(.001*t))))}return this}render(e){this._renderer.info.reset(),this._renderer.render(this._scene,this._camera)}stop(){return this._time=0,this._running=!1,this._renderer.setAnimationLoop(null),this}}function fn(s={}){return function(e,t){e.hasOwnProperty("__properties")==0&&(e.__properties=Object.assign({},e.__proto__.__properties)),e.__properties[t]=s}}function zs(...s){return function(e){let t=e.prototype;t._dependencies==null&&(t._dependencies=[]),t._dependencies.push(...s)}}let{PI:du,cos:ry,sin:Pp,pow:Kl,sqrt:Um}=Math;function iy(s){return 1-m0(1-s)}function m0(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375}var g0;(function(s){s[s.Linear=0]="Linear",s[s.QuadraticIn=1]="QuadraticIn",s[s.QuadraticOut=2]="QuadraticOut",s[s.QuadraticInOut=3]="QuadraticInOut",s[s.CubicIn=4]="CubicIn",s[s.CubicOut=5]="CubicOut",s[s.CubicInOut=6]="CubicInOut",s[s.QuarticIn=7]="QuarticIn",s[s.QuarticOut=8]="QuarticOut",s[s.QuarticInOut=9]="QuarticInOut",s[s.QuinticIn=10]="QuinticIn",s[s.QuinticOut=11]="QuinticOut",s[s.QuinticInOut=12]="QuinticInOut",s[s.SinusoidalIn=13]="SinusoidalIn",s[s.SinusoidalOut=14]="SinusoidalOut",s[s.SinusoidalInOut=15]="SinusoidalInOut",s[s.ExponentialIn=16]="ExponentialIn",s[s.ExponentialOut=17]="ExponentialOut",s[s.ExponentialInOut=18]="ExponentialInOut",s[s.CircularIn=19]="CircularIn",s[s.CircularOut=20]="CircularOut",s[s.CircularInOut=21]="CircularInOut",s[s.ElasticIn=22]="ElasticIn",s[s.ElasticOut=23]="ElasticOut",s[s.ElasticInOut=24]="ElasticInOut",s[s.BackIn=25]="BackIn",s[s.BackOut=26]="BackOut",s[s.BackInOut=27]="BackInOut",s[s.BounceIn=28]="BounceIn",s[s.BounceOut=29]="BounceOut",s[s.BounceInOut=30]="BounceInOut"})(g0||(g0={}));const ww=[function(s){return s},function(s){return s*s},function(s){return s*(2-s)},function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)},function(s){return s*s*s},function(s){return--s*s*s+1},function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)},function(s){return s*s*s*s},function(s){return 1- --s*s*s*s},function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)},function(s){return s*s*s*s*s},function(s){return--s*s*s*s*s+1},function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)},function(s){return 1-ry(s*du/2)},function(s){return Pp(s*du/2)},function(s){return .5*(1-ry(du*s))},function(s){return s===0?0:Kl(1024,s-1)},function(s){return s===1?1:1-Kl(2,-10*s)},function(s){return s===0?0:s===1?1:(s*=2)<1?.5*Kl(1024,s-1):.5*(2-Kl(2,-10*(s-1)))},function(s){return 1-Um(1-s*s)},function(s){return Um(1- --s*s)},function(s){return(s*=2)<1?-.5*(Um(1-s*s)-1):.5*(Um(1-(s-=2)*s)+1)},function(s){return s===0?0:s===1?1:-Kl(2,10*(s-1))*Pp(5*(s-1.1)*du)},function(s){return s===0?0:s===1?1:Kl(2,-10*s)*Pp(5*(s-.1)*du)+1},function(s){return s===0?0:s===1?1:(s*=2)<1?-.5*Kl(2,10*(s-1))*Pp(5*(s-1.1)*du):.5*Kl(2,-10*(s-1))*Pp(5*(s-1.1)*du)+1},function(s){var e=1.70158;return s*s*((e+1)*s-e)},function(s){var e=1.70158;return--s*s*((e+1)*s+e)+1},function(s){var e=2.5949095;return(s*=2)<1?s*s*((e+1)*s-e)*.5:.5*((s-=2)*s*((e+1)*s+e)+2)},iy,m0,function(s){return s<.5?.5*iy(2*s):.5*m0(2*s-1)+.5}];class Mw{style=g0.QuadraticInOut;time=4}const{clamp:Tw,lerp:v0}=Kn;class y0 extends en{_vcam=null;_vcamSolo=null;_vcams=[];_lerpTime=0;brainBlend=new Mw;get vcam(){return this._vcam}get vcams(){return this._vcams}update(e){let t=this.getActiveCamera();if(t!=null){for(let n of this._vcams)n.enabled=n===t;if(this._lerpTime<this.brainBlend.time){this._lerpTime+=e;let n=Tw(this._lerpTime/this.brainBlend.time,0,1),r=ww[this.brainBlend.style];r&&(n=r(n)),this._lerpToMainCamera(t,n)}else this._lerpToMainCamera(t,1)}}activeCamera(e,t=4){this._vcamSolo!==e&&(this._vcamSolo=e,this._lerpTime=0,this.brainBlend.time=t)}addCamera(e){this._vcams.indexOf(e)===-1&&this._vcams.push(e)}removeCamera(e){let t=this._vcams.indexOf(e);t!==-1&&this._vcams.splice(t,1)}getActiveCamera(){return this._vcamSolo||this._vcams.filter((e=>e.enabled)).sort(((e,t)=>t.priority-e.priority))[0]}_lerpToMainCamera(e,t){let n=this.viewer.camera,r=e,i=r.lens,a=n.fov,l=n.near,u=n.far;n.position.lerp(r.finalPosition,t),n.quaternion.slerp(r.finalRotation,t),n.fov=v0(a,i.fov,t),n.near=v0(l,i.near,t),n.far=v0(u,i.far,t),a==i.fov&&l==i.near&&u==i.far||n.updateProjectionMatrix()}}const{clamp:pu}=Kn,{min:Ew,max:Cp,acos:Aw,abs:Ji}=Math,Dp=1e-6,Rw=Math.log(.01);function ay(s,e,t,n){let r=-Rw/t;return s+(e-s)*(1-Math.exp(-r*n))}function Qh(s,e,t,n){let r=1-Ew(n,t)/t,i=r*r;return s+(e-s)*(1-i*i)}function Lw(s,e,t,n,r){return s.copy(e).slerp(t,ay(0,1,n,r))}function Pw(s,e,t,n,r){return s.copy(e).slerp(t,Qh(0,1,n,r))}function x0(s,e,t,n,r,i){s._velocity===void 0&&(s._velocity=0);let a=2/(n=Math.max(1e-4,n)),l=a*i,u=1/(1+l+.48*l*l+.235*l*l*l),h=e-t,p=t,f=r*n;h=pu(h,-f,f),t=e-h;let m=(s._velocity+a*h)*i;s._velocity=(s._velocity-a*m)*u;let g=t+(h+m)*u;return p-e>0==g>p&&(g=p,s._velocity=(g-p)/i),g}function Cw(s,e,t,n,r=s){return r.copy(s).slerp(e,x0(r,0,1,t,1/0,n))}function Dw(s,e,t,n,r=s){return r.copy(s).lerp(e,x0(r,0,1,t,1/0,n))}let sy=new D;function Ow(s,e,t,n,r=s){if(n<=0)return r.copy(e);let i=sy.copy(e).sub(s);return i.lengthSq()<Dp?r.copy(e):r.copy(s).add(i.multiplyScalar(pu(t*n,0,1)))}function Iw(s,e,t,n,r=s){let i=sy.copy(e).sub(s),a=i.length(),l=n*t;if(a>l){if(l>0){let u=i.multiplyScalar(1/a);return r.copy(s).add(u)}return r.copy(s)}return r.copy(e)}function oy(s,e,t=Dp){return Ji(s.x-e.x)<=t*Cp(1,Ji(s.x),Ji(e.x))&&Ji(s.y-e.y)<=t*Cp(1,Ji(s.y),Ji(e.y))&&Ji(s.z-e.z)<=t*Cp(1,Ji(s.z),Ji(e.z))&&Ji(s.w-e.w)<=t*Cp(1,Ji(s.w),Ji(e.w))}function Nw(s,e,t,n){return n<=0||oy(s,e)?e:s.slerp(e,pu(n*t,0,1))}function kw(s,e,t,n,r=s){if(n<=0||oy(s,e))return r.copy(e);let i=pu(n*t,0,1),a=Cp((function(l,u){let h=l.x*u.x+l.y*u.y+l.z*u.z+l.w*u.w;return Aw(2*h*h-1)})(s,e),Dp);return r.copy(s).slerp(e,pu(i/a,0,1))}function Fw(s,e,t,n){if(n<=0)return e;let r=e-s;return Ji(r)<Dp?e:s+r*pu(n*t,0,1)}function Uw(s,e,t,n){let r=e-s;if(Ji(r)<Dp)return e;let i=n*t;return s+pu(r,-i,i)}var Bs;(function(s){s[s.FREE=0]="FREE",s[s.TRANSLATE=1]="TRANSLATE",s[s.LOCK=2]="LOCK"})(Bs||(Bs={}));class ly{mode=Bs.FREE;forbidX=!1;forbidY=!1;forbidZ=!1;forbidPanX=!1;forbidPanY=!1;rotateSpeed=2;rotateSmoothing=.5;panSpeed=2;panSmoothing=.5;phiMin=.001;phiMax=Math.PI-.001;thetaMin=-1/0;thetaMax=1/0;distanceMin=.001;distanceMax=1/0;rotateTouchID=0}class cy{trackedObjectOffset=new D}class uy{fov=45;near=.1;far=1e3}class hy extends en{_finalPosition=new D;_finalRotation=new Jt;priority=10;lookAt=null;follow=null;lens=new uy;aim=new cy;correctPosition=new D;correctRotation=new Jt;lookaheadPosition=new D;brain;get finalPosition(){return this._finalPosition.copy(this.node.position).add(this.correctPosition)}get finalRotation(){return this._finalRotation.copy(this.node.quaternion).multiply(this.correctRotation)}onLoad({lookAt:e,fov:t,near:n,far:r,...i}){this.node.isCamera=!0,this.lookAt=e,$t(this.lens,{fov:t,near:n,far:r}),$t(this.node,i),this.brain=this.viewer.getComponent(this.viewer.camera,y0),this.brain.addCamera(this)}onDestroy(){this.brain.removeCamera(this)}update(e){this.lookAt&&this.node.lookAt(this.lookAt.position)}}const{clamp:Op,degToRad:zw}=Kn,{abs:Oo,tan:Bw}=Math;let ps=new ce,zm=new ce,Hw=new ce,jw=new ce,Bm=new ce,Hs=new D,Ha=new D,dy=new D,py=new D,fy=new D,fu=new Jt,b0=new Jt,$i=new Jv,Gw=new wr;class my extends hy{_button=-1;_touchID=-1;_distanceDelta=0;_preLoc0=new ce;_preLoc1=new ce;_rotateDelta=new ce;_panDelta=new ce;freelook=new ly;onLoad({forbidX:e=!1,forbidY:t=!1,forbidZ:n=!1,forbidPanX:r=!1,forbidPanY:i=!1,mode:a=Bs.FREE,...l}){super.onLoad(l),$t(this.freelook,{forbidX:e,forbidY:t,forbidZ:n,forbidPanX:r,forbidPanY:i,mode:a})}onEnable(){this.viewer.on(bn.POINTER_DOWN,this._onPointerDown,this),this.viewer.on(bn.POINTER_UP,this._onPointerUp,this),this.viewer.on(bn.POINTER_MOVE,this._onPointerMove,this),this.viewer.on(bn.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.on(bn.TOUCH_START,this._onTouchStart,this),this.viewer.on(bn.TOUCH_MOVE,this._onTouchMove,this),this.reset()}onDisable(){this.viewer.off(bn.POINTER_DOWN,this._onPointerDown,this),this.viewer.off(bn.POINTER_UP,this._onPointerUp,this),this.viewer.off(bn.POINTER_MOVE,this._onPointerMove,this),this.viewer.off(bn.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.off(bn.TOUCH_START,this._onTouchStart,this),this.viewer.off(bn.TOUCH_MOVE,this._onTouchMove,this)}reset(){this._button=-1,this._touchID=-1,this._rotateDelta.set(0,0),this._panDelta.set(0,0),this._distanceDelta=0}_onPointerDown(e){this._button=e.button,this._preLoc0.set(e.pageX,e.pageY)}_onPointerUp(e){this._button=-1}_onPointerMove(e){switch(ps.set(e.pageX,e.pageY),this._button){case 0:this._rotateDelta.add(this._calculateRotateDelta(Bm,this._preLoc0,ps));break;case 1:this._panDelta.add(this._calculatePanDelta(Bm,this._preLoc0,ps))}this._preLoc0.copy(ps)}_onMouseWheel(e){if(this.lookAt){let t=Hs.copy(this.lookAt.position).add(this.aim.trackedObjectOffset).distanceTo(this.node.position),n=t+this._distanceDelta;e.deltaY>0?n*=this._calculateDistanceScale(1/.85):e.deltaY<0&&(n*=this._calculateDistanceScale(.85)),this._distanceDelta=n-t}}_onTouchStart(e){if(this._button>-1)return;let t=e.touches,n=this.freelook.rotateTouchID;t.length>n+1?(this._preLoc0.set(t[n].pageX,t[n].pageY),this._preLoc1.set(t[n+1].pageX,t[n+1].pageY)):t.length>n&&(this._touchID=t[n].identifier,this._preLoc0.set(t[n].pageX,t[n].pageY))}_onTouchMove(e){if(this._button>-1)return;let t=e.touches,n=this.freelook.rotateTouchID;if(t.length>n+1){if(ps.set(t[n].pageX,t[n].pageY),zm.set(t[n+1].pageX,t[n+1].pageY),this.lookAt){let r=Hs.copy(this.lookAt.position).add(this.aim.trackedObjectOffset).distanceTo(this.node.position),i=(r+this._distanceDelta)*this._calculateDistanceScale(this._preLoc0.distanceTo(this._preLoc1)/ps.distanceTo(zm));this._distanceDelta=i-r}this._panDelta.add(this._calculatePanDelta(Bm,jw.copy(this._preLoc0).add(this._preLoc1).multiplyScalar(.5),Hw.copy(ps).add(zm).multiplyScalar(.5))),this._preLoc0.copy(ps),this._preLoc1.copy(zm)}else t.length>n&&this._touchID===t[n].identifier&&(ps.set(t[n].pageX,t[n].pageY),this._rotateDelta.add(this._calculateRotateDelta(Bm,this._preLoc0,ps)),this._preLoc0.copy(ps))}_calculateDistanceScale(e){return this.freelook.forbidZ&&(e=1),e}_calculateRotateDelta(e,t,n){let r=this.freelook,i=this.viewer.renderer.domElement;return e.copy(n).sub(t).multiplyScalar(2*r.rotateSpeed*Math.PI/i.height),e.y=-e.y,r.forbidX&&(e.x=0),r.forbidY&&(e.y=0),e}_calculatePanDelta(e,t,n){let r=this.freelook,i=this.viewer.renderer.domElement;return e.copy(n).sub(t).multiplyScalar(r.panSpeed/i.height),r.forbidPanX&&(e.x=0),r.forbidPanY&&(e.y=0),e}update(e){let t=this.freelook;if(this.lookAt){switch(Hs.copy(this.lookAt.position).add(this.aim.trackedObjectOffset),t.mode){case Bs.FREE:if(Oo(this._rotateDelta.x)+Oo(this._rotateDelta.y)+Oo(this._distanceDelta)>.001){fu.setFromUnitVectors(this.node.up,St.DEFAULT_UP),Ha.copy(this.node.position).sub(Hs),Ha.applyQuaternion(fu),$i.setFromVector3(Ha);let n=Qh(1,0,this.freelook.rotateSmoothing,e);this._rotateDelta.x=$i.theta-Op($i.theta-this._rotateDelta.x,t.thetaMin,t.thetaMax),$i.theta=$i.theta-this._rotateDelta.x*(1-n),this._rotateDelta.y=Op($i.phi+this._rotateDelta.y,t.phiMin,t.phiMax)-$i.phi,$i.phi=Op($i.phi+this._rotateDelta.y*(1-n),.001,Math.PI-.001),this._distanceDelta=Op($i.radius+this._distanceDelta,t.distanceMin,t.distanceMax)-$i.radius,$i.radius=$i.radius+this._distanceDelta*(1-n),this._rotateDelta.multiplyScalar(n),this._distanceDelta*=n,Ha.setFromSpherical($i),Ha.applyQuaternion(fu.invert()),this.node.position.copy(Ha.add(Hs))}break;case Bs.TRANSLATE:if(Oo(this._distanceDelta)>.001){Ha.copy(this.node.position).sub(this.lookAt.position);let n=Qh(1,0,this.freelook.rotateSmoothing,e),r=Ha.length();this._distanceDelta=Op(r+this._distanceDelta,t.distanceMin,t.distanceMax)-r;let i=r+this._distanceDelta*(1-n);this._distanceDelta*=n;let a=Ha.normalize().multiplyScalar(i).add(this.lookAt.position);dy.copy(a).sub(this.node.position),this.aim.trackedObjectOffset.add(dy),this.node.position.copy(a),Hs.copy(this.lookAt.position).add(this.aim.trackedObjectOffset)}break;case Bs.LOCK:if(Oo(this._rotateDelta.x)+Oo(this._rotateDelta.y)+Oo(this._distanceDelta)>.001){let n=Qh(1,0,this.freelook.rotateSmoothing,e);fu.setFromEuler(Gw.set(-this._rotateDelta.y*(1-n),this._rotateDelta.x*(1-n),0)),fu.multiply(this.node.quaternion),b0.copy(this.node.quaternion).invert(),b0.multiply(fu),this.node.quaternion.multiply(b0.multiply(fu)),this._rotateDelta.multiplyScalar(n)}}switch(t.mode){case Bs.FREE:case Bs.TRANSLATE:if(Oo(this._panDelta.x)+Oo(this._panDelta.y)>.001){Ha.copy(this.node.position).sub(Hs),py.setFromMatrixColumn(this.node.matrix,0),fy.setFromMatrixColumn(this.node.matrix,1);let n=2*Ha.length()*Bw(zw(.5*this.lens.fov)),r=Qh(1,0,this.freelook.panSmoothing,e),i=this.aim.trackedObjectOffset;i.sub(py.multiplyScalar(this._panDelta.x*n*(1-r))),i.add(fy.multiplyScalar(this._panDelta.y*n*(1-r))),this._panDelta.multiplyScalar(r),Hs.copy(this.lookAt.position).add(i),this.node.position.copy(Ha.add(Hs))}this.node.lookAt(Hs)}}}}const gy="SYSTEM_UPDATE",vy="SYSTEM_UPDATE_AFTER",Vw="EULER";function Ww(s,e,t){s.sleep||(s.mass!==1&&s.acceleration.multiplyScalar(1/s.mass),s.velocity.add(s.acceleration.multiplyScalar(e)),s.position.add(s.velocity.multiplyScalar(e)),s.acceleration.set(0,0,0))}function Xw(s,e,t,n=Vw){Ww(s,e)}class Hm{a;b;arr;constructor(e,t){Array.isArray(e)?this.arr=e:(this.a=e??0,this.b=t??this.a)}getValue(e=!1){return this.arr?this.arr[this.arr.length*Math.random()>>0]:(function(t,n,r){if(t===n)return r?t>>0:t;{let i=t+Math.random()*(n-t);return r?i>>0:i}})(this.a,this.b,e)}}class yy{_countSpan=null;_intervalSpan=null;_elapse=0;_inteval=0;_lastTime=0;_repeat=1;_repeatCount=1;constructor(e=1,t=0,n=1){this._countSpan=Array.isArray(e)?new Hm(e[0],e[1]):new Hm(e),this._intervalSpan=Array.isArray(t)?new Hm(t[0],t[1]):new Hm(t),this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat=n}reset(){this._elapse=0,this._lastTime=0,this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat}getVaue(e){return(this._repeatCount>0||this._repeat<0)&&(this._elapse+=e,this._elapse-this._lastTime>=this._inteval)?(this._lastTime+=this._inteval,this._inteval=this._intervalSpan.getValue(),this._repeatCount--,this._countSpan.getValue(!0)):0}}const{PI:S0}=Math,Zh={easeLinear:function(s){return s},easeInQuad:function(s){return Math.pow(s,2)},easeOutQuad:function(s){return-(Math.pow(s-1,2)-1)},easeInOutQuad:function(s){return(s/=.5)<1?.5*Math.pow(s,2):-.5*((s-=2)*s-2)},easeInCubic:function(s){return Math.pow(s,3)},easeOutCubic:function(s){return Math.pow(s-1,3)+1},easeInOutCubic:function(s){return(s/=.5)<1?.5*Math.pow(s,3):.5*(Math.pow(s-2,3)+2)},easeInQuart:function(s){return Math.pow(s,4)},easeOutQuart:function(s){return-(Math.pow(s-1,4)-1)},easeInOutQuart:function(s){return(s/=.5)<1?.5*Math.pow(s,4):-.5*((s-=2)*Math.pow(s,3)-2)},easeInSine:function(s){return 1-Math.cos(s*(S0/2))},easeOutSine:function(s){return Math.sin(s*(S0/2))},easeInOutSine:function(s){return-.5*(Math.cos(S0*s)-1)},easeInExpo:function(s){return s===0?0:Math.pow(2,10*(s-1))},easeOutExpo:function(s){return s===1?1:1-Math.pow(2,-10*s)},easeInOutExpo:function(s){return s===0?0:s===1?1:(s/=.5)<1?.5*Math.pow(2,10*(s-1)):.5*(2-Math.pow(2,-10*--s))},easeInCirc:function(s){return-(Math.sqrt(1-s*s)-1)},easeOutCirc:function(s){return Math.sqrt(1-Math.pow(s-1,2))},easeInOutCirc:function(s){return(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)},easeInBack:function(s){var e=1.70158;return s*s*((e+1)*s-e)},easeOutBack:function(s){var e=1.70158;return(s-=1)*s*((e+1)*s+e)+1},easeInOutBack:function(s){var e=1.70158;return(s/=.5)<1?s*s*((1+(e*=1.525))*s-e)*.5:.5*((s-=2)*s*((1+(e*=1.525))*s+e)+2)}};function xy(s){return s.constructor.type==="Span"?s.getValue():s}function jm(s,e,t){for(var n in e)s.hasOwnProperty(n)&&(t?t.indexOf(n)<0&&(s[n]=xy(e[n])):s[n]=xy(e[n]));return s}function qw(s,e){for(let t in e)if(s.hasOwnProperty(t)){let n=s[t];n&&n.copy?n.copy(e[t]):s[t]=e[t]}return s}const{clamp:LE,clamp01:Yw}=Kn;class _0{index=0;age=0;life=1/0;energy=1;progress=0;dead=!1;sleep=!1;delay=0;acceleration=new D;scale=new D(1,1,1);position=new D;velocity=new D;rotation=new wr;behaviours=[];parent=null;color=new Ne;alpha=1;mass=1;easing=Zh.easeLinear;transform={};rand=new D;constructor(e){jm(this,e)}reset(){return this.age=0,this.life=1/0,this.energy=1,this.progress=0,this.dead=!1,this.sleep=!1,this.delay=0,this.acceleration.set(0,0,0),this.scale.set(1,1,1),this.position.set(0,0,0),this.velocity.set(0,0,0),this.rotation.set(0,0,0),this.parent=null,this.color.setRGB(1,1,1),this.alpha=1,this.mass=1,this.easing=Zh.easeLinear,this.rand.set(0,0,0),this.removeAllBehaviours(),this}destroy(){return this.dead=!0,this.parent=null,this}update(e){if(this.sleep||this.dead)return!1;if(this.delay>0)return this.delay-=e,!1;if(this.age+=e,this.age>this.life){if(!(this.energy>0))return this.destroy(),!1;this.energy=0,this.progress=1}else this.progress=this.easing(Yw(this.age/this.life)),this.energy=1-this.progress;for(let t=this.behaviours.length;t--;)this.behaviours[t].applyBehaviour(this,e,this.progress);return!0}addBehaviour(...e){for(let t of e)this.behaviours.push(t),t.initialize(this)}removeBehaviour(e){let t=this.behaviours.indexOf(e);t>-1&&this.behaviours.splice(t,1)}removeAllBehaviours(){this.behaviours.length=0}}const Qw=new R1(null,new ot,new ot);class by{spriteFrame=Qw;count=1;interval=0;repeat=1;billboard=!0;behaviours=[];constructor(e={}){jm(this,e)}}const{clamp:Zw}=Kn,Sy={count:1};class Kw extends _0{rate=new yy(1,.1);playing=!1;particles=[];damping=.006;controller=new by;constructor(e){super(),jm(this,e),this.initialize(this.controller)}initialize({count:e,interval:t,repeat:n,behaviours:r}){this.rate=new yy(e,t,n),this.behaviours=r}update(e){return!this.sleep&&!this.dead&&(this.age+=e,this.age>this.life&&this.particles.length==0&&this.destroy(),this.playing&&this.generate(e),this.particles.length>0&&this.integrate(e),!0)}integrate(e){this.damping;let t,n=Zw(60*e,.5,1.5);for(let r=this.particles.length;r--;)t=this.particles[r],t.update(e)&&(this.parent?.emit("PARTICLE_UPDATE",t),this.controller.onParticleUpdate&&this.controller.onParticleUpdate(t),Xw(t,n)),t.dead&&(this.particles.splice(r,1),this.parent?.pool.expire(t),this.parent?.emit("PARTICLE_DEAD",t))}createParticle(e){let t=this.parent.pool.get(_0);t.reset(),t.addBehaviour(...this.behaviours),t.parent=this,t.index=this.particles.length,this.particles.push(t),this.parent?.emit("PARTICLE_CREATED",t),this.controller.onParticleCreate&&this.controller.onParticleCreate(t,e)}generate(e){for(let t=Sy.count=this.rate.getVaue(e);t--;)this.createParticle(Sy)}emit(e){for(let t=e.count=Math.max(1,e.count);t--;)this.createParticle(e)}play(){this.playing=!0,this.rate.reset()}stop(){this.playing=!1}}class Jw{list=[];get(e){return this.list.length>0?this.list.pop():new e}expire(e){this.list.push(e)}}var _y=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class w0 extends en{playing=!1;pool=new Jw;emitters=[];renderers=[];onLoad({name:e,...t}){this.name=e||"ParticleSystem-"+this.uuid,$t(this.node,t)}addEmitter(e){return e.parent=this,this.emitters.push(e),this.emit("EMITTER_ADDED",e),this}removeEmitter(e){return e.parent!==this||(e.parent=null,this.emitters.splice(this.emitters.indexOf(e),1),this.emit("EMITTER_REMOVED",e)),this}addRenderer(e){return this.renderers.push(e.init(this)),this}removeRenderer(e){return this.renderers.splice(this.renderers.indexOf(e.reset()),1),this}play(){for(let e=this.emitters.length;e--;)this.emitters[e].play();return this.playing=!0,this}stop(){return this.playing=!1,this}update(e){if(!this.playing)return;let t;for(let n=this.emitters.length;n--;)t=this.emitters[n],t.update(e),t.particles.length&&this.emit(gy,this);this.emit(vy,this)}getCount(){let e=0;for(let t=this.emitters.length;t--;)e+=this.emitters[t].particles.length;return e}onDestroy(){for(let e=this.emitters.length;e--;)this.emitters[e].destroy();for(let e=this.renderers.length;e--;)this.renderers[e].destroy();this.emitters.length=0,this.renderers.length=0}}_y([fn()],w0.prototype,"play",null),_y([fn()],w0.prototype,"stop",null);class Ip{enabled;constructor(e=!0){this.enabled=e}applyBehaviour(e,t,n){this.enabled&&this.mutate(e,t,n)}initialize(e){}mutate(e,t,n){}}class $w extends Ip{alphaA;alphaB;easing;constructor(e=1,t,n=Zh.easeLinear,r){super(r),this.alphaA=e,this.alphaB=t,this.easing=n}initialize(e){e.transform.alphaA=this.alphaA,e.transform.alphaB=this.alphaB}mutate(e,t,n){e.alpha=e.transform.alphaB!==void 0?Kn.lerp(e.transform.alphaA,e.transform.alphaB,this.easing(n)):e.transform.alphaA}}class eM extends Ip{colorA;colorB;easing;constructor(e=new Ne,t,n=Zh.easeLinear,r){super(r),this.colorA=e,this.colorB=t,this.easing=n}initialize(e){e.transform.colorA=this.colorA.clone(),e.transform.colorB=this.colorB?.clone()}mutate(e,t,n){e.color.copy(e.transform.colorA),e.transform.colorB&&e.color.lerp(e.transform.colorB,this.easing(n))}}class wy extends Ip{force;constructor(e=new D,t){super(t),this.force=e,this.force.multiplyScalar(100)}initialize(e){e.transform.force=this.force.clone()}mutate(e,t,n){e.acceleration.add(e.transform.force)}}class tM extends wy{gravity;constructor(e=10,t){super(new D(0,-e,0),t),this.gravity=e}}class nM extends Ip{scaleA;scaleB;easing;constructor(e=new D,t,n=Zh.easeLinear,r){super(r),this.scaleA=e,this.scaleB=t,this.easing=n}initialize(e){e.transform.scaleA=this.scaleA.clone(),e.transform.scaleB=this.scaleB?.clone()}mutate(e,t,n){e.scale.copy(e.transform.scaleA),e.transform.scaleB&&e.scale.lerp(e.transform.scaleB,this.easing(n))}}class My extends ht{system;init(e){return this.system=e,this.system.node.add(this),this.system.on(gy,this.onSystemUpdate,this),this.system.on(vy,this.onSystemUpdateAfter,this),this}reset(){return this.system&&(this.system.targetOff(this),this.system.node.remove(this),this.system=void 0),this}destroy(){}onSystemUpdate(e){}onSystemUpdateAfter(e){}}const Ty={blending:Un,depthTest:!0,depthWrite:!1,transparent:!0,maxParticles:200},M0=new Vi;let Kh=new Jt;class rM extends My{stride=21;buffer;interleavedBuffer;geometry=new Mm;renderMode=0;constructor(e=Ty){super();const{blending:t,useAlphaSDF:n,depthTest:r,depthWrite:i,transparent:a,maxParticles:l,map:u,...h}={...Ty,...e},p=new Bt({uniforms:{map:{value:u}},defines:{USE_ALPHA_SDF:!!n,IS_ADDITIVE_BLENDING:t===Un},vertexShader:`
precision highp float;
attribute vec4 texCoords;
attribute vec4 meshCoords;
attribute vec3 spritePos;
attribute vec4 spriteQuat;
attribute vec4 spriteColor;
attribute vec2 decorators;

varying vec2 vUv;
varying vec4 vColor;

#include <matrix>

mat2 makeRotateMatrix(in float rad) {
    float c = cos(rad);
    float s = sin(rad);
    return mat2(c,-s,s,c);
}

void main() {
    vColor = spriteColor;
    vUv = uv * texCoords.zw + texCoords.xy;
    vUv.y = 1. - vUv.y;

    mat4 instanceMatrix = getInstanceMatrix(spritePos, spriteQuat, vec3(1.));
    mat4 mvMatrix = modelViewMatrix * instanceMatrix;

    vec4 transformed = vec4(position,1.);
    transformed.xy = transformed.xy * meshCoords.zw + meshCoords.xy;

    vec4 mvPosition = mvMatrix * transformed;
    vec4 bbPosition = mvMatrix * vec4(0.,0.,0.,1.);
    vec2 scale = vec2(length(mvMatrix[0].xyz), length(mvMatrix[1].xyz));
    bbPosition.xy += makeRotateMatrix(spriteQuat.x) * transformed.xy * scale;
    mvPosition = mix(mvPosition, bbPosition, decorators.x);
    
    gl_Position = projectionMatrix * mvPosition;
}
`,fragmentShader:`
precision highp float;
uniform sampler2D map;
varying vec2 vUv;
varying vec4 vColor;

float luma(vec3 color) { return dot(color, vec3(0.299, 0.587, 0.114)); }

void main() {
    vec4 color = texture2D(map, vUv);
    float shape = color.r;

#ifdef USE_ALPHA_SDF
#ifdef IS_ADDITIVE_BLENDING
    float l = vColor.a * luma(vColor.rgb);
    shape = max(smoothstep(0.48, 0.52, shape), shape * l);
#else
    shape = smoothstep(0.48, 0.52, shape);
#endif
#endif

    float alpha = color.a * vColor.a;
    vec3 col = vColor.rgb * vColor.a * shape;
    gl_FragColor = vec4(col, alpha * shape);
}
`,blending:t,depthTest:r,depthWrite:i,transparent:a});let f=new Float32Array(l*this.stride),m=new Zv(f,this.stride),g=new Mm;g.index=M0.index,g.attributes.position=M0.attributes.position,g.attributes.uv=M0.attributes.uv,g.setAttribute("texCoords",new Or(m,4,0,!1)),g.setAttribute("meshCoords",new Or(m,4,4,!1)),g.setAttribute("spritePos",new Or(m,3,8,!1)),g.setAttribute("decorators",new Or(m,2,11,!1)),g.setAttribute("spriteQuat",new Or(m,4,13,!1)),g.setAttribute("spriteColor",new Or(m,4,17,!1)),this.buffer=f,this.interleavedBuffer=m,this.interleavedBuffer.setUsage(hf),this.geometry=g,this.material=p,this.frustumCulled=!1,$t(this,h)}onSystemUpdateAfter(e){let t=0,n=e.emitters;for(let r=n.length;r--;){let i=n[r].particles;for(let a=i.length;a--;)this.commitInstanceBuffer(i[a],t++*this.stride)}this.interleavedBuffer.needsUpdate=!0,this.geometry.instanceCount=t,this.visible=t>0}commitInstanceBuffer(e,t=0){let{position:n,rotation:r,scale:i,color:a}=e,{billboard:l,spriteFrame:u}=e.parent.controller,{texCoords:h,meshCoords:p}=u;l?Kh.x=r.x:Kh.setFromEuler(r);let f=this.buffer;f[t++]=h.x,f[t++]=h.y,f[t++]=h.z,f[t++]=h.w,f[t++]=p.x*i.x,f[t++]=p.y*i.y,f[t++]=p.z*i.x,f[t++]=p.w*i.y,f[t++]=n.x,f[t++]=n.y,f[t++]=n.z,f[t++]=l?1:0,f[t++]=0,f[t++]=Kh.x,f[t++]=Kh.y,f[t++]=Kh.z,f[t++]=Kh.w,f[t++]=a.r,f[t++]=a.g,f[t++]=a.b,f[t++]=e.alpha}}class iM extends en{create({width:e=1,height:t=1,depth:n=1,widthSegments:r=1,heightSegments:i=1,depthSegments:a=1,material:l=new st,...u}){return $t(new ht(new Xn(e,t,n,r,i,a),l),u)}}class aM extends en{create({radius:e=1,length:t=1,capSegments:n=4,radialSegments:r=8,material:i=new st,...a}){return $t(new ht(new Gl(e,t,n,r),i),a)}}class sM extends en{create({radius:e,segments:t,thetaStart:n,thetaLength:r,material:i=new st,...a}){return $t(new ht(new Ai(e,t,n,r),i),a)}}class oM extends en{create({radius:e=1,height:t=1,radialSegments:n=32,heightSegments:r=1,openEnded:i=!1,thetaStart:a=0,thetaLength:l=2*Math.PI,material:u=new st,...h}){return $t(new ht(new Yi(e,t,n,r,i,a,l),u),h)}}class lM extends en{create({radiusTop:e=1,radiusBottom:t=1,height:n=1,radialSegments:r=32,heightSegments:i=1,openEnded:a=!1,thetaStart:l=0,thetaLength:u=2*Math.PI,material:h=new st,...p}){return $t(new ht(new ma(e,t,n,r,i,a,l,u),h),p)}}class cM extends en{create({radius:e=1,detail:t=0,material:n=new st,...r}){return $t(new ht(new ks(e,t),n),r)}}class uM extends en{create({geometry:e=null,thresholdAngle:t=1,material:n=new st,...r}){return $t(new ht(new Uh(e,t),n),r)}}class hM extends en{create({shapes:e=new Fa([new ce(.5,.5),new ce(-.5,.5),new ce(-.5,-.5),new ce(.5,-.5)]),options:t={},material:n=new st,...r}){return $t(new ht(new Pe(e,t),n),r)}}class dM extends en{create({radius:e=1,detail:t=0,material:n=new st,...r}){return $t(new ht(new Xe(e,t),n),r)}}class pM extends en{create({points:e=[new ce(0,-.5),new ce(.5,0),new ce(0,.5)],segments:t=12,phiStart:n=0,phiLength:r=2*Math.PI,material:i=new st,...a}){return $t(new ht(new us(e,t,n,r),i),a)}}class fM extends en{create({radius:e=1,detail:t=0,material:n=new st,...r}){return $t(new ht(new Qe(e,t),n),r)}}class mM extends en{create({width:e=1,height:t=1,widthSegments:n=1,heightSegments:r=1,material:i=new st,...a}){return $t(new ht(new Vi(e,t,n,r),i),a)}}class gM extends en{create({vertices:e=[],indices:t=[],radius:n=1,detail:r=0,material:i=new st,...a}){return $t(new ht(new Ri(e,t,n,r),i),a)}}class vM extends en{create({innerRadius:e=.5,outerRadius:t=1,thetaSegments:n=32,phiSegments:r=1,thetaStart:i=0,thetaLength:a=2*Math.PI,material:l=new st,...u}){return $t(new ht(new tt(e,t,n,r,i,a),l),u)}}class yM extends en{create({shapes:e=new Fa([new ce(0,.5),new ce(-.5,-.5),new ce(.5,-.5)]),curveSegments:t=12,material:n=new st,...r}){return $t(new ht(new xn(e,t),n),r)}}class xM extends en{create({radius:e,widthSegments:t,heightSegments:n,material:r=new st,...i}){return $t(new ht(new ae(e,t,n),r),i)}}class bM extends en{create({radius:e=1,detail:t=0,material:n=new st,...r}){return $t(new ht(new Z(e,t),n),r)}}class SM extends en{create({radius:e=1,tube:t=.4,radialSegments:n=12,tubularSegments:r=48,arc:i=2*Math.PI,material:a=new st,...l}){return $t(new ht(new ue(e,t,n,r,i),a),l)}}class _M extends en{create({radius:e=1,tube:t=.4,tubularSegments:n=64,radialSegments:r=8,p:i=2,q:a=3,material:l=new st,...u}){return $t(new ht(new ke(e,t,n,r,i,a),l),u)}}class wM extends en{create({path:e=new Xc(new D(-1,-1,0),new D(-1,1,0),new D(1,1,0)),tubularSegments:t=64,radius:n=1,radialSegments:r=8,closed:i=!1,material:a=new st,...l}){return $t(new ht(new rt(e,t,n,r,i),a),l)}}class MM extends en{create({geometry:e=null,material:t=new st,...n}){return $t(new ht(new lt(e),t),n)}}class Ey extends Bt{kernel;constructor(e=new ce){super({uniforms:{inputBuffer:new qe(null),depthBuffer:new qe(null),resolution:new qe(new ce),texelSize:new qe(new ce),halfTexelSize:new qe(new ce),kernel:new qe(0),scale:new qe(1),cameraNear:new qe(0),cameraFar:new qe(1),minDepthThreshold:new qe(0),maxDepthThreshold:new qe(1),depthScale:new qe(0),depthToBlurRatioBias:new qe(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <encodings_fragment>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:it,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class Ay{renderTargetA;renderTargetB;convolutionMaterial;scene;camera;screen;renderToScreen=!1;constructor({gl:e,resolution:t,width:n=500,height:r=500,minDepthThreshold:i=0,maxDepthThreshold:a=1,depthScale:l=0,depthToBlurRatioBias:u=.25}){this.renderTargetA=new Xt(t,t,{minFilter:_t,magFilter:_t,stencilBuffer:!1,depthBuffer:!1,type:br}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Ey,this.convolutionMaterial.setTexelSize(1/n,1/r),this.convolutionMaterial.setResolution(new ce(n,r)),this.scene=new Oa,this.camera=new Ls,this.convolutionMaterial.uniforms.minDepthThreshold.value=i,this.convolutionMaterial.uniforms.maxDepthThreshold.value=a,this.convolutionMaterial.uniforms.depthScale.value=l,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=u,this.convolutionMaterial.defines.USE_DEPTH=l>0;const h=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),p=new Float32Array([0,0,2,0,0,2]),f=new ut;f.setAttribute("position",new pt(h,3)),f.setAttribute("uv",new pt(p,2)),this.screen=new ht(f,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,n){const r=this.scene,i=this.camera,a=this.renderTargetA,l=this.renderTargetB;let u=this.convolutionMaterial,h=u.uniforms;h.depthBuffer.value=t.depthTexture;const p=u.kernel;let f,m,g,x=t;for(m=0,g=p.length-1;m<g;++m)f=(1&m)==0?a:l,h.kernel.value=p[m],h.inputBuffer.value=x.texture,e.setRenderTarget(f),e.render(r,i),x=f;h.kernel.value=p[m],h.inputBuffer.value=x.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(r,i)}}class Ry extends st{_tDepth={value:null};_distortionMap={value:null};_tDiffuse={value:null};_tDiffuseBlur={value:null};_textureMatrix={value:null};_hasBlur={value:!1};_mirror={value:0};_mixBlur={value:0};_blurStrength={value:.5};_minDepthThreshold={value:.9};_maxDepthThreshold={value:1};_depthScale={value:0};_depthToBlurRatioBias={value:.25};_distortion={value:1};_mixContrast={value:1};constructor(e={}){super(e),this.setValues(e)}onBeforeCompile(e){e.defines?.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),e.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
		uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}}const Np=new ot,Io=new ot,Jh=new Gi,mu=new D,T0=new D,kp=new D,Fp=new Ie,Jl=new D,Gm=new D,Vm=new D;class TM extends en{_fbo1;_fbo2;_blurPass;_hasBlur=!1;_virtualCamera=new vn;_reflectorOffset=0;_textureMatrix=new Ie;_reflectorMaterial;create({width:e=1,height:t=1,...n}){return $t(new ht(new Vi(e,t)),{rotation:E1(-Math.PI/2,0,0),...n})}onLoad({mixBlur:e=0,mixStrength:t=1,resolution:n=256,blur:r=[0,0],minDepthThreshold:i=.9,maxDepthThreshold:a=1,depthScale:l=0,depthToBlurRatioBias:u=.25,mirror:h=0,distortion:p=1,mixContrast:f=1,distortionMap:m,reflectorOffset:g=0,...x}){const y=this.viewer.renderer,b={minFilter:_t,magFilter:_t,type:br};this._fbo1=new Xt(n,n,b),this._fbo1.depthBuffer=!0,this._fbo1.depthTexture=new er(n,n),this._fbo1.depthTexture.format=xa,this._fbo1.depthTexture.type=qo,this._fbo2=new Xt(n,n,b),this._blurPass=new Ay({gl:y,resolution:n,width:r[0],height:r[1],minDepthThreshold:i,maxDepthThreshold:a,depthScale:l,depthToBlurRatioBias:u});let w=this._hasBlur=r[0]+r[1]>0;this._reflectorOffset=g,this._reflectorMaterial=Object.assign(new Ry,{mirror:h,mixBlur:e,textureMatrix:this._textureMatrix,tDiffuse:this._fbo1.texture,tDepth:this._fbo1.depthTexture,tDiffuseBlur:this._fbo2.texture,hasBlur:w,mixStrength:t,minDepthThreshold:i,maxDepthThreshold:a,depthScale:l,depthToBlurRatioBias:u,distortion:p,distortionMap:m,mixContrast:f,defines:{USE_BLUR:w?"":void 0,USE_DEPTH:l>0?"":void 0,USE_DISTORTION:m?"":void 0},...x},!0),this.node.material=this._reflectorMaterial}onDestroy(){this._fbo1.dispose(),this._fbo2.dispose(),this._reflectorMaterial.dispose()}beforeRender(){const e=this.viewer.camera,t=this._virtualCamera,n=this._textureMatrix;if(mu.setFromMatrixPosition(this.node.matrixWorld),T0.setFromMatrixPosition(e.matrixWorld),Fp.extractRotation(this.node.matrixWorld),Jl.set(0,0,1),Jl.applyMatrix4(Fp),mu.addScaledVector(Jl,this._reflectorOffset),kp.subVectors(mu,T0),kp.dot(Jl)>0)return;kp.reflect(Jl).negate(),kp.add(mu),Fp.extractRotation(e.matrixWorld),Vm.set(0,0,-1),Vm.applyMatrix4(Fp),Vm.add(T0),Gm.subVectors(mu,Vm),Gm.reflect(Jl).negate(),Gm.add(mu),t.position.copy(kp),t.up.set(0,1,0),t.up.applyMatrix4(Fp),t.up.reflect(Jl),t.lookAt(Gm),t.far=e.far,t.updateMatrixWorld(),t.projectionMatrix.copy(e.projectionMatrix),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse),n.multiply(this.node.matrixWorld),Jh.setFromNormalAndCoplanarPoint(Jl,mu),Jh.applyMatrix4(t.matrixWorldInverse),Io.set(Jh.normal.x,Jh.normal.y,Jh.normal.z,Jh.constant);const r=t.projectionMatrix;Np.x=(Math.sign(Io.x)+r.elements[8])/r.elements[0],Np.y=(Math.sign(Io.y)+r.elements[9])/r.elements[5],Np.z=-1,Np.w=(1+r.elements[10])/r.elements[14],Io.multiplyScalar(2/Io.dot(Np)),r.elements[2]=Io.x,r.elements[6]=Io.y,r.elements[10]=Io.z+1,r.elements[14]=Io.w}update(e){this.node.visible=!1;const t=this.viewer.renderer,n=this.viewer.scene,r=t.xr.enabled,i=t.shadowMap.autoUpdate;this.beforeRender(),t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.setRenderTarget(this._fbo1),t.state.buffers.depth.setMask(!0),t.autoClear||t.clear(),t.render(n,this._virtualCamera),this._hasBlur&&this._blurPass.render(t,this._fbo1,this._fbo2),t.xr.enabled=r,t.shadowMap.autoUpdate=i,this.node.visible=!0,t.setRenderTarget(null)}}class EM extends en{_fbo;_scene;_camera;get texture(){return this._fbo.texture}onLoad({width:e=128,height:t=128,...n}){const{scene:r,camera:i,size:a,renderer:l}=this.viewer;this._scene=r,this._camera=i,this._fbo=new Xt(e||a.width,t||a.height),this._fbo.texture.readPixels=(u,h,p,f,m)=>l.readRenderTargetPixels(this._fbo,u,h,p,f,m),$t(this.texture,n)}update(e){const t=this.viewer.renderer;t.setRenderTarget(this._fbo),t.render(this._scene,this._camera),t.setRenderTarget(null)}}class E0 extends en{create(){return new ht(new ae(500,60,40),new mr({side:Be}))}}class AM extends E0{onLoad(e){Zi.Load(Object.assign({magFilter:_t,minFilter:_t},e)).then((t=>{this.node.material.map=t,this.node.material.needsUpdate=!0}))}}class RM extends E0{}class Ly extends en{create(){return new Zg(new Em)}onLoad({listener:e}){this.viewer.addNode(this.node.listener,{},e||this.viewer.camera)}play({url:e,loop:t=!1,volume:n=1,force:r=!1}){Zi.Load({url:e}).then((i=>{r&&this.node.stop(),this.node.setBuffer(i),this.node.setLoop(t),this.node.setVolume(n),this.node.isPlaying||this.node.play()}))}stop(){this.node.stop()}}class LM extends en{create(){return new Em}onLoad(e){this.node}}class PM extends Ly{create(){return new Yv(new Em)}play({refDistance:e=20,maxDistance:t=1e4,...n}){super.play(n),this.node.setRefDistance(e),this.node.setMaxDistance(t)}}function A0(s){return s>1e3?Math.floor(.001*s)+"k":s>1e6?Math.floor(1e-6*s)+"m":s}var gu=function(s,e,t){var n=1/0,r=0,i=Math.round,a=i(window.devicePixelRatio||1),l=80*a,u=48*a,h=3*a,p=2*a,f=3*a,m=15*a,g=74*a,x=30*a,y=document.createElement("canvas");y.width=l,y.height=u,y.style.cssText="width:80px;height:48px";var b=y.getContext("2d");return b.font="bold "+9*a+"px Helvetica,Arial,sans-serif",b.textBaseline="top",b.fillStyle=t,b.fillRect(0,0,l,u),b.fillStyle=e,b.fillText(s,h,p),b.fillRect(f,m,g,x),b.fillStyle=t,b.globalAlpha=.9,b.fillRect(f,m,g,x),{dom:y,update:function(w,_){n=Math.min(n,w),r=Math.max(r,w),b.fillStyle=t,b.globalAlpha=1,b.fillRect(0,0,l,m),b.fillStyle=e,b.fillText(A0(i(w))+" "+s+" ("+A0(i(n))+"-"+A0(i(r))+")",h,p),b.drawImage(y,f+a,m,g-a,x,f,m,g-a,x),b.fillRect(f+g-a,m,a,x),b.fillStyle=t,b.globalAlpha=.9,b.fillRect(f+g-a,m,a,i((1-w/_)*x))}}},CM=function(){var s=0,e=document.createElement("div");function t(p){return e.appendChild(p.dom),p}function n(p){for(var f=0;f<e.children.length;f++)e.children[f].style.display=f===p?"block":"none";s=p}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",(function(p){p.preventDefault(),n(++s%e.children.length)}),!1);var r=(performance||Date).now(),i=r,a=0,l=t(new gu("FPS","#0ff","#002")),u=t(new gu("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=t(new gu("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){a++;var p=(performance||Date).now();if(u.update(p-r,200),p>=i+1e3&&(l.update(1e3*a/(p-i),100),i=p,a=0,h)){var f=performance.memory;h.update(f.usedJSHeapSize/1048576,f.jsHeapSizeLimit/1048576)}return p},update:function(){r=this.end()},domElement:e,setMode:n}};class DM extends ui{_stats=new CM;_dcPanel=new gu("DC","#ff8","#221");_triPanel=new gu("TRI","#ff8","#221");_texPanel=new gu("TEX","#ff8","#221");_prgPanel=new gu("PRG","#ff8","#221");onLoad(e){this._stats.addPanel(this._dcPanel),this._stats.addPanel(this._texPanel),this._stats.addPanel(this._triPanel),this._stats.addPanel(this._prgPanel),this._stats.showPanel(0),document.body.appendChild(this._stats.dom)}update(e){let t=this.viewer.renderer.info;this._dcPanel.update(t.render.calls,300),this._triPanel.update(t.render.triangles,5e5),this._texPanel.update(t.memory.textures,200),this._prgPanel.update(t.programs.length,50),this._stats.update()}}class OM extends ui{name="VirtualCameraPlugin";_brain=null;_freelookCamera=null;onEnable(){this._brain&&(this._brain.enabled=!0),this._freelookCamera&&(this._freelookCamera.enabled=!0)}onDisable(){this._brain&&(this._brain.enabled=!1),this._freelookCamera&&(this._freelookCamera.enabled=!1)}onLoad(e){const t=this.viewer.camera,n=Object.assign({fov:t.fov,near:t.near,far:t.far,lookAt:new St,position:T1(0,0,4)},e);this._brain=this.viewer.addComponent(t,y0),this._freelookCamera=this.viewer.addNode(my,n)}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.18.2
 * @author George Michael Brower
 * @license MIT
 */class ga{constructor(e,t,n,r,i="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),ga.nextNameID=ga.nextNameID||0,this.$name.id="lil-gui-name-"+ ++ga.nextNameID,this.$widget=document.createElement(i),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",(a=>a.stopPropagation())),this.domElement.addEventListener("keyup",(a=>a.stopPropagation())),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Py extends ga{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",(()=>{this.setValue(this.$input.checked),this._callOnFinishChange()})),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function R0(s){let e,t;return(e=s.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=s.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=s.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const IM={isPrimitive:!0,match:s=>typeof s=="string",fromHexString:R0,toHexString:R0},Up={isPrimitive:!0,match:s=>typeof s=="number",fromHexString:s=>parseInt(s.substring(1),16),toHexString:s=>"#"+s.toString(16).padStart(6,0)},NM={isPrimitive:!1,match:s=>Array.isArray(s),fromHexString(s,e,t=1){const n=Up.fromHexString(s);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(255&n)/255*t},toHexString:([s,e,t],n=1)=>Up.toHexString(s*(n=255/n)<<16^e*n<<8^t*n<<0)},kM={isPrimitive:!1,match:s=>Object(s)===s,fromHexString(s,e,t=1){const n=Up.fromHexString(s);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(255&n)/255*t},toHexString:({r:s,g:e,b:t},n=1)=>Up.toHexString(s*(n=255/n)<<16^e*n<<8^t*n<<0)},FM=[IM,Up,NM,kM];class Cy extends ga{constructor(e,t,n,r){var i;super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(i=this.initialValue,FM.find((a=>a.match(i)))),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",(()=>{this._setValueFromHexString(this.$input.value)})),this.$input.addEventListener("blur",(()=>{this._callOnFinishChange()})),this.$text.addEventListener("input",(()=>{const a=R0(this.$text.value);a&&this._setValueFromHexString(a)})),this.$text.addEventListener("focus",(()=>{this._textFocused=!0,this.$text.select()})),this.$text.addEventListener("blur",(()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()})),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Wm extends ga{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",(r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()})),this.$button.addEventListener("touchstart",(()=>{}),{passive:!0}),this.$disable=this.$button}}class Dy extends ga{constructor(e,t,n,r,i,a){super(e,t,n,"number"),this._initInput(),this.min(r),this.max(i);const l=a!==void 0;this.step(l?a:this._getImplicitStep(),l),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=p=>{const f=parseFloat(this.$input.value);isNaN(f)||(this._snapClampSetValue(f+p),this.$input.value=this.getValue())};let t,n,r,i,a,l=!1;const u=p=>{if(l){const f=p.clientX-t,m=p.clientY-n;Math.abs(m)>5?(p.preventDefault(),this.$input.blur(),l=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(f)>5&&h()}if(!l){const f=p.clientY-r;a-=f*this._step*this._arrowKeyMultiplier(p),i+a>this._max?a=this._max-i:i+a<this._min&&(a=this._min-i),this._snapClampSetValue(i+a)}r=p.clientY},h=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",h)};this.$input.addEventListener("input",(()=>{let p=parseFloat(this.$input.value);isNaN(p)||(this._stepExplicit&&(p=this._snap(p)),this.setValue(this._clamp(p)))})),this.$input.addEventListener("keydown",(p=>{p.key==="Enter"&&this.$input.blur(),p.code==="ArrowUp"&&(p.preventDefault(),e(this._step*this._arrowKeyMultiplier(p))),p.code==="ArrowDown"&&(p.preventDefault(),e(this._step*this._arrowKeyMultiplier(p)*-1))})),this.$input.addEventListener("wheel",(p=>{this._inputFocused&&(p.preventDefault(),e(this._step*this._normalizeMouseWheel(p)))}),{passive:!1}),this.$input.addEventListener("mousedown",(p=>{t=p.clientX,n=r=p.clientY,l=!0,i=this.getValue(),a=0,window.addEventListener("mousemove",u),window.addEventListener("mouseup",h)})),this.$input.addEventListener("focus",(()=>{this._inputFocused=!0})),this.$input.addEventListener("blur",(()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()}))}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=m=>{const g=this.$slider.getBoundingClientRect();let x=((y,b,w,_,T)=>(y-b)/(w-b)*(T-_)+_)(m,g.left,g.right,this._min,this._max);this._snapClampSetValue(x)},t=m=>{e(m.clientX)},n=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)};let r,i,a=!1;const l=m=>{m.preventDefault(),this._setDraggingStyle(!0),e(m.touches[0].clientX),a=!1},u=m=>{if(a){const g=m.touches[0].clientX-r,x=m.touches[0].clientY-i;Math.abs(g)>Math.abs(x)?l(m):(window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h))}else m.preventDefault(),e(m.touches[0].clientX)},h=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",u),window.removeEventListener("touchend",h)},p=this._callOnFinishChange.bind(this);let f;this.$slider.addEventListener("mousedown",(m=>{this._setDraggingStyle(!0),e(m.clientX),window.addEventListener("mousemove",t),window.addEventListener("mouseup",n)})),this.$slider.addEventListener("touchstart",(m=>{m.touches.length>1||(this._hasScrollBar?(r=m.touches[0].clientX,i=m.touches[0].clientY,a=!0):l(m),window.addEventListener("touchmove",u,{passive:!1}),window.addEventListener("touchend",h))}),{passive:!1}),this.$slider.addEventListener("wheel",(m=>{if(Math.abs(m.deltaX)<Math.abs(m.deltaY)&&this._hasScrollBar)return;m.preventDefault();const g=this._normalizeMouseWheel(m)*this._step;this._snapClampSetValue(this.getValue()+g),this.$input.value=this.getValue(),clearTimeout(f),f=setTimeout(p,400)}),{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class Oy extends ga{constructor(e,t,n,r){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach((i=>{const a=document.createElement("option");a.innerHTML=i,this.$select.appendChild(a)})),this.$select.addEventListener("change",(()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()})),this.$select.addEventListener("focus",(()=>{this.$display.classList.add("focus")})),this.$select.addEventListener("blur",(()=>{this.$display.classList.remove("focus")})),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=t===-1?e:this._names[t],this}}class Iy extends ga{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",(()=>{this.setValue(this.$input.value)})),this.$input.addEventListener("keydown",(r=>{r.code==="Enter"&&this.$input.blur()})),this.$input.addEventListener("blur",(()=>{this._callOnFinishChange()})),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let vu=null,Ny=new WeakMap;class ky extends ga{constructor(e,t,n){super(e,t,n,"image"),this.$img=document.createElement("img"),this.$widget.appendChild(this.$img),this.updateDisplay()}updateDisplay(){return(async function(e){if(e instanceof HTMLImageElement)return e.src;{let t=Ny.get(e);if(t)return t;const n=Math.min(e.width,256),r=Math.min(e.height,256);if(vu==null&&(vu=document.createElement("canvas").getContext("2d")),vu.canvas.width=n,vu.canvas.height=r,e.data){let i=vu.createImageData(e.width,e.height);i.data.set(e.data),e=await createImageBitmap(i)}return e instanceof ImageBitmap?(vu.drawImage(e,0,0,e.width,e.height,0,0,n,r),Ny.set(e,t=vu.canvas.toDataURL()),t):""}})(this.getValue()).then((e=>this.$img.src=e)),this}}class Xm{constructor(e){this.dom=e}add(){for(let e=0;e<arguments.length;e++){const t=arguments[e];t instanceof Xm?this.dom.appendChild(t.dom):console.error("UIElement:",t,"is not an instance of UIElement.")}return this}remove(){for(let e=0;e<arguments.length;e++){const t=arguments[e];t instanceof Xm?this.dom.removeChild(t.dom):console.error("UIElement:",t,"is not an instance of UIElement.")}return this}clear(){for(;this.dom.children.length;)this.dom.removeChild(this.dom.lastChild)}setId(e){return this.dom.id=e,this}getId(){return this.dom.id}setClass(e){return this.dom.className=e,this}addClass(e){return this.dom.classList.add(e),this}removeClass(e){return this.dom.classList.remove(e),this}setStyle(e,t){for(let n=0;n<t.length;n++)this.dom.style[e]=t[n];return this}setDisabled(e){return this.dom.disabled=e,this}setTextContent(e){return this.dom.textContent=e,this}getIndexOfChild(e){return Array.prototype.indexOf.call(this.dom.children,e.dom)}}function Fy(s){let e=s.toString(),t=e.indexOf(".");return t>0?e.length-t-1:0}class UM extends Xm{constructor(e){super(document.createElement("input")),this.dom.style.cursor="ns-resize",this.dom.value="0.00",this.value=0,this.min=-1/0,this.max=1/0,this.step=.01,this.precision=Fy(this.step),this.unit="",this.setValue(e);const t=this,n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!0);let r=0,i=0;const a={x:0,y:0},l={x:0,y:0};function u(g){const x=t.value;a.x=g.clientX,a.y=g.clientY,r+=a.x-l.x-(a.y-l.y);let y=i+10*r/(g.shiftKey?5:50)*t.step;y=Math.min(t.max,Math.max(t.min,y)),x!==y&&(t.setValue(y),t.dom.dispatchEvent(n)),l.x=g.clientX,l.y=g.clientY}function h(){document.removeEventListener("mousemove",u,!1),document.removeEventListener("mouseup",h,!1),Math.abs(r)<2&&(t.dom.focus(),t.dom.select())}function p(g){const x=t.value;a.x=g.touches[0].pageX,a.y=g.touches[0].pageY,r+=a.x-l.x-(a.y-l.y);let y=i+r/(g.shiftKey?5:50)*t.step;y=Math.min(t.max,Math.max(t.min,y)),x!==y&&(t.setValue(y),t.dom.dispatchEvent(n)),l.x=g.touches[0].pageX,l.y=g.touches[0].pageY}function f(g){g.touches.length===0&&(document.removeEventListener("touchmove",p,!1),document.removeEventListener("touchend",f,!1))}function m(){t.dom.style.cursor="ns-resize"}m(),this.dom.addEventListener("keydown",(function(g){switch(g.stopPropagation(),g.keyCode){case 13:t.dom.blur();break;case 38:g.preventDefault(),t.setValue(t.getValue()+t.step),t.dom.dispatchEvent(n);break;case 40:g.preventDefault(),t.setValue(t.getValue()-t.step),t.dom.dispatchEvent(n)}}),!1),this.dom.addEventListener("mousedown",(function(g){g.preventDefault(),r=0,i=t.value,l.x=g.clientX,l.y=g.clientY,document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",h,!1)}),!1),this.dom.addEventListener("touchstart",(function(g){g.touches.length===1&&(r=0,i=t.value,l.x=g.touches[0].pageX,l.y=g.touches[0].pageY,document.addEventListener("touchmove",p,!1),document.addEventListener("touchend",f,!1))}),!1),this.dom.addEventListener("change",(function(){t.setValue(t.dom.value)}),!1),this.dom.addEventListener("focus",(function(){t.dom.style.backgroundColor="",t.dom.style.cursor=""}),!1),this.dom.addEventListener("blur",m,!1)}getValue(){return this.value}setValue(e){return e!==void 0&&((e=parseFloat(e))<this.min&&(e=this.min),e>this.max&&(e=this.max),this.value=e,this.dom.value=e.toFixed(this.precision),this.unit!==""&&(this.dom.value+=" "+this.unit),this._onChangeCallback&&this._onChangeCallback(e)),this}onChange(e){return this._onChangeCallback=e,this}setStep(e){return this.step=e,this.precision=Fy(e),this}setRange(e,t){return this.min=e,this.max=t,this}setUnit(e){return this.unit=e,this}}class zM extends ga{constructor(e,t,n,r,i,a){super(e,t,n,"vector"),this.vector=this.initialValue.clone&&this.initialValue.clone()||Object.assign({},this.initialValue);let l=[];this.initialValue.x!==void 0&&l.push("x"),this.initialValue.y!==void 0&&l.push("y"),this.initialValue.z!==void 0&&l.push("z"),this.initialValue.w!==void 0&&l.push("w");for(let u=0;u<l.length;u++)this.setInput(l[u],u<l.length-1,r,i,a)}setInput(e,t,n,r,i){let a=new UM(this.vector[e]);if(a.dom.setAttribute("type","number"),a.dom.setAttribute("aria-labelledby",this.$name.id),a.setRange(n,r),a.setStep(i),a.setValue(this.vector[e]),a.onChange((l=>{this.vector[e]=l,this.setValue(this.vector)})),this.$widget.appendChild(a.dom),t){let l=document.createElement("div");l.classList.add("fill"),this.$widget.appendChild(l)}}}let Uy=!1;class qm{constructor({parent:e,autoPlace:t=e===void 0,container:n,width:r,title:i="Controls",id:a=i,closeFolders:l=!1,injectStyles:u=!0,touchStyles:h=!0}={}){if(this.id=a,this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",(()=>this.openAnimated(this._closed))),this.$title.addEventListener("keydown",(p=>{p.code!=="Enter"&&p.code!=="Space"||(p.preventDefault(),this.$title.click())})),this.$title.addEventListener("touchstart",(()=>{}),{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(i),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),h&&this.domElement.classList.add("allow-touch-styles"),!Uy&&u&&((function(p){const f=document.createElement("style");f.innerHTML=p;const m=document.querySelector("head link[rel=stylesheet], head style");m?document.head.insertBefore(f,m):document.head.appendChild(f)})(`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid rgba(255, 255, 255, 0.6);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "↕";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}
.lil-gui .controller.image img {
  max-width: 100%;
}
.lil-gui .controller.vector input {
  color: var(--number-color);
}
.lil-gui .controller.vector .fill {
  height: 100%;
  margin-left: var(--spacing);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "▾";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "▸";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "✓";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`),Uy=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=l}add(e,t,n,r,i){if(Object(n)===n)return new Oy(this,e,t,n);const a=e[t];switch(typeof a){case"number":return new Dy(this,e,t,n,r,i);case"boolean":return new Py(this,e,t);case"string":return new Iy(this,e,t);case"function":return new Wm(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,a)}addColor(e,t,n=1){return new Cy(this,e,t,n)}addImage(e,t){return new ky(this,e,t)}addVector(e,t,n=-1/0,r=1/0,i=.01){return new zM(this,e,t,n,r,i)}addFolder(e,t=e){const n=new qm({parent:this,title:e,id:t});return this.root._closeFolders&&n.close(),n}removeFolder(e){let t=this.getFolder(e);return t&&t.destroy(),this}getFolder(e){return this.folders.find((t=>t.id===e))}load(e,t=!0){return e.controllers&&this.controllers.forEach((n=>{n instanceof Wm||n._name in e.controllers&&n.load(e.controllers[n._name])})),t&&e.folders&&this.folders.forEach((n=>{n._title in e.folders&&n.load(e.folders[n._title])})),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach((n=>{if(!(n instanceof Wm)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}})),e&&this.folders.forEach((n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()})),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame((()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const n=i=>{i.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame((()=>{this.$children.style.height=r+"px"}))})),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach((t=>t.reset())),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach((e=>e.destroy()))}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach((t=>{e=e.concat(t.controllersRecursive())})),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach((t=>{e=e.concat(t.foldersRecursive())})),e}}const yu=`varying vec2 vUv;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`;class BM extends Bt{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new qe(null),luminanceBuffer1:new qe(null),minLuminance:new qe(.01),deltaTime:new qe(0),tau:new qe(1)},extensions:{shaderTextureLOD:!0},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <packing>\r
\r
#define packFloatToRGBA(v) packDepthToRGBA(v)\r
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\r
\r
uniform lowp sampler2D luminanceBuffer0;\r
uniform lowp sampler2D luminanceBuffer1;\r
\r
uniform float minLuminance;\r
uniform float deltaTime;\r
uniform float tau;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	// This 1x1 buffer contains the previous luminance.\r
	float l0 = unpackRGBAToFloat(texture2D(luminanceBuffer0, vUv));\r
\r
	// Get the current average scene luminance.\r
	#if __VERSION__ < 300\r
\r
		float l1 = texture2DLodEXT(luminanceBuffer1, vUv, MIP_LEVEL_1X1).r;\r
\r
	#else\r
\r
		float l1 = textureLod(luminanceBuffer1, vUv, MIP_LEVEL_1X1).r;\r
\r
	#endif\r
\r
	l0 = max(minLuminance, l0);\r
	l1 = max(minLuminance, l1);\r
\r
	// Adapt the luminance using Pattanaik's technique.\r
	float adaptedLum = l0 + (l1 - l0) * (1.0 - exp(-deltaTime * tau));\r
\r
	gl_FragColor = (adaptedLum == 1.0) ? vec4(1.0) : packFloatToRGBA(adaptedLum);\r
\r
}\r
`,vertexShader:yu})}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}}class Ym extends Bt{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{inputBuffer:new qe(null),cocBuffer:new qe(null),texelSize:new qe(new ce),kernel64:new qe(null),kernel16:new qe(null),scale:new qe(1)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#if PASS == 1\r
\r
	uniform vec4 kernel64[32];\r
\r
#else\r
\r
	uniform vec4 kernel16[8];\r
\r
#endif\r
\r
uniform lowp sampler2D cocBuffer;\r
uniform vec2 texelSize;\r
uniform float scale;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	#ifdef FOREGROUND\r
\r
		vec2 CoCNearFar = texture2D(cocBuffer, vUv).rg;\r
		float CoC = CoCNearFar.r * scale;\r
\r
	#else\r
\r
		float CoC = texture2D(cocBuffer, vUv).g * scale;\r
\r
	#endif\r
\r
	if(CoC == 0.0) {\r
\r
		// Skip blurring.\r
		gl_FragColor = texture2D(inputBuffer, vUv);\r
\r
	} else {\r
\r
		#ifdef FOREGROUND\r
\r
			// Use far CoC to avoid weak blurring around foreground objects.\r
			vec2 step = texelSize * max(CoC, CoCNearFar.g * scale);\r
\r
		#else\r
\r
			vec2 step = texelSize * CoC;\r
\r
		#endif\r
\r
		#if PASS == 1\r
\r
			vec4 acc = vec4(0.0);\r
\r
			// Each vector contains two sampling points (64 in total).\r
			for(int i = 0; i < 32; ++i) {\r
\r
				vec4 kernel = kernel64[i];\r
\r
				vec2 uv = step * kernel.xy + vUv;\r
				acc += texture2D(inputBuffer, uv);\r
\r
				uv = step * kernel.zw + vUv;\r
				acc += texture2D(inputBuffer, uv);\r
\r
			}\r
\r
			gl_FragColor = acc / 64.0;\r
\r
		#else\r
\r
			vec4 maxValue = texture2D(inputBuffer, vUv);\r
\r
			// Each vector contains two sampling points (16 in total).\r
			for(int i = 0; i < 8; ++i) {\r
\r
				vec4 kernel = kernel16[i];\r
\r
				vec2 uv = step * kernel.xy + vUv;\r
				maxValue = max(texture2D(inputBuffer, uv), maxValue);\r
\r
				uv = step * kernel.zw + vUv;\r
				maxValue = max(texture2D(inputBuffer, uv), maxValue);\r
\r
\r
			}\r
\r
			gl_FragColor = maxValue;\r
\r
		#endif\r
\r
	}\r
\r
}\r
`,vertexShader:yu}),t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.scale}setScale(e){this.scale=e}generateKernel(){const e=new Float64Array(128),t=new Float64Array(32);let n=0,r=0;for(let i=0,a=Math.sqrt(80);i<80;++i){const l=2.39996323*i,u=Math.sqrt(i)/a,h=u*Math.cos(l),p=u*Math.sin(l);i%5==0?(t[r++]=h,t[r++]=p):(e[n++]=h,e[n++]=p)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}const kn="srgb",Qm="srgb-linear",zy=Number($e.replace(/\D+/g,""))>=152,HM=new Map([[jr,Qm],[Ct,kn]]),jM=new Map([[Qm,jr],[kn,Ct]]);function $l(s){return s===null?null:zy?s.outputColorSpace:HM.get(s.outputEncoding)}function va(s,e){s!==null&&(zy?s.colorSpace=e:s.encoding=jM.get(e))}function By(s,e,t){return s*(e-t)-e}function L0(s,e,t){return Math.min(Math.max((s+e)/(e-t),0),1)}class GM extends Bt{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new qe(null),focusDistance:new qe(0),focusRange:new qe(0),cameraNear:new qe(.3),cameraFar:new qe(1e3)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <packing>\r
\r
#ifdef GL_FRAGMENT_PRECISION_HIGH\r
\r
	uniform highp sampler2D depthBuffer;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer;\r
\r
#endif\r
\r
uniform float focusDistance;\r
uniform float focusRange;\r
uniform float cameraNear;\r
uniform float cameraFar;\r
\r
varying vec2 vUv;\r
\r
float readDepth(const in vec2 uv) {\r
\r
	#if DEPTH_PACKING == 3201\r
\r
		return unpackRGBAToDepth(texture2D(depthBuffer, uv));\r
\r
	#else\r
\r
		return texture2D(depthBuffer, uv).r;\r
\r
	#endif\r
\r
}\r
\r
void main() {\r
\r
	float depth = readDepth(vUv);\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		float viewZ = perspectiveDepthToViewZ(depth, cameraNear, cameraFar);\r
		float linearDepth = viewZToOrthographicDepth(viewZ, cameraNear, cameraFar);\r
\r
	#else\r
\r
		float linearDepth = depth;\r
\r
	#endif\r
\r
	float signedDistance = linearDepth - focusDistance;\r
	float magnitude = smoothstep(0.0, focusRange, abs(signedDistance));\r
\r
	gl_FragColor.rg = magnitude * vec2(\r
		step(signedDistance, 0.0),\r
		step(0.0, signedDistance)\r
	);\r
\r
}\r
`,vertexShader:yu}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=ki){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-By(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=L0(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-By(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=L0(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof vn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}const P0=0,VM=1,WM=2,XM=3,qM=4,YM=5,QM=6,ZM=7,KM=8,Hy=9,JM=10,$M=11,e2=12,t2=13,n2=14,r2=15,i2=16,a2=17,s2=18,o2=19,l2=20,c2=21,u2=22,jy=23,h2=24,d2=25,p2=26,f2=27,Gy=28,m2=29,C0=30,g2=31,v2=32,y2=0,x2=1,D0=1,Vy=2,Wy=0,zp=1,O0=2,sn={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},I0=2,b2=3,S2=0,Xy=1,_2=2,fs={REINHARD:0,REINHARD2:1,REINHARD2_ADAPTIVE:2,OPTIMIZED_CINEON:3,ACES_FILMIC:4},w2=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])];class M2 extends Bt{constructor(e=new ot){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new qe(null),texelSize:new qe(new ot),scale:new qe(1),kernel:new qe(0)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
\r
void main() {\r
\r
	vec4 sum = texture2D(inputBuffer, vUv0); // Top left\r
	sum += texture2D(inputBuffer, vUv1); // Top right\r
	sum += texture2D(inputBuffer, vUv2); // Bottom right\r
	sum += texture2D(inputBuffer, vUv3); // Bottom left\r
	gl_FragColor = sum * 0.25; // Compute the average\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec4 texelSize; // XY = texel size, ZW = half texel size\r
uniform float kernel;\r
uniform float scale;\r
\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
\r
void main() {\r
\r
	vec2 uv = position.xy * 0.5 + 0.5;\r
	vec2 dUv = (texelSize.xy * vec2(kernel) + texelSize.zw) * scale;\r
\r
	vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\r
	vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\r
	vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\r
	vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`}),this.setTexelSize(e.x,e.y),this.kernelSize=I0}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get kernelSequence(){return w2[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t,.5*e,.5*t)}setSize(e,t){const n=1/e,r=1/t;this.uniforms.texelSize.value.set(n,r,.5*n,.5*r)}}class qy extends Bt{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new qe(null),opacity:new qe(1)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <dithering_pars_fragment>\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
uniform float opacity;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec4 texel = texture2D(inputBuffer, vUv);\r
	gl_FragColor = opacity * texel;\r
\r
	#include <encodings_fragment>\r
	#include <dithering_fragment>\r
\r
}\r
`,vertexShader:yu})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}}class T2 extends Bt{constructor(){super({name:"DepthMaskMaterial",defines:{DEPTH_EPSILON:"0.0001",DEPTH_PACKING_0:"0",DEPTH_PACKING_1:"0",DEPTH_TEST_STRATEGY:D0},uniforms:{inputBuffer:new qe(null),depthBuffer0:new qe(null),depthBuffer1:new qe(null),cameraNearFar:new qe(new ce(1,1))},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <packing>\r
\r
#ifdef GL_FRAGMENT_PRECISION_HIGH\r
\r
	uniform highp sampler2D depthBuffer0;\r
	uniform highp sampler2D depthBuffer1;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer0;\r
	uniform mediump sampler2D depthBuffer1;\r
\r
#endif\r
\r
uniform sampler2D inputBuffer;\r
uniform vec2 cameraNearFar;\r
\r
float getViewZ(const in float depth) {\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		return perspectiveDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\r
\r
	#else\r
\r
		return orthographicDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\r
\r
	#endif\r
\r
}\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec2 depth;\r
\r
	#if DEPTH_PACKING_0 == 3201\r
\r
		depth.x = unpackRGBAToDepth(texture2D(depthBuffer0, vUv));\r
\r
	#else\r
\r
		depth.x = texture2D(depthBuffer0, vUv).r;\r
\r
	#endif\r
\r
	#if DEPTH_PACKING_1 == 3201\r
\r
		depth.y = unpackRGBAToDepth(texture2D(depthBuffer1, vUv));\r
\r
	#else\r
\r
		depth.y = texture2D(depthBuffer1, vUv).r;\r
\r
	#endif\r
\r
	bool isMaxDepth = (depth.x == 1.0);\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		// Linearize.\r
		depth.x = viewZToOrthographicDepth(getViewZ(depth.x), cameraNearFar.x, cameraNearFar.y);\r
		depth.y = viewZToOrthographicDepth(getViewZ(depth.y), cameraNearFar.x, cameraNearFar.y);\r
\r
	#endif\r
\r
	#if DEPTH_TEST_STRATEGY == 0\r
\r
		// Decide based on depth test.\r
		bool keep = depthTest(depth.x, depth.y);\r
\r
	#elif DEPTH_TEST_STRATEGY == 1\r
\r
		// Always keep max depth.\r
		bool keep = isMaxDepth || depthTest(depth.x, depth.y);\r
\r
	#else\r
\r
		// Always discard max depth.\r
		bool keep = !isMaxDepth && depthTest(depth.x, depth.y);\r
\r
	#endif\r
\r
	if(keep) {\r
\r
		gl_FragColor = texture2D(inputBuffer, vUv);\r
\r
	} else {\r
\r
		discard;\r
\r
	}\r
\r
}\r
`,vertexShader:yu}),this.depthMode=Bo}set depthBuffer0(e){this.uniforms.depthBuffer0.value=e}set depthPacking0(e){this.defines.DEPTH_PACKING_0=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer0(e,t=ki){this.depthBuffer0=e,this.depthPacking0=t}set depthBuffer1(e){this.uniforms.depthBuffer1.value=e}set depthPacking1(e){this.defines.DEPTH_PACKING_1=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer1(e,t=ki){this.depthBuffer1=e,this.depthPacking1=t}get maxDepthStrategy(){return Number(this.defines.DEPTH_TEST_STRATEGY)}set maxDepthStrategy(e){this.defines.DEPTH_TEST_STRATEGY=e.toFixed(0),this.needsUpdate=!0}get keepFar(){return this.maxDepthStrategy}set keepFar(e){this.maxDepthStrategy=e?D0:Vy}getMaxDepthStrategy(){return this.maxDepthStrategy}setMaxDepthStrategy(e){this.maxDepthStrategy=e}get epsilon(){return Number(this.defines.DEPTH_EPSILON)}set epsilon(e){this.defines.DEPTH_EPSILON=e.toFixed(16),this.needsUpdate=!0}getEpsilon(){return this.epsilon}setEpsilon(e){this.epsilon=e}get depthMode(){return Number(this.defines.DEPTH_MODE)}set depthMode(e){let t;switch(e){case Au:t="false";break;case zo:t="true";break;case jo:t="abs(d1 - d0) <= DEPTH_EPSILON";break;case Go:t="abs(d1 - d0) > DEPTH_EPSILON";break;case Bo:t="d0 > d1";break;case Ho:t="d0 >= d1";break;case oc:t="d0 <= d1";break;default:t="d0 < d1"}this.defines.DEPTH_MODE=e.toFixed(0),this.defines["depthTest(d0, d1)"]=t,this.needsUpdate=!0}getDepthMode(){return this.depthMode}setDepthMode(e){this.depthMode=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNearFar.value.set(e.near,e.far),e instanceof vn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}class E2 extends Bt{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new qe(null),texelSize:new qe(new ce)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
// (1 / 4) * 0.5 = 0.125\r
#define WEIGHT_INNER 0.125\r
// (1 / 9) * 0.5 = 0.0555555\r
#define WEIGHT_OUTER 0.0555555\r
\r
varying vec2 vUv;\r
varying vec2 vUv00;\r
varying vec2 vUv01;\r
varying vec2 vUv02;\r
varying vec2 vUv03;\r
varying vec2 vUv04;\r
varying vec2 vUv05;\r
varying vec2 vUv06;\r
varying vec2 vUv07;\r
varying vec2 vUv08;\r
varying vec2 vUv09;\r
varying vec2 vUv10;\r
varying vec2 vUv11;\r
\r
float clampToBorder(const in vec2 uv) {\r
\r
	return float(uv.s >= 0.0 && uv.s <= 1.0 && uv.t >= 0.0 && uv.t <= 1.0);\r
\r
}\r
\r
void main() {\r
\r
	vec4 c = vec4(0.0);\r
\r
	vec4 w = WEIGHT_INNER * vec4(\r
		clampToBorder(vUv00),\r
		clampToBorder(vUv01),\r
		clampToBorder(vUv02),\r
		clampToBorder(vUv03)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv00);\r
	c += w.y * texture2D(inputBuffer, vUv01);\r
	c += w.z * texture2D(inputBuffer, vUv02);\r
	c += w.w * texture2D(inputBuffer, vUv03);\r
\r
	w = WEIGHT_OUTER * vec4(\r
		clampToBorder(vUv04),\r
		clampToBorder(vUv05),\r
		clampToBorder(vUv06),\r
		clampToBorder(vUv07)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv04);\r
	c += w.y * texture2D(inputBuffer, vUv05);\r
	c += w.z * texture2D(inputBuffer, vUv06);\r
	c += w.w * texture2D(inputBuffer, vUv07);\r
\r
	w = WEIGHT_OUTER * vec4(\r
		clampToBorder(vUv08),\r
		clampToBorder(vUv09),\r
		clampToBorder(vUv10),\r
		clampToBorder(vUv11)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv08);\r
	c += w.y * texture2D(inputBuffer, vUv09);\r
	c += w.z * texture2D(inputBuffer, vUv10);\r
	c += w.w * texture2D(inputBuffer, vUv11);\r
\r
	c += WEIGHT_OUTER * texture2D(inputBuffer, vUv);\r
	gl_FragColor = c;\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec2 texelSize;\r
\r
varying vec2 vUv;\r
varying vec2 vUv00;\r
varying vec2 vUv01;\r
varying vec2 vUv02;\r
varying vec2 vUv03;\r
varying vec2 vUv04;\r
varying vec2 vUv05;\r
varying vec2 vUv06;\r
varying vec2 vUv07;\r
varying vec2 vUv08;\r
varying vec2 vUv09;\r
varying vec2 vUv10;\r
varying vec2 vUv11;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	vUv00 = vUv + texelSize * vec2(-1.0, 1.0);\r
	vUv01 = vUv + texelSize * vec2(1.0, 1.0);\r
	vUv02 = vUv + texelSize * vec2(-1.0, -1.0);\r
	vUv03 = vUv + texelSize * vec2(1.0, -1.0);\r
\r
	vUv04 = vUv + texelSize * vec2(-2.0, 2.0);\r
	vUv05 = vUv + texelSize * vec2(0.0, 2.0);\r
	vUv06 = vUv + texelSize * vec2(2.0, 2.0);\r
	vUv07 = vUv + texelSize * vec2(-2.0, 0.0);\r
	vUv08 = vUv + texelSize * vec2(2.0, 0.0);\r
	vUv09 = vUv + texelSize * vec2(-2.0, -2.0);\r
	vUv10 = vUv + texelSize * vec2(0.0, -2.0);\r
	vUv11 = vUv + texelSize * vec2(2.0, -2.0);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}class A2 extends Bt{constructor(e,t,n,r,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:$e.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new qe(null),depthBuffer:new qe(null),resolution:new qe(new ce),texelSize:new qe(new ce),cameraNear:new qe(.3),cameraFar:new qe(1e3),aspect:new qe(1),time:new qe(0)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(r)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=ki){this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){return this.fragmentShader=`#include <common>\r
#include <packing>\r
#include <dithering_pars_fragment>\r
\r
#define packFloatToRGBA(v) packDepthToRGBA(v)\r
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#if DEPTH_PACKING == 3201\r
\r
	uniform lowp sampler2D depthBuffer;\r
\r
#elif defined(GL_FRAGMENT_PRECISION_HIGH)\r
\r
	uniform highp sampler2D depthBuffer;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer;\r
\r
#endif\r
\r
uniform vec2 resolution;\r
uniform vec2 texelSize;\r
\r
uniform float cameraNear;\r
uniform float cameraFar;\r
uniform float aspect;\r
uniform float time;\r
\r
varying vec2 vUv;\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#if THREE_REVISION >= 137\r
\r
	vec4 sRGBToLinear(const in vec4 value) {\r
\r
		return vec4(mix(\r
			pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)),\r
			value.rgb * 0.0773993808,\r
			vec3(lessThanEqual(value.rgb, vec3(0.04045)))\r
		), value.a);\r
\r
	}\r
\r
#endif\r
\r
float readDepth(const in vec2 uv) {\r
\r
	#if DEPTH_PACKING == 3201\r
\r
		return unpackRGBAToDepth(texture2D(depthBuffer, uv));\r
\r
	#else\r
\r
		return texture2D(depthBuffer, uv).r;\r
\r
	#endif\r
\r
}\r
\r
float getViewZ(const in float depth) {\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		return perspectiveDepthToViewZ(depth, cameraNear, cameraFar);\r
\r
	#else\r
\r
		return orthographicDepthToViewZ(depth, cameraNear, cameraFar);\r
\r
	#endif\r
\r
}\r
\r
/**\r
 * Based on work by Sam Hocevar, Emil Persson and Ian Taylor.\r
 * https://www.chilliant.com/rgb2hsv.html\r
 */\r
\r
vec3 RGBToHCV(const in vec3 RGB) {\r
\r
	vec4 P = mix(vec4(RGB.bg, -1.0, 2.0 / 3.0), vec4(RGB.gb, 0.0, -1.0 / 3.0), step(RGB.b, RGB.g));\r
	vec4 Q = mix(vec4(P.xyw, RGB.r), vec4(RGB.r, P.yzx), step(P.x, RGB.r));\r
	float C = Q.x - min(Q.w, Q.y);\r
	float H = abs((Q.w - Q.y) / (6.0 * C + EPSILON) + Q.z);\r
	return vec3(H, C, Q.x);\r
\r
}\r
\r
vec3 RGBToHSL(const in vec3 RGB) {\r
\r
	vec3 HCV = RGBToHCV(RGB);\r
	float L = HCV.z - HCV.y * 0.5;\r
	float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + EPSILON);\r
	return vec3(HCV.x, S, L);\r
\r
}\r
\r
vec3 HueToRGB(const in float H) {\r
\r
	float R = abs(H * 6.0 - 3.0) - 1.0;\r
	float G = 2.0 - abs(H * 6.0 - 2.0);\r
	float B = 2.0 - abs(H * 6.0 - 4.0);\r
	return clamp(vec3(R, G, B), 0.0, 1.0);\r
\r
}\r
\r
vec3 HSLToRGB(const in vec3 HSL) {\r
\r
	vec3 RGB = HueToRGB(HSL.x);\r
	float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\r
	return (RGB - 0.5) * C + HSL.z;\r
\r
}\r
\r
FRAGMENT_HEAD\r
\r
void main() {\r
\r
	FRAGMENT_MAIN_UV\r
\r
	vec4 color0 = texture2D(inputBuffer, UV);\r
	vec4 color1 = vec4(0.0);\r
\r
	FRAGMENT_MAIN_IMAGE\r
\r
	gl_FragColor = color0;\r
\r
	#ifdef ENCODE_OUTPUT\r
\r
		#include <encodings_fragment>\r
\r
	#endif\r
\r
	#include <dithering_fragment>\r
\r
}\r
`.replace(sn.FRAGMENT_HEAD,e.get(sn.FRAGMENT_HEAD)||"").replace(sn.FRAGMENT_MAIN_UV,e.get(sn.FRAGMENT_MAIN_UV)||"").replace(sn.FRAGMENT_MAIN_IMAGE,e.get(sn.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=`uniform vec2 resolution;\r
uniform vec2 texelSize;\r
\r
uniform float cameraNear;\r
uniform float cameraFar;\r
uniform float aspect;\r
uniform float time;\r
\r
varying vec2 vUv;\r
\r
VERTEX_HEAD\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	VERTEX_MAIN_SUPPORT\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`.replace(sn.VERTEX_HEAD,e.get(sn.VERTEX_HEAD)||"").replace(sn.VERTEX_MAIN_SUPPORT,e.get(sn.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof vn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return sn}}class R2 extends Bt{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:$e.replace(/\D+/g,"")},uniforms:{inputBuffer:new qe(null),threshold:new qe(0),smoothing:new qe(1),range:new qe(null)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#ifdef RANGE\r
\r
	uniform vec2 range;\r
\r
#elif defined(THRESHOLD)\r
\r
	uniform float threshold;\r
	uniform float smoothing;\r
\r
#endif\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec4 texel = texture2D(inputBuffer, vUv);\r
	float l = luminance(texel.rgb);\r
\r
	#ifdef RANGE\r
\r
		// Apply a luminance range mask.\r
		float low = step(range.x, l);\r
		float high = step(l, range.y);\r
\r
		l *= low * high;\r
\r
	#elif defined(THRESHOLD)\r
\r
		l = smoothstep(threshold, threshold + smoothing, l);\r
\r
	#endif\r
\r
	#ifdef COLOR\r
\r
		gl_FragColor = vec4(texel.rgb * l, l);\r
\r
	#else\r
\r
		gl_FragColor = vec4(l);\r
\r
	#endif\r
\r
}\r
`,vertexShader:yu}),this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}}class L2 extends Bt{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new qe(e),inputBuffer:new qe(null),strength:new qe(1)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#ifdef MASK_PRECISION_HIGH\r
\r
	uniform mediump sampler2D maskTexture;\r
\r
#else\r
\r
	uniform lowp sampler2D maskTexture;\r
\r
#endif\r
\r
#if MASK_FUNCTION != 0\r
\r
	uniform float strength;\r
\r
#endif\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	#if COLOR_CHANNEL == 0\r
\r
		float mask = texture2D(maskTexture, vUv).r;\r
\r
	#elif COLOR_CHANNEL == 1\r
\r
		float mask = texture2D(maskTexture, vUv).g;\r
\r
	#elif COLOR_CHANNEL == 2\r
\r
		float mask = texture2D(maskTexture, vUv).b;\r
\r
	#else\r
\r
		float mask = texture2D(maskTexture, vUv).a;\r
\r
	#endif\r
\r
	#if MASK_FUNCTION == 0\r
\r
		#ifdef INVERTED\r
\r
			// (mask > 0.0) ? 0.0 : 1.0;\r
			mask = step(mask, 0.0);\r
\r
		#else\r
\r
			// (mask > 0.0) ? 1.0 : 0.0;\r
			mask = 1.0 - step(mask, 0.0);\r
\r
		#endif\r
\r
	#else\r
\r
		mask = clamp(mask * strength, 0.0, 1.0);\r
\r
		#ifdef INVERTED\r
\r
			mask = 1.0 - mask;\r
\r
		#endif\r
\r
	#endif\r
\r
	#if MASK_FUNCTION == 2\r
\r
		// MULTIPLY_RGB_SET_ALPHA\r
		gl_FragColor = vec4(mask * texture2D(inputBuffer, vUv).rgb, mask);\r
\r
	#else\r
\r
		// DISCARD / MULTIPLY\r
		gl_FragColor = mask * texture2D(inputBuffer, vUv);\r
\r
	#endif\r
\r
}\r
`,vertexShader:yu}),this.colorChannel=y2,this.maskFunction=S2}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Vn&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}}class P2 extends Bt{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new qe(null),supportBuffer:new qe(null),texelSize:new qe(new ce),radius:new qe(.85)},blending:it,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
	uniform mediump sampler2D supportBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
	uniform lowp sampler2D supportBuffer;\r
\r
#endif\r
\r
uniform float radius;\r
\r
varying vec2 vUv;\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
varying vec2 vUv4;\r
varying vec2 vUv5;\r
varying vec2 vUv6;\r
varying vec2 vUv7;\r
\r
void main() {\r
\r
	vec4 c = vec4(0.0);\r
\r
	c += texture2D(inputBuffer, vUv0) * 0.0625;\r
	c += texture2D(inputBuffer, vUv1) * 0.125;\r
	c += texture2D(inputBuffer, vUv2) * 0.0625;\r
	c += texture2D(inputBuffer, vUv3) * 0.125;\r
	c += texture2D(inputBuffer, vUv) * 0.25;\r
	c += texture2D(inputBuffer, vUv4) * 0.125;\r
	c += texture2D(inputBuffer, vUv5) * 0.0625;\r
	c += texture2D(inputBuffer, vUv6) * 0.125;\r
	c += texture2D(inputBuffer, vUv7) * 0.0625;\r
\r
	vec4 baseColor = texture2D(supportBuffer, vUv);\r
	gl_FragColor = mix(baseColor, c, radius);\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec2 texelSize;\r
\r
varying vec2 vUv;\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
varying vec2 vUv4;\r
varying vec2 vUv5;\r
varying vec2 vUv6;\r
varying vec2 vUv7;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	vUv0 = vUv + texelSize * vec2(-1.0, 1.0);\r
	vUv1 = vUv + texelSize * vec2(0.0, 1.0);\r
	vUv2 = vUv + texelSize * vec2(1.0, 1.0);\r
	vUv3 = vUv + texelSize * vec2(-1.0, 0.0);\r
\r
	vUv4 = vUv + texelSize * vec2(1.0, 0.0);\r
	vUv5 = vUv + texelSize * vec2(-1.0, -1.0);\r
	vUv6 = vUv + texelSize * vec2(0.0, -1.0);\r
	vUv7 = vUv + texelSize * vec2(1.0, -1.0);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}set supportBuffer(e){this.uniforms.supportBuffer.value=e}get radius(){return this.uniforms.radius.value}set radius(e){this.uniforms.radius.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}const C2=new Ls;let ec=null;class Ur{constructor(e="Pass",t=new Oa,n=C2){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new ht((function(){if(ec===null){const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),r=new Float32Array([0,0,2,0,0,2]);ec=new ut,ec.setAttribute!==void 0?(ec.setAttribute("position",new pt(n,3)),ec.setAttribute("uv",new pt(r,2))):(ec.addAttribute("position",new pt(n,3)),ec.addAttribute("uv",new pt(r,2)))}return ec})(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Oa),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=ki){}render(e,t,n,r,i){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Xt||t instanceof an||t instanceof pn||t instanceof Ur)&&this[e].dispose()}}}class Yy extends Ur{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new qy,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Xt(1,1,{minFilter:_t,magFilter:_t,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,r,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Vn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":$l(e)===kn&&va(this.renderTarget.texture,kn))}}class D2 extends Ur{constructor(e,{minLuminance:t=.01,adaptationRate:n=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new BM,this.needsSwap=!1,this.renderTargetPrevious=new Xt(1,1,{minFilter:Wt,magFilter:Wt,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const r=this.fullscreenMaterial;r.luminanceBuffer0=this.renderTargetPrevious.texture,r.luminanceBuffer1=e,r.minLuminance=t,r.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new Yy(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,r,i){this.fullscreenMaterial.deltaTime=r,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}}class O2 extends Ur{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,r,i){const a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}}const Qy=new Ne;class N0 extends Ur{constructor(e=!0,t=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,r,i){const a=this.overrideClearColor,l=this.overrideClearAlpha,u=e.getClearAlpha(),h=a!==null,p=l>=0;h?(e.getClearColor(Qy),e.setClearColor(a,p?l:u)):p&&e.setClearAlpha(l),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),h?e.setClearColor(Qy,u):p&&e.setClearAlpha(u)}}const $h=-1;class hi extends Fi{constructor(e,t=-1,n=-1,r=1){super(),this.resizable=e,this.baseSize=new ce(1,1),this.preferredSize=new ce(t,n),this.target=this.preferredSize,this.s=r,this.effectiveSize=new ce,this.addEventListener("change",(()=>this.updateEffectiveSize())),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,n=this.effectiveSize,r=this.scale;t.width!==$h?n.width=t.width:t.height!==$h?n.width=Math.round(t.height*(e.width/Math.max(e.height,1))):n.width=Math.round(e.width*r),t.height!==$h?n.height=t.height:t.width!==$h?n.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n.height=Math.round(e.height*r)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar($h),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){this.baseSize.width===e&&this.baseSize.height===t||(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){this.preferredSize.width===e&&this.preferredSize.height===t||(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return $h}}let k0=!1;class Zy{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let n;if(t.material.flatShading)switch(t.material.side){case We:n=this.materialsFlatShadedDoubleSide;break;case Be:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded}else switch(t.material.side){case We:n=this.materialsDoubleSide;break;case Be:n=this.materialsBackSide;break;default:n=this.materials}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=n[2]:t.isInstancedMesh?t.material=n[1]:t.material=n[0],++this.meshCount}}}cloneMaterial(e){if(!(e instanceof Bt))return e.clone();const t=e.uniforms,n=new Map;for(const i in t){const a=t[i].value;a.isRenderTargetTexture&&(t[i].value=null,n.set(i,a))}const r=e.clone();for(const i of n)t[i[0]].value=i[1],r.uniforms[i[0]].value=i[1];return r}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){const t=this.materials=[this.cloneMaterial(e),this.cloneMaterial(e),this.cloneMaterial(e)];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=Se;t[2].skinning=!0,this.materialsBackSide=t.map((n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.side=Be,r})),this.materialsDoubleSide=t.map((n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.side=We,r})),this.materialsFlatShaded=t.map((n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r})),this.materialsFlatShadedBackSide=t.map((n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=Be,r})),this.materialsFlatShadedDoubleSide=t.map((n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=We,r}))}}render(e,t,n){const r=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,k0){const i=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const a of i)a[0].material=a[1];this.meshCount!==i.size&&i.clear()}else{const i=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=i}e.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return k0}static set workaroundEnabled(e){k0=e}}class Ky extends Ur{constructor(e,t,n=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new N0,this.overrideMaterialManager=n===null?null:new Zy(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new Zy(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,r,i){const a=this.scene,l=this.camera,u=this.selection,h=l.layers.mask,p=a.background,f=e.shadowMap.autoUpdate,m=this.renderToScreen?null:t;u!==null&&l.layers.set(u.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(m),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,a,l):e.render(a,l),l.layers.mask=h,a.background=p,e.shadowMap.autoUpdate=f}}class I2 extends Ur{constructor(e,t,{renderTarget:n,resolutionScale:r=1,width:i=hi.AUTO_SIZE,height:a=hi.AUTO_SIZE,resolutionX:l=i,resolutionY:u=a}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new Ky(e,t,new _o({depthPacking:$s}));const h=this.renderPass;h.skipShadowMapUpdate=!0,h.ignoreBackground=!0;const p=h.getClearPass();p.overrideClearColor=new Ne(16777215),p.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Xt(1,1,{minFilter:Wt,magFilter:Wt}),this.renderTarget.texture.name="DepthPass.Target");const f=this.resolution=new hi(this,l,u,r);f.addEventListener("change",(m=>this.setSize(f.baseWidth,f.baseHeight)))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,r,i){const a=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,a)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}}function Jy(s,e,t){for(const n of e){const r="$1"+s+n.charAt(0).toUpperCase()+n.slice(1),i=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(i,r))}}function N2(s,e,t){let n=e.getFragmentShader(),r=e.getVertexShader();const i=n!==void 0&&/mainImage/.test(n),a=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&(t.attributes&O0)!=0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!i&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const l=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,u=t.shaderParts;let h=u.get(sn.FRAGMENT_HEAD)||"",p=u.get(sn.FRAGMENT_MAIN_UV)||"",f=u.get(sn.FRAGMENT_MAIN_IMAGE)||"",m=u.get(sn.VERTEX_HEAD)||"",g=u.get(sn.VERTEX_MAIN_SUPPORT)||"";const x=new Set,y=new Set;if(a&&(p+=`	${s}MainUv(UV);
`,t.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const _=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);g+=`	${s}MainSupport(`,g+=_?`vUv);
`:`);
`;for(const T of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const A of T[1].split(/\s*,\s*/))t.varyings.add(A),x.add(A),y.add(A);for(const T of r.matchAll(l))y.add(T[1])}for(const _ of n.matchAll(l))y.add(_[1]);for(const _ of e.defines.keys())y.add(_.replace(/\([\w\s,]*\)/g,""));for(const _ of e.uniforms.keys())y.add(_);y.delete("while"),y.delete("for"),y.delete("if"),e.uniforms.forEach(((_,T)=>t.uniforms.set(s+T.charAt(0).toUpperCase()+T.slice(1),_))),e.defines.forEach(((_,T)=>t.defines.set(s+T.charAt(0).toUpperCase()+T.slice(1),_)));const b=new Map([["fragment",n],["vertex",r]]);Jy(s,y,t.defines),Jy(s,y,b),n=b.get("fragment"),r=b.get("vertex");const w=e.blendMode;if(t.blendModes.set(w.blendFunction,w),i){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(f+=e.inputColorSpace===kn?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==""?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const _=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${s}MainImage(color0, UV, `,(t.attributes&zp)!=0&&_.test(n)&&(f+="depth, ",t.readDepth=!0),f+=`color1);
	`;const T=s+"BlendOpacity";t.uniforms.set(T,w.opacity),f+=`color0 = blend${w.blendFunction}(color0, color1, ${T});

	`,h+=`uniform float ${T};

`}if(h+=n+`
`,r!==null&&(m+=r+`
`),u.set(sn.FRAGMENT_HEAD,h),u.set(sn.FRAGMENT_MAIN_UV,p),u.set(sn.FRAGMENT_MAIN_IMAGE,f),u.set(sn.VERTEX_HEAD,m),u.set(sn.VERTEX_MAIN_SUPPORT,g),e.extensions!==null)for(const _ of e.extensions)t.extensions.add(_)}}class k2 extends Ur{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new A2(null,null,null,e),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(t),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort(((t,n)=>n.attributes-t.attributes));for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new H2;let t=0;for(const l of this.effects)if(l.blendMode.blendFunction===Hy)e.attributes|=l.getAttributes()&zp;else{if((e.attributes&l.getAttributes()&O0)!=0)throw new Error(`Convolution effects cannot be merged (${l.name})`);N2("e"+t++,l,e)}let n=e.shaderParts.get(sn.FRAGMENT_HEAD),r=e.shaderParts.get(sn.FRAGMENT_MAIN_IMAGE),i=e.shaderParts.get(sn.FRAGMENT_MAIN_UV);const a=/\bblend\b/g;for(const l of e.blendModes.values())n+=l.getShaderCode().replace(a,`blend${l.blendFunction}`)+`
`;(e.attributes&zp)!=0?(e.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,e.colorSpace===kn&&(r+=`color0 = sRGBToLinear(color0);
	`),e.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(sn.FRAGMENT_HEAD,n),e.shaderParts.set(sn.FRAGMENT_MAIN_IMAGE,r),e.shaderParts.set(sn.FRAGMENT_MAIN_UV,i);for(const[l,u]of e.shaderParts)u!==null&&e.shaderParts.set(l,u.trim().replace(/^#/,`
#`));this.skipRendering=t===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=ki){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,r,i){for(const a of this.effects)a.update(e,t,r);if(!this.skipRendering||this.renderToScreen){const a=this.fullscreenMaterial;a.inputBuffer=t.texture,a.time+=r*this.timeScale,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const r of this.effects)r.initialize(e,t,n);this.updateMaterial(),n!==void 0&&n!==Vn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){e.type==="change"&&this.recompile()}}class $y extends Ur{constructor({kernelSize:e=I0,resolutionScale:t=.5,width:n=hi.AUTO_SIZE,height:r=hi.AUTO_SIZE,resolutionX:i=n,resolutionY:a=r}={}){super("KawaseBlurPass"),this.renderTargetA=new Xt(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const l=this.resolution=new hi(this,i,a,t);l.addEventListener("change",(u=>this.setSize(l.baseWidth,l.baseHeight))),this._blurMaterial=new M2,this._blurMaterial.kernelSize=e,this.copyMaterial=new qy}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(e){this._blurMaterial=e}get dithering(){return this.copyMaterial.dithering}set dithering(e){this.copyMaterial.dithering=e}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(e){this.blurMaterial.kernelSize=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,r,i){const a=this.scene,l=this.camera,u=this.renderTargetA,h=this.renderTargetB,p=this.blurMaterial,f=p.kernelSequence;let m=t;this.fullscreenMaterial=p;for(let g=0,x=f.length;g<x;++g){const y=(1&g)==0?u:h;p.kernel=f[g],p.inputBuffer=m.texture,e.setRenderTarget(y),e.render(a,l),m=y}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=m.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(a,l)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const r=n.width,i=n.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.blurMaterial.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==Vn?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):$l(e)===kn&&(va(this.renderTargetA.texture,kn),va(this.renderTargetB.texture,kn)))}static get AUTO_SIZE(){return hi.AUTO_SIZE}}class ex extends Ur{constructor({renderTarget:e,luminanceRange:t,colorOutput:n,resolutionScale:r=1,width:i=hi.AUTO_SIZE,height:a=hi.AUTO_SIZE,resolutionX:l=i,resolutionY:u=a}={}){super("LuminancePass"),this.fullscreenMaterial=new R2(n,t),this.needsSwap=!1,this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new Xt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const h=this.resolution=new hi(this,l,u,r);h.addEventListener("change",(p=>this.setSize(h.baseWidth,h.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,r,i){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){n!==void 0&&n!==Vn&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}class F2 extends Ur{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new N0(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,r,i){const a=e.getContext(),l=e.state.buffers,u=this.scene,h=this.camera,p=this.clearPass,f=this.inverted?0:1,m=1-f;l.color.setMask(!1),l.depth.setMask(!1),l.color.setLocked(!0),l.depth.setLocked(!0),l.stencil.setTest(!0),l.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),l.stencil.setFunc(a.ALWAYS,f,4294967295),l.stencil.setClear(m),l.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(e,null):(p.render(e,t),p.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(u,h)):(e.setRenderTarget(t),e.render(u,h),e.setRenderTarget(n),e.render(u,h)),l.color.setLocked(!1),l.depth.setLocked(!1),l.stencil.setLocked(!1),l.stencil.setFunc(a.EQUAL,1,4294967295),l.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),l.stencil.setLocked(!0)}}class U2 extends Ur{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Xt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new E2,this.upsamplingMaterial=new P2,this.resolution=new ce}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(e){if(this.levels!==e){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<e;++n){const r=t.clone();r.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(r)}this.upsamplingMipmaps.push(t);for(let n=1,r=e-1;n<r;++n){const i=t.clone();i.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(e){this.upsamplingMaterial.radius=e}render(e,t,n,r,i){const{scene:a,camera:l}=this,{downsamplingMaterial:u,upsamplingMaterial:h}=this,{downsamplingMipmaps:p,upsamplingMipmaps:f}=this;let m=t;this.fullscreenMaterial=u;for(let g=0,x=p.length;g<x;++g){const y=p[g];u.setSize(m.width,m.height),u.inputBuffer=m.texture,e.setRenderTarget(y),e.render(a,l),m=y}this.fullscreenMaterial=h;for(let g=f.length-1;g>=0;--g){const x=f[g];h.setSize(m.width,m.height),h.inputBuffer=m.texture,h.supportBuffer=p[g].texture,e.setRenderTarget(x),e.render(a,l),m=x}}setSize(e,t){const n=this.resolution;n.set(e,t);let r=n.width,i=n.height;for(let a=0,l=this.downsamplingMipmaps.length;a<l;++a)r=Math.round(.5*r),i=Math.round(.5*i),this.downsamplingMipmaps[a].setSize(r,i),a<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[a].setSize(r,i)}initialize(e,t,n){if(n!==void 0){const r=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of r)i.texture.type=n;if(n!==Vn)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if($l(e)===kn)for(const i of r)va(i.texture,kn)}}dispose(){super.dispose();for(const e of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))e.dispose()}}class tc extends Ur{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.input=t}setInput(e){this.input=e}render(e,t,n,r,i){const a=this.fullscreenMaterial.uniforms;t!==null&&a!==void 0&&a[this.input]!==void 0&&(a[this.input].value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){n!==void 0&&n!==Vn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}const F0=.001;class z2{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*F0}get fixedDelta(){return this._fixedDelta*F0}set fixedDelta(e){this._fixedDelta=1e3*e}get elapsed(){return this._elapsed*F0}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(e!==void 0?e:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(e){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}}class B2{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:r=0,frameBufferType:i}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,i,r),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Yy,this.depthTexture=null,this.passes=[],this.timer=new z2,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new ce),n=e.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;r===Vn&&$l(e)===kn&&(va(this.inputBuffer.texture,kn),va(this.outputBuffer.texture,kn),this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const i of this.passes)i.initialize(e,n,r)}}replaceRenderer(e,t=!0){const n=this.renderer,r=n.domElement.parentNode;return this.setRenderer(e),t&&r!==null&&(r.removeChild(n.domElement),r.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new er;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Ss,e.type=Wa):e.type=Va,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,r){const i=this.renderer,a=i===null?new ce:i.getDrawingBufferSize(new ce),l={minFilter:_t,magFilter:_t,stencilBuffer:t,depthBuffer:e,type:n},u=new Xt(a.width,a.height,l);return r>0&&(u.ignoreDepthForMultisampleCopy=!1,u.samples=r),n===Vn&&$l(i)===kn&&va(u.texture,kn),u.texture.name="EffectComposer.Buffer",u.texture.generateMipmaps=!1,u}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,r=this.renderer,i=r.getDrawingBufferSize(new ce),a=r.getContext().getContextAttributes().alpha,l=this.inputBuffer.texture.type;if(e.setRenderer(r),e.setSize(i.width,i.height),e.initialize(r,a,l),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const u=this.createDepthTexture();for(e of n)e.setDepthTexture(u)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const r=(i,a)=>i||a.needsDepthTexture;t.reduce(r,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let r,i,a,l=this.inputBuffer,u=this.outputBuffer,h=!1;e===void 0&&(this.timer.update(),e=this.timer.delta);let p=null;for(let f=this.passes.length;f--;)if(this.passes[f].enabled){p=this.passes[f];break}for(const f of this.passes)f.enabled&&(this.autoRenderToScreen&&(f.renderToScreen=f===p),f.render(t,l,u,e,h),f.needsSwap&&(h&&(n.renderToScreen=f.renderToScreen,r=t.getContext(),i=t.state.buffers.stencil,i.setFunc(r.NOTEQUAL,1,4294967295),n.render(t,l,u,e,h),i.setFunc(r.EQUAL,1,4294967295)),a=l,l=u,u=a),f instanceof F2?h=!0:f instanceof O2&&(h=!1))}setSize(e,t,n){const r=this.renderer,i=r.getSize(new ce);e!==void 0&&t!==void 0||(e=i.width,t=i.height),i.width===e&&i.height===t||r.setSize(e,t,n);const a=r.getDrawingBufferSize(new ce);this.inputBuffer.setSize(a.width,a.height),this.outputBuffer.setSize(a.width,a.height);for(const l of this.passes)l.setSize(a.width,a.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}}class H2{constructor(){this.shaderParts=new Map([[sn.FRAGMENT_HEAD,null],[sn.FRAGMENT_MAIN_UV,null],[sn.FRAGMENT_MAIN_IMAGE,null],[sn.VERTEX_HEAD,null],[sn.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Wy,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Qm}}class j2 extends Set{constructor(e,t=10){super(),this.l=t,this.exclusive=!1,e!==void 0&&this.set(e)}get layer(){return this.l}set layer(e){const t=this.l;for(const n of this)n.layers.disable(t),n.layers.enable(e);this.l=e}getLayer(){return this.layer}setLayer(e){this.layer=e}isExclusive(){return this.exclusive}setExclusive(e){this.exclusive=e}clear(){const e=this.layer;for(const t of this)t.layers.disable(e);return super.clear()}set(e){this.clear();for(const t of e)this.add(t);return this}indexOf(e){return this.has(e)?0:-1}add(e){return this.exclusive?e.layers.set(this.layer):e.layers.enable(this.layer),super.add(e)}delete(e){return this.has(e)&&e.layers.disable(this.layer),super.delete(e)}toggle(e){let t;return this.has(e)?(this.delete(e),t=!1):(this.add(e),t=!0),t}setVisible(e){for(const t of this)e?t.layers.enable(0):t.layers.disable(0);return this}}const G2=new Map([[P0,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x + y, opacity);\r
\r
}\r
`],[VM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y, min(y.a, opacity));\r
\r
}\r
`],[WM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, (x + y) * 0.5, opacity);\r
\r
}\r
`],[XM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(yHSL.rg, xHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[qM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(step(0.0, y) * (1.0 - min(vec4(1.0), (1.0 - x) / y)), vec4(1.0), step(1.0, x));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[YM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = step(0.0, x) * mix(min(vec4(1.0), x / max(1.0 - y, 1e-9)), vec4(1.0), step(1.0, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[QM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, min(x, y), opacity);\r
\r
}\r
`],[ZM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, abs(x - y), opacity);\r
\r
}\r
`],[KM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x / max(y, 1e-12), opacity);\r
\r
}\r
`],[Hy,null],[JM,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, (x + y - 2.0 * x * y), opacity);\r
\r
}\r
`],[$M,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 a = min(x, 1.0), b = min(y, 1.0);\r
	vec4 z = mix(2.0 * a * b, 1.0 - 2.0 * (1.0 - a) * (1.0 - b), step(0.5, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[e2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, step(1.0, x + y), opacity);\r
\r
}\r
`],[t2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(yHSL.r, xHSL.gb));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[n2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, 1.0 - y, opacity);\r
\r
}\r
`],[r2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y * (1.0 - x), opacity);\r
\r
}\r
`],[i2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, max(x, y), opacity);\r
\r
}\r
`],[a2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, clamp(y + x - 1.0, 0.0, 1.0), opacity);\r
\r
}\r
`],[s2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, min(x + y, 1.0), opacity);\r
\r
}\r
`],[o2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, clamp(2.0 * y + x - 1.0, 0.0, 1.0), opacity);\r
\r
}\r
`],[l2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(xHSL.rg, yHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[c2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x * y, opacity);\r
\r
}\r
`],[u2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, 1.0 - abs(1.0 - x - y), opacity);\r
\r
}\r
`],[jy,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y, opacity);\r
\r
}\r
`],[h2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(2.0 * y * x, 1.0 - 2.0 * (1.0 - y) * (1.0 - x), step(0.5, x));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[d2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 y2 = 2.0 * y;\r
\r
	vec4 z = mix(\r
		mix(y2, x, step(0.5 * x, y)),\r
		max(vec4(0.0), y2 - 1.0), \r
		step(x, (y2 - 1.0))\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`],[p2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(min(x * x / max(1.0 - y, 1e-12), 1.0), y, step(1.0, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[f2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(xHSL.r, yHSL.g, xHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[Gy,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x + y - min(x * y, 1.0), opacity);\r
\r
}\r
`],[m2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 y2 = 2.0 * y;\r
	vec4 w = step(0.5, y);\r
\r
	vec4 z = mix(\r
		x - (1.0 - y2) * x * (1.0 - x), \r
		mix(\r
			x + (y2 - 1.0) * (sqrt(x) - x),\r
			x + (y2 - 1.0) * x * ((16.0 * x - 12.0) * x + 3.0),\r
			w * (1.0 - step(0.25, x))\r
		),\r
		w\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`],[C0,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return y;\r
\r
}\r
`],[g2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, max(x + y - 1.0, 0.0), opacity);\r
\r
}\r
`],[v2,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(\r
		max(1.0 - min((1.0 - x) / (2.0 * y), 1.0), 0.0),\r
		min(x / (2.0 * (1.0 - y)), 1.0),\r
		step(0.5, y)\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`]]);class V2 extends Fi{constructor(e,t=1){super(),this._blendFunction=e,this.opacity=new qe(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return G2.get(this.blendFunction)}}class ed extends Fi{constructor(e,t,{attributes:n=Wy,blendFunction:r=jy,defines:i=new Map,uniforms:a=new Map,extensions:l=null,vertexShader:u=null}={}){super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=u,this.defines=i,this.uniforms=a,this.extensions=l,this.blendMode=new V2(r),this.blendMode.addEventListener("change",(h=>this.setChanged())),this._inputColorSpace=Qm,this._outputColorSpace=""}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=ki){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Xt||t instanceof an||t instanceof pn||t instanceof Ur)&&this[e].dispose()}}}class tx extends ed{constructor({blendFunction:e=Gy,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,mipmapBlur:r=!1,intensity:i=1,radius:a=.85,levels:l=8,kernelSize:u=b2,resolutionScale:h=.5,width:p=hi.AUTO_SIZE,height:f=hi.AUTO_SIZE,resolutionX:m=p,resolutionY:g=f}={}){super("BloomEffect",`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D map;\r
\r
#else\r
\r
	uniform lowp sampler2D map;\r
\r
#endif\r
\r
uniform float intensity;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	outputColor = texture2D(map, uv) * intensity;\r
\r
}\r
`,{blendFunction:e,uniforms:new Map([["map",new qe(null)],["intensity",new qe(i)]])}),this.renderTarget=new Xt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new $y({kernelSize:u}),this.luminancePass=new ex({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new U2,this.mipmapBlurPass.enabled=r,this.mipmapBlurPass.radius=a,this.mipmapBlurPass.levels=l,this.uniforms.get("map").value=r?this.mipmapBlurPass.texture:this.renderTarget.texture;const x=this.resolution=new hi(this,m,g,h);x.addEventListener("change",(y=>this.setSize(x.baseWidth,x.baseHeight)))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){const r=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(e,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,i.renderTarget):this.blurPass.render(e,i.renderTarget,r)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,t):this.blurPass.render(e,t,r)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(e,t),this.mipmapBlurPass.setSize(e,t)}initialize(e,t,n){this.blurPass.initialize(e,t,n),this.luminancePass.initialize(e,t,n),this.mipmapBlurPass.initialize(e,t,n),n!==void 0&&(this.renderTarget.texture.type=n,$l(e)===kn&&va(this.renderTarget.texture,kn))}}class W2 extends ed{constructor({offset:e=new ce(.001,5e-4),radialModulation:t=!1,modulationOffset:n=.15}={}){super("ChromaticAberrationEffect",`#ifdef RADIAL_MODULATION\r
\r
	uniform float modulationOffset;\r
\r
#endif\r
\r
varying float vActive;\r
varying vec2 vUvR;\r
varying vec2 vUvB;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	vec2 ra = inputColor.ra;\r
	vec2 ba = inputColor.ba;\r
\r
	#ifdef RADIAL_MODULATION\r
\r
		const vec2 center = vec2(0.5);\r
		float d = distance(uv, center) * 2.0;\r
		d = max(d - modulationOffset, 0.0);\r
\r
		if(vActive > 0.0 && d > 0.0) {\r
\r
			ra = texture2D(inputBuffer, mix(uv, vUvR, d)).ra;\r
			ba = texture2D(inputBuffer, mix(uv, vUvB, d)).ba;\r
\r
		}\r
\r
	#else\r
\r
		if(vActive > 0.0) {\r
\r
			ra = texture2D(inputBuffer, vUvR).ra;\r
			ba = texture2D(inputBuffer, vUvB).ba;\r
\r
		}\r
\r
	#endif\r
\r
	outputColor = vec4(ra.x, inputColor.g, ba.x, max(max(ra.y, ba.y), inputColor.a));\r
\r
}\r
`,{vertexShader:`uniform vec2 offset;\r
\r
varying float vActive;\r
varying vec2 vUvR;\r
varying vec2 vUvB;\r
\r
void mainSupport(const in vec2 uv) {\r
\r
	vec2 shift = offset * vec2(1.0, aspect);\r
	vActive = (shift.x != 0.0 || shift.y != 0.0) ? 1.0 : 0.0;\r
	vUvR = uv + shift;\r
	vUvB = uv - shift;\r
\r
}\r
`,attributes:O0,uniforms:new Map([["offset",new qe(e)],["modulationOffset",new qe(n)]])}),this.radialModulation=t}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(e){e?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(e){this.uniforms.get("modulationOffset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}}class X2 extends ed{constructor(e,{blendFunction:t,worldFocusDistance:n,worldFocusRange:r,focusDistance:i=0,focalLength:a=.1,focusRange:l=a,bokehScale:u=1,resolutionScale:h=1,width:p=hi.AUTO_SIZE,height:f=hi.AUTO_SIZE,resolutionX:m=p,resolutionY:g=f}={}){super("DepthOfFieldEffect",`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D nearColorBuffer;\r
	uniform mediump sampler2D farColorBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D nearColorBuffer;\r
	uniform lowp sampler2D farColorBuffer;\r
\r
#endif\r
\r
uniform lowp sampler2D nearCoCBuffer;\r
uniform float scale;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, const in float depth, out vec4 outputColor) {\r
\r
	vec4 colorNear = texture2D(nearColorBuffer, uv);\r
	vec4 colorFar = texture2D(farColorBuffer, uv);\r
\r
	float cocNear = texture2D(nearCoCBuffer, uv).r;\r
	cocNear = min(cocNear * scale, 1.0);\r
\r
	// The far color buffer has been premultiplied with the CoC buffer.\r
	vec4 result = inputColor * (1.0 - colorFar.a) + colorFar;\r
	result = mix(result, colorNear, cocNear);\r
\r
	outputColor = result;\r
\r
}\r
`,{blendFunction:t,attributes:zp,uniforms:new Map([["nearColorBuffer",new qe(null)],["farColorBuffer",new qe(null)],["nearCoCBuffer",new qe(null)],["scale",new qe(1)]])}),this.camera=e,this.renderTarget=new Xt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new tc(new GM(e));const x=this.cocMaterial;x.focusDistance=i,x.focusRange=l,n!==void 0&&(x.worldFocusDistance=n),r!==void 0&&(x.worldFocusRange=r),this.blurPass=new $y({resolutionScale:h,resolutionX:m,resolutionY:g,kernelSize:I0}),this.maskPass=new tc(new L2(this.renderTargetCoC.texture));const y=this.maskPass.fullscreenMaterial;y.maskFunction=Xy,y.colorChannel=x2,this.bokehNearBasePass=new tc(new Ym(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new tc(new Ym(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new tc(new Ym(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new tc(new Ym(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const b=this.resolution=new hi(this,m,g,h);b.addEventListener("change",(w=>this.setSize(b.baseWidth,b.baseHeight))),this.bokehScale=u}set mainCamera(e){this.camera=e,this.cocMaterial.copyCameraSettings(e)}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){this.bokehNearBasePass.fullscreenMaterial.scale=e,this.bokehNearFillPass.fullscreenMaterial.scale=e,this.bokehFarBasePass.fullscreenMaterial.scale=e,this.bokehFarFillPass.fullscreenMaterial.scale=e,this.maskPass.fullscreenMaterial.strength=e,this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){const t=this.camera;return L0(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e,t=ki){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,n){const r=this.renderTarget,i=this.renderTargetCoC,a=this.renderTargetCoCBlurred,l=this.renderTargetMasked;if(this.target!==null){const u=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=u}this.cocPass.render(e,null,i),this.blurPass.render(e,i,a),this.maskPass.render(e,t,l),this.bokehFarBasePass.render(e,l,r),this.bokehFarFillPass.render(e,r,this.renderTargetFar),this.bokehNearBasePass.render(e,t,r),this.bokehNearFillPass.render(e,r,this.renderTargetNear)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const r=n.width,i=n.height;this.cocPass.setSize(e,t),this.blurPass.setSize(e,t),this.maskPass.setSize(e,t),this.renderTargetCoC.setSize(e,t),this.renderTargetMasked.setSize(e,t),this.renderTarget.setSize(r,i),this.renderTargetNear.setSize(r,i),this.renderTargetFar.setSize(r,i),this.renderTargetCoCBlurred.setSize(r,i),this.bokehNearBasePass.fullscreenMaterial.setSize(e,t),this.bokehNearFillPass.fullscreenMaterial.setSize(e,t),this.bokehFarBasePass.fullscreenMaterial.setSize(e,t),this.bokehFarFillPass.fullscreenMaterial.setSize(e,t)}initialize(e,t,n){this.cocPass.initialize(e,t,n),this.maskPass.initialize(e,t,n),this.bokehNearBasePass.initialize(e,t,n),this.bokehNearFillPass.initialize(e,t,n),this.bokehFarBasePass.initialize(e,t,n),this.bokehFarFillPass.initialize(e,t,n),this.blurPass.initialize(e,t,Vn),this.maskPass.fullscreenMaterial.maskFunction=t?Xy:_2,n!==void 0&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,$l(e)===kn&&(va(this.renderTarget.texture,kn),va(this.renderTargetNear.texture,kn),va(this.renderTargetFar.texture,kn),va(this.renderTargetMasked.texture,kn)))}}class q2 extends ed{constructor({blendFunction:e=C0}={}){super("FXAAEffect",`/**\r
 * FXAA 3.11 by Timothy Lottes\r
 *\r
 * Copyright (c) 2011, NVIDIA CORPORATION. All rights reserved.\r
 *\r
 * TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THIS SOFTWARE IS PROVIDED "AS IS" AND NVIDIA AND ITS SUPPLIERS\r
 * DISCLAIM ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF\r
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL NVIDIA OR ITS SUPPLIERS BE LIABLE FOR ANY\r
 * SPECIAL, INCIDENTAL, INDIRECT, OR CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS\r
 * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY OTHER PECUNIARY LOSS) ARISING OUT OF\r
 * THE USE OF OR INABILITY TO USE THIS SOFTWARE, EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\r
 */\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))\r
#define ONE_OVER_TWELVE 0.08333333333333333\r
\r
varying vec2 vUvDown;\r
varying vec2 vUvUp;\r
varying vec2 vUvLeft;\r
varying vec2 vUvRight;\r
\r
varying vec2 vUvDownLeft;\r
varying vec2 vUvUpRight;\r
varying vec2 vUvUpLeft;\r
varying vec2 vUvDownRight;\r
\r
vec4 fxaa(const in vec4 inputColor, const in vec2 uv) {\r
\r
	// Luma at the current fragment.\r
	float lumaCenter = luminance(inputColor.rgb);\r
\r
	// Luma at the four direct neighbours of the current fragment.\r
	float lumaDown = luminance(texture2D(inputBuffer, vUvDown).rgb);\r
	float lumaUp = luminance(texture2D(inputBuffer, vUvUp).rgb);\r
	float lumaLeft = luminance(texture2D(inputBuffer, vUvLeft).rgb);\r
	float lumaRight = luminance(texture2D(inputBuffer, vUvRight).rgb);\r
\r
	// Find the maximum and minimum luma around the current fragment.\r
	float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));\r
	float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));\r
\r
	// Compute the delta.\r
	float lumaRange = lumaMax - lumaMin;\r
\r
	// Skip AA if the luma variation is lower than a threshold (low contrast or dark area).\r
	if(lumaRange < max(EDGE_THRESHOLD_MIN, lumaMax * EDGE_THRESHOLD_MAX)) {\r
\r
		return inputColor;\r
\r
	}\r
\r
	// Query the 4 remaining corners lumas.\r
	float lumaDownLeft = luminance(texture2D(inputBuffer, vUvDownLeft).rgb);\r
	float lumaUpRight = luminance(texture2D(inputBuffer, vUvUpRight).rgb);\r
	float lumaUpLeft = luminance(texture2D(inputBuffer, vUvUpLeft).rgb);\r
	float lumaDownRight = luminance(texture2D(inputBuffer, vUvDownRight).rgb);\r
\r
	// Combine the four edges lumas (using intermediary variables for future computations with the same values).\r
	float lumaDownUp = lumaDown + lumaUp;\r
	float lumaLeftRight = lumaLeft + lumaRight;\r
\r
	// Same for corners.\r
	float lumaLeftCorners = lumaDownLeft + lumaUpLeft;\r
	float lumaDownCorners = lumaDownLeft + lumaDownRight;\r
	float lumaRightCorners = lumaDownRight + lumaUpRight;\r
	float lumaUpCorners = lumaUpRight + lumaUpLeft;\r
\r
	// Compute an estimation of the gradient along the horizontal and vertical axis.\r
	float edgeHorizontal = (\r
		abs(-2.0 * lumaLeft + lumaLeftCorners) +\r
		abs(-2.0 * lumaCenter + lumaDownUp ) * 2.0 +\r
		abs(-2.0 * lumaRight + lumaRightCorners)\r
	);\r
\r
	float edgeVertical = (\r
		abs(-2.0 * lumaUp + lumaUpCorners) +\r
		abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 +\r
		abs(-2.0 * lumaDown + lumaDownCorners)\r
	);\r
\r
	// Check if the local edge is horizontal or vertical.\r
	bool isHorizontal = (edgeHorizontal >= edgeVertical);\r
\r
	// Choose the step size (one pixel) accordingly.\r
	float stepLength = isHorizontal ? texelSize.y : texelSize.x;\r
\r
	// Select the two neighboring texels' lumas in the opposite direction to the local edge.\r
	float luma1 = isHorizontal ? lumaDown : lumaLeft;\r
	float luma2 = isHorizontal ? lumaUp : lumaRight;\r
\r
	// Compute gradients in this direction.\r
	float gradient1 = abs(luma1 - lumaCenter);\r
	float gradient2 = abs(luma2 - lumaCenter);\r
\r
	// Check which direction is the steepest.\r
	bool is1Steepest = gradient1 >= gradient2;\r
\r
	// Gradient in the corresponding direction, normalized.\r
	float gradientScaled = 0.25 * max(gradient1, gradient2);\r
\r
	// Average luma in the correct direction.\r
	float lumaLocalAverage = 0.0;\r
\r
	if(is1Steepest) {\r
\r
		// Switch the direction.\r
		stepLength = -stepLength;\r
		lumaLocalAverage = 0.5 * (luma1 + lumaCenter);\r
\r
	} else {\r
\r
		lumaLocalAverage = 0.5 * (luma2 + lumaCenter);\r
\r
	}\r
\r
	// Shift UV in the correct direction by half a pixel.\r
	vec2 currentUv = uv;\r
\r
	if(isHorizontal) {\r
\r
		currentUv.y += stepLength * 0.5;\r
\r
	} else {\r
\r
		currentUv.x += stepLength * 0.5;\r
\r
	}\r
\r
	// Compute offset (for each iteration step) in the right direction.\r
	vec2 offset = isHorizontal ? vec2(texelSize.x, 0.0) : vec2(0.0, texelSize.y);\r
\r
	// Compute UVs to explore on each side of the edge, orthogonally. The QUALITY allows us to step faster.\r
	vec2 uv1 = currentUv - offset * QUALITY(0);\r
	vec2 uv2 = currentUv + offset * QUALITY(0);\r
\r
	// Read lumas at both extremities of the exploration segment, and compute the delta w.r.t. the local average luma.\r
	float lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\r
	float lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\r
	lumaEnd1 -= lumaLocalAverage;\r
	lumaEnd2 -= lumaLocalAverage;\r
\r
	// If the deltas at the current extremities are larger than the local gradient, the side of the edge has been reached.\r
	bool reached1 = abs(lumaEnd1) >= gradientScaled;\r
	bool reached2 = abs(lumaEnd2) >= gradientScaled;\r
	bool reachedBoth = reached1 && reached2;\r
\r
	// If the side has not been reached, continue to explore in this direction.\r
	if(!reached1) {\r
\r
		uv1 -= offset * QUALITY(1);\r
\r
	}\r
\r
	if(!reached2) {\r
\r
		uv2 += offset * QUALITY(1);\r
\r
	}\r
\r
	// If both sides have not been reached, continue to explore.\r
	if(!reachedBoth) {\r
\r
		for(int i = 2; i < SAMPLES; ++i) {\r
\r
			// If needed, read luma in 1st direction, compute delta.\r
			if(!reached1) {\r
\r
				lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\r
				lumaEnd1 = lumaEnd1 - lumaLocalAverage;\r
\r
			}\r
\r
			// If needed, read luma in opposite direction, compute delta.\r
			if(!reached2) {\r
\r
				lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\r
				lumaEnd2 = lumaEnd2 - lumaLocalAverage;\r
\r
			}\r
\r
			// If the deltas are larger than the local gradient, the side of the edge has been reached.\r
			reached1 = abs(lumaEnd1) >= gradientScaled;\r
			reached2 = abs(lumaEnd2) >= gradientScaled;\r
			reachedBoth = reached1 && reached2;\r
			\r
			// If the side has not been reached, continue to explore in this direction, with dynamic quality.\r
			if(!reached1) {\r
\r
				uv1 -= offset * QUALITY(i);\r
\r
			}\r
\r
			if(!reached2) {\r
\r
				uv2 += offset * QUALITY(i);\r
\r
			}\r
\r
			// If both sides have been reached, stop the exploration.\r
			if(reachedBoth) {\r
\r
				break;\r
\r
			}\r
\r
		}\r
\r
	}\r
\r
	// Compute the distances to each side edge of the edge (!).\r
	float distance1 = isHorizontal ? (uv.x - uv1.x) : (uv.y - uv1.y);\r
	float distance2 = isHorizontal ? (uv2.x - uv.x) : (uv2.y - uv.y);\r
\r
	// Check in which direction the side of the edge is closer.\r
	bool isDirection1 = distance1 < distance2;\r
	float distanceFinal = min(distance1, distance2);\r
\r
	// Thickness of the edge.\r
	float edgeThickness = (distance1 + distance2);\r
\r
	// Check if the luma at the center is smaller than the local average.\r
	bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;\r
\r
	// If the luma is smaller than at its neighbour, the delta luma at each end should be positive (same variation).\r
	bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;\r
	bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;\r
\r
	// Only keep the result in the direction of the closer side of the edge.\r
	bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;\r
\r
	// UV offset: read in the direction of the closest side of the edge.\r
	float pixelOffset = -distanceFinal / edgeThickness + 0.5;\r
\r
	// If the luma variation is incorrect, do not offset.\r
	float finalOffset = correctVariation ? pixelOffset : 0.0;\r
\r
	// Sub-Pixel Shifting\r
	// Full weighted average of the luma over the 3x3 neighborhood.\r
	float lumaAverage = ONE_OVER_TWELVE * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);\r
	// Ratio of the delta between the global average and the center luma, over the luma range in the 3x3 neighborhood.\r
	float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);\r
	float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;\r
	// Compute a sub-pixel offset based on this delta.\r
	float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * SUBPIXEL_QUALITY;\r
\r
	// Pick the biggest of the two offsets.\r
	finalOffset = max(finalOffset, subPixelOffsetFinal);\r
\r
	// Compute the final UV coordinates.\r
	vec2 finalUv = uv;\r
\r
	if(isHorizontal) {\r
\r
		finalUv.y += finalOffset * stepLength;\r
\r
	} else {\r
\r
		finalUv.x += finalOffset * stepLength;\r
\r
	}\r
\r
	return texture2D(inputBuffer, finalUv);\r
\r
}\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	outputColor = fxaa(inputColor, uv);\r
\r
}\r
`,{vertexShader:`varying vec2 vUvDown;\r
varying vec2 vUvUp;\r
varying vec2 vUvLeft;\r
varying vec2 vUvRight;\r
\r
varying vec2 vUvDownLeft;\r
varying vec2 vUvUpRight;\r
varying vec2 vUvUpLeft;\r
varying vec2 vUvDownRight;\r
\r
void mainSupport(const in vec2 uv) {\r
\r
	vUvDown = uv + vec2(0.0, -1.0) * texelSize;\r
	vUvUp = uv + vec2(0.0, 1.0) * texelSize;\r
	vUvRight = uv + vec2(1.0, 0.0) * texelSize;\r
	vUvLeft = uv + vec2(-1.0, 0.0) * texelSize;\r
\r
	vUvDownLeft = uv + vec2(-1.0, -1.0) * texelSize;\r
	vUvUpRight = uv + vec2(1.0, 1.0) * texelSize;\r
	vUvUpLeft = uv + vec2(-1.0, 1.0) * texelSize;\r
	vUvDownRight = uv + vec2(1.0, -1.0) * texelSize;\r
\r
}\r
`,blendFunction:e,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(e){this.defines.set("EDGE_THRESHOLD_MIN",e.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(e){this.defines.set("EDGE_THRESHOLD_MAX",e.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(e){this.defines.set("SUBPIXEL_QUALITY",e.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(e){this.defines.set("SAMPLES",e.toFixed(0)),this.setChanged()}}new D,new Ie,new Ne,new D,new D;class Y2 extends tx{constructor(e,t,n){super(n),this.setAttributes(this.getAttributes()|zp),this.camera=t,this.depthPass=new I2(e,t),this.clearPass=new N0(!0,!1,!1),this.clearPass.overrideClearColor=new Ne(0),this.depthMaskPass=new tc(new T2);const r=this.depthMaskMaterial;r.copyCameraSettings(t),r.depthBuffer1=this.depthPass.texture,r.depthPacking1=$s,r.depthMode=jo,this.renderTargetMasked=new Xt(1,1,{depthBuffer:!1}),this.renderTargetMasked.texture.name="Bloom.Masked",this.selection=new j2,this.selection.layer=11,this._inverted=!1,this._ignoreBackground=!1}set mainScene(e){this.depthPass.mainScene=e}set mainCamera(e){this.camera=e,this.depthPass.mainCamera=e,this.depthMaskMaterial.copyCameraSettings(e)}getSelection(){return this.selection}get depthMaskMaterial(){return this.depthMaskPass.fullscreenMaterial}get inverted(){return this._inverted}set inverted(e){this._inverted=e,this.depthMaskMaterial.depthMode=e?Go:jo}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get ignoreBackground(){return this._ignoreBackground}set ignoreBackground(e){this._ignoreBackground=e,this.depthMaskMaterial.maxDepthStrategy=e?Vy:D0}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}setDepthTexture(e,t=ki){this.depthMaskMaterial.depthBuffer0=e,this.depthMaskMaterial.depthPacking0=t}update(e,t,n){const r=this.camera,i=this.selection,a=this.inverted;let l=t;if(this.ignoreBackground||!a||i.size>0){const u=r.layers.mask;r.layers.set(i.layer),this.depthPass.render(e),r.layers.mask=u,l=this.renderTargetMasked,this.clearPass.render(e,l),this.depthMaskPass.render(e,t,l)}super.update(e,l,n)}setSize(e,t){super.setSize(e,t),this.renderTargetMasked.setSize(e,t),this.depthPass.setSize(e,t)}initialize(e,t,n){super.initialize(e,t,n),this.clearPass.initialize(e,t,n),this.depthPass.initialize(e,t,n),this.depthMaskPass.initialize(e,t,n),n!==void 0&&(this.renderTargetMasked.texture.type=n,$l(e)===kn&&va(this.renderTargetMasked.texture,kn))}}class Q2 extends ed{constructor({blendFunction:e=C0,adaptive:t=!0,mode:n=t?fs.REINHARD2_ADAPTIVE:fs.REINHARD2,resolution:r=256,maxLuminance:i=16,whitePoint:a=i,middleGrey:l=.6,minLuminance:u=.01,averageLuminance:h=1,adaptationRate:p=1}={}){super("ToneMappingEffect",`#include <tonemapping_pars_fragment>\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
uniform lowp sampler2D luminanceBuffer;\r
uniform float whitePoint;\r
uniform float middleGrey;\r
\r
#if TONE_MAPPING_MODE != 2\r
\r
	uniform float averageLuminance;\r
\r
#endif\r
\r
vec3 Reinhard2ToneMapping(vec3 color) {\r
\r
	color *= toneMappingExposure;\r
\r
	// Calculate the luminance of the current pixel.\r
	float l = luminance(color);\r
\r
	#if TONE_MAPPING_MODE == 2\r
\r
		// Get the average luminance from the adaptive 1x1 buffer.\r
		float lumAvg = unpackRGBAToFloat(texture2D(luminanceBuffer, vec2(0.5)));\r
\r
	#else\r
\r
		float lumAvg = averageLuminance;\r
\r
	#endif\r
\r
	float lumScaled = (l * middleGrey) / max(lumAvg, 1e-6);\r
	float lumCompressed = lumScaled * (1.0 + lumScaled / (whitePoint * whitePoint));\r
	lumCompressed /= (1.0 + lumScaled);\r
\r
	return clamp(lumCompressed * color, 0.0, 1.0);\r
\r
}\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	#if TONE_MAPPING_MODE == 1 || TONE_MAPPING_MODE == 2\r
\r
		outputColor = vec4(Reinhard2ToneMapping(inputColor.rgb), inputColor.a);\r
\r
	#else\r
\r
		outputColor = vec4(toneMapping(inputColor.rgb), inputColor.a);\r
\r
	#endif\r
\r
}\r
`,{blendFunction:e,uniforms:new Map([["luminanceBuffer",new qe(null)],["maxLuminance",new qe(i)],["whitePoint",new qe(a)],["middleGrey",new qe(l)],["averageLuminance",new qe(h)]])}),this.renderTargetLuminance=new Xt(1,1,{minFilter:Oi,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new ex({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new D2(this.luminancePass.texture,{minLuminance:u,adaptationRate:p}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=r,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode!==e){switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case fs.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case fs.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)","OptimizedCineonToneMapping(texel)");break;case fs.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel")}this.adaptiveLuminancePass.enabled=e===fs.REINHARD2_ADAPTIVE,this.setChanged()}}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===fs.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?fs.REINHARD2_ADAPTIVE:fs.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}}class xu extends ui{_composer;_effects=[];_effectPass=null;_effectsNeedUpdate=!1;onLoad({depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:r=br}){this._composer=new B2(this.viewer.renderer,{depthBuffer:e,stencilBuffer:t,multisampling:n,frameBufferType:r}),this._composer.addPass(new Ky(this.viewer.scene,this.viewer.camera))}onDestroy(){this._composer.dispose()}onEnable(){let e=this.viewer.getPlugin(Fm);e&&(e.enabled=!1),this.viewer.on(bn.RESIZE,this.onResize,this)}onDisable(){let e=this.viewer.getPlugin(Fm);e&&(e.enabled=!0),this.viewer.off(bn.RESIZE,this.onResize,this)}onResize(e,t){this._composer.setSize(e,t)}addPass(e){this._composer.addPass(e)}removePass(e){this._composer.removePass(e)}addEffect(e){this._effects.push(e),this._effectsNeedUpdate=!0}removeEffect(e){let t=this._effects.indexOf(e);t>-1&&(this._effects.splice(t,1),this._effectsNeedUpdate=!0)}updateEffects(){this._effectsNeedUpdate&&(this._effectsNeedUpdate=!1,this._effectPass&&(this.removePass(this._effectPass),this._effectPass=null),this._effects.length&&(this._effectPass=new k2(this.viewer.camera,...this._effects),this.addPass(this._effectPass)))}update(e){this.updateEffects(),this.viewer.renderer.info.reset(),this._composer.render(e)}}var Z2=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let bu=class extends ui{pass;onEnable(){this.pass.enabled=!0}onDisable(){this.pass.enabled=!1}onLoad(s){this.initialize&&this.initialize(s),this.viewer.getPlugin(xu)?.addPass(this.pass)}onDestroy(){this.viewer.getPlugin(xu)?.removePass(this.pass)}};bu=Z2([zs(xu)],bu);const K2=new Pr(-1,1,1,-1,0,1),U0=new ut;U0.setAttribute("position",new He([-1,3,0,-1,-1,0,3,-1,0],3)),U0.setAttribute("uv",new He([0,2,0,0,2,0],2));class J2{constructor(e){this._mesh=new ht(U0,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,K2)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const z0={uniforms:{tDiffuse:{value:null},tDepth:{value:null},tNormal:{value:null},tNoise:{value:null},uClippingParams:{value:new ot},uSamples:{value:[]},uAoParams:{value:new ot},uScreenSize:{value:new ot},uSsaoProjectionInfo:{value:new ot},uFrameModTaaSS:{value:0},cameraNear:{value:.1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Ie},cameraInverseProjectionMatrix:{value:new Ie}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }`,fragmentShader:`
    precision highp float;

    #include <packing>

    uniform sampler2D tDiffuse;
    uniform sampler2D tDepth;
    uniform sampler2D tNormal;
    uniform sampler2D tNoise;
    uniform vec4      uSamples[32]; 
    uniform vec4      uAoParams;
    uniform vec4      uScreenSize;
    uniform vec4      uSsaoProjectionInfo;
    uniform float     uFrameModTaaSS;
    varying vec2      vUv;

    //x = far - near
    //y = near
    //z = tanFov * aspect
    //w = tanFov
    uniform vec4      uClippingParams;

    #define uRadius     uAoParams.x
    #define uSampleCnt  uAoParams.y
    #define uGiBoost    uAoParams.z
    #define uBias       uAoParams.w

    uniform float cameraNear;
    uniform float cameraFar;
    uniform mat4 cameraProjectionMatrix;
    uniform mat4 cameraInverseProjectionMatrix;

    vec3 ndcToView(vec2 ndc, float depth) {
        float z = depth * uClippingParams.x + uClippingParams.y;
        return vec3(ndc * uClippingParams.zw, -1.0) * z;
    }
    
    vec2 viewToNdc(vec3 view) {
        return -view.xy / (uClippingParams.zw * view.z);
    }

    vec3 textureNormal(sampler2D map, vec2 uv) {
	    return unpackRGBToNormal(texture(map, uv).xyz);
    }

    float textureDepth(sampler2D map, vec2 uv) {
        return (-perspectiveDepthToViewZ(texture(map, uv).r, cameraNear, cameraFar ) - cameraNear) / (cameraFar - cameraNear);
    }

    float zValueFromScreenSpacePosition(const in float depth) {
        return (depth * uClippingParams.x + uClippingParams.y);
    }

    vec3 reconstructCSPosition(const in vec2 ssP, const in float z) {
        return vec3((ssP.xy * uSsaoProjectionInfo.xy + uSsaoProjectionInfo.zw) * z, z);
    }

    vec3 getPosition(const in vec2 uv) {
        return reconstructCSPosition(uv * uScreenSize.xy, zValueFromScreenSpacePosition(textureDepth(tDepth, uv)));
    }

    vec3 getOffsetedPixelPos(const in vec2 uv, const in vec2 unitOffset, const in float screenSpaceRadius) {
        vec2 uvOff = uv + floor(screenSpaceRadius * unitOffset) / uScreenSize.xy;
        float d = zValueFromScreenSpacePosition(textureDepth(tDepth, uvOff));
        return reconstructCSPosition(uvOff * uScreenSize.xy, d);
    }

    float interleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {
        vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);
        return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));
    }

    float hash(vec2 p) {
        return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453123);
    }

    vec2 hash2(vec2 p) { // replace this by something better
        p = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));
        return fract(sin(p) * 43758.5453123);
    }

    vec3 hash3(vec2 p){
        // p += uFrameModTaaSS * vec2(0.05);
        vec3 q = vec3(dot(p,vec2(127.1,311.7)), 
                    dot(p,vec2(269.5,183.3)), 
                    dot(p,vec2(419.2,371.9)) );
        return fract(sin(q)*43758.5453);
    }


    vec3 ssao() {
        vec2 uv = vUv;

        float uSsaoRadius = uRadius;
        float uSsaoIntensity = uGiBoost;
        float uSsaoProjectionScale = -1559.1949;
        float uSsaoBias = 0.008;

        vec3 cameraSpacePosition = getPosition(uv);
        float ssRadius = -uSsaoProjectionScale * uSsaoRadius / cameraSpacePosition.z;

        float d = textureDepth(tDepth, vUv);
        if(d >= 0.999) {
             return vec3(1.);
        }
        if (ssRadius < 1.) {
            return vec3(1.);
        }

        vec3 normal = normalize(cross(dFdy(cameraSpacePosition), dFdx(cameraSpacePosition)));
        // vec3 normal = -textureNormal(tNormal, uv);
        // return normal * 0.5 + 0.5;

        float nFalloff = mix(1.0, max(0.0, 1.5 * normal.z), 0.35);
        // return vec3(nFalloff);

        float randomAngle = 6.28 * interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);
        float invRadius2 = 1.0 / (uSsaoRadius * uSsaoRadius);
        float contrib = 0.0;
        float vv;
        float vn;
        float screenSpaceRadius;
        float angle;
        vec3 occludingPoint;
        vec2 offsetUnitVec;

        float offset = 0.;
        float nbSamples = 32.;
        for (float i = 0.; i < nbSamples; i++) {
            screenSpaceRadius = (offset + i + 0.5) * (1.0 / nbSamples);
            angle = screenSpaceRadius * (3.0 * 6.28) + randomAngle;
            screenSpaceRadius = max(0.75, screenSpaceRadius * ssRadius);
            offsetUnitVec = vec2(cos(angle), sin(angle));
            occludingPoint = getOffsetedPixelPos(uv, offsetUnitVec, screenSpaceRadius);
            occludingPoint -= cameraSpacePosition;
            vv = dot(occludingPoint, occludingPoint);
            vn = dot(occludingPoint, normal);
            contrib += max(1. - vv * invRadius2, 0.0) * max((vn - uSsaoBias) * inversesqrt(vv), 0.0);
        }
        float aoValue = max(0.0, 1.0 - sqrt(contrib * nFalloff / nbSamples));
        aoValue = pow(aoValue, 10.0 * uSsaoIntensity);
        return vec3(mix(1.0, aoValue, clamp(ssRadius - 1.0, 0.0, 1.0)));
    }

    // vec3 ssao2() {
    //     const float ATTF = 1e-5; 
    //     float d = textureDepth(tDepth, vUv);
    //     if( d >= 0.999) {
    //         discard;
    //     }
    //     float occ = 0.;
    //     float occCnt = 0.;
    //     vec3 p = ndcToView(vUv * 2. - 1., d);
    //     // vec3 n = textureNormal(tNormal, vUv);
    //     vec3 n = normalize(cross(dFdx(p), dFdy(p)));

    //     vec3  rvec = normalize(texture(tNoise, gl_FragCoord.xy/64.0).rgb*2.-1.);
    //     for(int i = 0; i<32 && d < 1.; i++) {
    //         vec3 dir = reflect(uSamples[i].xyz, rvec); // a la Crysis
    //         dir -= 2.*dir*step(dot(n,dir), 0.);  // a la Starcraft
    //         vec3 sp = p + (dir*uRadius) * (d*1e2); // scale radius with depth
    //         vec2 spNdc = viewToNdc(sp); // get sample ndc coords
            
    //         bvec4 outOfScreen = bvec4(false); // check if sample projects to screen
    //         outOfScreen.xy = lessThan(spNdc, vec2(-1));
    //         outOfScreen.zw = greaterThan(spNdc, vec2(1));
    //         if(any(outOfScreen)) continue;

    //         float spd = textureDepth(tDepth, (spNdc*0.5+0.5));
    //         vec3  occEye = -sp/sp.z*(spd*uClippingParams.x+uClippingParams.y); // compute correct pos
    //         vec3  occVec = occEye - p; // vector
    //         float att2 = 1.0+ATTF*length(occVec); // quadratic attenuation
    //         occ += max(0.0,dot(normalize(occVec),n)-0.25) / (att2*att2);
    //         ++occCnt;
    //     }
    //     return occCnt > 0.0 ? vec3(1.0-occ*uGiBoost/occCnt) : vec3(1.);
    // }

    vec3 ssao2() {
        const float ATTF = 1e-5; 
        float d = textureDepth(tDepth, vUv);
        if( d >= 0.999) {
            discard;
        }
        float occ = 0.;
        float occCnt = 0.;
        vec3 p = ndcToView(vUv * 2. - 1., d);
        vec3 n = textureNormal(tNormal, vUv);
        // vec3 n = normalize(cross(dFdx(p), dFdy(p)));

        float invRadius2 = 1.0 / (uRadius * uRadius);
        vec2 sUv = gl_FragCoord.xy/64.;
        vec3 rvec = normalize(hash3(sUv)*2.-1.);
        float nbSamples = 8.; //采样率太低会出现水波纹
        // for(int i = 0; i < 32 && d < 1.; i++) {
        for(float i = 0.; i<nbSamples && d < 1.; i++) {
            vec2 st = sUv * i;
            vec3 s = (hash3(st)*2.-1.) * mix(1e-5,.5,hash(st)); //随机缩放步长,固定步长更容易收敛,随机步长AO更准确
            vec3 dir = reflect(s, rvec); // a la Crysis
            // vec3 dir = reflect(uSamples[i].xyz, rvec); // a la Crysis
            dir -= 2.*dir*step(dot(n,dir), 0.);  // a la Starcraft
            vec3 sp = p + (dir*uRadius) * (d*5.); // scale radius with depth
            vec2 spNdc = viewToNdc(sp); // get sample ndc coords
            
            bvec4 outOfScreen = bvec4(false); // check if sample projects to screen
            outOfScreen.xy = lessThan(spNdc, vec2(-1));
            outOfScreen.zw = greaterThan(spNdc, vec2(1));
            if(any(outOfScreen)) continue;

            float spd = textureDepth(tDepth, (spNdc*0.5+0.5));
            vec3  occEye = -sp/sp.z*(spd*uClippingParams.x+uClippingParams.y); // compute correct pos
            vec3  occVec = occEye - p; // vector
            float att2 = 1.0+ATTF*length(occVec); // quadratic attenuation
            occ += max(0.0,dot(normalize(occVec),n)-0.25) / (att2*att2) * max(0., 1.-dot(occVec,occVec) * invRadius2);
            ++occCnt;
        }
        return occCnt > 0.0 ? vec3(1.0-occ*uGiBoost*10./occCnt) : vec3(1.);
    }

    void main() {        
        gl_FragColor.rgb = ssao2();
        // gl_FragColor.rgb = vec3(interleavedGradientNoise(vUv, 0.));
        // gl_FragColor.rgb = vec3(hash(gl_FragCoord.xy/64.));
        // gl_FragColor.rgb = texture(tNoise, gl_FragCoord.xy/64.0).rgb;
        gl_FragColor.a = 1.;
    }
    `},{randFloat:Zm,randInt:B0,degToRad:$2,lerp:PE}=Kn;let nx=new ot,eT=new ot;class tT extends Ur{_scene;_camera;_ssaoMaterial;_fsQuad;_depthTexture;_normalRenderTarget;_normalMaterial;_aoParams=new ot(24,32,1,0);get radius(){return this._aoParams.x}set radius(e){this._aoParams.x=e}get giBoost(){return this._aoParams.z}set giBoost(e){this._aoParams.z=e}constructor(e,t){super(),this._scene=e,this._camera=t,this._ssaoMaterial=new Bt({uniforms:lh.clone(z0.uniforms),vertexShader:z0.vertexShader,fragmentShader:z0.fragmentShader});let n=window.innerWidth,r=window.innerHeight;this._depthTexture=new er(n,r,Wa),this._normalRenderTarget=new Xt(n,r,{depthTexture:this._depthTexture}),this._normalMaterial=new Fg({blending:it}),this._fsQuad=new J2(null),this._createSamples(),this._createNoiseTexure()}_createSamples(){let e=[];for(let t=0;t<32;t++){let n=new D().set(Zm(-1,1),Zm(-1,1),Zm(-1,1)).normalize();e[t]=new ot(n.x,n.y,n.z,1).multiplyScalar(Zm(1e-5,1))}this._ssaoMaterial.uniforms.uSamples.value=e}_createNoiseTexure(){let e=new Uint8Array(16384);for(let n=0;n<16384;n+=4)e[n+0]=B0(0,255),e[n+1]=B0(0,255),e[n+2]=B0(0,255);let t=new yn(e,64,64,Hr,Vn);t.wrapS=$r,t.wrapT=$r,t.minFilter=_t,t.magFilter=_t,t.needsUpdate=!0,this._ssaoMaterial.uniforms.tNoise.value=t}setSize(e,t){this._normalRenderTarget.setSize(e,t),this._ssaoMaterial.uniforms.uScreenSize.value=eT.set(e,t,1/e,1/t);let n=this._camera.projectionMatrix.elements,r=new ot(-2/(e*n[0]),-2/(t*n[5]),(1-n[2])/n[0],(1+n[6])/n[5]);this._ssaoMaterial.uniforms.uSsaoProjectionInfo.value=r}render(e,t,n,r,i){this._renderOverride(e,this._normalMaterial,this._normalRenderTarget),this._blit(e,n,this.renderToScreen?null:t,this._ssaoMaterial)}_renderOverride(e,t,n){e.setRenderTarget(n),this._scene.overrideMaterial=t,e.render(this._scene,this._camera),this._scene.overrideMaterial=null}_blit(e,t,n,r){e.setRenderTarget(n),r.uniforms.tDiffuse.value=t.texture,r.uniforms.tDepth.value=this._normalRenderTarget.depthTexture,r.uniforms.tNormal.value=this._normalRenderTarget.texture,r.uniforms.uAoParams.value=this._aoParams,r.uniforms.uFrameModTaaSS.value++;let i=this._camera;this._ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(i.projectionMatrixInverse),this._ssaoMaterial.uniforms.cameraProjectionMatrix.value=i.projectionMatrix,this._ssaoMaterial.uniforms.cameraNear.value=i.near,this._ssaoMaterial.uniforms.cameraFar.value=i.far;let a=Math.tan(.5*$2(i.fov));nx.set(i.far-i.near,i.near,a*i.aspect,a),this._ssaoMaterial.uniforms.uClippingParams.value=nx,this._fsQuad.material=r,this._fsQuad.render(e)}dispose(){this._ssaoMaterial.dispose(),this._fsQuad.dispose()}}var rx=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class H0 extends bu{initialize(e){this.pass=new tT(this.viewer.scene,this.viewer.camera)}get radius(){return this.pass.radius}set radius(e){this.pass.radius=e}get giBoost(){return this.pass.giBoost}set giBoost(e){this.pass.giBoost=e}}rx([fn({min:.001,max:10,step:.001})],H0.prototype,"radius",null),rx([fn({min:.1,max:2,step:.01})],H0.prototype,"giBoost",null);const Bp=new ut;Bp.setAttribute("position",new pt(new Float32Array([-1,-1,3,-1,-1,3]),2)),Bp.setAttribute("uv",new pt(new Float32Array([0,0,2,0,0,2]),2)),Bp.boundingSphere=new zi,Bp.computeBoundingSphere=function(){};const nT=new Pr;class Hp{constructor(e){this._mesh=new ht(Bp,e),this._mesh.frustumCulled=!1}render(e){e.render(this._mesh,nT)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}const rT={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new Ie},viewMat:{value:new Ie},projViewMat:{value:new Ie},projectionMatrixInv:{value:new Ie},viewMatrixInv:{value:new Ie},cameraPos:{value:new D},resolution:{value:new ce},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 1);
}`,fragmentShader:`
    #define SAMPLES 16
    #define FSAMPLES 16.0
uniform sampler2D sceneDiffuse;
uniform highp sampler2D sceneNormal;
uniform highp sampler2D sceneDepth;
uniform mat4 projectionMatrixInv;
uniform mat4 viewMatrixInv;
uniform mat4 projMat;
uniform mat4 viewMat;
uniform mat4 projViewMat;
uniform vec3 cameraPos;
uniform vec2 resolution;
uniform float time;
uniform vec3[SAMPLES] samples;
uniform float[SAMPLES] samplesR;
uniform float radius;
uniform float distanceFalloff;
uniform float near;
uniform float far;
uniform bool logDepth;
uniform bool ortho;
uniform bool screenSpaceRadius;
uniform sampler2D bluenoise;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }

    vec3 getWorldPosLog(vec3 posS) {
      vec2 uv = posS.xy;
      float z = posS.z;
      float nearZ =near;
      float farZ = far;
      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
      vec4 wpos = projectionMatrixInv * clipVec;
      return wpos.xyz / wpos.w;
    }
    vec3 getWorldPos(float depth, vec2 coord) {
      #ifdef LOGDEPTH
        return getWorldPosLog(vec3(coord, depth));
      #endif
      float z = depth * 2.0 - 1.0;
      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
      // Perspective division
     vec4 worldSpacePosition = viewSpacePosition;
     worldSpacePosition.xyz /= worldSpacePosition.w;
      return worldSpacePosition.xyz;
  }

  vec3 computeNormal(vec3 worldPos, vec2 vUv) {
    ivec2 p = ivec2(vUv * resolution);
    float c0 = texelFetch(sceneDepth, p, 0).x;
    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;

    float dl = abs((2.0 * l1 - l2) - c0);
    float dr = abs((2.0 * r1 - r2) - c0);
    float db = abs((2.0 * b1 - b2) - c0);
    float dt = abs((2.0 * t1 - t2) - c0);

    vec3 ce = getWorldPos(c0, vUv).xyz;

    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;

    return normalize(cross(dpdx, dpdy));
}

void main() {
      vec4 diffuse = texture2D(sceneDiffuse, vUv);
      float depth = texture2D(sceneDepth, vUv).x;
      if (depth == 1.0) {
        gl_FragColor = vec4(vec3(1.0), 1.0);
        return;
      }
      vec3 worldPos = getWorldPos(depth, vUv);
    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);
      #ifdef HALFRES
        vec3 normal = texture2D(sceneNormal, vUv).rgb;
      #else
        vec3 normal = computeNormal(worldPos, vUv);
      #endif
      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);
      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);
      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));
      vec3 bitangent = cross(normal, tangent);
      mat3 tbn = mat3(tangent, bitangent, normal);
      float occluded = 0.0;
      float totalWeight = 0.0;
     /* float radiusScreen = distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(48.0, 0.0) / resolution)
      );/*vUv.x < 0.5 ? radius : min(distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(100.0, 0.0) / resolution)
      ), radius);
      float distanceFalloffScreen = radiusScreen * 0.2;*/
      float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;
      for(float i = 0.0; i < FSAMPLES; i++) {
        vec3 sampleDirection = 
        tbn * 
        samples[int(i)];
        ;
        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];
        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;
        vec4 offset = projMat * vec4(samplePos, 1.0);
        offset.xyz /= offset.w;
        offset.xyz = offset.xyz * 0.5 + 0.5;
        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;
        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) 
         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/
        #ifdef LOGDEPTH
        float distSample = linearize_depth_log(sampleDepth, near, far);
        #else
        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);
        #endif
        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);
        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));
        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);
        float weight = dot(sampleDirection, normal);
          occluded += rangeCheck * weight * 
            (distSample + bias
               < distWorld ? 1.0 : 0.0) * (
          (dot(
            diff,
            diff
             
            ) < 1.0 || (sampleDepth == depth) || (
              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0
            ) ? 0.0 : 1.0)
          );
          totalWeight += weight;
      }
      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);
      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);
}`},iT={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Ie},viewMat:{value:new Ie},projectionMatrixInv:{value:new Ie},viewMatrixInv:{value:new Ie},cameraPos:{value:new D},resolution:{value:new ce},color:{value:new D(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1},fog:{value:!1},fogExp:{value:!1},fogDensity:{value:0},fogNear:{value:1/0},fogFar:{value:1/0},colorMultiply:{value:!0}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform highp sampler2D downsampledDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform vec2 resolution;
    uniform vec3 color;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform float intensity;
    uniform float renderMode;
    uniform float near;
    uniform float far;
    uniform bool gammaCorrection;
    uniform bool logDepth;
    uniform bool ortho;
    uniform bool screenSpaceRadius;
    uniform bool fog;
    uniform bool fogExp;
    uniform bool colorMultiply;
    uniform float fogDensity;
    uniform float fogNear;
    uniform float fogFar;
    uniform float radius;
    uniform float distanceFalloff;
    uniform vec3 cameraPos;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
       // if (logDepth) {
        #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
        #endif
      //  }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }

    #include <common>
    #include <dithering_pars_fragment>
    void main() {
        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);
        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);
        float depth = texture2D(
            sceneDepth,
            vUv
        ).x;
        #ifdef HALFRES 
        vec4 texel;
        if (depth == 1.0) {
            texel = vec4(0.0, 0.0, 0.0, 1.0);
        } else {
        vec3 worldPos = getWorldPos(depth, vUv);
        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);
       // vec4 texel = texture2D(tDiffuse, vUv);
       // Find closest depth;
       float totalWeight = 0.0;
       float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
        for(float x = -1.0; x <= 1.0; x++) {
            for(float y = -1.0; y <= 1.0; y++) {
                vec2 offset = vec2(x, y);
                ivec2 p = ivec2(
                    (vUv * resolution * 0.5) + offset
                );
                vec2 pUv = vec2(p) / (resolution * 0.5);
                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;
                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);
                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;
                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);
                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);
                float weight = rangeCheck;
                totalWeight += weight;
                texel += sampleInfo * weight;
            }
        }
        if (totalWeight == 0.0) {
            texel = texture2D(tDiffuse, vUv);
        } else {
            texel /= totalWeight;
        }
    }
        #else
        vec4 texel = texture2D(tDiffuse, vUv);
        #endif

     
        float finalAo = pow(texel.a, intensity);
        float fogFactor;
        float fogDepth = distance(
            cameraPos,
            getWorldPos(depth, vUv)
        );
        if (fog) {
            if (fogExp) {
                fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
            } else {
                fogFactor = smoothstep( fogNear, fogFar, fogDepth );
            }
        }
        finalAo = mix(finalAo, 1.0, fogFactor);
        vec3 aoApplied = color * mix(vec3(1.0), sceneTexel.rgb, float(colorMultiply));
        if (renderMode == 0.0) {
            gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 1.0) {
            gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 2.0) {
            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
        } else if (renderMode == 3.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        } else if (renderMode == 4.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        }
        #include <dithering_fragment>
        if (gammaCorrection) {
            gl_FragColor = LinearTosRGB(gl_FragColor);
        }
    }
    `},aT={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Ie},viewMat:{value:new Ie},projectionMatrixInv:{value:new Ie},viewMatrixInv:{value:new Ie},cameraPos:{value:new D},resolution:{value:new ce},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1.0);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform vec2 resolution;
    uniform float r;
    uniform float radius;
     uniform float worldRadius;
    uniform float index;
     uniform float near;
     uniform float far;
     uniform float distanceFalloff;
     uniform bool logDepth;
     uniform bool screenSpaceRadius;
    varying vec2 vUv;

    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        highp float z_n = 2.0 * d - 1.0;
        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     return linearize_depth(linDepth, nearZ, farZ);
   }
   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
     return nearZ + (farZ - nearZ) * d;
   }
   vec3 getWorldPosLog(vec3 posS) {
     vec2 uv = posS.xy;
     float z = posS.z;
     float nearZ =near;
     float farZ = far;
     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
     vec4 wpos = projectionMatrixInv * clipVec;
     return wpos.xyz / wpos.w;
   }
    vec3 getWorldPos(float depth, vec2 coord) {
     #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
     #endif
        
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
    #include <common>
    #define NUM_SAMPLES 16
    uniform vec2 poissonDisk[NUM_SAMPLES];
    void main() {
        const float pi = 3.14159;
        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec2 uv = vUv;
        vec4 data = texture2D(tDiffuse, vUv);
        float occlusion = data.a;
        float baseOcc = data.a;
        vec3 normal = data.rgb * 2.0 - 1.0;
        float count = 1.0;
        float d = texture2D(sceneDepth, vUv).x;
        if (d == 1.0) {
          gl_FragColor = data;
          return;
        }
        vec3 worldPos = getWorldPos(d, vUv);
        float size = radius;
        float angle;
        if (index == 0.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;
        } else if (index == 1.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;
        } else if (index == 2.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;
        } else {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;
        }

        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
        float radiusToUse = screenSpaceRadius ? distance(
          worldPos,
          getWorldPos(d, vUv +
            vec2(worldRadius, 0.0) / resolution)
        ) : worldRadius;
        float distanceFalloffToUse =screenSpaceRadius ?
            radiusToUse * distanceFalloff
        : distanceFalloff;


        for(int i = 0; i < NUM_SAMPLES; i++) {
            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;
            vec4 dataSample = texture2D(tDiffuse, uv + offset);
            float occSample = dataSample.a;
            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;
            float dSample = texture2D(sceneDepth, uv + offset).x;
            vec3 worldPosSample = getWorldPos(dSample, uv + offset);
            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
            float rangeCheck = dSample == 1.0 ? 0.0 :exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));
            occlusion += occSample * rangeCheck;
            count += rangeCheck;
        }
        if (count > 0.0) {
          occlusion /= count;
        }
        #ifdef LOGDEPTH
          occlusion = clamp(occlusion, 0.0, 1.0);
          if (occlusion == 0.0) {
            occlusion = 1.0;
          }
        #endif
        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);
    }
    `},sT={uniforms:{sceneDepth:{value:null},resolution:{value:new ce},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new Ie},projectionMatrixInv:{value:new Ie},logDepth:{value:!1}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = vec4(position, 1);
    }`,fragmentShader:`
    uniform highp sampler2D sceneDepth;
    uniform vec2 resolution;
    uniform float near;
    uniform float far;
    uniform bool logDepth;
    uniform mat4 viewMatrixInv;
    uniform mat4 projectionMatrixInv;
    varying vec2 vUv;
    layout(location = 1) out vec4 gNormal;
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
        if (logDepth) {
          return getWorldPosLog(vec3(coord, depth));
        }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }
    void main() {
        vec2 uv = vUv - vec2(0.5) / resolution;
        vec2 pixelSize = vec2(1.0) / resolution;
        vec2[] uvSamples = vec2[4](
            uv,
            uv + vec2(pixelSize.x, 0.0),
            uv + vec2(0.0, pixelSize.y),
            uv + pixelSize
        );
        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;
        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;
        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;
        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;
        float minDepth = min(min(depth00, depth10), min(depth01, depth11));
        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));
        float targetDepth = minDepth;
        // Checkerboard pattern to avoid artifacts
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { 
            targetDepth = maxDepth;
        }
        int chosenIndex = 0;
        float[] samples = float[4](depth00, depth10, depth01, depth11);
        for(int i = 0; i < 4; ++i) {
            if (samples[i] == targetDepth) {
                chosenIndex = i;
                break;
            }
        }
        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]
        ), 0.0);
       /* float[] samples = float[4](depth00, depth10, depth01, depth11);
        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);
        float[] distances = float[4](depth00, depth10, depth01, depth11);
        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));

        int remaining[3];
        int rejected[3];
        int i, j, k;

        for(i = 0, j = 0, k = 0; i < 4; ++i) {
            if (distances[i] < maxDistance) {
                remaining[j++] = i;
            } else {
                rejected[k++] = i;
            }
        }
        for(;j < 3;++j) {
            remaining[j] = rejected[--k];
        }
        vec3 s = vec3(
            samples[remaining[0]],
            samples[remaining[1]],
            samples[remaining[2]]
        );
        c = (s.x + s.y + s.z) / 3.0;

        distances[0] = abs(c - s.x);
        distances[1] = abs(c - s.y);
        distances[2] = abs(c - s.z);

        float minDistance = min(min(distances[0], distances[1]), distances[2]);

        for(i = 0; i < 3; ++i) {
            if (distances[i] == minDistance) {
                break;
            }
        }*/
      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]
        ), 0.0);*/
    }`},oT=Uint8Array.from(atob("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"),(s=>s.charCodeAt(0)));function ix(s,e,t){if(e.getQueryParameter(s,e.QUERY_RESULT_AVAILABLE)){const n=e.getQueryParameter(s,e.QUERY_RESULT)/1e6;t.lastTime=n}else setTimeout((()=>{ix(s,e,t)}),1)}class lT extends Ur{constructor(e,t,n=512,r=512){super(),this.width=n,this.height=r,this.clear=!0,this.camera=t,this.scene=e,this.autosetGamma=!0,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Ne(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0,colorMultiply:!0},{set:(i,a,l)=>{const u=i[a];return i[a]=l,a==="aoSamples"&&u!==l&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),a==="denoiseSamples"&&u!==l&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),a==="halfRes"&&u!==l&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),a==="depthAwareUpsampling"&&u!==l&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),a==="gammaCorrection"&&(this.autosetGamma=!1),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.copyQuad=new Hp(new Bt({uniforms:{tDiffuse:{value:null}},depthWrite:!1,vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = vec4(position, 1);
            }
            `,fragmentShader:`
            uniform sampler2D tDiffuse;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(tDiffuse, vUv);
            }
            `})),this.writeTargetInternal=new Xt(this.width,this.height,{minFilter:_t,magFilter:_t,depthBuffer:!1}),this.readTargetInternal=new Xt(this.width,this.height,{minFilter:_t,magFilter:_t,depthBuffer:!1}),this.outputTargetInternal=new Xt(this.width,this.height,{minFilter:_t,magFilter:_t,depthBuffer:!1}),this.bluenoise=new yn(oT,128,128),this.bluenoise.colorSpace=el,this.bluenoise.wrapS=$r,this.bluenoise.wrapT=$r,this.bluenoise.minFilter=Wt,this.bluenoise.magFilter=Wt,this.bluenoise.needsUpdate=!0,this.lastTime=0,this.needsDepthTexture=!0,this.needsSwap=!0,this._r=new ce,this._c=new Ne}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new bf(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=Pu,this.depthDownsampleTarget.texture[0].type=xr,this.depthDownsampleTarget.texture[0].minFilter=Wt,this.depthDownsampleTarget.texture[0].magFilter=Wt,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=Hr,this.depthDownsampleTarget.texture[1].type=br,this.depthDownsampleTarget.texture[1].minFilter=Wt,this.depthDownsampleTarget.texture[1].magFilter=Wt,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new Hp(new Bt(sT))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(e=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const t={...rT};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new Bt(t)):this.effectShaderQuad=new Hp(new Bt(t))}configureDenoisePass(e=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const t={...aT};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.denoiseSamples),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new Bt(t)):this.poissonBlurQuad=new Hp(new Bt(t))}configureEffectCompositer(e=!1){const t={...iT};e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new Bt(t)):this.effectCompositerQuad=new Hp(new Bt(t))}generateHemisphereSamples(e){const t=[];for(let n=0;n<e;n++){const r=2.399963*n,i=Math.sqrt(n+.5)/Math.sqrt(e),a=i*Math.cos(r),l=i*Math.sin(r),u=Math.sqrt(1-(a*a+l*l));t.push(new D(a,l,u))}return t}generateHemisphereSamplesR(e){let t=[];for(let n=0;n<e;n++)t.push((n+1)/e);return t}generateDenoiseSamples(e,t){const n=2*Math.PI*t/e,r=1/e,i=r,a=[];let l=r,u=0;for(let h=0;h<e;h++)a.push(new ce(Math.cos(u),Math.sin(u)).multiplyScalar(Math.pow(l,.75))),l+=i,u+=n;return a}setSize(e,t){this.width=e,this.height=t;const n=this.configuration.halfRes?.5:1;this.writeTargetInternal.setSize(e*n,t*n),this.readTargetInternal.setSize(e*n,t*n),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(e*n,t*n),this.outputTargetInternal.setSize(e,t)}setDepthTexture(e){this.depthTexture=e}render(e,t,n){const r=e.xr.enabled;let i,a,l;e.xr.enabled=!1,e.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=e.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer)),t.texture.type!==this.outputTargetInternal.texture.type&&(this.outputTargetInternal.texture.type=t.texture.type,this.outputTargetInternal.texture.needsUpdate=!0),this.debugMode&&(i=e.getContext(),a=i.getExtension("EXT_disjoint_timer_query_webgl2"),a===null&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),this.debugMode&&(l=i.createQuery(),i.beginQuery(a.TIME_ELAPSED_EXT,l)),this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let u=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(u*=.5),this.configuration.halfRes&&(e.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(e)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new D),this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=u,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(e);for(let h=0;h<this.configuration.denoiseIterations;h++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new D),this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=u,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=h,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(e);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=u,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.autosetGamma?this.renderToScreen:this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),this.effectCompositerQuad.material.uniforms.colorMultiply.value=this.configuration.colorMultiply,this.effectCompositerQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new D),this.effectCompositerQuad.material.uniforms.fog.value=!!this.scene.fog,this.scene.fog&&(this.scene.fog.isFog?(this.effectCompositerQuad.material.uniforms.fogExp.value=!1,this.effectCompositerQuad.material.uniforms.fogNear.value=this.scene.fog.near,this.effectCompositerQuad.material.uniforms.fogFar.value=this.scene.fog.far):this.scene.fog.isFogExp2?(this.effectCompositerQuad.material.uniforms.fogExp.value=!0,this.effectCompositerQuad.material.uniforms.fogDensity.value=this.scene.fog.density):console.error(`Unsupported fog type ${this.scene.fog.constructor.name} in SSAOPass.`)),e.setRenderTarget(this.outputTargetInternal),this.effectCompositerQuad.render(e),e.setRenderTarget(this.renderToScreen?null:n),this.copyQuad.material.uniforms.tDiffuse.value=this.outputTargetInternal.texture,this.copyQuad.render(e),this.debugMode&&(i.endQuery(a.TIME_ELAPSED_EXT),ix(l,i,this)),e.xr.enabled=r}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(e){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(e)}setQualityMode(e){e==="Performance"?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Low"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Medium"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):e==="High"?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):e==="Ultra"&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}var td=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class Su extends bu{name="N8AOPlugin";_quality="Medium";initialize(e){this.pass=new lT(this.viewer.scene,this.viewer.camera),Object.assign(this.pass.configuration,{depthAwareUpsampling:!0,aoRadius:5,aoSamples:16,denoiseSamples:4,denoiseRadius:12,distanceFalloff:1,intensity:1,renderMode:0,...e})}get intensity(){return this.pass.configuration.intensity}set intensity(e){this.pass.configuration.intensity=e}get aoRadius(){return this.pass.configuration.aoRadius}set aoRadius(e){this.pass.configuration.aoRadius=e}get quality(){return this._quality}set quality(e){this.pass.setQualityMode(e)}get renderMode(){return this.pass.configuration.renderMode}set renderMode(e){this.pass.configuration.renderMode=e}get depthAwareUpsampling(){return this.pass.configuration.depthAwareUpsampling}set depthAwareUpsampling(e){this.pass.configuration.depthAwareUpsampling=e}get halfRes(){return this.pass.configuration.halfRes}set halfRes(e){this.pass.configuration.halfRes=e}}td([fn({min:0,max:10,step:.01})],Su.prototype,"intensity",null),td([fn({min:1,max:10,step:.01})],Su.prototype,"aoRadius",null),td([fn({value:["Performance","Low","Medium","High","Ultra"]})],Su.prototype,"quality",null),td([fn({value:{Combined:0,AO:1,"No AO":2,Split:3,"Split AO":4}})],Su.prototype,"renderMode",null),td([fn()],Su.prototype,"depthAwareUpsampling",null),td([fn()],Su.prototype,"halfRes",null);var cT=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let js=class extends ui{effect;onEnable(){this.viewer.getPlugin(xu)?.addEffect(this.effect)}onDisable(){this.viewer.getPlugin(xu)?.removeEffect(this.effect)}onLoad(s){this.initialize&&this.initialize(s)}};js=cT([zs(xu)],js);var ax=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class j0 extends js{name="BloomPlugin";initialize(e){this.effect=new tx({blendFunction:P0,...e})}get intensity(){return this.effect.intensity}set intensity(e){this.effect.intensity=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}}ax([fn({min:0,max:1,step:.01})],j0.prototype,"intensity",null),ax([fn({min:0,max:10,step:.01})],j0.prototype,"luminanceThreshold",null);var uT=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class sx extends js{name="ChromaticAberrationPlugin";get offset(){return this.effect.offset}set offset(e){this.effect.offset.copy(e)}initialize(e){this.effect=new W2(e)}}uT([fn()],sx.prototype,"offset",null);var G0=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class Km extends js{name="DepthOfFieldPlugin";initialize({target:e,...t}){this.effect=new X2(this.viewer.camera,t),this.effect.target=e}get target(){return this.effect.target}set target(e){this.effect.target=e}get focalLength(){return this.effect.circleOfConfusionMaterial.focalLength}set focalLength(e){this.effect.circleOfConfusionMaterial.focalLength=e}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}}G0([fn()],Km.prototype,"target",null),G0([fn()],Km.prototype,"focalLength",null),G0([fn()],Km.prototype,"bokehScale",null);var hT=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class ox extends js{name="ToneMappingPlugin";get mode(){return this.effect.mode}set mode(e){this.effect.mode=e}initialize(e){this.effect=new Q2(e)}}hT([fn({value:fs})],ox.prototype,"mode",null);var V0=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class Jm extends js{name="SelectiveBloomPlugin";initialize({selection:e,selectionLayer:t=11,ignoreBackground:n=!1,...r}){this.effect=new Y2(this.viewer.scene,this.viewer.camera,{blendFunction:P0,...r}),Array.isArray(e)&&this.effect.selection.set(e),this.effect.selection.layer=t,this.effect.ignoreBackground=n}get intensity(){return this.effect.intensity}set intensity(e){this.effect.intensity=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get selectionLayer(){return this.effect.selection.layer}set selectionLayer(e){this.effect.selection.layer=e}}V0([fn({min:0,max:10,step:.01})],Jm.prototype,"intensity",null),V0([fn({min:0,max:10,step:.01})],Jm.prototype,"luminanceThreshold",null),V0([fn()],Jm.prototype,"selectionLayer",null);var $m=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};class jp extends js{name="FXAAPlugin";initialize(e){this.effect=new q2(e)}get minEdgeThreshold(){return this.effect.minEdgeThreshold}set minEdgeThreshold(e){this.effect.minEdgeThreshold=e}get maxEdgeThreshold(){return this.effect.maxEdgeThreshold}set maxEdgeThreshold(e){this.effect.maxEdgeThreshold=e}get subpixelQuality(){return this.effect.subpixelQuality}set subpixelQuality(e){this.effect.subpixelQuality=e}get samples(){return this.effect.samples}set samples(e){this.effect.samples=e}}$m([fn()],jp.prototype,"minEdgeThreshold",null),$m([fn()],jp.prototype,"maxEdgeThreshold",null),$m([fn()],jp.prototype,"subpixelQuality",null),$m([fn()],jp.prototype,"samples",null);const dT={uniforms:{tDiffuse:{value:null},resolution:{value:new ce(1/1024,1/512)}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
	precision highp float;

	uniform sampler2D tDiffuse;

	uniform vec2 resolution;

	varying vec2 vUv;

	// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)

	//----------------------------------------------------------------------------------
	// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag
	// SDK Version: v3.00
	// Email:       gameworks@nvidia.com
	// Site:        http://developer.nvidia.com/
	//
	// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
	//
	// Redistribution and use in source and binary forms, with or without
	// modification, are permitted provided that the following conditions
	// are met:
	//  * Redistributions of source code must retain the above copyright
	//    notice, this list of conditions and the following disclaimer.
	//  * Redistributions in binary form must reproduce the above copyright
	//    notice, this list of conditions and the following disclaimer in the
	//    documentation and/or other materials provided with the distribution.
	//  * Neither the name of NVIDIA CORPORATION nor the names of its
	//    contributors may be used to endorse or promote products derived
	//    from this software without specific prior written permission.
	//
	// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ''AS IS'' AND ANY
	// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
	// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
	// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
	// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	//
	//----------------------------------------------------------------------------------

	#ifndef FXAA_DISCARD
			//
			// Only valid for PC OpenGL currently.
			// Probably will not work when FXAA_GREEN_AS_LUMA = 1.
			//
			// 1 = Use discard on pixels which don't need AA.
			//     For APIs which enable concurrent TEX+ROP from same surface.
			// 0 = Return unchanged color on pixels which don't need AA.
			//
			#define FXAA_DISCARD 0
	#endif

	/*--------------------------------------------------------------------------*/
	#define FxaaTexTop(t, p) texture2D(t, p, -100.0)
	#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), -100.0)
	/*--------------------------------------------------------------------------*/

	#define NUM_SAMPLES 5

	// assumes colors have premultipliedAlpha, so that the calculated color contrast is scaled by alpha
	float contrast( vec4 a, vec4 b ) {
			vec4 diff = abs( a - b );
			return max( max( max( diff.r, diff.g ), diff.b ), diff.a );
	}

	/*============================================================================

									FXAA3 QUALITY - PC

	============================================================================*/

	/*--------------------------------------------------------------------------*/
	vec4 FxaaPixelShader(
			vec2 posM,
			sampler2D tex,
			vec2 fxaaQualityRcpFrame,
			float fxaaQualityEdgeThreshold,
			float fxaaQualityinvEdgeThreshold
	) {
			vec4 rgbaM = FxaaTexTop(tex, posM);
			vec4 rgbaS = FxaaTexOff(tex, posM, vec2( 0.0, 1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaE = FxaaTexOff(tex, posM, vec2( 1.0, 0.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaN = FxaaTexOff(tex, posM, vec2( 0.0,-1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaW = FxaaTexOff(tex, posM, vec2(-1.0, 0.0), fxaaQualityRcpFrame.xy);
			// . S .
			// W M E
			// . N .

			bool earlyExit = max( max( max(
					contrast( rgbaM, rgbaN ),
					contrast( rgbaM, rgbaS ) ),
					contrast( rgbaM, rgbaE ) ),
					contrast( rgbaM, rgbaW ) )
					< fxaaQualityEdgeThreshold;
			// . 0 .
			// 0 0 0
			// . 0 .

			#if (FXAA_DISCARD == 1)
					if(earlyExit) FxaaDiscard;
			#else
					if(earlyExit) return rgbaM;
			#endif

			float contrastN = contrast( rgbaM, rgbaN );
			float contrastS = contrast( rgbaM, rgbaS );
			float contrastE = contrast( rgbaM, rgbaE );
			float contrastW = contrast( rgbaM, rgbaW );

			float relativeVContrast = ( contrastN + contrastS ) - ( contrastE + contrastW );
			relativeVContrast *= fxaaQualityinvEdgeThreshold;

			bool horzSpan = relativeVContrast > 0.;
			// . 1 .
			// 0 0 0
			// . 1 .

			// 45 deg edge detection and corners of objects, aka V/H contrast is too similar
			if( abs( relativeVContrast ) < .3 ) {
					// locate the edge
					vec2 dirToEdge;
					dirToEdge.x = contrastE > contrastW ? 1. : -1.;
					dirToEdge.y = contrastS > contrastN ? 1. : -1.;
					// . 2 .      . 1 .
					// 1 0 2  ~=  0 0 1
					// . 1 .      . 0 .

					// tap 2 pixels and see which ones are "outside" the edge, to
					// determine if the edge is vertical or horizontal

					vec4 rgbaAlongH = FxaaTexOff(tex, posM, vec2( dirToEdge.x, -dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongH = contrast( rgbaM, rgbaAlongH );
					// . 1 .
					// 0 0 1
					// . 0 H

					vec4 rgbaAlongV = FxaaTexOff(tex, posM, vec2( -dirToEdge.x, dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongV = contrast( rgbaM, rgbaAlongV );
					// V 1 .
					// 0 0 1
					// . 0 .

					relativeVContrast = matchAlongV - matchAlongH;
					relativeVContrast *= fxaaQualityinvEdgeThreshold;

					if( abs( relativeVContrast ) < .3 ) { // 45 deg edge
							// 1 1 .
							// 0 0 1
							// . 0 1

							// do a simple blur
							return mix(
									rgbaM,
									(rgbaN + rgbaS + rgbaE + rgbaW) * .25,
									.4
							);
					}

					horzSpan = relativeVContrast > 0.;
			}

			if(!horzSpan) rgbaN = rgbaW;
			if(!horzSpan) rgbaS = rgbaE;
			// . 0 .      1
			// 1 0 1  ->  0
			// . 0 .      1

			bool pairN = contrast( rgbaM, rgbaN ) > contrast( rgbaM, rgbaS );
			if(!pairN) rgbaN = rgbaS;

			vec2 offNP;
			offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;
			offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;

			bool doneN = false;
			bool doneP = false;

			float nDist = 0.;
			float pDist = 0.;

			vec2 posN = posM;
			vec2 posP = posM;

			int iterationsUsed = 0;
			int iterationsUsedN = 0;
			int iterationsUsedP = 0;
			for( int i = 0; i < NUM_SAMPLES; i++ ) {
					iterationsUsed = i;

					float increment = float(i + 1);

					if(!doneN) {
							nDist += increment;
							posN = posM + offNP * nDist;
							vec4 rgbaEndN = FxaaTexTop(tex, posN.xy);
							doneN = contrast( rgbaEndN, rgbaM ) > contrast( rgbaEndN, rgbaN );
							iterationsUsedN = i;
					}

					if(!doneP) {
							pDist += increment;
							posP = posM - offNP * pDist;
							vec4 rgbaEndP = FxaaTexTop(tex, posP.xy);
							doneP = contrast( rgbaEndP, rgbaM ) > contrast( rgbaEndP, rgbaN );
							iterationsUsedP = i;
					}

					if(doneN || doneP) break;
			}


			if ( !doneP && !doneN ) return rgbaM; // failed to find end of edge

			float dist = min(
					doneN ? float( iterationsUsedN ) / float( NUM_SAMPLES - 1 ) : 1.,
					doneP ? float( iterationsUsedP ) / float( NUM_SAMPLES - 1 ) : 1.
			);

			// hacky way of reduces blurriness of mostly diagonal edges
			// but reduces AA quality
			dist = pow(dist, .5);

			dist = 1. - dist;

			return mix(
					rgbaM,
					rgbaN,
					dist * .5
			);
	}

	void main() {
			const float edgeDetectionQuality = .2;
			const float invEdgeDetectionQuality = 1. / edgeDetectionQuality;

			gl_FragColor = FxaaPixelShader(
					vUv,
					tDiffuse,
					resolution,
					edgeDetectionQuality, // [0,1] contrast needed, otherwise early discard
					invEdgeDetectionQuality
			);

	}
	`};class pT extends bu{name="NVFXAAPlugin";_material=new Bt(dT);initialize(e){this.pass=new tc(this._material,"tDiffuse")}update(e){const t=this.viewer.dpr,n=this.viewer.size;this._material.uniforms.resolution.value.set(1/(n.width*t),1/(n.height*t))}}class Gs extends ui{_gui;onLoad(){this._gui=new qm({width:310,title:"Inspector"}).close()}onDestroy(){this._gui.destroy()}inspect(e="",...t){let n=this._gui;e&&(n=n.getFolder(e)||n.addFolder(e).close());for(let r of t){if(n.getFolder(r.uuid))return;let i=r.__properties;i&&Object.keys(i).length&&fT(n.addFolder(this.getObjectName(r),r.uuid).close(),r,i)}return this}uninspect(e="",...t){let n=this._gui;if(t.length>0){e&&(n=n.getFolder(e)||n);for(let r of t)n.removeFolder(r.uuid)}else e&&n.removeFolder(e)}getObjectName(e){return e.name||e.constructor.name||e.__cls}}function fT(s,e,t){let n=[];e.isComponent&&n.push({k:"enabled",order:0});for(let r in t)n.push((t[r].k=r,t[r]));n.sort(((r,i)=>(r.order??1e3)-(i.order??1e3)));for(let r=0;r<n.length;r++){let i=s,a=n[r],l=a.k;a.dir&&(i=s.getFolder(a.dir)||s.addFolder(a.dir).close());let u=e[l];if(u!=null)if(u.isColor)a.value={[l]:"#"+u.getHexString()},a.$=i.addColor(a.value,l).onChange((h=>u.set(h)));else if(u.isTexture){a.value={};let h=u.image;h.data==null&&u.isRenderTargetTexture&&u.readPixels&&(a.value.capture=()=>{h.data=h.data||new Uint8Array(h.width*h.height*4),u.readPixels(0,0,h.width,h.height,h.data),a.$.updateDisplay()},i.add(a.value,"capture")),a.value[l]=h,a.$=i.addImage(a.value,l)}else u.isVector2||u.isVector3||u.isVector4||u.isEuler?(a.value={[l]:u},a.$=i.addVector(a.value,l,a.min,a.max,a.step).onChange((h=>u.copy(h)))):typeof u=="object"||(a.$=i.add(e,l,a.value||a.min,a.max,a.step));else a.$=i.add(e,l,a.value||a.min,a.max,a.step)}}var mT=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};function lx(s){return s instanceof bu||s instanceof js}let W0=class extends ui{_inspector;onLoad(s){this._inspector=this.viewer.getPlugin(Gs),this._inspector.inspect("Postprocessing",...this.viewer.scene._components.filter(lx)),this.viewer.on("component-changed",this._onComponentChanged,this)}onDestroy(){this.viewer.off("component-changed",this._onComponentChanged,this)}_onComponentChanged(s){lx(s.target)&&(s.action==="add"&&this._inspector.inspect("Postprocessing",s.target),s.action==="remove"&&this._inspector.uninspect("Postprocessing",s.target))}};function cx(s,e,t){s.__properties_copy==null&&(s.__properties_copy=s.__properties);let n=Object.assign({},s.__properties_copy),r=s.__properties_ignore||{};for(let i in s){if(s[i]==null){delete n[i];continue}n[i]==null&&r[i]==null&&t[i]==null&&(n[i]=Object.assign({},e[i]));let a=n[i]&&n[i].parent;a&&s[a]==null&&delete n[i]}return s.__properties=n,s}function ux(s){return Object.values(s).forEach(((e,t)=>e.order=t)),s}function hx(s){return s.reduce(((e,t)=>(e[t]=!0,e)),{})}W0=mT([zs(Gs)],W0);var gT=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let _u=class extends ui{inspector;inspectorNodeHandlers=[];onLoad(s){this.inspector=this.viewer.getPlugin(Gs),this.viewer.on("node-changed",this._onNodeChanged,this)}onDestroy(){this.viewer.off("node-changed",this._onNodeChanged,this)}start(){this.viewer.scene.traverse((s=>this.inspectorNodeHandlers.forEach((e=>e.onNodeAdd&&e.onNodeAdd(s)))))}registHandler(s){this.inspectorNodeHandlers.push(s.init(this))}unregistHandler(s){this.inspectorNodeHandlers.remove(s)}_onNodeChanged(s){let e=s.action;e==="add"?s.target.traverse((t=>this.inspectorNodeHandlers.forEach((n=>n.onNodeAdd&&n.onNodeAdd(t))))):(e==="remove"||e==="clear")&&s.target.traverse((t=>this.inspectorNodeHandlers.forEach((n=>n.onNodeRemove&&n.onNodeRemove(t)))))}};_u=gT([zs(Gs)],_u);class X0{inspectorNode;init(e){return this.inspectorNode=e,this}}var vT=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let q0=class extends ui{_inspectorNode;_inspectorHandler;onLoad(s){this._inspectorNode=this.viewer.getPlugin(_u),this._inspectorHandler=new yT,this._inspectorNode.registHandler(this._inspectorHandler)}onDestroy(){this._inspectorNode.unregistHandler(this._inspectorHandler)}};q0=vT([zs(_u)],q0);class yT extends X0{_materials={};onNodeAdd(e){if(e.isMesh&&e.material){let t=e.material;this._materials[t.uuid]==null&&(this._materials[t.uuid]=0,cx(t,xT,bT),this.inspectorNode.inspector.inspect("Materials",t)),this._materials[t.uuid]++}}onNodeRemove(e){if(e.isMesh&&e.material){let t=e.material;--this._materials[t.uuid]<=0&&this.inspectorNode.inspector.uninspect("Materials",t)}}}const xT=ux({visible:{},transparent:{},side:{value:{FrontSide:0,BackSide:1,DoubleSide:2}},color:{dir:"diffuse"},opacity:{dir:"diffuse",min:0,max:1,step:.01},map:{dir:"diffuse"},roughnessMap:{dir:"roughness"},roughness:{dir:"roughness",min:0,max:1,step:.01},metalnessMap:{dir:"metalness"},metalness:{dir:"metalness",min:0,max:1,step:.01},aoMap:{dir:"ao"},aoMapIntensity:{dir:"ao",min:0,max:1,step:.01,parent:"aoMap"},emissive:{dir:"emissive"},emissiveMap:{dir:"emissive"},emissiveIntensity:{dir:"emissive",min:0,max:1,step:.01,parent:"emissiveMap"},normalMap:{dir:"normal"},normalScale:{dir:"normal",parent:"normalMap"},displacementScale:{dir:"displacement",min:0,max:1,step:.01,parent:"displacementMap"},displacementBias:{dir:"displacement",parent:"displacementMap"},envMapIntensity:{min:0,max:1,step:.01,parent:"envMap"},lightMapIntensity:{min:0,max:1,step:.01,parent:"lightMap"}}),bT=hx(["vertexShader","fragmentShader","__properties","__properties_copy","isMaterial","isMeshPhongMaterial","isMeshBasicMaterial","isMeshStandardMaterial","isShaderMaterial","uuid","name","type","blending","vertexColors","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clippingPlanes","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaToCoverage","premultipliedAlpha","forceSinglePass","userData","version","_alphaTest","defines","bumpScale","normalMapType","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","toneMapped","flatShading","fog","uniforms","uniformsGroups","extensions","defaultAttributeValues","linewidth","lights","clipping","uniformsNeedUpdate"]);var Gp=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let Y0=class extends ui{_viewerWrap;_inspector;onLoad(s){this._viewerWrap=new Vp(this.viewer,s),this._inspector=this.viewer.getPlugin(Gs),this._inspector.inspect("",this._viewerWrap)}onDestroy(){this._viewerWrap.dispose()}};Y0=Gp([zs(Gs)],Y0);class Vp{name="Viewer";viewer;envMap=new Map;get outputEncoding(){return this.viewer.renderer.outputEncoding}set outputEncoding(e){this.viewer.renderer.outputEncoding=e}get toneMapping(){return this.viewer.renderer.toneMapping}set toneMapping(e){this.viewer.renderer.toneMapping=e}get toneMappingExposure(){return this.viewer.renderer.toneMappingExposure}set toneMappingExposure(e){this.viewer.renderer.toneMappingExposure=e}get shadows(){return this.viewer.renderer.shadowMap.enabled}set shadows(e){this.viewer.renderer.shadowMap.enabled=e}get environment(){return this._envName(this.viewer.environment)}set environment(e){this.viewer.setEnvironment({url:this.envMap.get(e)})}constructor(e,t){this.viewer=e,this.viewer.on("env-changed",this._onEnvChanged,this),this._setProperties(t)}dispose(){this.viewer.off("env-changed",this._onEnvChanged,this)}_onEnvChanged(e){let t=this.__properties.environment.$;t&&t.updateDisplay()}_envName(e){return e instanceof File?e.name:e?i0(e):"none"}_setProperties({environments:e}){this.envMap.set("none",null),this.envMap.set(this.environment,this.viewer.environment),e?.reduce(((t,n)=>t.set(i0(n),n)),this.envMap),e=Array.from(this.envMap.keys()),this.__properties.environment={value:e}}}Gp([fn({value:{LinearEncoding:3e3,sRGBEncoding:3001}})],Vp.prototype,"outputEncoding",null),Gp([fn({value:{NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,CineonToneMapping:3,ACESFilmicToneMapping:4}})],Vp.prototype,"toneMapping",null),Gp([fn({min:0,max:10,step:.01})],Vp.prototype,"toneMappingExposure",null),Gp([fn()],Vp.prototype,"shadows",null);var ST=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let Q0=class extends ui{onLoad(s){}};Q0=ST([zs(Gs)],Q0);var _T=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let Z0=class extends ui{_inspectorNode;_inspectorHandler;onLoad(s){this._inspectorNode=this.viewer.getPlugin(_u),this._inspectorHandler=new wT,this._inspectorHandler.helperGroup=this.viewer.addNode(Cr),this._inspectorNode.registHandler(this._inspectorHandler)}onDestroy(){this._inspectorHandler.helperGroup.remove(),this._inspectorNode.unregistHandler(this._inspectorHandler)}update(s){this._inspectorHandler.helperGroup.children.forEach((e=>{e.visible=e.light.visible,e.update()}))}};Z0=_T([zs(_u)],Z0);class wT extends X0{helperGroup;onNodeAdd(e){e.isLight&&(e.isDirectionalLight&&this.helperGroup.add(new c1(e)),e.isPointLight&&this.helperGroup.add(new i1(e)),e.isSpotLight&&this.helperGroup.add(new n1(e)),e.target&&(function(t,n,r,i){Object.defineProperty(t,n,{configurable:!0,enumerable:!0,get:r,set:i})})(e,"targetPos",(()=>e.target.position),(t=>e.target.position.copy(t))),cx(e,MT,TT),this.inspectorNode.inspector.inspect("Lights",e))}onNodeRemove(e){if(e.isLight){let t=this.helperGroup.children.find((n=>n.light===e));t&&this.helperGroup.remove(t),this.inspectorNode.inspector.uninspect("Lights",e)}}}const MT=ux({visible:{},castShadow:{},intensity:{min:0,max:1,step:.01},color:{},position:{},targetPos:{}}),TT=hx(["isObject3D","isLight","isDirectionalLight","isPointLight","isSpotLight","isAmbientLight","isHemisphereLight","uuid","name","type","parent","children","matrix","matrixWorld","matrixAutoUpdate","scale","up","matrixWorldNeedsUpdate","matrixWorldAutoUpdate","layers","receiveShadow","frustumCulled","renderOrder","animations","userData","uniforms","target","shadow","rotation"]);var ET=function(s,e,t,n){var r,i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(a=(i<3?r(a):i>3?r(e,t,a):r(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};let K0=class extends ui{_inspector;onLoad(s){this._inspector=this.viewer.getPlugin(Gs),this._inspector.inspect("Components",...this.viewer.getComponentsInChidren(this.viewer.scene,en).filter((e=>!e.isPlugin))),this.viewer.on("component-changed",this._onComponentChanged,this)}onDestroy(){this.viewer.off("component-changed",this._onComponentChanged,this)}_onComponentChanged(s){s.target.isPlugin||(s.action==="add"&&this._inspector.inspect("Components",s.target),s.action==="remove"&&this._inspector.uninspect("Components",s.target))}};K0=ET([zs(Gs)],K0)})();E.J12;E.$c;E.I_b;E.oGK;var n3=E.$p;E.$q;var r3=E.$r;E.i5S;E.nXV;E.bd1;E.LY2;E.bGH;E.NDo;E.gSk;E.WMw;E.OTo;E.Se2;E.cum;var i3=E.Mig;E.i_9;E.m7l;E.sYA;var a3=E.Xcj;E.mzJ;E.ZZA;E.T__;E.HkE;E.tGC;E.gOo;var Qr=E.meI;E.BbS;E.kqm;var jx=E.Wat;E.Hmr;E.SJI;E.rMl;E.mTL;E.y8_;E._Li;E.z81;E._MY;var s3=E.dFZ;E.IIx;E.N$j;E.XO3;E._YM;E.TUj;E.ZzF;E.GQ;E.nvb;E.DvJ;E.fQA;E.TlE;var o3=E.u9r;E.s4_;E.T95;E.CtF;E.V1s;E.Rki;E.ROQ;E.YN5;E.BVQ;E.YT8;E._DE;E.YGz;E.WXy;E.max;E.trn;E.zf8;E.uWy;E.SUY;var vs=E.Ilk;E.xRS;E.R2R;E.epp;var Uo=E.wA2;E.Z_g;E.EB7;E.DqL;E._3;E.b_z;E.Qrh;E.unp;E._am;E.fY$;E.vxC;E.BtG;E.cBK;E.g8_;E.AXT;E.yj7;E.dYG;E.tm_;E.S2y;E.B02;E.PeU;E.Hyl;E.Wqd;E.Xaj;E.dZ3;E.m_w;E.fHI;E.LBq;E.JUT;E.p3g;var l3=E.IEO;E.yxD;E.A5E;E.jfJ;E.T_J;E.tEQ;E.qkB;E.HWo;E.brP;E.$YQ;var Jp=E.iRp,c3=E.Ox3;E.cBI;E.cU9;E.ntt;E.DT1;E.Kgo;E.ehD;E.fSK;E.Vdb;E.l8J;E.dj0;E.QM0;E.TOt;var u3=E.Qmf,h3=E.JIf;E.Ny0;E.eD;E.jwo;E.dSO;E.Bf4;var cb=E.USm;E.pBf;var d3=E.vpe;E.$Vf;E.O7d;var p3=E.JE9;E.hH6;E.e62;var Gx=E.a$l;E.OM3;var f3=E.VzW,m3=E.ybr;E.yo9;E.Wzm;E.zUS;E.Wl3;E.iWj;E.CoK;E.ylh;E.v9Y;E.LSk;E.XSA;E.w$m;E.ksN;E.j4z;E.OAl;E.VLJ;E.ZAu;E.cLu;E.vmT;E.Qpg;E.So8;E.Wjw;E.cJO;E.QRU;E.uSM;E.S3k;E.fnl;E.PpQ;E.ZRs;E.oqc;E.UT1;E.KQe;E.s28;E.uEm;E.b08;E.yPR;E.ph9;E.llF;E.EIF;E.lb7;E.L5s;E.$TI;var mv=E.SPe;E.aVm;E.j87;E.RNb;E.Kz5;E.vpT;E.kB5;E._C8;E.Syv;E.NMF;E.pIN;E.eMJ;E.x5V;E.tUh;E.z8B;E.GZb;E.p7y;E.S9g;E.Zr5;E.vCF;E.yt0;E.uXU;E._kC;E.lk7;E.x12;E.Zzh;E.nls;E.g_z;E.U7;E.FT0;E.blk;E.ejS;var g3=E.rnI;E.wem;E.lfu;E.FDw;E.lRj;var v3=E.D1R;E.qyh;E.GUF;E.EoG;E.aNw;E.Zp0;E.lLk;var y3=E.jAl;E.uEv;E.YKA;E.cRx;E.Y8D;E.RsA;E.F5T;E.u7G;var dv=E.M8C,Vx=E.Vkp,gv=E.yGw;E.Sm8;var Eu=E.Kj0;E.vBJ;E.lRF;E.Lun;E.YBo;E.kaV;E.RSm;E.xoR;E.EJi;E.Qme;E.Wid;E.IKL;E.r_;E.OoA;E.qhX;E.M5h;E.Ns1;E.Ue;E.RR3;E.TyD;E.vZf;E.HTd;E.aH4;E.YLQ;E.BVF;E.MyG;E.jFi;E.aCh;var x3=E.uL9;E.IFH;E.bdR;E.M6v;E.RvT;E.ymC;E.dUE;var b3=E.Tme;E.Gql;E.PA7;E.REq;E.pQR;E.ghN;E.Hy8;E.Wpd;E.LgZ;E.iWC;E.lkL;E.iKG;E._iA;E.ntZ;E.anP;E.HRQ;E.hpZ;E.w2v;E.WI2;E.y$t;E.cPb;E.JOQ;E.BKK;var ub=E._12;E.tJx;E.OdJ;var vv=E.SyM;E.cek;E.xG9;var S3=E.woe,_3=E.UY4;E.aq0;E.ujx;E.Uol;E.VYz;E.tSf;E.M20;E.iUV;E.tf;E.ZQ6;E.mXe;var yv=E._fP;E.iLg;E.zbs;E.ZTh;E.HdW;E.UZH;E.mSO;var w3=E.wk1;E.E2K;E.FUD;E.pKu;E.GG6;E.Gih;E.iiP;E.SvJ;E.ptH;E.jZA;E.y2t;E.gi4;E.Djp;E.BG$;E.NYV;E.xJs;E.bsb;E.ekQ;E.CaW;E.eaV;E.BFQ;E.v3W;E.ILR;E.fto;E.l0P;E.vCx;E._AM;E.wuA;E.av9;E.CtA;E.FIo;E.zHn;E.iMs;E.T_f;E.hEm;E.D9w;E.CdI;E.wo6;E.TIb;var hb=E.rpg;E.ce8;E.rOj;E.V4E;E.o8S;E.lGU;E.vuL;E.KI_;E.iLN;E.xsS;var M3=E.b26;E.w5d;E.WdD;E.Vj0;var $p=E.jyz;E.Tn7;E.bnF;E.HW6;E.oa8;E.T_1;E.iDF;E.iAb;E.OdW;E._YX;E.TUv;E.Hw6;E.aLr;E.Aip;E.xo$;E.$V;E.lDi;E.gti;E.PMe;E.FvO;E.jyi;E.xeV;E.k74;E.RlZ;E.KhW;E.HgB;E.W2J;E.JWc;E.kP0;E.u37;E.Z6B;E.QZ1;E.Ir4;E.nE5;E.NwF;E.Wbm;E.N4l;E.QmN;var ja=E.wes;E.IOt;E.L5g;E.H$k;E.xEZ;E.Yin;var ef=E.dpR,T3=E.hmx,E3=E.Lb$;E.Cne;E.XvJ;E.XZw;E.FE5;E.CJI;E.z$h;E.UlW;E.WwZ;E.Lcc;E.WXh;E.VNk;E.ub3;E.xfE;E.qlB;E.lCJ;E.WTc;E.rAo;var Wx=E.xWb;E.gH0;E.rBU;E.rDY;E.ywz;E.wJv;E.JQ4;E.k0A;E.irR;E.LsT;E.Oih;E.p9U;E.MiG;E.JSe;E.dwk;E.FM8;var yr=E.Pa4;E.Ltg;E.yC1;E.Lpp;E.fO1;var A3=E.AEx;E._9o;E.k5T;E.b5g;E.Ywn;E.GVz;E.oAp;E.kFz;E.dd2;E.CP7;E.fQK;E.Uk6;E._sL;E.Pnf;E.c8b;E._lf;E.ad5;E.L_r;E.HOT;E.$R8;E.lDs;E.Oe_;E.S6$;var ac=E.CbL;E.knz;class Xx{_taskCount=0;_taskFinished=0;_resolve=Promise.resolve();_progress=0;get progress(){return this._progress}task(z,{name:P="",weight:$=1}={}){return this._regist($),this._resolve.then(()=>typeof z=="function"?z():z).then(()=>this._finish($,P)).catch(ve=>{this._finish($,P),console.error(ve)})}reset(){this._taskCount=0,this._taskFinished=0,this._progress=0}_finish(z,P){this._taskFinished+=z,this._progress=dv.clamp01(Math.max(this._progress,this._taskFinished/this._taskCount))}_regist(z){this._taskCount=Math.max(1,this._taskCount+z)}}class R3 extends d3{taskManger=new Xx;restartCount=0;reset(){this.clear(),this.taskManger.reset(),this.taskManger=new Xx}get progress(){return this.taskManger.progress}restart(){window.location.href="https://www.bilibili.com/video/BV1E8411v7xy"}task(z,P={}){return this.taskManger.task(z,P)}}const jt=new R3;function L3(){const[ee,z]=Zr.useState(!1),[P,$]=Zr.useState(!1),[ve,ze]=Zr.useState(!1),[Ze,at]=Zr.useState(!1);return Zr.useEffect(()=>{jt.on("doorCreate",()=>{ze(!0)},!0,!0),jt.on("openDoor",()=>{at(!0),$(!1)},!0,!0),setTimeout(()=>{z(!0),$(!0)},500)},[]),nn.jsxs("div",{className:"menu-container",children:[nn.jsx("div",{className:"menu-12",style:{opacity:P?"0.9":"0"}}),nn.jsxs("div",{className:"menu-login",style:{opacity:ee?"1":"0"},children:[nn.jsx("div",{className:"background"}),nn.jsx("div",{className:"menu-description",children:nn.jsxs("div",{className:"description",children:[nn.jsx("p",{children:"免责声明："}),nn.jsx("p",{children:"本网站是一个纯粹的技术示例，旨在展示和分享我们的技术能力。网站的设计和内容受到《原神》的启发，并尽可能地复制了《原神》的登录界面。我们对此表示敬意，并强调这个项目不是官方的《原神》产品，也没有与《原神》或其母公司miHoYo有任何关联。"}),nn.jsx("p",{children:"我们没有，也无意从这个项目中获得任何经济利益。这个网站的所有内容仅供学习和研究目的，以便让更多的人了解和熟悉webgl开发技术。"}),nn.jsx("p",{children:"如果miHoYo或任何有关方面认为这个项目侵犯了他们的权益，请联系我们，我们会立即采取行动。"})]})}),nn.jsx("button",{className:"ClickMe",onClick:ee?()=>{jt.emit("button-start-click"),jt.emit("start"),z(!1)}:()=>{}}),nn.jsx("button",{className:"ClickMe",style:{bottom:"16%",backgroundImage:'url("/Genshin/jump.png")'},onClick:ee?()=>{window.open("https://www.bilibili.com/video/BV1E8411v7xy")}:()=>{}})]}),ve&&nn.jsx("div",{className:"menu-doorCreate-content",style:{opacity:Ze?"0":"1"},children:nn.jsx("div",{className:"menu-doorCreate",children:nn.jsx("div",{className:"entry"})})})]})}let mg=new M3,cv=null;function db(){let ee=performance.now();if(cv!==null){let z=ee-cv;mg.update(z*.001)}cv=ee,requestAnimationFrame(db)}db();let pb=1;const P3={uuid:""+pb++};function C3(){mg.unscheduleAll(P3)}function D3(ee,z=[],P=0,$=-1){const[ve]=Zr.useState(()=>({uuid:""+pb++})),ze=Zr.useCallback(ee,z);Zr.useEffect(()=>(mg.schedule(ve,ze,P,$),()=>mg.unshedule(ve,ze)),[ze,P,$])}function O3(){const ee=Zr.useRef(),[z,P]=Zr.useState(!0),[$,ve]=Zr.useState(0);return Zr.useEffect(()=>{$>=1&&(P(!1),setTimeout(()=>jt.emit("preloaded"),1500))},[$]),D3(ze=>{ze=dv.clamp(ze,.005,.3);let Ze=dv.damp($,jt.progress,170,ze);Ze!==0&&(Ze>.99&&(Ze=1),ve(Ze))},[$]),nn.jsx("div",{className:"progress-container",style:{opacity:z?"1":"0"},children:nn.jsxs("div",{className:"progress-content",children:[nn.jsx("img",{className:"Genshin",src:"Genshin/Genshin.png",alt:"图片",style:{opacity:z?"1":"0"}}),nn.jsxs("div",{className:"LoadingBar",style:{opacity:z?"1":"0"},children:[nn.jsx("div",{className:"progress-bar",children:nn.jsx("div",{ref:ee,className:"progress",style:{width:$*100+"%"}})}),nn.jsx("div",{className:"ball",style:{left:"-2vmin"}}),nn.jsx("div",{className:"ball",style:{left:"40.8vmin",top:"-2.4vmin"}}),nn.jsx("div",{style:{paddingTop:"1vmin",fontSize:"1.4vmin"},children:"为了您更好的体验，请在电脑端打开"})]})]})})}class I3{resources={}}class fb{name="";active=!1;target;SM}Promise.resolve();class N3{constructor(z){this.target=z}_state="";_states=[];_handlers={};_promise=Promise.resolve();reset(){this._state="",this._states=[],this._handlers={}}getState(){return this._state}setState(z){if(this._state===z)return!1;if(this._state){let P=this._handlers[this._state];if(P===void 0||P.canTransfer&&!P.canTransfer(z))return!1}return this._states.push(z),this._states.length==1&&this._transferState(),!0}_transferState(){let z=async()=>{let $=this._handlers[this._state];$&&($.onLeave&&await this._promise.then(()=>$.onLeave()),$.active=!1)},P=async()=>{if(!this._states.length)return;let $=this._state=this._states.shift(),ve=this._handlers[$];ve&&(ve.onEnter&&await this._promise.then(()=>ve.onEnter()),ve.active=!0),this._states.length>0&&this._transferState()};this._promise.then(z).then(P).catch(console.error)}registState(z){let P=new z,$=P.name||P.constructor.name;this._handlers[$]&&console.warn(`state: ${$} duplicate registered`),P.SM=this,P.target=this.target,this._handlers[$]=P}updateState(z){for(let P in this._handlers){let $=this._handlers[P];$.active&&$.onUpdate&&$.onUpdate(z)}}}var Kx,Jx,$x,hg;class pg extends($x=Uo,Jx=[ac()],Kx=[ac({min:0,max:20,step:.001})],$x){constructor(){super(...arguments);ag(hg,5,this)}get color(){return this.node.color}set color(P){this.node.color.copy(P)}get intensity(){return this.node.intensity}set intensity(P){this.node.intensity=P}create(P){return n3(new i3,{color:new vs(1011455),intensity:6,...P})}}hg=ig($x),ko(hg,2,"color",Jx,pg),ko(hg,2,"intensity",Kx,pg),Yp(hg,pg);const na=new yr;let k3=new yr;class F3 extends Uo{speed=new yr(0,0,-88);shouldStop=!1;_zOffset=0;onLoad(z){na.set(0,0,0),this.on("showDoor",this.stop,this),this.on("openDoor",this.openDoor,this)}update(z){this.shouldStop||(na.add(k3.copy(this.speed).multiplyScalar(z)),this.viewer.camera.position.copy(na))}stop(z){this.shouldStop=!0,this._zOffset=z;let P=this.viewer.camera.position.clone();ja.TweenManager.Tween(this.viewer.camera).to({position:new yr(P.x,P.y,z-165)},5).easing(ja.Easing.Cubic.Out).start()}openDoor(){let z=this.viewer.camera.position.clone();ja.TweenManager.KillTweensOf(this.viewer.camera),ja.TweenManager.Tween(this.viewer.camera).to({position:new yr(z.x,z.y,this._zOffset-400)},.6).easing(ja.Easing.Cubic.In).start()}}const U3=`
#ifdef USE_FOG
    #ifdef FOG_EXP2
        float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
    #else
        float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
    #endif
    vec3 linearFragCol = aces_fitted(gl_FragColor.rgb);
    gl_FragColor.rgb = mix( linearFragCol, fogColor, fogFactor );
    gl_FragColor.rgb = ACES_Inv(gl_FragColor.rgb);
#endif
`,rd=`
vec3 rrt_odt_fit(vec3 v)
{
    vec3 a = v*(         v + 0.0245786) - 0.000090537;
    vec3 b = v*(0.983729*v + 0.4329510) + 0.238081;
    return a/b;
}
vec3 inv_rrt_odt_fit(vec3 v)
{
    vec3 a = -(sqrt(10.)*sqrt((-187248350.*pow(v,vec3(2.)))+232585567.*v+241290.)+21650.*v-1230.);
    vec3 b = (98370.*v-100000.);
    return a/b;
}

mat3 mat3_from_rows(vec3 c0, vec3 c1, vec3 c2)
{
    mat3 m = mat3(c0, c1, c2);
    m = transpose(m);

    return m;
}

vec3 mul(mat3 m, vec3 v)
{
    return m * v;
}

mat3 mul(mat3 m1, mat3 m2)
{
    return m1 * m2;
}

vec3 aces_fitted(vec3 color)
{
    mat3 ACES_INPUT_MAT = mat3_from_rows(
        vec3( 0.59719, 0.35458, 0.04823),
        vec3( 0.07600, 0.90834, 0.01566),
        vec3( 0.02840, 0.13383, 0.83777));

    mat3 ACES_OUTPUT_MAT = mat3_from_rows(
        vec3( 1.60475,-0.53108,-0.07367),
        vec3(-0.10208, 1.10813,-0.00605),
        vec3(-0.00327,-0.07276, 1.07602));

    color = mul(ACES_INPUT_MAT, color);

    // Apply RRT and ODT
    color = rrt_odt_fit(color);

    color = mul(ACES_OUTPUT_MAT, color);

    return color;
}
vec3 ACES_Inv(vec3 color)
{
    mat3 ACES_INPUT_MAT = mat3_from_rows(
        vec3( 1.76474, -0.67577, -0.08896),
        vec3( -0.14702, 1.16025, -0.01322),
        vec3( -0.03633, -0.16243, 1.19877));

    mat3 ACES_OUTPUT_MAT = mat3_from_rows(
        vec3( 0.64304, 0.31119,0.04578),
        vec3(0.05926, 0.93144, 0.00929),
        vec3(0.00596,0.06393, 0.93012));

    color = mul(ACES_OUTPUT_MAT, color);
    
    // Apply RRT and ODT
    color = inv_rrt_odt_fit(color);

    color = mul(ACES_INPUT_MAT, color);

    return color;
}

vec3 PowVec3(vec3 v, float p)
{
    return vec3(pow(v.x, p), pow(v.y, p), pow(v.z, p));
}

const float gamma = 2.2;
vec3 ToSRGB(vec3 v) { return PowVec3(v, 1.0/gamma); }
`,z3=`
${rd}
void RE_Direct_ToonPhysical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, const in float metalnessFactor, inout ReflectedLight reflectedLight ) {
    float dotNL_noSaturate = dot( geometry.normal, directLight.direction );
    float dotNL = saturate( dotNL_noSaturate );
    float dotNL_toon = smoothstep(0.25,0.27,dotNL);//*pow(dotNL,0.5);//*0.8;//+0.14;
    vec3 irradiance = dotNL_toon * directLight.color;
    #ifdef USE_CLEARCOAT
        float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
        vec3 ccIrradiance = dotNLcc * directLight.color;
        clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
    #endif
    #ifdef USE_SHEEN
        sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
    #endif
    #ifdef USE_IRIDESCENCE
        reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
    #else
        //手动调整反射粗糙度
        float new_roughness = (1.0-step(0.01,metalnessFactor))*pow(material.roughness,0.4);
        new_roughness += step(0.01,metalnessFactor)*pow(material.roughness,1.4);
        reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, new_roughness );
    #endif
    // reflectedLight.directSpecular*=13.;
    reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
    //计算出假反射
    float dotNL_reflect_faker = 1.-smoothstep(0.,0.3,dotNL_noSaturate);

	float fresnelTerm = dot(geometry.viewDir, geometry.normal);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.) * dotNL_reflect_faker;
    reflectedLight.directDiffuse += fresnelCol*pow(fresnelTerm,4.5)*0.8;
}
`,qx=`
${rd}
void RE_Direct_ToonPhysical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, const in float metalnessFactor, inout ReflectedLight reflectedLight ) {
    float dotNL_noSaturate = dot( geometry.normal, directLight.direction );
    float dotNL = saturate( dotNL_noSaturate );
    float dotNL_toon = smoothstep(0.25,0.27,dotNL)*pow(dotNL,0.5)*1.4;//*0.8;//+0.14;
    dotNL_toon += smoothstep(0.75,0.8,dotNL)*pow(dotNL,1.);
    vec3 irradiance = dotNL_toon * directLight.color;
    #ifdef USE_CLEARCOAT
        float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
        vec3 ccIrradiance = dotNLcc * directLight.color;
        clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
    #endif
    #ifdef USE_SHEEN
        sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
    #endif
    #ifdef USE_IRIDESCENCE
        reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
    #else
        //手动调整反射粗糙度
        float new_roughness = (1.0-metalnessFactor)*pow(material.roughness,0.4);
        new_roughness += metalnessFactor*pow(material.roughness,1.2);
        reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, new_roughness );
    #endif
    reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
    //计算出假反射
    float dotNL_reflect_faker = 1.-smoothstep(0.,0.3,dotNL_noSaturate);

	float fresnelTerm = dot(geometry.viewDir, geometry.normal);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.) * dotNL_reflect_faker;
    reflectedLight.directDiffuse += fresnelCol*pow(fresnelTerm,5.)*0.8;
}
`,uv=`

GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
    geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
    float dotNVi = saturate( dot( normal, geometry.viewDir ) );
    if ( material.iridescenceThickness == 0.0 ) {
        material.iridescence = 0.0;
    } else {
        material.iridescence = saturate( material.iridescence );
    }
    if ( material.iridescence > 0.0 ) {
        material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
        material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
    }
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
    PointLight pointLight;
    #if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
    PointLightShadow pointLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
        pointLight = pointLights[ i ];
        getPointLightInfo( pointLight, geometry, directLight );
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
        pointLightShadow = pointLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
        #endif
        RE_Direct( directLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
    SpotLight spotLight;
    vec4 spotColor;
    vec3 spotLightCoord;
    bool inSpotLightMap;
    #if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
    SpotLightShadow spotLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
        spotLight = spotLights[ i ];
        getSpotLightInfo( spotLight, geometry, directLight );
        #if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
        #define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
        #elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
        #define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
        #else
        #define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
        #endif
        #if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
            spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
            inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
            spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
            directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
        #endif
        #undef SPOT_LIGHT_MAP_INDEX
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
        spotLightShadow = spotLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
        #endif
        RE_Direct( directLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
    DirectionalLight directionalLight;
    #if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
    DirectionalLightShadow directionalLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
        directionalLight = directionalLights[ i ];
        getDirectionalLightInfo( directionalLight, geometry, directLight );
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
        directionalLightShadow = directionalLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
        #endif
        RE_Direct_ToonPhysical( directLight, geometry, material,metalnessFactor, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
    RectAreaLight rectAreaLight;
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
        rectAreaLight = rectAreaLights[ i ];
        RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
    vec3 iblIrradiance = vec3( 0.0 );
    vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
    irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
    #if ( NUM_HEMI_LIGHTS > 0 )
        #pragma unroll_loop_start
        for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
            irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
        }
        #pragma unroll_loop_end
    #endif
#endif
#if defined( RE_IndirectSpecular )
    vec3 radiance = vec3( 0.0 );
    vec3 clearcoatRadiance = vec3( 0.0 );
#endif
`,tf=`
float random(vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}`,B3=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;
uniform float time;

${tf}
${rd}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    vec3 mask = col.rgb;

    vec3 col_r = mix(vec3(23., 145., 250.)/255.,vec3(0.93),vec3(pow(mask.r,0.4)));
    
    col = vec4(col_r,col.a);
    col.rgb = ACES_Inv(col.rgb);

    gl_FragColor = vec4(col);
}`,H3=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;

${tf}
${rd}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    col.a = col.r;
    col = vec4(vec3(0.9)*2.,col.a*0.4);
    gl_FragColor = vec4(col);
}`,j3=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;

uniform vec3 color_1;
uniform float color_intensity_1;
uniform vec3 color_2;
uniform float color_intensity_2;

${tf}
${rd}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    vec3 mask = col.rgb;

    vec3 col_r = mix(color_1*color_intensity_1,color_2*color_intensity_2,vec3(pow(mask.r,0.6)));

    col = vec4(col_r,col.a);
    col.rgb = ACES_Inv(col.rgb);
    gl_FragColor = vec4(col);
}`,G3=`
/* 噪波 */
const float F3 =  0.3333333;
const float G3 =  0.1666667;
vec3 random3(vec3 c) {
	float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
	vec3 r;
	r.z = fract(512.0*j);
	j *= .125;
	r.x = fract(512.0*j);
	j *= .125;
	r.y = fract(512.0*j);
	return r-0.5;
}
float noise3d(vec3 p) {
	 vec3 s = floor(p + dot(p, vec3(F3)));
	 vec3 x = p - s + dot(s, vec3(G3));

	 vec3 e = step(vec3(0.0), x - x.yzx);
	 vec3 i1 = e*(1.0 - e.zxy);
	 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
	
	 vec3 x1 = x - i1 + G3;
	 vec3 x2 = x - i2 + 2.0*G3;
	 vec3 x3 = x - 1.0 + 3.0*G3;
	 
	 vec4 w, d;
	 
	 w.x = dot(x, x);
	 w.y = dot(x1, x1);
	 w.z = dot(x2, x2);
	 w.w = dot(x3, x3);
	 
	 w = max(0.6 - w, 0.0);
	 
	 d.x = dot(random3(s), x);
	 d.y = dot(random3(s + i1), x1);
	 d.z = dot(random3(s + i2), x2);
	 d.w = dot(random3(s + 1.0), x3);
	 
	 w *= w;
	 w *= w;
	 d *= w;
	 
	 return dot(d, vec4(52.0));
}
`,V3=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform float time;
${G3}

void main() {
    
	vec2 uv = vUv*vec2(0.0024,0.0016);
	
	float f = 0.0;

    f = clamp(noise3d(vPositionW*vec3(0.012,0.012,0.)+vec3(time*0.25))+0.2,0.,1.);
    f+= clamp(noise3d(vPositionW*vec3(0.004,0.004,0.)-vec3(time*0.15))+0.1,0.,1.);

    f=clamp(f,0.,1.);
    //做一个y轴的过渡
    f*=(1.-smoothstep(-5.,45.,vPositionW.y));
    f*= (smoothstep(-200.,-35.,vPositionW.y));
    //做一个x轴的过渡
    f*=(smoothstep(0.,40.,vPositionW.x)+(1.-smoothstep(-40.,-0.,vPositionW.x)));
    
    gl_FragColor = vec4(vec3(1.)*3.,f*0.3);
}`,W3=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D lightTexture;
uniform float time;

${tf}

void main() {
    float mask = 1.5*texture(lightTexture,vUv+vec2(time*0.015,0.)).r;
    mask+=  texture(lightTexture,vUv*vec2(0.4,1.)+vec2(time*-0.0075,0.)).r;

    vec4 col = vec4(vec3(1.8),mask);
    //与相机距离越近，透明度降低
    float distanceToCamera = distance(cameraPosition.xyz,vPositionW);
    col.a*=smoothstep(200.,1000.,distanceToCamera);
    col.a*=smoothstep(0.0,0.5,vUv.y);
    col.a*=smoothstep(0.0,0.1,vUv.x)*smoothstep(1.0,0.9,vUv.x);
    gl_FragColor = vec4(col);
}`,X3=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

${tf}

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );

    vUv = uv;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
      vec3 instPosition = vec3(instanceMatrix * vec4(vec3(0.),1.));
    #endif

    #ifdef USE_INSTANCING
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif

    //uv为随机值
    vec2 wh = vec2(2.,4.);
    float rn = ceil(random(instPosition.xy)*wh.x*wh.y);
    vec2 cell = vec2(1.,1.)/wh;vUv = uv/wh;
    vUv+=vec2(cell.x*mod(rn,wh.x),cell.y*(ceil(rn/wh.x)-1.));
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = projectionMatrix*modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = vec4((viewerUV.xyz / viewerUV.w).xy* 0.5 + 0.5,0.,1.);
}`,gg=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
    vUv = uv;
    //UV是反的
    vUv.y = 1.0 - vUv.y;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
    #endif

    #ifdef USE_INSTANCING
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = projectionMatrix*modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = vec4((viewerUV.xyz / viewerUV.w).xy* 0.5 + 0.5,0.,1.);
}`,q3=new ef,Y3=q3.load("Genshin/Login/Textures/Tex_0062.png"),Fo=new $p({uniforms:{cloudTexture:{value:Y3},color_1:{value:new vs("#00a2f0")},color_intensity_1:{value:1},color_2:{value:new vs("#f0f0f5")},color_intensity_2:{value:1}},fragmentShader:j3,vertexShader:X3,transparent:!0,depthWrite:!1}),Q3=new ef,Z3=Q3.load("Genshin/Login/Textures/Tex_0063.png"),K3=new $p({uniforms:{cloudTexture:{value:Z3}},fragmentShader:B3,vertexShader:gg,transparent:!0,depthWrite:!1}),J3=new ef,$3=J3.load("Genshin/Login/Textures/Tex_0067b.png"),eE=new $p({uniforms:{cloudTexture:{value:$3}},fragmentShader:H3,vertexShader:gg,transparent:!0,depthWrite:!1}),Yx=new $p({uniforms:{time:{value:123}},fragmentShader:V3,vertexShader:gg,transparent:!0,depthWrite:!1}),tE=new ef,xv=tE.load("Genshin/Login/Textures/Tex_0071.png");xv.wrapS=hb;xv.wrapT=hb;const Qx=new $p({uniforms:{lightTexture:{value:xv},time:{value:123}},fragmentShader:W3,vertexShader:gg,transparent:!0,depthWrite:!1});class nE{getToonMaterial_Column(z){return z.metalness=.3,z.onBeforeCompile=function(P){let $=P.fragmentShader;$=$.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            vec3 fresnelCol = vec3(0x11,0x2e,0xae)/255.*5.;
            ${z3}
            `),$=$.replace("#include <lights_fragment_begin>",`
            ${uv}
            `),$=$.replace("#include <fog_fragment>",`
            ${U3}
            `),P.fragmentShader=$},z}getToonMaterial_Road(z,P){return z.color.multiply(new vs("#fffcfe").add(new vs().setRGB(.015,0,0))),z.normalMap.minFilter=v3,z.normalMap.anisotropy=P.capabilities.getMaxAnisotropy()/2,z.roughnessMap.anisotropy=P.capabilities.getMaxAnisotropy()/2,z.map.anisotropy=P.capabilities.getMaxAnisotropy()/2,z.roughness=5,z.metalness=0,z.onBeforeCompile=function($){let ve=$.fragmentShader;ve=ve.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            //vec3 fresnelCol = vec3(254., 103., 57.)/255.;
            vec3 fresnelCol = vec3(0.)/255.;
            ${qx}
            `),ve=ve.replace("#include <lights_fragment_begin>",`
            ${uv}
            `),$.fragmentShader=ve},z.needsUpdate=!0,z}getToonMaterial_Door(z,P){return z.metalness=.15,z.color=new vs("#454545"),z.onBeforeCompile=function($){let ve=$.fragmentShader;ve=ve.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            vec3 fresnelCol = vec3(254., 103., 57.)/255.;
            ${qx}
            `),ve=ve.replace("#include <lights_fragment_begin>",`
            ${uv}
            `),$.fragmentShader=ve},z.needsUpdate=!0,z}}const pv=new nE;var eb,tb,nb,rb,ib,nd;class Zp extends(ib=vv,rb=[ac()],nb=[ac({min:0,max:20,step:.001})],tb=[ac()],eb=[ac({min:0,max:20,step:.001})],ib){constructor(){super(...arguments);ag(nd,5,this)}get Cloud_Color_1(){return Fo.uniforms.color_1.value}set Cloud_Color_1(P){Fo.uniforms.color_1.value.copy(P)}get intensity_Color_1(){return Fo.uniforms.color_intensity_1.value}set intensity_Color_1(P){Fo.uniforms.color_intensity_1.value=P}get Cloud_Color_2(){return Fo.uniforms.color_2.value}set Cloud_Color_2(P){Fo.uniforms.color_2.value.copy(P)}get intensity_Color_2(){return Fo.uniforms.color_intensity_2.value}set intensity_Color_2(P){Fo.uniforms.color_intensity_2.value=P}update(P){}}nd=ig(ib),ko(nd,2,"Cloud_Color_1",rb,Zp),ko(nd,2,"intensity_Color_1",nb,Zp),ko(nd,2,"Cloud_Color_2",tb,Zp),ko(nd,2,"intensity_Color_2",eb,Zp),Yp(nd,Zp);class rE extends Uo{zLength=212.4027;offset=new yr(0,34,200);extendNum=1;RoadUnitLength=0;hasStartGame=!1;obj;shouldStop=!1;doorHasCreate=!1;shouldOpenDoor=!1;originPosList=[];mixerList=[];onLoad(){const z=this.viewer.user.resources.SM_Road;this.viewer.scene.add(z),z.traverse($=>{$.receiveShadow=!0,$ instanceof Eu&&($.material=pv.getToonMaterial_Road($.material,this.viewer.renderer),$.receiveShadow=!0)});for(let $ of z.children)$.scale.multiplyScalar(.1),$.position.multiplyScalar(.1),$.position.sub(this.offset);let P=z.children.length;this.RoadUnitLength=P;for(let $=0;$<this.extendNum;$++)for(let ve=0;ve<P;ve++){let ze=this.cloneObject3D(z.children[ve]);ze.position.add(new yr(0,0,-this.zLength*(1+$))),z.add(ze)}this.zLength*=1+this.extendNum,this.obj=z;for(let $=0;$<this.obj.children.length;$++)this.originPosList.push(this.obj.children[$].position.clone());this.on("start",this._startGame,this,!0)}update(z){if(this.obj&&!this.shouldStop){for(let P=0;P<this.obj.children.length;P++)if(this.obj.children[P].position.z>na.z){P%this.RoadUnitLength==0&&this.hasStartGame&&(this.shouldStop=!0,this._showDoor(this.obj.children[P].position.z),jt.emit("showDoor",this.obj.children[P].position.z)),this.obj.children[P].position.sub(new yr(0,0,this.zLength)),this.originPosList[P].sub(new yr(0,0,this.zLength));let $=this.originPosList[P].clone();this.obj.children[P].position.add(new yr(0,-70,0)),ja.TweenManager.KillTweensOf(this.obj.children[P]),ja.TweenManager.Tween(this.obj.children[P]).to({position:$},2).easing(ja.Easing.Back.Out).start()}}for(let P of this.mixerList)P.time+z>1.4583333333333333?(this.doorHasCreate||(jt.emit("doorCreate"),this._creatBackground()),this.shouldOpenDoor&&P.time+z*1.6<P.timeScale*P._actions[0]._clip.duration&&P.update(z*1.6)):P.update(z)}cloneObject3D(z){return z.clone()}_startGame(){this.hasStartGame=!0}_showDoor(z){this.viewer.load({url:"Genshin/Login/DOOR.glb"}).then(P=>{jt.emit("doorCreateBegin"),P.traverse($=>{$ instanceof Eu&&($.castShadow=!0,$.receiveShadow=!0,$.material=pv.getToonMaterial_Door($.material,this.viewer.renderer))}),P.scale.set(.1,.1,.04);for(let $ of P.animations){const ve=new a3(P);ve.clipAction($).setLoop(y3,1),ve.clipAction($).play(),this.mixerList.push(ve)}this.offset.set(0,-this.offset.y,z-this.extendNum*this.zLength-14),P.position.copy(this.offset)})}hasLoadBackground=!1;_creatBackground(){this.hasLoadBackground||(this.viewer.load({url:"Genshin/Login/WHITE_PLANE.glb"}).then(z=>{z.scale.set(.1,.1,.1),z.traverse(P=>{P instanceof Eu&&(P.material.color=new vs("#ffffff").multiplyScalar(3))}),z.position.copy(this.offset),this.doorHasCreate=!0}),this.hasLoadBackground=!0)}openDoor(){this.shouldOpenDoor=!0}}const iE=`
vec3 rgb2hsv(vec3 c)
{
    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

    float d = q.x - min(q.w, q.y);
    float e = 1.0e-10;
    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
}

vec3 hsv2rgb(vec3 c)
{
    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
`;class aE extends u3{constructor(){super("CustomEffect",`
            ${iE}
            ${rd}
            uniform float intensity;
            uniform float whiteAlpha;
            void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
                vec3 linear = aces_fitted(inputColor.rgb);
                vec3 hsv = rgb2hsv(linear);
                hsv.z += intensity; 
                
                vec3 color = mix(hsv2rgb(hsv),vec3(1.),whiteAlpha);
                color = clamp(color,vec3(0.),vec3(1.));
                color = ACES_Inv(color);

                outputColor.rgb = color;
                outputColor.a = inputColor.a;
            }
        `),this.uniforms.set("intensity",new Wx(0)),this.uniforms.set("whiteAlpha",new Wx(0))}}class sE extends h3{_intensity=0;initialize(z){this.effect=new aE}playTransition(){ja.TweenManager.Timeline(this.effect.uniforms.get("intensity")).to({value:3},.84,{easing:ja.Easing.Cubic.In}).start(),ja.TweenManager.Timeline(this.effect.uniforms.get("whiteAlpha")).delay(.5).to({value:1},.2).start()}recoverTransition(){}}const Br=new c3(16736802,35);var ab,sb,ob,dg;class fg extends(ob=Uo,sb=[ac()],ab=[ac({min:0,max:100,step:.01})],ob){constructor(){super(...arguments);ag(dg,5,this);Cx(this,"_originalPos",new yr)}onLoad(P){this._originalPos.set(1e4,0,6e3),this._originalPos.y=Math.sqrt(Math.pow(this._originalPos.x,2)+Math.pow(this._originalPos.z,2))/1.35;let $=new b3;this.viewer.scene.add($),Br.target=$,Br.castShadow=!0,Br.shadow.mapSize.width=1024,Br.shadow.mapSize.height=1024,Br.shadow.camera.top=400,Br.shadow.camera.bottom=-100,Br.shadow.camera.left=-100,Br.shadow.camera.right=400,Br.shadow.camera.near=1,Br.shadow.camera.far=5e4,Br.shadow.bias=-5e-5,this.viewer.scene.add(Br),this.viewer.renderer.shadowMap.enabled=!0}update(P){Br.position.copy(na.clone().add(this._originalPos)),Br.target.position.copy(na)}get color(){return Br.color}set color(P){Br.color.copy(P)}get intensity(){return Br.intensity}set intensity(P){Br.intensity=P}}dg=ig(ob),ko(dg,2,"color",sb,fg),ko(dg,2,"intensity",ab,fg),Yp(dg,fg);const bv=206e3,oE=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec3 vPositionW;

float random(float seed) {
    return fract(sin(seed) * 43758.5453);
}

void main() {
    #include <clipping_planes_fragment>
    vec3 outgoingLight = vec3( 0.0 );
    vec4 diffuseColor = vec4( diffuse, opacity );
    #include <logdepthbuf_fragment>

    #if defined( USE_MAP ) || defined( USE_ALPHAMAP )
        vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
    #endif
    #ifdef USE_MAP
        float rr = vColor.r+vColor.g+vColor.b;
        float randomInt = float(int(random(rr) * 3.0));
        diffuseColor.a *= texture2D( map, vec2(uv.x/3.+randomInt/3.,uv.y)).r;
    #endif
    #ifdef USE_ALPHAMAP
        diffuseColor.a *= texture2D( alphaMap, uv ).g;
    #endif
    //与相机距离越近，透明度降低
    float distanceToCamera = distance(cameraPosition.xyz,vPositionW);
    diffuseColor.a*=smoothstep(1500.,5000.,distanceToCamera);

    #include <color_fragment>
    #include <alphatest_fragment>
    outgoingLight = diffuseColor.rgb;
    #include <output_fragment>
    #include <tonemapping_fragment>
    #include <encodings_fragment>
    #include <fog_fragment>
    #include <premultiplied_alpha_fragment>
}`,lE=`uniform float size;
uniform float scale;
uniform float time;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec3 vPositionW;
float random(float seed) {
    return fract(sin(seed) * 43758.5453);
}

void main() {
    #include <color_vertex>
    #include <morphcolor_vertex>
    #include <begin_vertex>

    //进行随机移动
    float moveLen = 500.;

    vColor;
    transformed+=vec3((random(vColor.r)-0.5)*2.,(random(vColor.g)-0.8)*2.,(random(vColor.b)-0.5)*2.)*sin(time*(0.1*random(vColor.b))+random(vColor.g))*moveLen;
    vColor.a = smoothstep(0.,0.2,sin(time*(1.2*random(vColor.b)+0.4)+random(vColor.g))-0.8);

    #include <morphtarget_vertex>
    #include <project_vertex>
    gl_PointSize = size;
    #ifdef USE_SIZEATTENUATION
        bool isPerspective = isPerspectiveMatrix( projectionMatrix );
        if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
    #endif
    #include <logdepthbuf_vertex>
    #include <clipping_planes_vertex>
    #include <worldpos_vertex>
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    #include <fog_vertex>
}`;let cE=[{Object:"Plane",Location:[39188.92,26406.37,41612.57],Rotation:[1.57,-.85,0]},{Object:"Plane",Location:[38546.52,180333.61,43235.39],Rotation:[1.57,-.85,0]},{Object:"Plane",Location:[47130.91,101574.17,48893.04],Rotation:[1.57,-.85,0]}];class uE extends Uo{PolarLightTransforms=[];lightInst;starParticle;onLoad(){const z=cE;for(let $ of z){let ve={position:new yr($.Location[0]*.1,$.Location[2]*.1,-$.Location[1]*.1),rotation:new yv().setFromEuler(new cb($.Rotation[0],-$.Rotation[1],$.Rotation[2])),scale:new yr(.1,.1,.1)};this.PolarLightTransforms.push(ve)}let P=function($,ve){return $.position.z-ve.position.z};this.PolarLightTransforms.sort(P),this.viewer.load({url:"Genshin/Login/SM_Light.glb"}).then($=>{$.traverse(ve=>{if(ve instanceof Eu){const ze=new mv(ve.geometry,Qx,this.PolarLightTransforms.length);this.viewer.scene.add(ze),this.lightInst=ze,this.updateInstance()}}),this.viewer.scene.remove($)}),this.viewer.addPlugin(hE,{PolarLightTransforms:this.PolarLightTransforms})}update(z){if(Qx.uniforms.time.value+=z,this.lightInst&&this.PolarLightTransforms[this.PolarLightTransforms.length-1].position.z>na.z){const P=this.PolarLightTransforms.pop();P.position.z-=bv*.1,this.PolarLightTransforms.unshift(P),this.updateInstance()}}updateInstance(){for(let z=0;z<this.PolarLightTransforms.length;z++){const P=new gv;P.compose(this.PolarLightTransforms[z].position,this.PolarLightTransforms[z].rotation,this.PolarLightTransforms[z].scale),this.lightInst.setMatrixAt(z,P)}this.lightInst.instanceMatrix.needsUpdate=!0}}class hE extends vv{particlesGeometry;particles;particlesMaterial;LightTransforms;onLoad({PolarLightTransforms:z}){this.LightTransforms=z;const P=[],$=[],ve=400;for(let Ke=0;Ke<ve;Ke++){const vt=(Math.random()-.5)*2500,Zt=(Math.random()-.5)*2500,$e=(Math.random()-.5)*1e3;P.push(vt,Zt,$e);const Rt=Math.random()*3-.2,Tt=Math.random()*3+.5,mn=Math.random()*3+1;$.push(Rt,Tt,mn,1)}this.particlesGeometry=new o3;const Ze=new ef().load("Genshin/Login/Textures/Tex_0075.png"),at=new _3({size:100,transparent:!0,vertexColors:!0,depthWrite:!1,map:Ze});at.userData={time:{value:0}},at.onBeforeCompile=((Ke,vt)=>{Ke.uniforms.time=at.userData.time,Ke.fragmentShader=oE,Ke.vertexShader=lE}),this.particlesMaterial=at,this.particles=new S3(this.particlesGeometry,at),this.particlesGeometry.setAttribute("position",new Gx(P,3)),this.particlesGeometry.setAttribute("color",new Gx($,4)),this.particles.position.set(0,0,-1e3),this.viewer.scene.add(this.particles)}update(z){this.particles.position.set(na.x,na.y,na.z-200),this.particlesMaterial.userData.time.value+=z;let P=this.LightTransforms[this.LightTransforms.length-1].position.clone();P.add(new yr(-2400,-3e3,0)),P.equals(this.particles.position)||this.particles.position.copy(P)}}let Kp=[{Object:"Plane",Location:[-60488.11,30484.8,-6891.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-69542.77,101073.62,-6497.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44203.43,57784.28,-11918.68],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-40366.7,181360.72,-11099.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-72774.31,46232.82,-5950.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38697.31,102738.58,-13675.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-39697.58,89473.2,-12885.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-70576.63,98760.97,-5235.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11577.29,20967.52,-8495.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53051.34,58629.79,-8506.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-40641.91,64329.8,-12371.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66843.48,29598.76,-6530.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-42266.62,117846.26,-11546.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-48705.39,101066.07,-10441.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49567.87,164044.48,-10240.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63117.21,134433.47,-8259.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38076.25,28385.15,-11646.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63856.56,63654.14,-6040.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47108.72,146434.25,-9769.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-65756.09,55139.4,-8018.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66542.17,71700.15,-6776.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-52955.52,118478.04,-8090.08],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-46181.9,17829.44,-12024.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-67787.98,101975.33,-7922.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-70802.82,74705.08,-5455.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77337.82,42162.42,-3855.2],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-58027.16,171653.22,-8907.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47533.1,65320.45,-10543.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-78667.24,28819.17,-3939.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38111.49,79744.12,-11381.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-61521.25,67721.06,-7865.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44977.68,8419.15,-12344.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-41123.9,112317.79,-11020.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49029.45,153857.14,-10354.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47707.91,191223.48,-11574.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-74357.59,77016.9,-6039],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-60313.66,111327.62,-9280.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38888.7,158582.42,-13395.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64989.38,18268.15,-6906.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47702.64,29095.63,-11841.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-37533.73,204645.06,-11568.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-69394.3,30884.51,-7636.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-68848.27,47398.38,-6964.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38732.76,43229.99,-11517.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-73883.41,17287.79,-6478.6],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44755.27,58276.9,-9764.92],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-39071.59,51918.05,-11078.43],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63274.73,40025.57,-8652.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-62579.56,50923.39,-8502.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-42790.08,51176.43,-11429.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53200.27,67074.03,-10203.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77784.38,5304.76,-4549.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49289.36,151485.28,-9629.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-55640.91,190088.7,-10384.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53048.9,175399.2,-10796.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66006.77,86973.08,-6132.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-43524.03,54104.23,-10704.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47088.84,80199.55,-9276.33],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77146.67,58302.61,-3942.77],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66249.42,15264.65,-6270.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64073.55,123106.3,-6906.44],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-46229.73,130501.7,-10025.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-82490.97,173482.25,-4353.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-80608.41,144983.98,-2785.73],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-86136.46,162263.17,-3370.05],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81995.86,158964.97,-2667.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81583.3,86139.34,-4563.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63542.82,191916.59,-8719.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84895.84,94419.38,-3594.49],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64876.92,181148.41,-6024.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-67078.11,187838.31,-5642.94],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66333.29,171824.92,-7252.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84164.83,50794.71,-2514.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-75747.9,93340.18,-5363.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-86779.97,69595.43,-3190.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-68075.7,160090,-6346.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81496.24,184704,-5170.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-74364.87,125927.47,-6323.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-76422.23,128279.49,-5181.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84114.8,78938.19,-3427.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-80861.78,199222.39,-4110.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-90903.52,80324.41,-1891.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-65615.95,200893.42,-6966.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-89984.97,193926.34,-2505.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-79432.23,98348.16,-4836.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-75866.27,166627.03,-6072.61],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-61931.27,171435.47,-7012.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-72609.31,157633.53,-6800.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-71874.77,112376.08,-5185.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-58272.69,194003.62,-8954.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33191.57,192969.95,-12168.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7729.77,203302.69,-12044.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33448.5,124687.7,-14101.5],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10800.77,191961.03,-13088.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26776.67,124435.65,-13278.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-6388.23,188151.53,-11936.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33506.66,167310.17,-12751.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10470.86,124911.66,-12972.34],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[21894.78,153700.95,-11352.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22500.16,104625.02,-11561.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[15021.9,161372.28,-13835.44],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35952.62,8960.45,-12680.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[24983.55,169113.8,-11648.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7514.82,207115.61,-12237.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36099.28,199031.14,-12898.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[30087.89,181245.11,-11916.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[34063.2,97968.63,-14079.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11050.82,106841.92,-13121.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[32327.57,102022.19,-12596.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[8259.29,135051.55,-12240.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35508.52,194710.14,-14040.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[13806.81,131640.5,-13873.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11197.23,203040.88,-12422.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[20678.98,92152.57,-13003.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[27871.1,108478.56,-11428.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[14984.64,203967.14,-12377.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[13265.85,139993.58,-13118.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[31890.34,156823.81,-12186.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23321.93,190977.06,-13803.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10227.62,202461.75,-13626.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[24688.1,69232.33,-12567.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[15203.11,188450.92,-11680.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36308.25,63836.87,-13727.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23746.79,206325.89,-12324.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11698.77,198823.94,-13880.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[19291.59,81163.95,-13557.63],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[16262.82,207534.09,-12083.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[12134.07,147130.5,-12981.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26012.87,138733.91,-11915.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[3466.73,183045.06,-12574.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22092.25,188174.31,-13289.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36754.02,51818.83,-11973.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[8574.26,153492.7,-12620.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[30644.81,186736.53,-13303.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35201.45,106908.62,-13286.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23851.34,78647.8,-12721.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22179.39,167124.92,-13018.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[31671.54,50759.5,-12471.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11813.79,143170.44,-13022.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34351.11,27696.56,-12688.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[21255.91,6485.1,-11217.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11208.84,102613.62,-13130.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33057.55,68809.81,-13096.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[4234.78,51710.18,-11486.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[1667.21,71991.79,-14084.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-3965.94,149901.31,-13356.85],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23668.09,192454.53,-13715.24],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[34579.93,535.9,-12641.43],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12943,136305.36,-11375.42],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36129.8,179558.42,-11778.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21417.77,104294.96,-13669.01],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[18684.31,43129.44,-13519.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10694.96,31095.83,-8981.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-29257.06,34978.15,-12890.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11700.69,128994.75,-12722.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26687.75,37564.85,-12873.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-18283.91,68041.17,-12362.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23971.93,53742.49,-12644.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[1813.69,101170.84,-12334.53],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[201.05,132976.06,-13340.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-109.44,27352.04,-13497.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-29617.71,131991.28,-13137.96],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-31325.67,166604.19,-13429.68],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34200.95,156391.66,-13779.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7907.19,39106.35,-11793.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-798.99,83786.37,-12406.34],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-32995.72,124826.48,-11257.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-8568.22,119949.73,-13907.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21707.48,89456.42,-11855.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-13206.12,108514.83,-12494.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36359.77,147442.47,-14037.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-20089.54,125311.23,-11847.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-24227.66,206625,-11776.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-10234.68,116258.25,-12829.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23368.36,114280.21,-13810.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22199.9,47657.26,-13026.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23635.01,28632.46,-11560.63],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6880.52,87265.32,-13670.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-27647.29,86538.07,-13170.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-27256.34,69600.05,-11908.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-15893.25,60098.4,-11558.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33723.85,193627.64,-11240.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23819.21,76624.97,-8963.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-8552.08,8124.37,-13352.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33068.69,127354.11,-12455.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-3920.98,91168.34,-13107.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-2587.8,125725.26,-11725.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[886.14,134066.64,-13209.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-16435.53,43916.24,-12313.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36057.67,34172.8,-12659.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-35375.84,181701.91,-11995.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-10987.94,50148.55,-11494.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7678.29,38058.29,-12141.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6170.16,48239.19,-13554.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[2379.64,25611.57,-12964.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1434.87,118983.62,-13924.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-17754.98,71741.3,-12472.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-4099.07,83695.23,-13730.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-19459.88,121049.45,-12919.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6969.36,32893.25,-12802.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-6095.34,96087.12,-12933.86],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-32797.46,71242.98,-13183.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[16729.79,11503.73,-12044.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-15198.83,103351.99,-12469.89],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-22466.19,192079.95,-13829.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1313.15,99086.27,-12820.38],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36871.18,185380.89,-12529.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-35360.94,7367.01,-11563.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12880.47,169898.52,-12104.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-26283.14,114315.76,-12690.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26090.14,1625.05,-12106.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[17351.56,62470.75,-13134.32],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21606.88,101088.28,-12209.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-175.6,51561.08,-9890.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[20253.86,20200.81,-13226.5],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7315.29,38971.62,-11814.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34409.87,153439.33,-12254.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-22889.51,195137.83,-13730.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-13531.78,44644.05,-13348.08],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-26576.53,28506.67,-12224.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-9095.18,57368.46,-12946.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12337.18,52056.7,-12155.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-17948.2,33375.7,-13310.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1353.68,31655.12,-13855.3],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7224.22,104272.54,-13626.86],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71511.45,107899.02,-7124.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72810.08,49857.28,-6531.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[64592.77,101436.56,-7718.37],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[73622.58,51558.74,-6659.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[43200.82,18227.13,-12499.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82170.21,124002.15,-3823],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[57687.3,6002.62,-8528.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[66682.44,62333.83,-6221.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[52207.59,65898.03,-9726.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62883.23,20746.46,-6422.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71609.9,168502.23,-4851.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[67136.91,65582.41,-5919.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75239.44,110216.45,-6259.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[56903.44,75679.29,-8625.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82051.9,-1572.71,-3188.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70423.33,94955.27,-6042.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72738.38,131873.92,-4846.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[59108.46,77306.6,-9113.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58786.59,93678.12,-7196.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89295.12,11261.52,-3815.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[61955.38,52479.84,-7401.91],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[63051.84,96387.06,-8603.96],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[83699.05,64346.81,-1973.48],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[85843.8,204874.86,-1584.47],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70186.14,69562.7,-5121.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[85904.45,171221.14,-3911.47],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49979.89,36179.12,-11089.29],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70919.38,173793.12,-6153.13],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[83566.2,136606.17,-3045.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[87411.4,5028.76,-3804.73],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[76811.52,2662.42,-5780.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58347.78,980.65,-7687.67],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75660.41,9705.05,-5236.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[80207.13,24260.02,-3198.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46530.74,30774.18,-10716.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[68274.11,69517.43,-7040.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[88295.8,143629.58,-1557.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72078.51,161115.12,-4719.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[74671.67,130453.27,-4800.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[77906.59,145324.61,-3230.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[42864.79,10651.66,-10540.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65980.25,79478.13,-6033.32],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82617.17,120626.51,-2973.77],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89755.86,50612.07,-1160.1],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[91043.76,77887.8,-2530.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[90599.33,109670.28,-2722.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[90479.91,120468.84,-3154.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71373.92,180298.23,-4948.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65874.48,33575.15,-7683.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62643.75,90847.28,-8991.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[81936.69,37121.51,-3387.95],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45169.82,791.72,-12092.89],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[77392.2,110209.6,-5039],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[79861.74,102198.28,-5329.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62561.84,12948.66,-7417.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89089.84,112020.41,-2143.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[56783.67,48e3,-9931.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[69571.55,57019.32,-6273.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[80563.8,113249.64,-4021.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[86451.38,38681.21,-2109.67],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75966.5,80977.07,-4593.61],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[42461.85,-2206.48,-10773.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[66021.14,180875.58,-6845.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44038.62,115115.38,-9916.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65524.25,173954.56,-6129.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49752.55,78332.03,-9069.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[63932.05,150056.62,-8121.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[37629.06,99027.16,-13346.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[43775.45,156398.53,-9922.48],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36576.96,23631.96,-7747.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45697.84,147818.84,-11227.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49266.07,175812.95,-8835],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[50142.55,169308.12,-10517.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45726.14,195604.75,-10526.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[54675.18,149483.39,-7877.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[69604.1,181135.42,-6380.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44948.47,176907.08,-11097.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[39166.82,61122.98,-10930.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44173.32,143495.72,-10092.98],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62606.25,167094.27,-8288.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[52247.95,102230.37,-8862.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46775.55,194146.84,-11945.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[40302,56987.04,-10790.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[59000.56,126305.89,-9596.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[55809.79,206690.89,-8221.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[40529.25,200411.97,-11612.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[54145.5,113944.23,-9723.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46014.91,133397.47,-10047.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[57505.39,140903.88,-9929.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46285.07,117698.52,-9400.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58556.93,207930.09,-8139.21],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[67890.2,177279.2,-7288.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[61931.2,188274.8,-7540.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[53601.83,108660.44,-9249.3],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[60339.25,194334.88,-8445.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[60801.77,180457.8,-7048.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[53743.35,182143.38,-10774.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7154.81,13400.49,-9534.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7615.13,110930.13,-9485.18],Rotation:[1.57,-0,0],Scale:[300,300,300]}];class dE extends Uo{posList=[];instanceMesh;onLoad(z){const P=new ub(3e3,1500),$=new mv(P,Fo,Kp.length);for(let ze=0;ze<Kp.length;ze++){const Ze=new yr(Kp[ze].Location[0],Kp[ze].Location[2],-Kp[ze].Location[1]).multiplyScalar(.1);this.posList.push(Ze)}let ve=function(ze,Ze){return ze.z-Ze.z};this.posList.sort(ve),this.instanceMesh=$,this.updateInstance(),this.viewer.scene.add($)}update(z){if(this.instanceMesh&&this.posList[this.posList.length-1].z>na.z){const P=this.posList.pop();P.z-=bv*.1,this.posList.unshift(P),this.updateInstance()}}updateInstance(){const z=new yv,P=new yr(1,1,1);for(let $=0;$<this.posList.length;$++){const ve=new gv;ve.compose(this.posList[$],z,P),this.instanceMesh.setMatrixAt($,ve)}this.instanceMesh.instanceMatrix.needsUpdate=!0}}class pE extends Uo{FogList=[];number=1;interval=80;onLoad(z){const P=new ub(1e3,1e3);for(let $=0;$<this.number;$++){const ve=new Eu(P,Yx);ve.position.z=-$*this.interval,this.viewer.scene.add(ve),this.FogList.push(ve)}}update(z){for(let P=0;P<this.FogList.length;P++)this.FogList[P].position.z=na.z-P*80-400;Yx.uniforms.time.value+=z}}let fE=[{Object:"SM_Qiao01",Location:[-3259.54,55909.38,-8971.05],Rotation:[0,-0,-3.26],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[-9677.17,56694.38,-8971.05],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-16160.93,57487.46,-8971.05],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-19991.23,57955.97,-12244.69],Rotation:[0,-0,-3.26],Scale:[7.49,7.49,7.49]},{Object:"SM_Qiao01",Location:[19413.68,26615.11,-9828.82],Rotation:[0,-0,-5.34],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[6706.94,30988.29,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[10552.28,36268.59,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao01",Location:[16803.78,85760.77,-9828.82],Rotation:[0,-0,-2.88],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[10555.82,84097.91,-9828.82],Rotation:[0,-0,-2.88],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-18525.85,69364.14,-12612.54],Rotation:[0,-0,0],Scale:[9.76,9.76,9.76]},{Object:"SM_ZhuZi01",Location:[-4961.68,77231.14,-16825.37],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-28871.62,103671.23,-11160.32],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[18490.02,38575.96,-18797.49],Rotation:[0,-0,-3.22],Scale:[10.6,10.6,10.6]},{Object:"SM_ZhuZi01",Location:[13441.07,68078.86,-31761.5],Rotation:[0,-0,0],Scale:[16.33,16.33,16.33]},{Object:"SM_ZhuZi01",Location:[13322.26,94559.95,-14267.74],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[4877.59,7859.61,-8885.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-47983.31,98522.4,-21724.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-4796.11,14035.09,-10501.75],Rotation:[0,-0,2.73],Scale:[5.52,5.52,5.52]},{Object:"SM_Qiao01",Location:[-3259.54,154108.7,-9828.82],Rotation:[0,-0,-3.26],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[-9677.17,154893.7,-9828.82],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-16160.93,155686.78,-9828.82],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-19991.23,156155.3,-9828.82],Rotation:[0,-0,-3.26],Scale:[5.52,5.52,5.52]},{Object:"SM_Qiao01",Location:[7277.17,116763.12,-9828.82],Rotation:[0,-0,-5.34],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[11083.29,121989.55,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[14928.63,127269.85,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao01",Location:[25034.26,183082.17,-9828.82],Rotation:[0,-0,-2.88],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[18786.29,181419.3,-9828.82],Rotation:[0,-0,-2.88],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-18525.85,167563.45,-12612.54],Rotation:[0,-0,0],Scale:[9.76,9.76,9.76]},{Object:"SM_ZhuZi01",Location:[21543.86,202600.36,-11815.69],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-28871.62,201870.55,-11160.32],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[27176.13,183971.92,-13077.91],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[9400.02,134814.62,-17395.76],Rotation:[0,-0,-3.22],Scale:[10.6,10.6,10.6]},{Object:"SM_ZhuZi01",Location:[13441.07,166278.17,-33032.77],Rotation:[0,-0,0],Scale:[16.33,16.33,16.33]},{Object:"SM_ZhuZi01",Location:[21552.73,191881.36,-14267.74],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[4877.59,106058.93,-13314.7],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-14183.06,121644.65,-13454.14],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-47983.31,196721.72,-21724.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[12424.48,53632.54,-8836.33],Rotation:[0,-0,-.14],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[5957.73,54554.15,-8836.33],Rotation:[0,-0,-.14],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[16131.76,53104.19,-15754.45],Rotation:[0,-0,-.14],Scale:[12.56,12.56,12.56]},{Object:"SM_Qiao02",Location:[20564.82,21186.92,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[14154.31,22441.3,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[14190.16,22434.29,-9103.71],Rotation:[0,-0,-.19],Scale:[4.16,4.16,4.16]},{Object:"SM_ZhuZi02",Location:[-24156.43,48468.04,-11681.44],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[12409.99,39026.4,-9229.88],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[13072.63,15697.74,-9052.71],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-20425.44,93584.4,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-13926.08,94237.45,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-24151.42,93210.02,-10667.05],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-13962.42,94233.8,-9103.71],Rotation:[0,-0,-3.04],Scale:[4.16,4.16,4.16]},{Object:"SM_Qiao02",Location:[-12631.35,83666.99,-6470.84],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-7632.57,79462.19,-6470.84],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-43669.46,107924.12,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-46243.29,101920.48,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[24239.87,20467.79,-10667.05],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[12899.75,150950.73,-9694.1],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[6489.23,152205.14,-9694.1],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-7462.1,173587.48,-13131.17],Rotation:[0,-0,-.19],Scale:[12.3,12.3,12.3]},{Object:"SM_Qiao02",Location:[28685.56,121142.08,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[22275.04,122396.45,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[22310.89,122389.44,-9103.71],Rotation:[0,-0,-.19],Scale:[4.16,4.16,4.16]},{Object:"SM_ZhuZi02",Location:[-46214.1,154239.41,-11681.44],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[16786.33,130027.66,-6284.35],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[21461.64,110428.16,-12232.26],Rotation:[0,-0,-.19],Scale:[10.35,10.35,10.35]},{Object:"SM_Qiao02",Location:[-20425.44,191783.73,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-13926.08,192436.77,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-24151.42,191409.36,-10667.05],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-13962.42,192433.11,-9103.71],Rotation:[0,-0,-3.04],Scale:[4.16,4.16,4.16]},{Object:"SM_Qiao02",Location:[-15131.77,180023.33,-7205.48],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-10132.99,175818.53,-7205.48],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-43669.46,206123.42,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-46243.29,200119.8,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[32360.61,120422.95,-10667.05],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-10041.13,151780.16,-4538.24],Rotation:[0,-0,-.19],Scale:[4.36,4.36,4.36]},{Object:"SM_ZhuZi02",Location:[-15583.6,24915.45,-16764.29],Rotation:[0,-0,-.19],Scale:[11.01,11.01,11.01]},{Object:"SM_ZhuZi02",Location:[-5821.24,114219,-14220.5],Rotation:[0,-0,-.19],Scale:[8.77,8.77,8.77]},{Object:"SM_ZhuZi02",Location:[18945.66,86650.52,-13077.91],Rotation:[0,-0,-.14],Scale:[11.02,11.02,11.02]},{Object:"SM_Qiao04",Location:[-6615.05,35478.82,-10267.71],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[21913.41,38149.66,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[25049.79,37910.36,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,69364.13,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,69364.14,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7843.3,92904.8,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10854.39,93814.42,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-9760.54,35478.82,-10267.71],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,69364.13,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,69364.14,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-10147.13,133691.66,-6631.95],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[3693.11,135250.05,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[6829.48,135010.75,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[16073.78,190226.2,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[19084.87,191135.83,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-13292.62,133691.66,-6631.95],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10601.09,7859.6,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-21301.37,25171.66,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-18159.03,25030.85,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-23313.97,25261.84,-22485.36],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-19169.94,48441.03,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-22315.43,48441.03,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-17155.32,48441.03,-22345.92],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7455.6,7859.6,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10601.09,106058.93,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-19900.83,121900.85,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-16758.5,121760.05,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-21913.43,121991.04,-22485.36],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-41227.61,154212.38,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-44373.1,154212.39,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-39213,154212.38,-22345.92],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7455.6,106058.93,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-8441.4,11828.74,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-5816.18,13430.53,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-11060.07,10230.94,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-21684.16,67868.18,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-15456.73,70656.77,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-35647.27,65416.07,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-22937.42,82841.48,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-28350.31,86995.72,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-12151.61,74563.68,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-17564.5,78717.92,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-1365.8,66285.88,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-6778.69,70440.12,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[9420.01,58008.08,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[4007.12,62162.32,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-10240.84,111312.08,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-7615.61,112913.88,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-12859.51,109714.29,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-21684.16,166067.5,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-15456.73,168856.08,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-35647.27,163615.41,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-22937.42,181040.8,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-28350.31,185195.05,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-12151.61,172763,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-17564.5,176917.23,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-1365.8,164485.2,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-6778.69,168639.44,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[9420.01,156207.41,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[4007.12,160361.66,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_ZhuZi04",Location:[-4725.46,35505.06,-22840.58],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-10787.73,69364.13,-26072.59],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[5914.76,92322.2,-27727.79],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-8132.51,133691.66,-25333.54],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-10787.73,167563.45,-26072.59],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[14145.23,189643.61,-27727.79],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[5676.85,35604.1,-19298.23],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]}],og=new gv,lg=new yr,cg=new yv,ug=new yr,Zx=new cb;class mE extends Uo{columeInstanceMap=new Map;onLoad(){const z=this.cloneList(fE);for(let P of z)this.columeInstanceMap.has(P.Object)||this.columeInstanceMap.set(P.Object,{indexList:[],instance:[]}),this.columeInstanceMap.get(P.Object).indexList.push(P);for(let P of this.columeInstanceMap.keys())this.viewer.load({url:"Genshin/Login/"+P+".glb"}).then($=>{let ve=this.columeInstanceMap.get(P);$.traverse(ze=>{if(ze instanceof Eu){let Ze=pv.getToonMaterial_Column(ze.material);const at=new mv(ze.geometry,Ze,ve.indexList.length);at.castShadow=!0;for(let Ke=0;Ke<ve.indexList.length;Ke++){let vt=ve.indexList[Ke];lg.set(vt.Location[0]*.1,vt.Location[2]*.1,-vt.Location[1]*.1),cg.setFromEuler(Zx.set(vt.Rotation[0],vt.Rotation[2],vt.Rotation[1])),ug.set(vt.Scale[0]*.1,vt.Scale[2]*.1,vt.Scale[1]*.1),og.compose(lg,cg,ug),at.setMatrixAt(Ke,og)}this.viewer.scene.add(at),ve.instance.push(at)}}),this.viewer.scene.remove($)})}update(z){for(let P of this.columeInstanceMap.values())for(let $=0;$<P.indexList.length;$++)if(-P.indexList[$].Location[1]*.1>na.z+2e3){P.indexList[$].Location[1]+=bv,lg.set(P.indexList[$].Location[0]*.1,P.indexList[$].Location[2]*.1,-P.indexList[$].Location[1]*.1),cg.setFromEuler(Zx.set(P.indexList[$].Rotation[0],P.indexList[$].Rotation[2],P.indexList[$].Rotation[1])),ug.set(P.indexList[$].Scale[0]*.1,P.indexList[$].Scale[2]*.1,P.indexList[$].Scale[1]*.1),og.compose(lg,cg,ug);for(let ve of P.instance)ve.setMatrixAt($,og),ve.instanceMatrix.needsUpdate=!0}}cloneList(z){let P=[];for(let $ of z)P.push({Object:$.Object,Location:$.Location.slice(),Rotation:$.Rotation.slice(),Scale:$.Scale.slice()});return P}}class gE extends Uo{originalPos=new yr;vCloud;onLoad(z){this.viewer.load({url:"Genshin/Login/SM_BigCloud.glb"}).then(P=>{this.vCloud=P;for(let $ of P.children)$.position.multiplyScalar(.1),$.scale.multiplyScalar(.1);P.traverse($=>{$ instanceof Eu&&($.renderOrder=-1,$.name=="Plane011"?$.material=K3:$.material=eE)})})}update(z){this.vCloud&&this.vCloud.position.copy(na)}}function hv(ee){let z=-(Math.sqrt(10)*Math.sqrt(-187248350*Math.pow(ee,2)+232585567*ee+241290)+21650*ee-1230),P=98370*ee-1e5;return z/P}function vE(ee){let z=new Vx;z.set(1.76474,-.67577,-.08896,-.14702,1.16025,-.01322,-.03633,-.16243,1.19877);let P=new Vx;return P.set(.64304,.31119,.04578,.05926,.93144,.00929,.00596,.06393,.93012),ee=ee.applyMatrix3(P),ee.set(hv(ee.x),hv(ee.y),hv(ee.z)),ee=ee.applyMatrix3(z),ee}function yE(ee){let z=new yr(ee.r,ee.g,ee.b);return z=vE(z),ee.r=z.x,ee.g=z.y,ee.b=z.z,ee}class xE extends vv{onLoad(){const P=window.innerHeight,$=new vs().setHex(7252),ve=new vs().setHex(147361),ze=new vs().setHex(2533631),Ze=.2,at=.6,Ke=new Float32Array(1*P*4);for(let Zt=0;Zt<P;Zt++)for(let $e=0;$e<1;$e++){const Rt=(Zt*1+$e)*4;let Tt=1-Zt/(P-1),mn=1-this.smoothstep(0,Ze,Tt),Ot=this.smoothstep(0,Ze,Tt)*(1-this.smoothstep(Ze,at,Tt)),Lt=Math.pow(this.smoothstep(Ze,at,Tt),1),rr=new vs().setRGB(Math.min(mn*$.r+Ot*ve.r+Lt*ze.r,1e5),Math.min(mn*$.g+Ot*ve.g+Lt*ze.g,1e5),Math.min(mn*$.b+Ot*ve.b+Lt*ze.b,1e5));yE(rr),Ke[Rt]=rr.r,Ke[Rt+1]=rr.g,Ke[Rt+2]=rr.b,Ke[Rt+3]=1}const vt=new l3(Ke,1,P,w3,f3);vt.needsUpdate=!0,this.viewer.scene.background=vt}smoothstep(z,P,$){return Math.max(0,Math.min(($-z)/(P-z),1))}}const{TweenManager:bE}=ja;let SE=Jp.prototype._onResize;function mb(){var ee=document.documentElement.clientWidth,z=document.documentElement.clientHeight;ee>z?Jp.prototype._onResize=SE:Jp.prototype._onResize=function(){this.viewer.resize(z,ee),this.viewer.emit(Jp.RESIZE,z,ee)}}mb();var _E="resize";window.addEventListener(_E,mb,!1);class wE{viewer;SM=new N3(this);constructor(z){this.viewer=new A3({canvas:z,camera:{fov:45,near:50,far:1e5,rotation:r3(5.5*Math.PI/180,0,0)},user:new I3,linear:!1,toneMapping:x3,outputEncoding:g3}),this.SM.registState(ME),this.SM.registState(TE),this.SM.setState("StatePreload"),this.SM.setState("StateGame")}destroy(){this.SM.reset(),this.viewer.destroy()}}class ME extends fb{name="StatePreload";onEnter(){const z=this.target.viewer.user.resources;return Promise.all([jt.task(Qr.Load({url:"Genshin/Login/DOOR.glb"}).then(P=>z.DOOR=P),{name:"DOOR"}),jt.task(Qr.Load({url:"Genshin/Login/SM_BigCloud.glb"}).then(P=>z.SM_BigCloud=P),{name:"SM_BigCloud"}),jt.task(Qr.Load({url:"Genshin/Login/SM_Light.glb"}).then(P=>z.SM_Light=P),{name:"SM_Light"}),jt.task(Qr.Load({url:"Genshin/Login/SM_Qiao01.glb"}).then(P=>z.SM_Qiao01=P),{name:"SM_Qiao01"}),jt.task(Qr.Load({url:"Genshin/Login/SM_Qiao02.glb"}).then(P=>z.SM_Qiao02=P),{name:"SM_Qiao02"}),jt.task(Qr.Load({url:"Genshin/Login/SM_Qiao03.glb"}).then(P=>z.SM_Qiao03=P),{name:"SM_Qiao03"}),jt.task(Qr.Load({url:"Genshin/Login/SM_Qiao04.glb"}).then(P=>z.SM_Qiao04=P),{name:"SM_Qiao04"}),jt.task(Qr.Load({url:"Genshin/Login/SM_Road.glb"}).then(P=>z.SM_Road=P),{name:"SM_Road"}),jt.task(Qr.Load({url:"Genshin/Login/SM_ZhuZi01.glb"}).then(P=>z.SM_ZhuZi01=P),{name:"SM_ZhuZi01"}),jt.task(Qr.Load({url:"Genshin/Login/SM_ZhuZi02.glb"}).then(P=>z.SM_ZhuZi02=P),{name:"SM_ZhuZi02"}),jt.task(Qr.Load({url:"Genshin/Login/SM_ZhuZi03.glb"}).then(P=>z.SM_ZhuZi03=P),{name:"SM_ZhuZi03"}),jt.task(Qr.Load({url:"Genshin/Login/SM_ZhuZi04.glb"}).then(P=>z.SM_ZhuZi04=P),{name:"SM_ZhuZi04"}),jt.task(Qr.Load({url:"Genshin/Login/WHITE_PLANE.glb"}).then(P=>z.WHITE_PLANE=P),{name:"WHITE_PLANE"})])}}class TE extends fb{name="StateGame";_road;_BloomTransition;_forwardCamera;onEnter(...z){this._initScene(),this._initAudios()}_initScene(){const z=this.target.viewer;z.scene.fog=new m3(3709682,5e3,1e4),z.addNode(pg),z.addNode(fg),z.addNode(uE),z.addNode(dE),z.addNode(pE),z.addNode(mE),z.addNode(gE),this._forwardCamera=z.addNode(F3),this._road=z.addNode(rE),z.addPlugin(xE),z.addPlugin(p3),z.addPlugin(s3,{mipmapBlur:!0,luminanceThreshold:2,intensity:.6}),this._BloomTransition=z.addPlugin(sE),z.addPlugin(E3,{mode:T3.ACES_FILMIC}),jt.on("start",this._startGame,this,!0)}_initAudios(){const z=this.target.viewer,P=z.addNode(jx),$=z.addNode(jx);jt.on("canvas-click",()=>{P.play({url:"/Genshin/BGM.mp3",loop:!0})}),jt.on("button-start-click",()=>{P.play({url:"/Genshin/BGM.mp3",loop:!0}),$.play({url:"/Genshin/Genshin Impact [Duang].mp3",force:!0})}),jt.on("openDoor",()=>{setTimeout(()=>$.play({url:"/Genshin/Genshin Impact [DoorThrough].mp3",force:!0}),150)}),jt.on("doorCreateBegin",()=>{setTimeout(()=>$.play({url:"/Genshin/Genshin Impact [DoorComeout].mp3",force:!0}),150)})}_startGame(z){this._road.emit("start"),jt.on("showDoor",P=>{this._forwardCamera.emit("showDoor",P),jt.on("doorCreate",()=>this.target.viewer.on(Jp.POINTER_DOWN,this._jump,this,!0),this,!0)},this,!0)}_jump(){jt.emit("openDoor"),this._forwardCamera.emit("openDoor"),this._BloomTransition.playTransition(),bE.Timeline(this).delay(.1).call(()=>{this._road.openDoor()}).delay(2).call(()=>{jt.restart(),console.log("restart")}).start()}}Qr.Load({url:"/Genshin/BGM.mp3"});Qr.Load({url:"/Genshin/Genshin Impact [Duang].mp3"});Qr.Load({url:"/Genshin/Genshin Impact [DoorThrough].mp3"});Qr.Load({url:"/Genshin/Genshin Impact [DoorComeout].mp3"});document.documentElement.clientWidth;document.documentElement.clientHeight;function EE({...ee}){const z=Zr.useRef(null);return Zr.useEffect(()=>{const P=new wE(z.current);return()=>P.destroy()},[jt.restartCount]),nn.jsx("aside",{className:"webgl-wrapper",children:nn.jsx("canvas",{onClick:()=>jt.emit("canvas-click"),ref:z,className:"webgl-canvas",width:"10px",style:{width:"10px"},...ee,children:"No Canvas!"})})}function AE(){const[ee,z]=Zr.useState(!0);return Zr.useEffect(()=>(jt.on("preloaded",()=>z(!1)),jt.on("restart",()=>z(!0)),()=>{jt.reset(),C3()}),[jt.restartCount]),nn.jsxs(nn.Fragment,{children:[nn.jsx(EE,{}),ee&&nn.jsx(O3,{}),!ee&&nn.jsx(L3,{})]})}function gb(){var ee=document.documentElement.clientWidth,z=document.documentElement.clientHeight;const P=document.getElementById("root");ee>z?(P.style.transform="rotate(0deg)",P.style.width=`${ee}px`,P.style.height=`${z}px`,P.style.top="0px",P.style.left="0px"):(P.style.transform="rotate(90deg)",P.style.width=`${z}px`,P.style.height=`${ee}px`,P.style.top=`${(z-ee)/2}px`,P.style.left=`${0-(z-ee)/2}px`)}gb();var RE="resize";window.addEventListener(RE,gb,!1);e3.createRoot(document.getElementById("root")).render(nn.jsx(qT.StrictMode,{children:nn.jsx(AE,{})}));
